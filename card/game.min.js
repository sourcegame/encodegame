getNetSendByGameID=function(a){switch(a){case 17:case 25:case 27:return MGGameInfo.MINI_GAME_INFO[a].game.netSend;default:return MGGameInfo.GAME_INFO[a].game.netSend}};var timeBe,timeEn,TestTimeBegin=function(){timeBe=(new Date).getTime()},TestTimeEnd=function(){timeEn=(new Date).getTime()};var PreLoaderConfig={apiPath:"http://localhost:5000/passport/v1/",pathResource:"",BackgroundMain:"res/main/GameIcons/BackgroundMain.jpg",Service:"game",PackageName:"abc",ServerAndPortSocketManager:"localhost:1230",PathToAvatar:"ImageAvatar_",PathToAvatarDefault:"ImageAvatar_1.png",PathToResourceDefault:cc.loader.resPath+"res/",ServerAndPortGame:"",PathToGameClass:"",EnableLog:!0,Messages:{ERROR_LOGIN_INFO:"Thông tin đăng nhập không hợp lệ",ERROR_LOGIN_SOCKETINFO:"Đăng nhập không thành công",
ERROR_REGISTER_USERNAME:"Vui lòng nhập tên đăng ký",ERROR_UPDATENAME_USERNAME:"Tên không hợp lệ",ERROR_REGISTER_PASSWORD:"Mật khẩu không trùng khớp",ERROR_REGISTER_CAPCHA:"Capcha không chính xác",ERROR_MASTER_SOCKET:"Không thể kết nối máy chủ",ERROR_LOST_ACTION:"Bạn đã không thao tác khá lâu, bạn sẽ được đẩy ra phòng chờ",ERROR_DO_NOT_LOGIN:"Vui lòng đăng nhập",REGISTER_SUCCESS:"Đăng ký thành công",ERROR_NOT_ENOUGH_GOLD:"Bạn không đủ gold để tham gia bàn chơi. \nXin vui lòng nạp gold để tiếp tục chơi",
ERROR_GAME_NOT_EXIST:"Game không tồn tại",Footer:"Phiên bản 0.1 - Tổng đài: 19001080 - Email: hotro@abc.vn"},LINKS:{FANPAGE:"",FORUM:"",HOTLINE:""},timePingMaster:1E4,timePingGame:1E4,TIME_LOST_ACTION:60,TIME_WAITING_ACTION:10,EVENT_DOISAO:!1,MINI_GAME:!1,RUONG_DO:!0,URL:{NAP_GOLD:"/nap-tien",HOME:"/"},MapResourceFolder:{AtlasLobby:"general/",IFish:"general/"},IDTaiXiu:1,IDTLMN:2,IDXocDia:3,IDXengMini:4,IDSamLoc:5,IDBinh:6,IDPhom:7,IDXito:8,IDPoker:9,IDLieng:10,IDDanhChan:11,IDSlotPoker:12,IDSlotLuxury:13,
IDFruitKong:14,IDDemCuu:15,IDDiamonds777:16,IDMiniTrenDuoi:17,IDSlotBAPD:18,IDSlotVanPhuc:19,IDSlotPanda:20,IDSlotHoangCung:21,IDSlotThamHiem:22,IDSlotAladin:23,IDSlotAiCap:24,IDMiniCaoThap:25,IDMiniVQMM:26,IDMiniDaoMo:27};window.PreLoaderConfig=PreLoaderConfig;(function(a,b){"object"===typeof exports?module.exports=exports=b():"function"===typeof define&&define.amd?define([],b):a.CryptoJS=b()})(this,function(){var a=a||function(a,d){var e=Object.create||function(){function a(){}return function(b){a.prototype=b;b=new a;a.prototype=null;return b}}(),f={},g=f.lib={},h=g.Base=function(){return{extend:function(a){var b=e(this);a&&b.mixIn(a);b.hasOwnProperty("init")&&this.init!==b.init||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=
b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),k=g.WordArray=h.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=d?b:4*a.length},toString:function(a){return(a||n).stringify(this)},concat:function(a){var b=this.words,d=a.words,e=
this.sigBytes;a=a.sigBytes;this.clamp();if(e%4)for(var f=0;f<a;f++)b[e+f>>>2]|=(d[f>>>2]>>>24-f%4*8&255)<<24-(e+f)%4*8;else for(f=0;f<a;f+=4)b[e+f>>>2]=d[f>>>2];this.sigBytes+=a;return this},clamp:function(){var d=this.words,e=this.sigBytes;d[e>>>2]&=4294967295<<32-e%4*8;d.length=a.ceil(e/4)},clone:function(){var a=h.clone.call(this);a.words=this.words.slice(0);return a},random:function(d){for(var e=[],f=function(d){var e=987654321;return function(){e=36969*(e&65535)+(e>>16)&4294967295;d=18E3*(d&
65535)+(d>>16)&4294967295;return(((e<<16)+d&4294967295)/4294967296+.5)*(.5<a.random()?1:-1)}},g=0,h;g<d;g+=4){var l=f(4294967296*(h||a.random()));h=987654071*l();e.push(4294967296*l()|0)}return new k.init(e,d)}}),l=f.enc={},n=l.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var d=[],e=0;e<a;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16));d.push((f&15).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,d=[],e=0;e<b;e+=2)d[e>>>3]|=parseInt(a.substr(e,2),
16)<<24-e%8*4;return new k.init(d,b/2)}},m=l.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var d=[],e=0;e<a;e++)d.push(String.fromCharCode(b[e>>>2]>>>24-e%4*8&255));return d.join("")},parse:function(a){for(var b=a.length,d=[],e=0;e<b;e++)d[e>>>2]|=(a.charCodeAt(e)&255)<<24-e%4*8;return new k.init(d,b)}},u=l.Utf8={stringify:function(a){try{return decodeURIComponent(escape(m.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return m.parse(unescape(encodeURIComponent(a)))}},
x=g.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new k.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=u.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(d){var e=this._data,f=e.words,g=e.sigBytes,h=this.blockSize,l=g/(4*h),l=d?a.ceil(l):a.max((l|0)-this._minBufferSize,0);d=l*h;g=a.min(4*d,g);if(d){for(var m=0;m<d;m+=h)this._doProcessBlock(f,m);m=f.splice(0,d);e.sigBytes-=g}return new k.init(m,g)},clone:function(){var a=h.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=x.extend({cfg:h.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){x.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,d){return(new a.init(d)).finalize(b)}},_createHmacHelper:function(a){return function(b,d){return(new A.HMAC.init(a,
d)).finalize(b)}}});var A=f.algo={};return f}(Math);(function(){var b=a,d=b.lib.WordArray;b.enc.Base64={stringify:function(a){var b=a.words,d=a.sigBytes,h=this._map;a.clamp();a=[];for(var k=0;k<d;k+=3)for(var l=(b[k>>>2]>>>24-k%4*8&255)<<16|(b[k+1>>>2]>>>24-(k+1)%4*8&255)<<8|b[k+2>>>2]>>>24-(k+2)%4*8&255,n=0;4>n&&k+.75*n<d;n++)a.push(h.charAt(l>>>6*(3-n)&63));if(b=h.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var b=a.length,g=this._map,h=this._reverseMap;if(!h)for(var h=
this._reverseMap=[],k=0;k<g.length;k++)h[g.charCodeAt(k)]=k;if(g=g.charAt(64))g=a.indexOf(g),-1!==g&&(b=g);for(var g=[],l=k=0;l<b;l++)if(l%4){var n=h[a.charCodeAt(l-1)]<<l%4*2,m=h[a.charCodeAt(l)]>>>6-l%4*2;g[k>>>2]|=(n|m)<<24-k%4*8;k++}return d.create(g,k)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(b){function d(a,b,d,e,f,g,h){a=a+(b&d|~b&e)+f+h;return(a<<g|a>>>32-g)+b}function e(a,b,d,e,f,g,h){a=a+(b&e|d&~e)+f+h;return(a<<g|a>>>32-g)+b}function f(a,
b,d,e,f,g,h){a=a+(b^d^e)+f+h;return(a<<g|a>>>32-g)+b}function g(a,b,d,e,f,g,h){a=a+(d^(b|~e))+f+h;return(a<<g|a>>>32-g)+b}var h=a,k=h.lib,l=k.WordArray,n=k.Hasher,k=h.algo,m=[];(function(){for(var a=0;64>a;a++)m[a]=4294967296*b.abs(b.sin(a+1))|0})();k=k.MD5=n.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,b){for(var h=0;16>h;h++){var l=b+h,k=a[l];a[l]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}var h=this._hash.words,
l=a[b+0],k=a[b+1],n=a[b+2],F=a[b+3],v=a[b+4],z=a[b+5],w=a[b+6],H=a[b+7],C=a[b+8],B=a[b+9],K=a[b+10],L=a[b+11],N=a[b+12],Q=a[b+13],I=a[b+14],M=a[b+15],q=h[0],r=h[1],p=h[2],t=h[3],q=d(q,r,p,t,l,7,m[0]),t=d(t,q,r,p,k,12,m[1]),p=d(p,t,q,r,n,17,m[2]),r=d(r,p,t,q,F,22,m[3]),q=d(q,r,p,t,v,7,m[4]),t=d(t,q,r,p,z,12,m[5]),p=d(p,t,q,r,w,17,m[6]),r=d(r,p,t,q,H,22,m[7]),q=d(q,r,p,t,C,7,m[8]),t=d(t,q,r,p,B,12,m[9]),p=d(p,t,q,r,K,17,m[10]),r=d(r,p,t,q,L,22,m[11]),q=d(q,r,p,t,N,7,m[12]),t=d(t,q,r,p,Q,12,m[13]),p=
d(p,t,q,r,I,17,m[14]),r=d(r,p,t,q,M,22,m[15]),q=e(q,r,p,t,k,5,m[16]),t=e(t,q,r,p,w,9,m[17]),p=e(p,t,q,r,L,14,m[18]),r=e(r,p,t,q,l,20,m[19]),q=e(q,r,p,t,z,5,m[20]),t=e(t,q,r,p,K,9,m[21]),p=e(p,t,q,r,M,14,m[22]),r=e(r,p,t,q,v,20,m[23]),q=e(q,r,p,t,B,5,m[24]),t=e(t,q,r,p,I,9,m[25]),p=e(p,t,q,r,F,14,m[26]),r=e(r,p,t,q,C,20,m[27]),q=e(q,r,p,t,Q,5,m[28]),t=e(t,q,r,p,n,9,m[29]),p=e(p,t,q,r,H,14,m[30]),r=e(r,p,t,q,N,20,m[31]),q=f(q,r,p,t,z,4,m[32]),t=f(t,q,r,p,C,11,m[33]),p=f(p,t,q,r,L,16,m[34]),r=f(r,p,
t,q,I,23,m[35]),q=f(q,r,p,t,k,4,m[36]),t=f(t,q,r,p,v,11,m[37]),p=f(p,t,q,r,H,16,m[38]),r=f(r,p,t,q,K,23,m[39]),q=f(q,r,p,t,Q,4,m[40]),t=f(t,q,r,p,l,11,m[41]),p=f(p,t,q,r,F,16,m[42]),r=f(r,p,t,q,w,23,m[43]),q=f(q,r,p,t,B,4,m[44]),t=f(t,q,r,p,N,11,m[45]),p=f(p,t,q,r,M,16,m[46]),r=f(r,p,t,q,n,23,m[47]),q=g(q,r,p,t,l,6,m[48]),t=g(t,q,r,p,H,10,m[49]),p=g(p,t,q,r,I,15,m[50]),r=g(r,p,t,q,z,21,m[51]),q=g(q,r,p,t,N,6,m[52]),t=g(t,q,r,p,F,10,m[53]),p=g(p,t,q,r,K,15,m[54]),r=g(r,p,t,q,k,21,m[55]),q=g(q,r,p,
t,C,6,m[56]),t=g(t,q,r,p,M,10,m[57]),p=g(p,t,q,r,w,15,m[58]),r=g(r,p,t,q,Q,21,m[59]),q=g(q,r,p,t,v,6,m[60]),t=g(t,q,r,p,L,10,m[61]),p=g(p,t,q,r,n,15,m[62]),r=g(r,p,t,q,B,21,m[63]);h[0]=h[0]+q|0;h[1]=h[1]+r|0;h[2]=h[2]+p|0;h[3]=h[3]+t|0},_doFinalize:function(){var a=this._data,d=a.words,e=8*this._nDataBytes,f=8*a.sigBytes;d[f>>>5]|=128<<24-f%32;var g=b.floor(e/4294967296);d[(f+64>>>9<<4)+15]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360;d[(f+64>>>9<<4)+14]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;
a.sigBytes=4*(d.length+1);this._process();a=this._hash;d=a.words;for(e=0;4>e;e++)f=d[e],d[e]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return a},clone:function(){var a=n.clone.call(this);a._hash=this._hash.clone();return a}});h.MD5=n._createHelper(k);h.HmacMD5=n._createHmacHelper(k)})(Math);(function(){var b=a,d=b.lib,e=d.WordArray,f=d.Hasher,g=[],d=b.algo.SHA1=f.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,
b){for(var d=this._hash.words,e=d[0],f=d[1],u=d[2],x=d[3],A=d[4],y=0;80>y;y++){if(16>y)g[y]=a[b+y]|0;else{var J=g[y-3]^g[y-8]^g[y-14]^g[y-16];g[y]=J<<1|J>>>31}J=(e<<5|e>>>27)+A+g[y];J=20>y?J+((f&u|~f&x)+1518500249):40>y?J+((f^u^x)+1859775393):60>y?J+((f&u|f&x|u&x)-1894007588):J+((f^u^x)-899497514);A=x;x=u;u=f<<30|f>>>2;f=e;e=J}d[0]=d[0]+e|0;d[1]=d[1]+f|0;d[2]=d[2]+u|0;d[3]=d[3]+x|0;d[4]=d[4]+A|0},_doFinalize:function(){var a=this._data,b=a.words,d=8*this._nDataBytes,e=8*a.sigBytes;b[e>>>5]|=128<<
24-e%32;b[(e+64>>>9<<4)+14]=Math.floor(d/4294967296);b[(e+64>>>9<<4)+15]=d;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=f.clone.call(this);a._hash=this._hash.clone();return a}});b.SHA1=f._createHelper(d);b.HmacSHA1=f._createHmacHelper(d)})();(function(b){var d=a,e=d.lib,f=e.WordArray,g=e.Hasher,e=d.algo,h=[],k=[];(function(){function a(d){for(var e=b.sqrt(d),f=2;f<=e;f++)if(!(d%f))return!1;return!0}function d(a){return 4294967296*(a-(a|0))|0}for(var e=2,f=0;64>f;)a(e)&&
(8>f&&(h[f]=d(b.pow(e,.5))),k[f]=d(b.pow(e,1/3)),f++),e++})();var l=[],e=e.SHA256=g.extend({_doReset:function(){this._hash=new f.init(h.slice(0))},_doProcessBlock:function(a,b){for(var d=this._hash.words,e=d[0],f=d[1],g=d[2],h=d[3],G=d[4],F=d[5],v=d[6],z=d[7],w=0;64>w;w++){if(16>w)l[w]=a[b+w]|0;else{var H=l[w-15],C=l[w-2];l[w]=((H<<25|H>>>7)^(H<<14|H>>>18)^H>>>3)+l[w-7]+((C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10)+l[w-16]}H=z+((G<<26|G>>>6)^(G<<21|G>>>11)^(G<<7|G>>>25))+(G&F^~G&v)+k[w]+l[w];C=((e<<30|e>>>
2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&f^e&g^f&g);z=v;v=F;F=G;G=h+H|0;h=g;g=f;f=e;e=H+C|0}d[0]=d[0]+e|0;d[1]=d[1]+f|0;d[2]=d[2]+g|0;d[3]=d[3]+h|0;d[4]=d[4]+G|0;d[5]=d[5]+F|0;d[6]=d[6]+v|0;d[7]=d[7]+z|0},_doFinalize:function(){var a=this._data,d=a.words,e=8*this._nDataBytes,f=8*a.sigBytes;d[f>>>5]|=128<<24-f%32;d[(f+64>>>9<<4)+14]=b.floor(e/4294967296);d[(f+64>>>9<<4)+15]=e;a.sigBytes=4*d.length;this._process();return this._hash},clone:function(){var a=g.clone.call(this);a._hash=this._hash.clone();return a}});
d.SHA256=g._createHelper(e);d.HmacSHA256=g._createHmacHelper(e)})(Math);(function(){function b(a){return a<<8&4278255360|a>>>8&16711935}var d=a,e=d.lib.WordArray,d=d.enc;d.Utf16=d.Utf16BE={stringify:function(a){var b=a.words;a=a.sigBytes;for(var d=[],e=0;e<a;e+=2)d.push(String.fromCharCode(b[e>>>2]>>>16-e%4*8&65535));return d.join("")},parse:function(a){for(var b=a.length,d=[],k=0;k<b;k++)d[k>>>1]|=a.charCodeAt(k)<<16-k%2*16;return e.create(d,2*b)}};d.Utf16LE={stringify:function(a){var d=a.words;
a=a.sigBytes;for(var e=[],k=0;k<a;k+=2){var l=b(d[k>>>2]>>>16-k%4*8&65535);e.push(String.fromCharCode(l))}return e.join("")},parse:function(a){for(var d=a.length,h=[],k=0;k<d;k++)h[k>>>1]|=b(a.charCodeAt(k)<<16-k%2*16);return e.create(h,2*d)}}})();(function(){if("function"==typeof ArrayBuffer){var b=a.lib.WordArray,d=b.init;(b.init=function(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));if(a instanceof Int8Array||"undefined"!==typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray||a instanceof
Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);if(a instanceof Uint8Array){for(var b=a.byteLength,g=[],h=0;h<b;h++)g[h>>>2]|=a[h]<<24-h%4*8;d.call(this,g,b)}else d.apply(this,arguments)}).prototype=b}})();(function(b){function d(a,b){return a<<b|a>>>32-b}b=a;var e=b.lib,f=e.WordArray,g=e.Hasher,e=b.algo,h=f.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,
7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),k=f.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=f.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,
14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),n=f.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),m=f.create([0,1518500249,1859775393,2400959708,2840853838]),u=f.create([1352829926,1548603684,1836072691,2053994217,0]),e=e.RIPEMD160=g.extend({_doReset:function(){this._hash=f.create([1732584193,4023233417,2562383102,
271733878,3285377520])},_doProcessBlock:function(a,b){for(var e=0;16>e;e++){var f=b+e,g=a[f];a[f]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}var f=this._hash.words,g=m.words,F=u.words,v=h.words,z=k.words,w=l.words,H=n.words,C,B,K,L,N,Q,I,M,q,r;Q=C=f[0];I=B=f[1];M=K=f[2];q=L=f[3];r=N=f[4];for(var p,e=0;80>e;e+=1)p=C+a[b+v[e]]|0,p=16>e?p+((B^K^L)+g[0]):32>e?p+((B&K|~B&L)+g[1]):48>e?p+(((B|~K)^L)+g[2]):64>e?p+((B&L|K&~L)+g[3]):p+((B^(K|~L))+g[4]),p|=0,p=d(p,w[e]),p=p+N|0,C=N,N=L,L=d(K,10),K=B,B=
p,p=Q+a[b+z[e]]|0,p=16>e?p+((I^(M|~q))+F[0]):32>e?p+((I&q|M&~q)+F[1]):48>e?p+(((I|~M)^q)+F[2]):64>e?p+((I&M|~I&q)+F[3]):p+((I^M^q)+F[4]),p|=0,p=d(p,H[e]),p=p+r|0,Q=r,r=q,q=d(M,10),M=I,I=p;p=f[1]+K+q|0;f[1]=f[2]+L+r|0;f[2]=f[3]+N+Q|0;f[3]=f[4]+C+I|0;f[4]=f[0]+B+M|0;f[0]=p},_doFinalize:function(){var a=this._data,b=a.words,d=8*this._nDataBytes,e=8*a.sigBytes;b[e>>>5]|=128<<24-e%32;b[(e+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360;a.sigBytes=4*(b.length+1);this._process();a=this._hash;
b=a.words;for(d=0;5>d;d++)e=b[d],b[d]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;return a},clone:function(){var a=g.clone.call(this);a._hash=this._hash.clone();return a}});b.RIPEMD160=g._createHelper(e);b.HmacRIPEMD160=g._createHmacHelper(e)})(Math);(function(){var b=a,d=b.enc.Utf8;b.algo.HMAC=b.lib.Base.extend({init:function(a,b){a=this._hasher=new a.init;"string"==typeof b&&(b=d.parse(b));var g=a.blockSize,h=4*g;b.sigBytes>h&&(b=a.finalize(b));b.clamp();for(var k=this._oKey=b.clone(),l=this._iKey=
b.clone(),n=k.words,m=l.words,u=0;u<g;u++)n[u]^=1549556828,m[u]^=909522486;k.sigBytes=l.sigBytes=h;this.reset()},reset:function(){var a=this._hasher;a.reset();a.update(this._iKey)},update:function(a){this._hasher.update(a);return this},finalize:function(a){var b=this._hasher;a=b.finalize(a);b.reset();return b.finalize(this._oKey.clone().concat(a))}})})();(function(){var b=a,d=b.lib,e=d.Base,f=d.WordArray,d=b.algo,g=d.HMAC,h=d.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:d.SHA1,iterations:1}),init:function(a){this.cfg=
this.cfg.extend(a)},compute:function(a,b){for(var d=this.cfg,e=g.create(d.hasher,a),h=f.create(),x=f.create([1]),A=h.words,y=x.words,J=d.keySize,d=d.iterations;A.length<J;){var G=e.update(b).finalize(x);e.reset();for(var F=G.words,v=F.length,z=G,w=1;w<d;w++){z=e.finalize(z);e.reset();for(var H=z.words,C=0;C<v;C++)F[C]^=H[C]}h.concat(G);y[0]++}h.sigBytes=4*J;return h}});b.PBKDF2=function(a,b,d){return h.create(d).compute(a,b)}})();(function(){var b=a,d=b.lib,e=d.Base,f=d.WordArray,d=b.algo,g=d.EvpKDF=
e.extend({cfg:e.extend({keySize:4,hasher:d.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var d=this.cfg,e=d.hasher.create(),g=f.create(),u=g.words,x=d.keySize,d=d.iterations;u.length<x;){A&&e.update(A);var A=e.update(a).finalize(b);e.reset();for(var y=1;y<d;y++)A=e.finalize(A),e.reset();g.concat(A)}g.sigBytes=4*x;return g}});b.EvpKDF=function(a,b,d){return g.create(d).compute(a,b)}})();(function(){var b=a,d=b.lib.WordArray,e=b.algo,f=e.SHA256,e=e.SHA224=
f.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=f._doFinalize.call(this);a.sigBytes-=4;return a}});b.SHA224=f._createHelper(e);b.HmacSHA224=f._createHmacHelper(e)})();(function(b){var d=a,e=d.lib,f=e.Base,g=e.WordArray,d=d.x64={};d.Word=f.extend({init:function(a,b){this.high=a;this.low=b}});d.WordArray=f.extend({init:function(a,d){a=this.words=a||[];this.sigBytes=d!=b?d:8*a.length},
toX32:function(){for(var a=this.words,b=a.length,d=[],e=0;e<b;e++){var f=a[e];d.push(f.high);d.push(f.low)}return g.create(d,this.sigBytes)},clone:function(){for(var a=f.clone.call(this),b=a.words=this.words.slice(0),d=b.length,e=0;e<d;e++)b[e]=b[e].clone();return a}})})();(function(b){var d=a,e=d.lib,f=e.WordArray,g=e.Hasher,h=d.x64.Word,e=d.algo,k=[],l=[],n=[];(function(){for(var a=1,b=0,d=0;24>d;d++){k[a+5*b]=(d+1)*(d+2)/2%64;var e=(2*a+3*b)%5,a=b%5,b=e}for(a=0;5>a;a++)for(b=0;5>b;b++)l[a+5*b]=
b+(2*a+3*b)%5*5;a=1;for(b=0;24>b;b++){for(var f=e=d=0;7>f;f++){if(a&1){var g=(1<<f)-1;32>g?e^=1<<g:d^=1<<g-32}a=a&128?a<<1^113:a<<1}n[b]=h.create(d,e)}})();var m=[];(function(){for(var a=0;25>a;a++)m[a]=h.create()})();e=e.SHA3=g.extend({cfg:g.cfg.extend({outputLength:512}),_doReset:function(){for(var a=this._state=[],b=0;25>b;b++)a[b]=new h.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,b){for(var d=this._state,e=this.blockSize/2,f=0;f<e;f++){var g=a[b+2*f],h=a[b+
2*f+1],g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,h=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,v=d[f];v.high^=h;v.low^=g}for(e=0;24>e;e++){for(f=0;5>f;f++){for(var z=g=0,w=0;5>w;w++)v=d[f+5*w],g^=v.high,z^=v.low;v=m[f];v.high=g;v.low=z}for(f=0;5>f;f++)for(v=m[(f+4)%5],g=m[(f+1)%5],h=g.high,w=g.low,g=v.high^(h<<1|w>>>31),z=v.low^(w<<1|h>>>31),w=0;5>w;w++)v=d[f+5*w],v.high^=g,v.low^=z;for(h=1;25>h;h++)v=d[h],f=v.high,v=v.low,w=k[h],32>w?(g=f<<w|v>>>32-w,z=v<<w|f>>>32-w):(g=v<<w-32|f>>>64-
w,z=f<<w-32|v>>>64-w),v=m[l[h]],v.high=g,v.low=z;v=m[0];f=d[0];v.high=f.high;v.low=f.low;for(f=0;5>f;f++)for(w=0;5>w;w++)h=f+5*w,v=d[h],g=m[h],h=m[(f+1)%5+5*w],z=m[(f+2)%5+5*w],v.high=g.high^~h.high&z.high,v.low=g.low^~h.low&z.low;v=d[0];f=n[e];v.high^=f.high;v.low^=f.low}},_doFinalize:function(){var a=this._data,d=a.words,e=8*a.sigBytes,g=32*this.blockSize;d[e>>>5]|=1<<24-e%32;d[(b.ceil((e+1)/g)*g>>>5)-1]|=128;a.sigBytes=4*d.length;this._process();for(var a=this._state,d=this.cfg.outputLength/8,
e=d/8,g=[],h=0;h<e;h++){var l=a[h],k=l.high,l=l.low,k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,l=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360;g.push(l);g.push(k)}return new f.init(g,d)},clone:function(){for(var a=g.clone.call(this),b=a._state=this._state.slice(0),d=0;25>d;d++)b[d]=b[d].clone();return a}});d.SHA3=g._createHelper(e);d.HmacSHA3=g._createHmacHelper(e)})(Math);(function(){function b(){return g.create.apply(g,arguments)}var d=a,e=d.lib.Hasher,f=d.x64,g=f.Word,h=f.WordArray,f=
d.algo,k=[b(1116352408,3609767458),b(1899447441,602891725),b(3049323471,3964484399),b(3921009573,2173295548),b(961987163,4081628472),b(1508970993,3053834265),b(2453635748,2937671579),b(2870763221,3664609560),b(3624381080,2734883394),b(310598401,1164996542),b(607225278,1323610764),b(1426881987,3590304994),b(1925078388,4068182383),b(2162078206,991336113),b(2614888103,633803317),b(3248222580,3479774868),b(3835390401,2666613458),b(4022224774,944711139),b(264347078,2341262773),b(604807628,2007800933),
b(770255983,1495990901),b(1249150122,1856431235),b(1555081692,3175218132),b(1996064986,2198950837),b(2554220882,3999719339),b(2821834349,766784016),b(2952996808,2566594879),b(3210313671,3203337956),b(3336571891,1034457026),b(3584528711,2466948901),b(113926993,3758326383),b(338241895,168717936),b(666307205,1188179964),b(773529912,1546045734),b(1294757372,1522805485),b(1396182291,2643833823),b(1695183700,2343527390),b(1986661051,1014477480),b(2177026350,1206759142),b(2456956037,344077627),b(2730485921,
1290863460),b(2820302411,3158454273),b(3259730800,3505952657),b(3345764771,106217008),b(3516065817,3606008344),b(3600352804,1432725776),b(4094571909,1467031594),b(275423344,851169720),b(430227734,3100823752),b(506948616,1363258195),b(659060556,3750685593),b(883997877,3785050280),b(958139571,3318307427),b(1322822218,3812723403),b(1537002063,2003034995),b(1747873779,3602036899),b(1955562222,1575990012),b(2024104815,1125592928),b(2227730452,2716904306),b(2361852424,442776044),b(2428436474,593698344),
b(2756734187,3733110249),b(3204031479,2999351573),b(3329325298,3815920427),b(3391569614,3928383900),b(3515267271,566280711),b(3940187606,3454069534),b(4118630271,4000239992),b(116418474,1914138554),b(174292421,2731055270),b(289380356,3203993006),b(460393269,320620315),b(685471733,587496836),b(852142971,1086792851),b(1017036298,365543100),b(1126000580,2618297676),b(1288033470,3409855158),b(1501505948,4234509866),b(1607167915,987167468),b(1816402316,1246189591)],l=[];(function(){for(var a=0;80>a;a++)l[a]=
b()})();f=f.SHA512=e.extend({_doReset:function(){this._hash=new h.init([new g.init(1779033703,4089235720),new g.init(3144134277,2227873595),new g.init(1013904242,4271175723),new g.init(2773480762,1595750129),new g.init(1359893119,2917565137),new g.init(2600822924,725511199),new g.init(528734635,4215389547),new g.init(1541459225,327033209)])},_doProcessBlock:function(a,b){for(var d=this._hash.words,e=d[0],f=d[1],g=d[2],h=d[3],G=d[4],F=d[5],v=d[6],d=d[7],z=e.high,w=e.low,H=f.high,C=f.low,B=g.high,K=
g.low,L=h.high,N=h.low,Q=G.high,I=G.low,M=F.high,q=F.low,r=v.high,p=v.low,t=d.high,ia=d.low,S=z,O=w,ca=H,aa=C,da=B,ba=K,la=L,ea=N,T=Q,P=I,ja=M,fa=q,ka=r,ga=p,ma=t,ha=ia,U=0;80>U;U++){var X=l[U];if(16>U)var R=X.high=a[b+2*U]|0,D=X.low=a[b+2*U+1]|0;else{var R=l[U-15],D=R.high,V=R.low,R=(D>>>1|V<<31)^(D>>>8|V<<24)^D>>>7,V=(V>>>1|D<<31)^(V>>>8|D<<24)^(V>>>7|D<<25),Z=l[U-2],D=Z.high,E=Z.low,Z=(D>>>19|E<<13)^(D<<3|E>>>29)^D>>>6,E=(E>>>19|D<<13)^(E<<3|D>>>29)^(E>>>6|D<<26),D=l[U-7],na=D.high,Y=l[U-16],W=
Y.high,Y=Y.low,D=V+D.low,R=R+na+(D>>>0<V>>>0?1:0),D=D+E,R=R+Z+(D>>>0<E>>>0?1:0),D=D+Y,R=R+W+(D>>>0<Y>>>0?1:0);X.high=R;X.low=D}var na=T&ja^~T&ka,Y=P&fa^~P&ga,X=S&ca^S&da^ca&da,pa=O&aa^O&ba^aa&ba,V=(S>>>28|O<<4)^(S<<30|O>>>2)^(S<<25|O>>>7),Z=(O>>>28|S<<4)^(O<<30|S>>>2)^(O<<25|S>>>7),E=k[U],qa=E.high,oa=E.low,E=ha+((P>>>14|T<<18)^(P>>>18|T<<14)^(P<<23|T>>>9)),W=ma+((T>>>14|P<<18)^(T>>>18|P<<14)^(T<<23|P>>>9))+(E>>>0<ha>>>0?1:0),E=E+Y,W=W+na+(E>>>0<Y>>>0?1:0),E=E+oa,W=W+qa+(E>>>0<oa>>>0?1:0),E=E+D,W=
W+R+(E>>>0<D>>>0?1:0),D=Z+pa,X=V+X+(D>>>0<Z>>>0?1:0),ma=ka,ha=ga,ka=ja,ga=fa,ja=T,fa=P,P=ea+E|0,T=la+W+(P>>>0<ea>>>0?1:0)|0,la=da,ea=ba,da=ca,ba=aa,ca=S,aa=O,O=E+D|0,S=W+X+(O>>>0<E>>>0?1:0)|0}w=e.low=w+O;e.high=z+S+(w>>>0<O>>>0?1:0);C=f.low=C+aa;f.high=H+ca+(C>>>0<aa>>>0?1:0);K=g.low=K+ba;g.high=B+da+(K>>>0<ba>>>0?1:0);N=h.low=N+ea;h.high=L+la+(N>>>0<ea>>>0?1:0);I=G.low=I+P;G.high=Q+T+(I>>>0<P>>>0?1:0);q=F.low=q+fa;F.high=M+ja+(q>>>0<fa>>>0?1:0);p=v.low=p+ga;v.high=r+ka+(p>>>0<ga>>>0?1:0);ia=d.low=
ia+ha;d.high=t+ma+(ia>>>0<ha>>>0?1:0)},_doFinalize:function(){var a=this._data,b=a.words,d=8*this._nDataBytes,e=8*a.sigBytes;b[e>>>5]|=128<<24-e%32;b[(e+128>>>10<<5)+30]=Math.floor(d/4294967296);b[(e+128>>>10<<5)+31]=d;a.sigBytes=4*b.length;this._process();return this._hash.toX32()},clone:function(){var a=e.clone.call(this);a._hash=this._hash.clone();return a},blockSize:32});d.SHA512=e._createHelper(f);d.HmacSHA512=e._createHmacHelper(f)})();(function(){var b=a,d=b.x64,e=d.Word,f=d.WordArray,d=b.algo,
g=d.SHA512,d=d.SHA384=g.extend({_doReset:function(){this._hash=new f.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var a=g._doFinalize.call(this);a.sigBytes-=16;return a}});b.SHA384=g._createHelper(d);b.HmacSHA384=g._createHmacHelper(d)})();a.lib.Cipher||
function(b){var d=a,e=d.lib,f=e.Base,g=e.WordArray,h=e.BufferedBlockAlgorithm,k=d.enc.Base64,l=d.algo.EvpKDF,n=e.Cipher=h.extend({cfg:f.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,d){this.cfg=this.cfg.extend(d);this._xformMode=a;this._key=b;this.reset()},reset:function(){h.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},
finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(a){return{encrypt:function(b,d,e){return("string"==typeof d?J:y).encrypt(a,b,d,e)},decrypt:function(b,d,e){return("string"==typeof d?J:y).decrypt(a,b,d,e)}}}}()});e.StreamCipher=n.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var m=d.mode={},u=e.BlockCipherMode=f.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,
b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}}),m=m.CBC=function(){function a(d,e,f){var g=this._iv;g?this._iv=b:g=this._prevBlock;for(var h=0;h<f;h++)d[e+h]^=g[h]}var d=u.extend();d.Encryptor=d.extend({processBlock:function(b,d){var e=this._cipher,f=e.blockSize;a.call(this,b,d,f);e.encryptBlock(b,d);this._prevBlock=b.slice(d,d+f)}});d.Decryptor=d.extend({processBlock:function(b,d){var e=this._cipher,f=e.blockSize,g=b.slice(d,d+
f);e.decryptBlock(b,d);a.call(this,b,d,f);this._prevBlock=g}});return d}(),x=(d.pad={}).Pkcs7={pad:function(a,b){for(var d=4*b,d=d-a.sigBytes%d,e=d<<24|d<<16|d<<8|d,f=[],h=0;h<d;h+=4)f.push(e);d=g.create(f,d);a.concat(d)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=n.extend({cfg:n.cfg.extend({mode:m,padding:x}),reset:function(){n.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var d=a.createEncryptor;else d=a.createDecryptor,
this._minBufferSize=1;this._mode&&this._mode.__creator==d?this._mode.init(this,b&&b.words):(this._mode=d.call(a,this,b&&b.words),this._mode.__creator=d)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var A=e.CipherParams=f.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||
this.formatter).stringify(this)}}),m=(d.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?g.create([1398893684,1701076831]).concat(a).concat(b):b).toString(k)},parse:function(a){a=k.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var d=g.create(b.slice(2,4));b.splice(0,4);a.sigBytes-=16}return A.create({ciphertext:a,salt:d})}},y=e.SerializableCipher=f.extend({cfg:f.extend({format:m}),encrypt:function(a,b,d,e){e=this.cfg.extend(e);var f=a.createEncryptor(d,
e);b=f.finalize(b);f=f.cfg;return A.create({ciphertext:b,key:d,iv:f.iv,algorithm:a,mode:f.mode,padding:f.padding,blockSize:a.blockSize,formatter:e.format})},decrypt:function(a,b,d,e){e=this.cfg.extend(e);b=this._parse(b,e.format);return a.createDecryptor(d,e).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),d=(d.kdf={}).OpenSSL={execute:function(a,b,d,e){e||(e=g.random(8));a=l.create({keySize:b+d}).compute(a,e);d=g.create(a.words.slice(b),4*d);a.sigBytes=
4*b;return A.create({key:a,iv:d,salt:e})}},J=e.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:d}),encrypt:function(a,b,d,e){e=this.cfg.extend(e);d=e.kdf.execute(d,a.keySize,a.ivSize);e.iv=d.iv;a=y.encrypt.call(this,a,b,d.key,e);a.mixIn(d);return a},decrypt:function(a,b,d,e){e=this.cfg.extend(e);b=this._parse(b,e.format);d=e.kdf.execute(d,a.keySize,a.ivSize,b.salt);e.iv=d.iv;return y.decrypt.call(this,a,b,d.key,e)}})}();a.mode.CFB=function(){function b(a,b,d,h){var k=this._iv;k?(k=k.slice(0),
this._iv=void 0):k=this._prevBlock;h.encryptBlock(k,0);for(h=0;h<d;h++)a[b+h]^=k[h]}var d=a.lib.BlockCipherMode.extend();d.Encryptor=d.extend({processBlock:function(a,d){var g=this._cipher,h=g.blockSize;b.call(this,a,d,h,g);this._prevBlock=a.slice(d,d+h)}});d.Decryptor=d.extend({processBlock:function(a,d){var g=this._cipher,h=g.blockSize,k=a.slice(d,d+h);b.call(this,a,d,h,g);this._prevBlock=k}});return d}();a.mode.ECB=function(){var b=a.lib.BlockCipherMode.extend();b.Encryptor=b.extend({processBlock:function(a,
b){this._cipher.encryptBlock(a,b)}});b.Decryptor=b.extend({processBlock:function(a,b){this._cipher.decryptBlock(a,b)}});return b}();a.pad.AnsiX923={pad:function(a,d){var e=a.sigBytes,f=4*d,f=f-e%f,e=e+f-1;a.clamp();a.words[e>>>2]|=f<<24-e%4*8;a.sigBytes+=f},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};a.pad.Iso10126={pad:function(b,d){var e=4*d,e=e-b.sigBytes%e;b.concat(a.lib.WordArray.random(e-1)).concat(a.lib.WordArray.create([e<<24],1))},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-
1>>>2]&255}};a.pad.Iso97971={pad:function(b,d){b.concat(a.lib.WordArray.create([2147483648],1));a.pad.ZeroPadding.pad(b,d)},unpad:function(b){a.pad.ZeroPadding.unpad(b);b.sigBytes--}};a.mode.OFB=function(){var b=a.lib.BlockCipherMode.extend(),d=b.Encryptor=b.extend({processBlock:function(a,b){var d=this._cipher,h=d.blockSize,k=this._iv,l=this._keystream;k&&(l=this._keystream=k.slice(0),this._iv=void 0);d.encryptBlock(l,0);for(d=0;d<h;d++)a[b+d]^=l[d]}});b.Decryptor=d;return b}();a.pad.NoPadding={pad:function(){},
unpad:function(){}};(function(b){b=a;var d=b.lib.CipherParams,e=b.enc.Hex;b.format.Hex={stringify:function(a){return a.ciphertext.toString(e)},parse:function(a){a=e.parse(a);return d.create({ciphertext:a})}}})();(function(){var b=a,d=b.lib.BlockCipher,e=b.algo,f=[],g=[],h=[],k=[],l=[],n=[],m=[],u=[],x=[],A=[];(function(){for(var a=[],b=0;256>b;b++)a[b]=128>b?b<<1:b<<1^283;for(var d=0,e=0,b=0;256>b;b++){var z=e^e<<1^e<<2^e<<3^e<<4,z=z>>>8^z&255^99;f[d]=z;g[z]=d;var w=a[d],y=a[w],C=a[y],B=257*a[z]^
16843008*z;h[d]=B<<24|B>>>8;k[d]=B<<16|B>>>16;l[d]=B<<8|B>>>24;n[d]=B;B=16843009*C^65537*y^257*w^16843008*d;m[z]=B<<24|B>>>8;u[z]=B<<16|B>>>16;x[z]=B<<8|B>>>24;A[z]=B;d?(d=w^a[a[a[C^w]]],e^=a[a[e]]):d=e=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],e=e.AES=d.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var a=this._keyPriorReset=this._key,b=a.words,d=a.sigBytes/4,a=4*((this._nRounds=d+6)+1),e=this._keySchedule=[],g=0;g<a;g++)if(g<d)e[g]=b[g];else{var h=e[g-1];g%
d?6<d&&4==g%d&&(h=f[h>>>24]<<24|f[h>>>16&255]<<16|f[h>>>8&255]<<8|f[h&255]):(h=h<<8|h>>>24,h=f[h>>>24]<<24|f[h>>>16&255]<<16|f[h>>>8&255]<<8|f[h&255],h^=y[g/d|0]<<24);e[g]=e[g-d]^h}b=this._invKeySchedule=[];for(d=0;d<a;d++)g=a-d,h=d%4?e[g]:e[g-4],b[d]=4>d||4>=g?h:m[f[h>>>24]]^u[f[h>>>16&255]]^x[f[h>>>8&255]]^A[f[h&255]]}},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,h,k,l,n,f)},decryptBlock:function(a,b){var d=a[b+1];a[b+1]=a[b+3];a[b+3]=d;this._doCryptBlock(a,b,this._invKeySchedule,
m,u,x,A,g);d=a[b+1];a[b+1]=a[b+3];a[b+3]=d},_doCryptBlock:function(a,b,d,e,f,g,h,l){for(var k=this._nRounds,m=a[b]^d[0],n=a[b+1]^d[1],u=a[b+2]^d[2],A=a[b+3]^d[3],y=4,x=1;x<k;x++)var q=e[m>>>24]^f[n>>>16&255]^g[u>>>8&255]^h[A&255]^d[y++],r=e[n>>>24]^f[u>>>16&255]^g[A>>>8&255]^h[m&255]^d[y++],p=e[u>>>24]^f[A>>>16&255]^g[m>>>8&255]^h[n&255]^d[y++],A=e[A>>>24]^f[m>>>16&255]^g[n>>>8&255]^h[u&255]^d[y++],m=q,n=r,u=p;q=(l[m>>>24]<<24|l[n>>>16&255]<<16|l[u>>>8&255]<<8|l[A&255])^d[y++];r=(l[n>>>24]<<24|l[u>>>
16&255]<<16|l[A>>>8&255]<<8|l[m&255])^d[y++];p=(l[u>>>24]<<24|l[A>>>16&255]<<16|l[m>>>8&255]<<8|l[n&255])^d[y++];A=(l[A>>>24]<<24|l[m>>>16&255]<<16|l[n>>>8&255]<<8|l[u&255])^d[y++];a[b]=q;a[b+1]=r;a[b+2]=p;a[b+3]=A},keySize:8});b.AES=d._createHelper(e)})();(function(){function b(a,b){var d=(this._lBlock>>>a^this._rBlock)&b;this._rBlock^=d;this._lBlock^=d<<a}function d(a,b){var d=(this._rBlock>>>a^this._lBlock)&b;this._lBlock^=d;this._rBlock^=d<<a}var e=a,f=e.lib,g=f.WordArray,f=f.BlockCipher,h=e.algo,
k=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],n=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],m=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,
2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,
2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,
117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,
335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},
{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,
18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,
131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,
1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,
12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,
90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,
2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,
4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,
200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,
10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,
30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],x=h.DES=f.extend({_doReset:function(){for(var a=this._key.words,b=[],d=0;56>d;d++){var e=k[d]-1;b[d]=a[e>>>5]>>>
31-e%32&1}a=this._subKeys=[];for(e=0;16>e;e++){for(var f=a[e]=[],g=n[e],d=0;24>d;d++)f[d/6|0]|=b[(l[d]-1+g)%28]<<31-d%6,f[4+(d/6|0)]|=b[28+(l[d+24]-1+g)%28]<<31-d%6;f[0]=f[0]<<1|f[0]>>>31;for(d=1;7>d;d++)f[d]>>>=4*(d-1)+3;f[7]=f[7]<<5|f[7]>>>27}b=this._invSubKeys=[];for(d=0;16>d;d++)b[d]=a[15-d]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._subKeys)},decryptBlock:function(a,b){this._doCryptBlock(a,b,this._invSubKeys)},_doCryptBlock:function(a,e,f){this._lBlock=a[e];this._rBlock=a[e+1];
b.call(this,4,252645135);b.call(this,16,65535);d.call(this,2,858993459);d.call(this,8,16711935);b.call(this,1,1431655765);for(var g=0;16>g;g++){for(var h=f[g],l=this._lBlock,k=this._rBlock,n=0,x=0;8>x;x++)n|=m[x][((k^h[x])&u[x])>>>0];this._lBlock=k;this._rBlock=l^n}f=this._lBlock;this._lBlock=this._rBlock;this._rBlock=f;b.call(this,1,1431655765);d.call(this,8,16711935);d.call(this,2,858993459);b.call(this,16,65535);b.call(this,4,252645135);a[e]=this._lBlock;a[e+1]=this._rBlock},keySize:2,ivSize:2,
blockSize:2});e.DES=f._createHelper(x);h=h.TripleDES=f.extend({_doReset:function(){var a=this._key.words;this._des1=x.createEncryptor(g.create(a.slice(0,2)));this._des2=x.createEncryptor(g.create(a.slice(2,4)));this._des3=x.createEncryptor(g.create(a.slice(4,6)))},encryptBlock:function(a,b){this._des1.encryptBlock(a,b);this._des2.decryptBlock(a,b);this._des3.encryptBlock(a,b)},decryptBlock:function(a,b){this._des3.decryptBlock(a,b);this._des2.encryptBlock(a,b);this._des1.decryptBlock(a,b)},keySize:6,
ivSize:2,blockSize:2});e.TripleDES=f._createHelper(h)})();(function(){function b(){for(var a=this._S,b=this._i,d=this._j,e=0,f=0;4>f;f++){var b=(b+1)%256,d=(d+a[b])%256,g=a[b];a[b]=a[d];a[d]=g;e|=a[(a[b]+a[d])%256]<<24-8*f}this._i=b;this._j=d;return e}var d=a,e=d.lib.StreamCipher,f=d.algo,g=f.RC4=e.extend({_doReset:function(){for(var a=this._key,b=a.words,a=a.sigBytes,d=this._S=[],e=0;256>e;e++)d[e]=e;for(var f=e=0;256>e;e++){var g=e%a,f=(f+d[e]+(b[g>>>2]>>>24-g%4*8&255))%256,g=d[e];d[e]=d[f];d[f]=
g}this._i=this._j=0},_doProcessBlock:function(a,d){a[d]^=b.call(this)},keySize:8,ivSize:0});d.RC4=e._createHelper(g);f=f.RC4Drop=g.extend({cfg:g.cfg.extend({drop:192}),_doReset:function(){g._doReset.call(this);for(var a=this.cfg.drop;0<a;a--)b.call(this)}});d.RC4Drop=e._createHelper(f)})();a.mode.CTRGladman=function(){function b(a){if(255===(a>>24&255)){var b=a>>16&255,d=a>>8&255;a&=255;255===b?(b=0,255===d?(d=0,255===a?a=0:++a):++d):++b;a=0+(b<<16)+(d<<8)+a}else a+=16777216;return a}var d=a.lib.BlockCipherMode.extend(),
e=d.Encryptor=d.extend({processBlock:function(a,d){var e=this._cipher,k=e.blockSize,l=this._iv,n=this._counter;l&&(n=this._counter=l.slice(0),this._iv=void 0);l=n;0===(l[0]=b(l[0]))&&(l[1]=b(l[1]));n=n.slice(0);e.encryptBlock(n,0);for(e=0;e<k;e++)a[d+e]^=n[e]}});d.Decryptor=e;return d}();(function(){function b(){for(var a=this._X,b=this._C,d=0;8>d;d++)g[d]=b[d];b[0]=b[0]+1295307597+this._b|0;b[1]=b[1]+3545052371+(b[0]>>>0<g[0]>>>0?1:0)|0;b[2]=b[2]+886263092+(b[1]>>>0<g[1]>>>0?1:0)|0;b[3]=b[3]+1295307597+
(b[2]>>>0<g[2]>>>0?1:0)|0;b[4]=b[4]+3545052371+(b[3]>>>0<g[3]>>>0?1:0)|0;b[5]=b[5]+886263092+(b[4]>>>0<g[4]>>>0?1:0)|0;b[6]=b[6]+1295307597+(b[5]>>>0<g[5]>>>0?1:0)|0;b[7]=b[7]+3545052371+(b[6]>>>0<g[6]>>>0?1:0)|0;this._b=b[7]>>>0<g[7]>>>0?1:0;for(d=0;8>d;d++){var e=a[d]+b[d],f=e&65535,k=e>>>16;h[d]=((f*f>>>17)+f*k>>>15)+k*k^((e&4294901760)*e|0)+((e&65535)*e|0)}a[0]=h[0]+(h[7]<<16|h[7]>>>16)+(h[6]<<16|h[6]>>>16)|0;a[1]=h[1]+(h[0]<<8|h[0]>>>24)+h[7]|0;a[2]=h[2]+(h[1]<<16|h[1]>>>16)+(h[0]<<16|h[0]>>>
16)|0;a[3]=h[3]+(h[2]<<8|h[2]>>>24)+h[1]|0;a[4]=h[4]+(h[3]<<16|h[3]>>>16)+(h[2]<<16|h[2]>>>16)|0;a[5]=h[5]+(h[4]<<8|h[4]>>>24)+h[3]|0;a[6]=h[6]+(h[5]<<16|h[5]>>>16)+(h[4]<<16|h[4]>>>16)|0;a[7]=h[7]+(h[6]<<8|h[6]>>>24)+h[5]|0}var d=a,e=d.lib.StreamCipher,f=[],g=[],h=[],k=d.algo.Rabbit=e.extend({_doReset:function(){for(var a=this._key.words,d=this.cfg.iv,e=0;4>e;e++)a[e]=(a[e]<<8|a[e]>>>24)&16711935|(a[e]<<24|a[e]>>>8)&4278255360;for(var f=this._X=[a[0],a[3]<<16|a[2]>>>16,a[1],a[0]<<16|a[3]>>>16,a[2],
a[1]<<16|a[0]>>>16,a[3],a[2]<<16|a[1]>>>16],a=this._C=[a[2]<<16|a[2]>>>16,a[0]&4294901760|a[1]&65535,a[3]<<16|a[3]>>>16,a[1]&4294901760|a[2]&65535,a[0]<<16|a[0]>>>16,a[2]&4294901760|a[3]&65535,a[1]<<16|a[1]>>>16,a[3]&4294901760|a[0]&65535],e=this._b=0;4>e;e++)b.call(this);for(e=0;8>e;e++)a[e]^=f[e+4&7];if(d){var e=d.words,d=e[0],e=e[1],d=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,f=d>>>16|e&4294901760,g=e<<16|d&65535;a[0]^=d;a[1]^=f;a[2]^=e;a[3]^=
g;a[4]^=d;a[5]^=f;a[6]^=e;a[7]^=g;for(e=0;4>e;e++)b.call(this)}},_doProcessBlock:function(a,d){var e=this._X;b.call(this);f[0]=e[0]^e[5]>>>16^e[3]<<16;f[1]=e[2]^e[7]>>>16^e[5]<<16;f[2]=e[4]^e[1]>>>16^e[7]<<16;f[3]=e[6]^e[3]>>>16^e[1]<<16;for(e=0;4>e;e++)f[e]=(f[e]<<8|f[e]>>>24)&16711935|(f[e]<<24|f[e]>>>8)&4278255360,a[d+e]^=f[e]},blockSize:4,ivSize:2});d.Rabbit=e._createHelper(k)})();a.mode.CTR=function(){var b=a.lib.BlockCipherMode.extend(),d=b.Encryptor=b.extend({processBlock:function(a,b){var d=
this._cipher,h=d.blockSize,k=this._iv,l=this._counter;k&&(l=this._counter=k.slice(0),this._iv=void 0);k=l.slice(0);d.encryptBlock(k,0);l[h-1]=l[h-1]+1|0;for(d=0;d<h;d++)a[b+d]^=k[d]}});b.Decryptor=d;return b}();(function(){function b(){for(var a=this._X,b=this._C,d=0;8>d;d++)g[d]=b[d];b[0]=b[0]+1295307597+this._b|0;b[1]=b[1]+3545052371+(b[0]>>>0<g[0]>>>0?1:0)|0;b[2]=b[2]+886263092+(b[1]>>>0<g[1]>>>0?1:0)|0;b[3]=b[3]+1295307597+(b[2]>>>0<g[2]>>>0?1:0)|0;b[4]=b[4]+3545052371+(b[3]>>>0<g[3]>>>0?1:0)|
0;b[5]=b[5]+886263092+(b[4]>>>0<g[4]>>>0?1:0)|0;b[6]=b[6]+1295307597+(b[5]>>>0<g[5]>>>0?1:0)|0;b[7]=b[7]+3545052371+(b[6]>>>0<g[6]>>>0?1:0)|0;this._b=b[7]>>>0<g[7]>>>0?1:0;for(d=0;8>d;d++){var e=a[d]+b[d],f=e&65535,k=e>>>16;h[d]=((f*f>>>17)+f*k>>>15)+k*k^((e&4294901760)*e|0)+((e&65535)*e|0)}a[0]=h[0]+(h[7]<<16|h[7]>>>16)+(h[6]<<16|h[6]>>>16)|0;a[1]=h[1]+(h[0]<<8|h[0]>>>24)+h[7]|0;a[2]=h[2]+(h[1]<<16|h[1]>>>16)+(h[0]<<16|h[0]>>>16)|0;a[3]=h[3]+(h[2]<<8|h[2]>>>24)+h[1]|0;a[4]=h[4]+(h[3]<<16|h[3]>>>
16)+(h[2]<<16|h[2]>>>16)|0;a[5]=h[5]+(h[4]<<8|h[4]>>>24)+h[3]|0;a[6]=h[6]+(h[5]<<16|h[5]>>>16)+(h[4]<<16|h[4]>>>16)|0;a[7]=h[7]+(h[6]<<8|h[6]>>>24)+h[5]|0}var d=a,e=d.lib.StreamCipher,f=[],g=[],h=[],k=d.algo.RabbitLegacy=e.extend({_doReset:function(){for(var a=this._key.words,d=this.cfg.iv,e=this._X=[a[0],a[3]<<16|a[2]>>>16,a[1],a[0]<<16|a[3]>>>16,a[2],a[1]<<16|a[0]>>>16,a[3],a[2]<<16|a[1]>>>16],a=this._C=[a[2]<<16|a[2]>>>16,a[0]&4294901760|a[1]&65535,a[3]<<16|a[3]>>>16,a[1]&4294901760|a[2]&65535,
a[0]<<16|a[0]>>>16,a[2]&4294901760|a[3]&65535,a[1]<<16|a[1]>>>16,a[3]&4294901760|a[0]&65535],f=this._b=0;4>f;f++)b.call(this);for(f=0;8>f;f++)a[f]^=e[f+4&7];if(d){var e=d.words,d=e[0],e=e[1],d=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,f=d>>>16|e&4294901760,g=e<<16|d&65535;a[0]^=d;a[1]^=f;a[2]^=e;a[3]^=g;a[4]^=d;a[5]^=f;a[6]^=e;a[7]^=g;for(f=0;4>f;f++)b.call(this)}},_doProcessBlock:function(a,d){var e=this._X;b.call(this);f[0]=e[0]^e[5]>>>16^
e[3]<<16;f[1]=e[2]^e[7]>>>16^e[5]<<16;f[2]=e[4]^e[1]>>>16^e[7]<<16;f[3]=e[6]^e[3]>>>16^e[1]<<16;for(e=0;4>e;e++)f[e]=(f[e]<<8|f[e]>>>24)&16711935|(f[e]<<24|f[e]>>>8)&4278255360,a[d+e]^=f[e]},blockSize:4,ivSize:2});d.RabbitLegacy=e._createHelper(k)})();a.pad.ZeroPadding={pad:function(a,d){var e=4*d;a.clamp();a.sigBytes+=e-(a.sigBytes%e||e)},unpad:function(a){for(var d=a.words,e=a.sigBytes-1;!(d[e>>>2]>>>24-e%4*8&255);)e--;a.sigBytes=e+1}};return a});var mg;mg={};
var ConstantsVariable={ISHOVER:!1},BinaryBuilder=cc.Class.extend({isBigEndian:!1,offset:0,tmpBuffer:null,ctor:function(){},initObj:function(a,b,d){"undefined"==typeof d&&(d=!1);this.isBigEndian=d;d=Object.keys(a).map(function(a){return a});var e=Object.keys(a).map(function(b){return a[b]}),f=Object.keys(b).map(function(a){return a}),g=Object.keys(b).map(function(a){return b[a]});return tmpBuffer=this.BuildBinaryFromStruct2(a,e,d,b,f,g)},createBinaryForObject:function(a,b){var d=[];Object.keys(a).map(function(b){return a[b]});
for(var e=Object.keys(b).map(function(a){return a}),f=Object.keys(b).map(function(a){return b[a]}),g=0;g<f.length;g++){var h=f[g],k=e[g];if(h===BinaryConstants.DataTypeID.Object8){var k=a[k],h=f[g+1],l=0;l++;d.push(this.createBinaryForObject(k,h));g+=l}else if(h===BinaryConstants.DataTypeID.Array8){var h=f[g+1],n=g+1,l=0,m={};for(m[e[n]]=h;-1<e[n].indexOf(k+"_");){l++;n++;if(n===f.length||0>e[n].indexOf(k+"_"))break;m[e[n]]=f[n]}d.push(this.createBinaryForArray(a[k],m));g+=l}else d.push(this.WriteDataByTypeID(h,
a[k]))}return this.concatDataView(d)},createBinaryForArray:function(a,b){var d=[],e=Object.keys(b).map(function(a){return a}),f=Object.keys(b).map(function(a){return b[a]});d.push(this.WriteDataByTypeID(BinaryConstants.DataTypeID.Array8,a.length));var g=f[0];if(0==a.length)return this.concatDataView(d);if(g!==BinaryConstants.DataTypeID.Array8&&g!==BinaryConstants.DataTypeID.Object8)for(var h=0;h<a.length;h++)d.push(this.WriteDataByTypeID(g,a[h]));else if(g===BinaryConstants.DataTypeID.Object8)for(e=
f[1],h=0;h<a.length;h++)d.push(this.createBinaryForObject(a[h],e));else for(h=0;h<a.length;h++){for(var g=a[h],k={},l=1;l<f.length;l++)k[e[l]]=f[l];d.push(this.createBinaryForArray(g,k))}return this.concatDataView(d)},BuildBinaryFromStruct2:function(a,b,d,e,f,g){b=[];var h,k,l;try{for(h=0;h<g.length;h++)if(k=g[h],l=f[h],k==BinaryConstants.DataTypeID.Object8){var n=a[l],m=g[h+1],u=0;u++;b.push(this.createBinaryForObject(n,m));h+=u}else if(k==BinaryConstants.DataTypeID.Array8){var x=a[l],m=g[h+1];d=
h+1;u=0;e={};for(e[f[d]]=m;-1<f[d].indexOf(l+"_");){u++;d++;if(d==g.length||0>f[d].indexOf(l+"_"))break;e[f[d]]=g[d]}b.push(this.createBinaryForArray(x,e));h+=u}else b.push(this.WriteDataByTypeID(k,a[l]))}catch(A){cc.error("Error BuildMessage "+l+" "+a[l])}return this.concatDataView(b)},writeFloat:function(a){var b=new ArrayBuffer(4),d=new DataView(b);try{d.setFloat32(0,a,this.isBigEndian)}catch(e){d.setFloat32(0,0,this.isBigEndian)}return b},writeInt8:function(a){var b=new ArrayBuffer(1),d=new DataView(b);
try{d.setInt8(0,a)}catch(e){d.setInt8(0,0)}return b},writeUInt8:function(a){var b=new ArrayBuffer(1),d=new DataView(b);try{d.setUint8(0,a)}catch(e){d.setUint8(0,0)}return b},writeUInt16:function(a){var b=new ArrayBuffer(2),d=new DataView(b);try{d.setUint16(0,a,this.isBigEndian)}catch(e){d.setUint16(0,0,this.isBigEndian)}return b},writeInt16:function(a){var b=new ArrayBuffer(2),d=new DataView(b);try{d.setInt16(0,a,this.isBigEndian)}catch(e){d.setInt16(0,0,this.isBigEndian)}return b},writeUInt32:function(a){var b=
new ArrayBuffer(4),d=new DataView(b);try{d.setUint32(0,a,this.isBigEndian)}catch(e){d.setUint32(0,0,this.isBigEndian)}return b},writeInt32:function(a){var b=new ArrayBuffer(4),d=new DataView(b);try{d.setInt32(0,a,this.isBigEndian)}catch(e){d.setInt32(0,0,this.isBigEndian)}return b},writeInt64:function(a){var b=new Uint8Array(8);try{b.set(new Uint8Array(this.writeInt32(a/2147483647)),0),b.set(new Uint8Array(this.writeInt32(a%2147483647)),4)}catch(d){b.set(new Uint8Array(this.writeInt32(0)),0),b.set(new Uint8Array(this.writeInt32(0)),
4)}return b.buffer},writeUInt64:function(a){var b=new Uint8Array(8);if(this.isBigEndian)try{b.set(new Uint8Array(this.writeUInt32(a/4294967295)),0),b.set(new Uint8Array(this.writeUInt32(a%4294967295)),4)}catch(d){b.set(new Uint8Array(this.writeUInt32(0)),0),b.set(new Uint8Array(this.writeUInt32(0)),4)}else try{b.set(new Uint8Array(this.writeUInt32(a%4294967295)),0),b.set(new Uint8Array(this.writeUInt32(a/4294967295)),4)}catch(d){b.set(new Uint8Array(this.writeUInt32(0)),0),b.set(new Uint8Array(this.writeUInt32(0)),
4)}return b.buffer},writeDouble:function(a){var b=new ArrayBuffer(8),d=new DataView(b);try{d.setFloat64(0,a,this.isBigEndian)}catch(e){d.setFloat64(0,0,this.isBigEndian)}return b},writeStringDynamic:function(a,b){for(var d=new Uint8Array(2*a.length+2),e=0;e<a.length;e++)d.set(new Uint8Array(this.writeUInt16(a.charCodeAt(e))),2*e);return d.buffer},BuildBinaryFromStruct:function(a,b){var d=[];if(Array.isArray(a)){for(var e=0;e<a.length;e++)d.push(this.BuildBinaryFromStruct(a[e],b));return this.concatDataView(d)}for(e in b)if(-1==
e.indexOf("_Struct")&&-1==e.indexOf("_Type"))if(b[e]==BinaryConstants.DataTypeID.Object8)d.push(this.WriteDataByTypeID(b[e],a[e].length)),d.push(this.BuildBinaryFromStruct(a[e],b[e+"_Struct"]));else if(b[e]==BinaryConstants.DataTypeID.Array8)d.push(this.WriteDataByTypeID(b[e],a[e].length)),d.push(this.BuildBinaryFromArray(a[e],b[e+"_Type"]));else try{if("undefined"==typeof a[e])throw"Data undefined";d.push(this.WriteDataByTypeID(b[e],a[e]))}catch(f){throw Error("Error K "+e+" ID "+b[e]+" ex : "+f);
}return this.concatDataView(d)},BuildBinaryFromArray:function(a,b){for(var d=[],e=0;e<a.length;e++)d.push(this.WriteDataByTypeID(b,a[e]));return this.concatDataView(d)},WriteDataByTypeID:function(a,b){switch(a){case BinaryConstants.DataTypeID.Int8:return this.writeInt8(b);case BinaryConstants.DataTypeID.UInt8:return this.writeUInt8(b);case BinaryConstants.DataTypeID.Int16:return this.writeInt16(b);case BinaryConstants.DataTypeID.UInt16:return this.writeUInt16(b);case BinaryConstants.DataTypeID.Int32:return this.writeInt32(b);
case BinaryConstants.DataTypeID.UInt32:return this.writeUInt32(b);case BinaryConstants.DataTypeID.Int64:return this.writeInt64(b);case BinaryConstants.DataTypeID.UInt64:return this.writeUInt64(b);case BinaryConstants.DataTypeID.Float:return this.writeFloat(b);case BinaryConstants.DataTypeID.Double:return this.writeDouble(b);case BinaryConstants.DataTypeID.StringDynamic:return this.writeStringDynamic(b);case BinaryConstants.DataTypeID.Object8:return this.writeUInt8(b);case BinaryConstants.DataTypeID.Array8:return this.writeUInt8(b)}},
concatDataView:function(a){for(var b,d=0;d<a.length;d++)b=this.appendDataView(b,a[d]);return b},appendDataView:function(a,b){if("undefined"==typeof a)return b;if("undefined"==typeof b)return a;var d=new Uint8Array(a.byteLength+b.byteLength);d.set(new Uint8Array(a),0);d.set(new Uint8Array(b),a.byteLength);return d.buffer}}),BinaryConstants=cc.Class.extend({ctor:function(){}});
BinaryConstants.DataTypeID={Int8:1,UInt8:2,Int16:3,UInt16:4,Int32:5,UInt32:6,Int64:7,UInt64:8,Float:9,Double:10,StringDynamic:11,Object8:12,Array8:13};
var BinaryParser=cc.Class.extend({isBigEndian:!1,offset:6,ctor:function(){},initObj:function(a,b){var d=Object.keys(a).map(function(a){return a}),e=Object.keys(a).map(function(b){return a[b]});return this.parseFromStruct2(a,d,e,b)},readDataForObject:function(a,b){for(var d={},e=Object.keys(a).map(function(a){return a}),f=Object.keys(a).map(function(b){return a[b]}),g=0;g<f.length;g++){var h=f[g],k=e[g];if(h===BinaryConstants.DataTypeID.Object8){var h=f[g+1],l=0;l++;d[k]=this.readDataForObject(h,b);
g+=l}else if(h===BinaryConstants.DataTypeID.Array8){var n=this.ReadDataByTypeID(h,b),h=f[g+1],m=g+1,l=0,u={};for(u[e[m]]=h;-1<e[m].indexOf(k+"_");){l++;m++;if(m===f.length||0>e[m].indexOf(k+"_"))break;u[e[m]]=f[m]}d[k]=this.readDataForArray(n,u,b);g+=l}else d[k]=this.ReadDataByTypeID(h,b)}return d},readDataForArray:function(a,b,d){var e=[],f=Object.keys(b).map(function(a){return a}),g=Object.keys(b).map(function(a){return b[a]}),h=g[0];if(h!==BinaryConstants.DataTypeID.Array8&&h!==BinaryConstants.DataTypeID.Object8)for(var k=
0;k<a;k++)e.push(this.ReadDataByTypeID(h,d));else if(h===BinaryConstants.DataTypeID.Object8)for(f=g[1],k=0;k<a;k++)e.push(this.readDataForObject(f,d));else for(k=0;k<a;k++){for(var l=this.ReadDataByTypeID(h,d),n={},m=1;m<g.length;m++)n[f[m]]=g[m];e.push(this.readDataForArray(l,n,d))}return e},parseFromStruct2:function(a,b,d,e){a={};for(var f=0;f<d.length;f++){var g=d[f],h=b[f];if(g===BinaryConstants.DataTypeID.Object8){var g=d[f+1],k=0;k++;f+=k;a[h]=this.readDataForObject(g,e)}else if(g===BinaryConstants.DataTypeID.Array8){var l=
this.ReadDataByTypeID(g,e),n=f+1,k=0,m={},g=d[f+1];for(m[b[n]]=g;-1<b[n].indexOf(h+"_");){k++;n++;if(n==d.length||0>b[n].indexOf(h+"_"))break;m[b[n]]=d[n]}f+=k;a[h]=this.readDataForArray(l,m,e)}else a[h]=this.ReadDataByTypeID(g,e)}return a},parseFromStruct:function(a,b){var d={},e="";try{for(var f in a)if(-1==f.indexOf("_Struct")&&-1==f.indexOf("_Type"))if(a[f]==BinaryConstants.DataTypeID.Object8){var g=this.ReadDataByTypeID(a[f],b);d[f]=[];for(var h=0;h<g;h++)d[f].push(this.parseFromStruct(a[f+"_Struct"],
b))}else if(a[f]==BinaryConstants.DataTypeID.Array8)for(g=this.ReadDataByTypeID(a[f],b),d[f]=[],h=0;h<g;h++)d[f].push(this.ReadDataByTypeID(a[f+"_Type"],b));else e=f,d[f]=this.ReadDataByTypeID(a[f],b)}catch(k){Utilities.showLog("Error Parse key:"+e+" data:"+a[f])}return d},readInt8:function(a){this.offset++;return a.getInt8(this.offset-1)},readUInt8:function(a){this.offset++;return a.getUint8(this.offset-1)},readInt16:function(a){this.offset+=2;return a.getInt16(this.offset-2,this.isBigEndian)},readUInt16:function(a){this.offset+=
2;return a.getUint16(this.offset-2,this.isBigEndian)},readUInt32:function(a){this.offset+=4;return a.getUint32(this.offset-4,this.isBigEndian)},readInt32:function(a){this.offset+=4;return a.getInt32(this.offset-4,this.isBigEndian)},readInt64:function(a){return this.isBigEndian?2147483647*this.readInt32(a)+this.readInt32(a):this.readInt32(a)+2147483647*this.readInt32(a)},readUInt64:function(a){return this.isBigEndian?4294967295*this.readUInt32(a)+this.readUInt32(a):this.readUInt32(a)+4294967295*this.readUInt32(a)},
readFloat:function(a){this.offset+=4;return a.getFloat32(this.offset-4,this.isBigEndian)},readDouble:function(a){this.offset+=8;return a.getFloat64(this.offset-8,this.isBigEndian)},readStringDynamic:function(a){for(var b="",d=0,e=0;e<a.byteLength;e++){d=this.readUInt16(a);if(0==d)break;b+=String.fromCharCode(d)}return b},ReadDataByTypeID:function(a,b){switch(a){case BinaryConstants.DataTypeID.Int8:return this.readInt8(b);case BinaryConstants.DataTypeID.UInt8:return this.readUInt8(b);case BinaryConstants.DataTypeID.Int16:return this.readInt16(b);
case BinaryConstants.DataTypeID.UInt16:return this.readUInt16(b);case BinaryConstants.DataTypeID.Int32:return this.readInt32(b);case BinaryConstants.DataTypeID.UInt32:return this.readUInt32(b);case BinaryConstants.DataTypeID.Int64:return this.readInt64(b);case BinaryConstants.DataTypeID.UInt64:return this.readUInt64(b);case BinaryConstants.DataTypeID.Float:return this.readFloat(b);case BinaryConstants.DataTypeID.Double:return this.readDouble(b);case BinaryConstants.DataTypeID.StringDynamic:return this.readStringDynamic(b);
case BinaryConstants.DataTypeID.Object8:return this.readUInt8(b);case BinaryConstants.DataTypeID.Array8:return this.readUInt8(b);default:console.log("Wtf ID ",a)}}}),Message=cc.Class.extend({controllerId:-1,requestId:-1,moduleId:-1,content:null,ctor:function(a,b,d){this.requestId=a;this.content=b;this.moduleId=d}});
Message.Parse=function(a){var b=a.getUint16(0,!0),d=a.getUint16(2,!0),e=a.getUint16(4,!0);return new Message(e,a,d)};
Message.buildSocketMsg=function(a,b,d){var e=MGNetCore.MGSocket.getSocketModuleID();if(d)return b=(new BinaryBuilder).initObj(d,b),d=new DataView(new ArrayBuffer(6)),d.setUint16(0,b.byteLength+6,!0),d.setUint16(2,e,!0),d.setUint16(4,a,!0),a=new Uint8Array(d.byteLength+b.byteLength),a.set(new Uint8Array(d.buffer),0),a.set(new Uint8Array(b),d.byteLength),a;d=new DataView(new ArrayBuffer(6));d.setUint16(0,6,!0);d.setUint16(2,e,!0);d.setUint16(4,a,!0);return d.buffer};
Message.buildMasterMsg=function(a,b,d){var e=MGNetCore.MGSocket.getMasterModuleID();if(d)return b=(new BinaryBuilder).initObj(d,b),d=new DataView(new ArrayBuffer(6)),d.setUint16(0,b.byteLength+6,!0),d.setUint16(2,e,!0),d.setUint16(4,a,!0),a=new Uint8Array(d.byteLength+b.byteLength),a.set(new Uint8Array(d.buffer),0),a.set(new Uint8Array(b),d.byteLength),a;d=new DataView(new ArrayBuffer(6));d.setUint16(0,6,!0);d.setUint16(2,e,!0);d.setUint16(4,a,!0);return d.buffer};
Message.buildGameMsg=function(a,b,d){var e=MGNetCore.MGSocket.getGameModuleID();if(d)return b=(new BinaryBuilder).initObj(d,b),d=new DataView(new ArrayBuffer(6)),d.setUint16(0,b.byteLength+6,!0),d.setUint16(2,e,!0),d.setUint16(4,a,!0),a=new Uint8Array(d.byteLength+b.byteLength),a.set(new Uint8Array(d.buffer),0),a.set(new Uint8Array(b),d.byteLength),a;d=new DataView(new ArrayBuffer(6));d.setUint16(0,6,!0);d.setUint16(2,e,!0);d.setUint16(4,a,!0);return d.buffer};
Message.buildMsgWithModule=function(a,b,d,e){if(e)return d=(new BinaryBuilder).initObj(e,d),e=new DataView(new ArrayBuffer(6)),e.setUint16(0,d.byteLength+6,!0),e.setUint16(2,a,!0),e.setUint16(4,b,!0),a=new Uint8Array(e.byteLength+d.byteLength),a.set(new Uint8Array(e.buffer),0),a.set(new Uint8Array(d),e.byteLength),a;e=new DataView(new ArrayBuffer(6));e.setUint16(0,6,!0);e.setUint16(2,a,!0);e.setUint16(4,b,!0);return e.buffer};
Message.buildChatMsg=function(a,b,d){var e=MGNetCore.MGSocket.getChatModuleID();if(d)return b=(new BinaryBuilder).initObj(d,b),d=new DataView(new ArrayBuffer(6)),d.setUint16(0,b.byteLength+6,!0),d.setUint16(2,e,!0),d.setUint16(4,a,!0),a=new Uint8Array(d.byteLength+b.byteLength),a.set(new Uint8Array(d.buffer),0),a.set(new Uint8Array(b),d.byteLength),a;d=new DataView(new ArrayBuffer(6));d.setUint16(0,6,!0);d.setUint16(2,e,!0);d.setUint16(4,a,!0);return d.buffer};var ResourceManager={};
MGNetCore=cc.Class.extend({_isWSS:null,_socket:null,_hostName:null,_port:null,_socketKey:null,callBackOnConnected:null,callBackOnReceiveData:null,callBackOnError:null,callBackOnClose:null,isRunError:!1,_MGSocketModuleID:null,_MGMasterModuleID:null,_MGGameModuleID:null,_MGChatModuleID:null,code:null,ctor:function(){cc.Class.call(this);this._isWSS=!1},initObj:function(a,b){this._hostName=a.split(":")[0];this._port=a.split(":")[1];this._socketKey=a;this._isWSS=b||!1;this.socket&&(this.socket.close(),
"function"==typeof this.callBackOnError&&(this.socket.onerror=this.callBackOnError))},connectHandler:function(){var a={stateEvent:"Connected"};a.socketKey=this._socketKey;this.callBackOnConnected&&this.callBackOnConnected(a)},ioErrorHandler:function(a){cc.error("ioErrorHandleronWsError() : ",a);this.callBackOnError&&this.callBackOnError(a)},dataHandler:function(a){this.callBackOnReceiveData&&this.callBackOnReceiveData(this.messageFilter(new DataView(a.data)))},closeHandler:function(a){cc.error("closeHandler-onWsError() : ",
a);this.callBackOnClose&&this.callBackOnClose(a);this.socket&&this.socket.close()},getMainIDNetMessage:function(a){return a.getUint32(4,!0)},getSubIDNetMessage:function(a){return a.getUint32(8,!0)},messageFilter:function(a){return Message.Parse(a)},sendMsg:function(a){try{this.socket.readyState==WebSocket.OPEN||"function"!=typeof this.callBackOnError||this.isRunError?this.socket.readyState==WebSocket.OPEN&&(this.isRunError=!1,this.socket.send(a)):(this.isRunError=!0,this.callBackOnError())}catch(b){"function"==
typeof this.callBackOnError&&this.callBackOnError()}},connect:function(){this.socket&&(this.socket.close(),this.socket=null);this.socket||(this.code=0,this.socket=new WebSocket((this._isWSS?"wss://":"wss://")+this._hostName+":"+this._port),this.socket.onopen=this.connectHandler.bind(this),this.socket.onerror=this.ioErrorHandler.bind(this),this.socket.onmessage=this.dataHandler.bind(this),this.socket.onclose=this.closeHandler.bind(this),this.socket.binaryType="arraybuffer")},close:function(){this.socket&&
(this.socket.close(),this.socket=null)},closeWithCode:function(a,b){this.socket&&(this.code=a,this.socket.close(),this.socket=null)},setSocketModuleID:function(a){this._MGSocketModuleID=a},getSocketModuleID:function(){return this._MGSocketModuleID},setMasterModuleID:function(a){this._MGMasterModuleID=a},getMasterModuleID:function(){return this._MGMasterModuleID},setGameModuleID:function(a){this._MGGameModuleID=a},getGameModuleID:function(){return this._MGGameModuleID},setChatModuleID:function(a){this._MGChatModuleID=
a},getChatModuleID:function(){return this._MGChatModuleID}});MGNetCore.MGSocket=null;
(function(){mg.sys=new function(){var a=this;a.getIsMobile=function(){return cc.sys.isMobile};a.isIOS=function(){return cc.sys.os===cc.sys.OS_IOS};a.isIOSNative=function(){return cc.sys.isNative&&a.isIOS()};a.isAndroid=function(){return cc.sys.os===cc.sys.OS_ANDROID};a.isAndroidNative=function(){return cc.sys.isNative&&a.isAndroid()};a.isWindows=function(){return cc.sys.os===cc.sys.OS_WINDOWS};a.isWindowsNative=function(){return cc.sys.isNative&&a.isWindows()};a.isMacOS=function(){return cc.sys.os===
cc.sys.OS_OSX};a.isMacOSNative=function(){return cc.sys.isNative&&a.isMacOS()};a.getLanguage=function(){return cc.sys.language};a.getBrowserType=function(){return cc.sys.browserType};a.getCapabilities=function(){return JSON.stringify(a.capabilities)};a.getOS=function(){return cc.sys.os};a.getPlatform=function(){return cc.sys.platform};a.isObjectValid=function(a){return cc.sys.isObjectValid(a)}}})();
(function(){mg.fn=new function(){var a=this;a.convertNumber=function(a){if(void 0===a)return"";a=a.toString().split(".");a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,".");return a.join(".")};a.isObject=function(a){return"[object Object]"===Object.prototype.toString.call(a)};a.isFunction=function(a){return"function"===typeof a};a.isBoolean=function(a){return"boolean"===typeof a};a.isNumber=function(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)};a.isInteger=function(b){return a.isNumber(b)&&
Math.floor(b)===b};a.isFloat=function(b){return!a.isInteger(b)&&a.isNumber(b)};a.isString=function(a){return"string"===typeof a||"[object String]"===Object.prototype.toString.call(a)};a.isUndefined=function(a){return void 0===a};a.isObject=function(a){return"object"===typeof a&&"[object Object]"===Object.prototype.toString.call(a)};a.isArray=function(a){return Array.isArray(a)||"object"===typeof a&&"[object Array]"===Object.prototype.toString.call(a)};a.sortArray=function(b,d){cc.assert(a.isArray(b),
"MGFunction.sortArray() : array invalid!");var e=a.isUndefined(d)||!0===d?function(a,b){return a>b}:function(a,b){return a<b};b.sort(e);return b};a.copyArray=function(a,d){var e,f=a.length,g=Array(f);if(d)for(e=f-1;0<=e;--e)g[e]=a[e];else for(e=0;e<f;e+=1)g[e]=a[e];return g};a.toInt=function(a,d){return parseInt(a,void 0===d?10:d)};a.toFloat=function(a){return parseFloat(a)};a.toNumber=function(a){return Number(a)};a.toBoolean=function(a){return!!a};a.parseRGB=function(a){var d,e=[];for(d=0;3>d;d++)e.push(parseInt(a.substr(2*
d,2),16));return cc.color(e[0],e[1],e[2])};a.dumpObject=function(a,d){for(var e in a)!0===d?a.hasOwnProperty(e):!1===d&&a.propertyIsEnumerable(e)};a.objToString=function(b){var d=typeof b;if("object"!==d||null===b)"string"===d&&(b='"'+b+'"'),b=String(b);else{if(b instanceof Date)return b.toLocaleString();var e,f,g=[],h=b&&b.constructor===Array;for(e in b)f=b[e],d=typeof f,"string"===d?f='"'+f+'"':"object"===d&&null!==f&&(f=a.objToString(f)),g.push((h?"":'"'+e+'":')+String(f));b=(h?"[":"{")+String(g)+
(h?"]":"}")}return b};return a}})();
(function(){var a=function(a){var b,d;if(!(this.index>=this.length))if(b=this[this.index++],d=b[0],b[0]=null,a)this.fail&&this.fail(a);else{a=this.obj;var h,k,l,n,m,u,x;for(h=0;h<b.length;++h){k=b[h];if("string"===typeof k&&"$"===k[0]){m=a;u=["obj"];x=!1;l=k.substring(1).split(".");for(n=0;n<l.length;++n){if(!m){x=!0;break}m=m[l[n]];u.push(l[n])}x||(k=m)}b[h]=k}cc.assert(d,"function is undefined!");Function.prototype.call.apply(d,b)}},b=function(){throw"done is already call!";},d=function(){throw"fail is already call!";
};mg.fn.createSequenceFunc=function(e){var f=[],g,h;f.index=0;e=void 0===e?{}:e;f.obj=e;g=a.bind(f);g.obj=e;h=function(){g()};h.then=function(a){f.push([a,g].concat(Array.prototype.slice.call(arguments,1)));return h};h.done=function(a){f.push([a,0].concat(Array.prototype.slice.call(arguments,1)));h.then=b;h.done=b;return h};h.fail=function(a){f.fail=a;h.then=d;h.fail=d;return h};return h}})();mg.fn.callNextFrame=function(a){cc.director.getScheduler().schedule(function(){a()},{},0,0,0,!1)};
mg.fn.delayCall=function(a,b,d){d=d||{};0===b?a():cc.director.getScheduler().schedule(a,d,0,0,b,!1)};mg.fn.callback=function(a){cc.assert(a instanceof Function,"mg.callback() : callback Invalid!");return Function.prototype.bind.apply(a,arguments)};mg.fn.emptyFunc=function(){return null};
(function(){mg.audio=new function(){var a=this,b=cc.audioEngine,d="true",e="true";a._init=function(){var b;b=cc.sys.localStorage.getItem("__m2_music_volume");a.setMusicVolume(b||100,!0);d=(d=cc.sys.localStorage.getItem("__m2_music_enabled"))||"true";a.setMusicEnabled(d,!0);b=cc.sys.localStorage.getItem("__m2_effect_volume");a.setEffectsVolume(b||100,!0);e=(e=cc.sys.localStorage.getItem("__m2_effect_enabled"))||"true";a.setEffectEnabled(e,!0)};a.playMusic=function(e,g,h){h=h||!0;if("false"===d)cc.warn("mg.audio.playMusic() : 【音乐】没有开启!");
else return 0<g&&a.setMusicVolume(.01*g),b.playMusic(""+e,h)};a.stopMusic=function(a){return b.stopMusic(a)};a.pauseMusic=function(){return b.pauseMusic()};a.resumeMusic=function(d,e){void 0!==d&&(cc.assert(mg.fn.isNumber(d)&&0<=d&&100>=d,"MGAudio.resumeMusic() : volume 必须是一个 >= 0 && <= 100的数值"),a.setMusicVolume(d,e));return b.resumeMusic()};a.rewindMusic=function(){return b.rewindMusic()};a.getMusicVolume=function(){return 100*b.getMusicVolume()};a.setMusicVolume=function(a,d){a=Math.floor(a);d=
d||!1;void 0!==d&&cc.assert(mg.fn.isBoolean(d),"mg.audio.setMusicVolume() : isSaveToNative必须是Boolean类型！");d&&cc.sys.localStorage.setItem("__m2_music_volume",a);return b.setMusicVolume(.01*a)};a.isMusicPlaying=function(){return b.isMusicPlaying()};a.willPlayMusic=function(){return b.willPlayMusic()};a.isEffectEnabled=function(){return e};a.setEffectEnabled=function(a,b){b&&cc.sys.localStorage.setItem("__m2_effect_enabled",String(a));e=String(a)};a.isMusicEnabled=function(){return d};a.setMusicEnabled=
function(a,b){b&&cc.sys.localStorage.setItem("__m2_music_enabled",String(a));d=String(a)};a.playEffect=function(d,g,h){if("false"===e)return cc.warn("mg.audio.playEffect() : 【音效】没有开启！"),null;0<g&&a.setEffectsVolume(.01*g);return b.playEffect(""+d,h)};a.setEffectsVolume=function(a,d){a=Math.floor(a);d=d||!1;void 0!==d&&cc.assert(mg.fn.isBoolean(d),"mg.audio.setEffectsVolume() : isSaveToNative必须是Boolean类型！");d&&cc.sys.localStorage.setItem("__m2_effect_volume",a);return b.setEffectsVolume(.01*a)};a.getEffectsVolume=
function(){return 100*b.getEffectsVolume()};a.pauseEffect=function(a){return b.pauseEffect(a)};a.pauseAllEffects=function(){return b.pauseAllEffects()};a.resumeEffect=function(a){return b.resumeEffect(a)};a.resumeAllEffects=function(){return b.resumeAllEffects()};a.stopEffect=function(a){return b.stopEffect(a)};a.stopAllEffects=function(){return b.stopAllEffects()};a.unloadEffect=function(a){return b.unloadEffect(""+a)};a.end=function(){return b.end()};a._init()}})();
(function(){mg.math=new function(){var a=this;a.randomBetween=function(a,d){return a+(d-a)*Math.random()};a.randomFloorBetween=function(b,d){return Math.floor(a.randomBetween(b,d))};a.randomCeilBetween=function(b,d){return Math.ceil(a.randomBetween(b,d))};a.randomRoundBetween=function(b,d){return Math.round(a.randomBetween(b,d))};a.random0Or1=function(){return Math.round(Math.random())};a.randomIntegerLess=function(b){return a.randomFloorBetween(0,b)};a.randomIntegerGreater=function(b){return a.randomFloorBetween(b,
Number.MAX_VALUE)};a.randomExcept=function(b,d,e,f){!0===f&&m2.fn.sortArray(e);for(var g,h=a.randomRoundBetween(b,d);;){g=!1;for(f=0;f<e.length;f++)h===e[f]&&(g=!0);if(!g)break;h=a.randomRoundBetween(b,d)}return h};a.getGreatestCommonDivisor=function(a,d){for(var e;0!==a%d;)e=a%d,a=d,d=e;return d};a.getCommonMultiple=function(b,d){return b*d/a.getGreatestCommonDivisor(b,d)};a.toMathAngle=function(a){for(a=90-a;0>a;)a+=360;for(;360<a;)a-=360;return a};a.toCocosAngle=function(b){return a.toMathAngle(b)};
a.getRotation=function(b,d){return a.toMathAngle(a.getAngle(d,b))};a.getAngle=function(a,d){var e=cc.pToAngle(cc.pSub(d,a));return cc.radiansToDegrees(e)};a.isPointInCircle=function(a,d,e){return Math.abs(cc.pDistance(a,d))<=e};a.isCircleIntersectCircle=function(a,d,e,f){return(a.x-e.x)*(a.x-e.x)+(a.y-e.y)*(a.y-e.y)<=(d+f)*(d+f)};a.getKByAngle=function(a){return Math.tan(cc.degreesToRadians(a))};a.getK=function(a,d){return(d.y-a.y)/(d.x-a.x)};a.getYByPosAndK=function(a,d,e){return e*(d-a.x)+a.y};
a.getXByPosAndK=function(a,d,e){return(d-a.y)/e+a.x};a.getRayPoint=function(b,d,e){d=a.toMathAngle(d);var f=e.height-b.y,f=f/Math.tan(cc.degreesToRadians(d)),g=cc.p(b.x+f,e.height);0>d&&90>=d&&(f=b.y,f/=Math.tan(cc.degreesToRadians(-d)),g.x=b.x+f,g.y=e.y);0>g.x?(f=b.x*Math.tan(cc.degreesToRadians(180-d)),g.y=b.y+f,g.x=e.x):g.x>e.width&&(f=e.width-b.x,f*=Math.tan(cc.degreesToRadians(d)),g.x=e.width,g.y=b.y+f);return g};a.getHitPoint=function(b,d,e){var f={};e=a.toMathAngle(e);var g,h,k,l,n,m,u,x,A,
y,J;90===e?(f.x=d.x,f.y=b.y+b.height,f.angle=a.toCocosAngle(270)):180===e?(f.x=b.x,f.y=d.y,f.angle=a.toCocosAngle(0)):270===e?(f.x=d.x,f.y=b.y,f.angle=a.toCocosAngle(90)):0===e?(f.x=b.x+b.width,f.y=d.y,f.angle=a.toCocosAngle(180)):(g=a.getKByAngle(e),h=a.getXByPosAndK(d,b.y+b.height,g),k=b.y+b.height,l=a.toCocosAngle(360-e),n=b.x,m=a.getYByPosAndK(d,b.x,g),u=a.toCocosAngle(180-e),x=a.getXByPosAndK(d,b.y,g),A=b.y,y=a.toCocosAngle(360-e),J=b.x+b.width,d=a.getYByPosAndK(d,b.x+b.width,g),g=a.toCocosAngle(180-
e),0<e&&90>e?h<b.x+b.width?(f.x=h,f.y=k,f.angle=l):(f.x=J,f.y=d,f.angle=g):90<e&&180>e?h>b.x?(f.x=h,f.y=k,f.angle=l):(f.x=n,f.y=m,f.angle=u):180<e&&270>e?x>b.x?(f.x=x,f.y=A,f.angle=y):(f.x=n,f.y=m,f.angle=u):x<b.x+b.width?(f.x=x,f.y=A,f.angle=y):(f.x=J,f.y=d,f.angle=g));return f}}})();
(function(){mg.action=new function(){var a=this;a.hit=function(b,d,e,f,g,h){var k,l;0<h?(f=mg.math.getHitPoint(d,e,f),k=f.angle,l=cc.p(f.x,f.y),e=cc.pDistance(e,l),e=cc.sequence(cc.moveTo(e/g,l),cc.callFunc(function(){b.rotation=k;b.runAction(a.hit(b,d,l,k,g,h-1))}))):(e=null,cc.warn("mg.action.hit() : 撞击次数小于0！"));return e};a.hitRepeatForever=function(b,d,e,f,g){return a.hit(b,d,e,f,g,Number.MAX_VALUE)};a.popShow=function(a,d){a.setScale(0);a.runAction(cc.sequence(cc.scaleTo(.4,1).easing(cc.easeBackOut()),
cc.callFunc(mg.fn.isFunction(d)||mg.fn.empty)))};a.popExit=function(a,d){var e=cc.sequence(cc.scaleTo(.1,0).easing(cc.easeBackIn()),cc.callFunc(mg.fn.isFunction(d)||mg.fn.empty),cc.removeSelf());a.runAction(e)};return a}})();
(function(){mg.CircleBy=cc.ScaleBy.extend({_center:cc.p(0,0),_radius:0,_radian:0,_moveTimes:1,_firstCall:!0,_duration:0,_fishDegree:0,_vDegree:0,ctor:function(a,b,d,e){cc.ScaleBy.prototype.ctor.call(this);this.initWithDuration(a,b,d,e)},initWithDuration:function(a,b,d,e){return cc.ScaleBy.prototype.initWithDuration.call(this,a,1)?(this._center=b,this._radius=d,this._duration=a,this._fishDegree=e,b=cc.director.getAnimationInterval(),this._radian=e/a/cc.director.getAnimationInterval()*Math.PI/180,this._vDegree=
this._fishDegree=e/a*b,this._radian=this._fishDegree*Math.PI/180,this._moveTimes=0,!0):!1},startWithTarget:function(a){cc.ScaleBy.prototype.startWithTarget.call(this,a);a=cc.pSub(cc.p(a.x,a.y),this._center);a=cc.radiansToDegrees(cc.pToAngle(a));this._moveTimes=60*a*this._duration/360;this._moveTimes=360/this._duration*a/60},update:function(a){if(!0===this._firstCall)this.startWithTarget(this.getTarget()),this._firstCall=!1;else if(this.getTarget()){a=cc.pSub(cc.p(this.getTarget().x,this.getTarget().y),
this._center);var b=(cc.radiansToDegrees(cc.pToAngle(a))-this._vDegree)*Math.PI/180;a=this._radius*Math.cos(b);b=this._radius*Math.sin(b);a=cc.p(a+this._center.x,b+this._center.y);this.getTarget().setPosition(a);this._moveTimes+=1}}});mg.circleBy=function(a,b,d,e){return new mg.CircleBy(a,b,d,e)}})();
(function(){mg.Shake=cc.ScaleBy.extend({_duration:0,_strengthX:0,_strengthY:0,_startPos:cc.p(0,0),ctor:function(a,b,d,e){cc.ScaleBy.prototype.ctor.call(this);this.initWithDuration(a,b,d,e)},initWithDuration:function(a,b,d,e){return cc.ScaleBy.prototype.initWithDuration.call(this,a,1)?(this._startPos=b,this._strengthX=d,this._strengthY=void 0===e?d:e,!0):!1},update:function(a){a=-this._strengthX+mg.math.randomBetween(0,this._strengthX);var b=-this._strengthY+mg.math.randomBetween(0,this._strengthY);
a=cc.pAdd(cc.p(this._startPos.x,this._startPos.y),cc.p(a,b));this.getTarget().setPosition(a)}});mg.shake=function(a,b,d,e){return new mg.Shake(a,b,d,e)}})();(function(){mg.event=new function(){this.registerCustomEvent=function(a,b,d,e){b=cc.EventListener.create({event:cc.EventListener.CUSTOM,target:a,eventName:b,callback:d});cc.eventManager.addListener(b,a);return b}}})();mg.TOUCH_EFFECT={};mg.TOUCH_EFFECT.NONE=0;mg.TOUCH_EFFECT.ZOOM=1;mg.TOUCH_EFFECT.POP=2;mg.TOUCH_EFFECT.LIGHT=3;
mg.TOUCH_EFFECT.OPACITY=4;mg.TOUCH_DIR_NONE=0;mg.TOUCH_DIR_X=1;mg.TOUCH_DIR_Y=2;mg.TOUCH_DIR_BOTH=3;
(function(){mg.touch=new function(){var a=this;a._makeTouch=function(b,d){var e;e=mg.fn.isNumber(d.touchScale)?d.touchScale:1;var f=b.width*e,g=b.height*e,h=mg.fn.isNumber(d.priority)?d.priority:b,k;e=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1!==d.swallow,target:b,onTouchBegan:a._onTouchBegan,onTouchMoved:a._onTouchMoved,onTouchEnded:a._onTouchEnded,onTouchCancelled:a._onTouchCanceled});e.debugTouchRect=d.debugTouchRect||!1;e.__config=d;e.__hasTouchBegan=mg.fn.isFunction(d.onTouchBegan);
e.__hasTouchMoved=mg.fn.isFunction(d.onTouchMoved);e.__hasTouchEnded=mg.fn.isFunction(d.onTouchEnded);e.__hasTouchCancelled=mg.fn.isFunction(d.onTouchCancelled);e.__isHightLight=!1;e.setEnabled(b.visible);b.__touchListener=e;b.__touchRect=cc.rect(0,0,f,g);k=new cc.DrawNode;b.parent.addChild(k,999);b.__touchModel=k;k.setPosition(b.x-f/2,b.y-g/2);k.drawRect(cc.p(0,0),cc.p(f,g),cc.color(255,0,0,128),0);k.setVisible(!0===d.debug);cc.eventManager.addListener(e,h)};a._onHighLight=function(a){a.__isHightLight=
!0;a.__config.touchEffect===mg.TOUCH_EFFECT.ZOOM?ui.commonScale(a.target,!0):a.__config.touchEffect===mg.TOUCH_EFFECT.POP&&ui.popScale(a.target)};a._onUnHighLight=function(a){a.__isHightLight=!1;a.__config.touchEffect===mg.TOUCH_EFFECT.ZOOM&&ui.commonScale(a.target)};a._onTouchBegan=function(b,d){var e=d.getCurrentTarget(),f=e.__touchListener,g=f.__config,h=e.__touchModel.convertToNodeSpace(b.getLocation());if(!cc.rectContainsPoint(e.__touchRect,h)||f.__hasTouchBegan&&!1===g.onTouchBegan.call(e,b,
d))return!1;a._onHighLight(f);return!0};a._onTouchMoved=function(b,d){var e=d.getCurrentTarget(),f=e.__touchListener,g=f.__config;f.__hasTouchMoved&&g.onTouchMoved.call(e,b,d);g.touchEffect!==mg.TOUCH_EFFECT.NONE&&(g=e.__touchModel.convertToNodeSpace(b.getLocation()),(e=cc.rectContainsPoint(e.__touchRect,g))&&!f.__isHightLight?a._onHighLight(f):!e&&f.__isHightLight&&a._onUnHighLight(f))};a._onTouchEnded=function(b,d){var e=d.getCurrentTarget(),f=e.__touchListener,g=f.__config,h=e.__touchModel.convertToNodeSpace(b.getLocation());
cc.rectContainsPoint(e.__touchRect,h)?(!mg.fn.isUndefined(e.__touchAudio)&&mg.audio.isEffectEnabled()&&mg.audio.playEffect(e.__touchAudio),f.__hasTouchEnded&&g.onTouchEnded.call(e,b,d)):f.__hasTouchCancelled&&g.onTouchCancelled.call(e,b,d);a._onUnHighLight(f)};a._onTouchCanceled=function(b,d){var e=d.getCurrentTarget(),f=e.__touchListener,g=f.__config;f.__hasTouchCancelled&&g.onTouchCancelled.call(e,b,d);a._onUnHighLight(f)};a.getTouchMoveInch=function(a,d,e){var f=Math.abs(a.x-d.x);a=Math.abs(a.y-
d.y);d=f>=(0<=e?e:4);e=a>=(0<=e?e:4);return d&&e?f>a?mg.TOUCH_DIR_X:mg.TOUCH_DIR_Y:d?mg.TOUCH_DIR_X:e?mg.TOUCH_DIR_Y:mg.TOUCH_DIR_NONE};a.makeTouchWithZoom=function(b,d){d.touchEffect=mg.TOUCH_EFFECT.ZOOM;a.clearTouch(b);a._makeTouch(b,d)};a.makeTouchWithPop=function(b,d){d.touchEffect=mg.TOUCH_EFFECT.POP;a.clearTouch(b);a._makeTouch(b,d)};a.clearTouch=function(a){a.__touchListener&&(cc.eventManager.removeListener(a.__touchListener),a.__touchListener=void 0)};a.makeTouch=function(b,d){cc.assert(mg.fn.isObject(d),
"mg.makeTouch() : config invalid!");var e=mg.fn.isUndefined(d.touchEffect)?mg.TOUCH_EFFECT.ZOOM:d.touchEffect;a.clearTouch(b);switch(e){case mg.TOUCH_EFFECT.NONE:a._makeTouch.call(b,b,d);break;case mg.TOUCH_EFFECT.ZOOM:a.makeTouchWithZoom.call(b,b,d);break;case mg.TOUCH_EFFECT.POP:a.makeTouchWithPop.call(b,b,d);break;default:a._makeTouch.call(b,b,d)}}}})();
(function(){cc.Node.prototype.setTouchEnable=function(a){for(var d=0,e=this.getChildren(),d=0;d<e.length;d++)e[d].setTouchEnable(a);this.__touchListener&&this.__touchListener.setEnabled(a)};var a=cc.Node.prototype.setVisible;cc.Node.prototype.setVisible=function(b){this.setTouchEnable(b);a.call(this,b)};cc.Node.prototype.getPositionByAnchorPoint=function(a){return cc.p(this.width*a.x,this.height*a.y)};cc.Node.prototype.getPositionByAnchorInDesNode=function(a,d){var e=this.convertToWorldSpace(this.getPositionByAnchorPoint(d));
return a.convertToNodeSpace(e)};cc.Node.prototype.getPositionInDesNode=function(a){return this.getPositionByAnchorInDesNode(a,this.getAnchorPoint())};cc.Node.prototype.setAnchorPointAndUpdatePosition=function(a){var d=this.getContentSize(),e=this.getAnchorPoint(),f=this.getPosition(),g=this.getScale(),e=cc.p(f.x-d.width*e.x*g,f.y-d.height*e.y*g),e=cc.p(e.x+d.width*a.x*g,e.y+d.height*a.y*g);this.setPosition(e);this.setAnchorPoint(a)};cc.Node.prototype.addChildToCenter=function(a){this.addChild(a);
a.setPosition(this.width/2,this.height/2)};cc.Node.prototype.addChildToAnchorPoint=function(a,d,e){cc.assert(a instanceof cc.Node,"cc.Node.addChildToAnchorPosition() : child is invalid!");e=e||cc.p(0,0);a.setPosition(cc.pAdd(this.getPositionByAnchorPoint(d),e));this.addChild(a)};cc.Node.prototype.isInScreen=function(){var a=!1;0<=this.getPositionX()&&this.getPositionX()<=cc.winSize.width&&0<=this.getPositionY()&&this.getPositionY()<=cc.winSize.height&&(a=!0);return a}})();
cc.ActionInterval.prototype.easeIn=function(a){return new cc.EaseIn(this,void 0===a?2:a)};cc.ActionInterval.prototype.easeOut=function(a){return new cc.EaseOut(this,void 0===a?2:a)};cc.ActionInterval.prototype.easeInOut=function(a){return new cc.EaseInOut(this,void 0===a?2:a)};cc.ActionInterval.prototype.easeExponentialIn=function(){return new cc.EaseExponentialIn(this)};cc.ActionInterval.prototype.easeExponentialOut=function(){return new cc.EaseExponentialOut(this)};
cc.ActionInterval.prototype.easeExponentialInOut=function(){return new cc.EaseExponentialInOut(this)};cc.ActionInterval.prototype.easeSineIn=function(){return new cc.EaseSineIn(this)};cc.ActionInterval.prototype.easeSineOut=function(){return new cc.EaseSineOut(this)};cc.ActionInterval.prototype.easeSineInOut=function(){return new cc.EaseSineInOut(this)};cc.ActionInterval.prototype.easeElasticIn=function(a){return new cc.EaseElasticIn(this,void 0===a?.3:a)};
cc.ActionInterval.prototype.easeElasticOut=function(a){return new cc.EaseElasticOut(this,void 0===a?.3:a)};cc.ActionInterval.prototype.easeElasticInOut=function(a){return new cc.EaseElasticInOut(this,void 0===a?.3:a)};cc.ActionInterval.prototype.easeBounceIn=function(){return new cc.EaseBounceIn(this)};cc.ActionInterval.prototype.easeBounceOut=function(){return new cc.EaseBounceOut(this)};cc.ActionInterval.prototype.easeBounceInOut=function(){return new cc.EaseBounceInOut(this)};
cc.ActionInterval.prototype.easeBackIn=function(){return new cc.EaseBackIn(this)};cc.ActionInterval.prototype.easeBackOut=function(){return new cc.EaseBackOut(this)};cc.ActionInterval.prototype.easeBackInOut=function(){return new cc.EaseBackInOut(this)};cc.ActionInterval.prototype.easeBezierAction=function(){return new cc.EaseBezierAction(this)};cc.ActionInterval.prototype.easeQuadraticActionIn=function(){return new cc.EaseQuadraticActionIn(this)};
cc.ActionInterval.prototype.easeQuadraticActionOut=function(){return new cc.EaseQuadraticActionOut(this)};cc.ActionInterval.prototype.easeQuadraticActionInOut=function(){return new cc.EaseQuadraticActionInOut(this)};cc.ActionInterval.prototype.easeQuarticActionIn=function(){return new cc.EaseQuarticActionIn(this)};cc.ActionInterval.prototype.easeQuarticActionOut=function(){return new cc.EaseQuarticActionOut(this)};cc.ActionInterval.prototype.easeQuarticActionInOut=function(){return new cc.EaseQuarticActionInOut(this)};
cc.ActionInterval.prototype.easeQuinticActionIn=function(){return new cc.EaseQuinticActionIn(this)};cc.ActionInterval.prototype.easeQuinticActionOut=function(){return new cc.EaseQuinticActionOut(this)};cc.ActionInterval.prototype.easeQuinticActionInOut=function(){return new cc.EaseQuinticActionInOut(this)};cc.ActionInterval.prototype.easeCircleActionIn=function(){return new cc.EaseCircleActionIn(this)};cc.ActionInterval.prototype.easeCircleActionOut=function(){return new cc.EaseCircleActionOut(this)};
cc.ActionInterval.prototype.easeCircleActionInOut=function(){return new cc.EaseCircleActionInOut(this)};cc.ActionInterval.prototype.easeCubicActionIn=function(){return new cc.EaseCubicActionIn(this)};cc.ActionInterval.prototype.easeCubicActionOut=function(){return new cc.EaseCubicActionOut(this)};cc.ActionInterval.prototype.easeCubicActionInOut=function(){return new cc.EaseCubicActionInOut(this)};md5=cc.Class.extend({});
md5.safeAdd=function(a,b){var d=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(d>>16)<<16|d&65535};md5.bitRotateLeft=function(a,b){return a<<b|a>>>32-b};md5.md5cmn=function(a,b,d,e,f,g){return md5.safeAdd(md5.bitRotateLeft(md5.safeAdd(md5.safeAdd(b,a),md5.safeAdd(e,g)),f),d)};md5.md5ff=function(a,b,d,e,f,g,h){return md5.md5cmn(b&d|~b&e,a,b,f,g,h)};md5.md5gg=function(a,b,d,e,f,g,h){return md5.md5cmn(b&e|d&~e,a,b,f,g,h)};md5.md5hh=function(a,b,d,e,f,g,h){return md5.md5cmn(b^d^e,a,b,f,g,h)};
md5.md5ii=function(a,b,d,e,f,g,h){return md5.md5cmn(d^(b|~e),a,b,f,g,h)};
md5.binlMD5=function(a,b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;var d,e,f,g,h,k=1732584193,l=-271733879,n=-1732584194,m=271733878;for(d=0;d<a.length;d+=16)e=k,f=l,g=n,h=m,k=md5.md5ff(k,l,n,m,a[d],7,-680876936),m=md5.md5ff(m,k,l,n,a[d+1],12,-389564586),n=md5.md5ff(n,m,k,l,a[d+2],17,606105819),l=md5.md5ff(l,n,m,k,a[d+3],22,-1044525330),k=md5.md5ff(k,l,n,m,a[d+4],7,-176418897),m=md5.md5ff(m,k,l,n,a[d+5],12,1200080426),n=md5.md5ff(n,m,k,l,a[d+6],17,-1473231341),l=md5.md5ff(l,n,m,k,a[d+7],22,-45705983),
k=md5.md5ff(k,l,n,m,a[d+8],7,1770035416),m=md5.md5ff(m,k,l,n,a[d+9],12,-1958414417),n=md5.md5ff(n,m,k,l,a[d+10],17,-42063),l=md5.md5ff(l,n,m,k,a[d+11],22,-1990404162),k=md5.md5ff(k,l,n,m,a[d+12],7,1804603682),m=md5.md5ff(m,k,l,n,a[d+13],12,-40341101),n=md5.md5ff(n,m,k,l,a[d+14],17,-1502002290),l=md5.md5ff(l,n,m,k,a[d+15],22,1236535329),k=md5.md5gg(k,l,n,m,a[d+1],5,-165796510),m=md5.md5gg(m,k,l,n,a[d+6],9,-1069501632),n=md5.md5gg(n,m,k,l,a[d+11],14,643717713),l=md5.md5gg(l,n,m,k,a[d],20,-373897302),
k=md5.md5gg(k,l,n,m,a[d+5],5,-701558691),m=md5.md5gg(m,k,l,n,a[d+10],9,38016083),n=md5.md5gg(n,m,k,l,a[d+15],14,-660478335),l=md5.md5gg(l,n,m,k,a[d+4],20,-405537848),k=md5.md5gg(k,l,n,m,a[d+9],5,568446438),m=md5.md5gg(m,k,l,n,a[d+14],9,-1019803690),n=md5.md5gg(n,m,k,l,a[d+3],14,-187363961),l=md5.md5gg(l,n,m,k,a[d+8],20,1163531501),k=md5.md5gg(k,l,n,m,a[d+13],5,-1444681467),m=md5.md5gg(m,k,l,n,a[d+2],9,-51403784),n=md5.md5gg(n,m,k,l,a[d+7],14,1735328473),l=md5.md5gg(l,n,m,k,a[d+12],20,-1926607734),
k=md5.md5hh(k,l,n,m,a[d+5],4,-378558),m=md5.md5hh(m,k,l,n,a[d+8],11,-2022574463),n=md5.md5hh(n,m,k,l,a[d+11],16,1839030562),l=md5.md5hh(l,n,m,k,a[d+14],23,-35309556),k=md5.md5hh(k,l,n,m,a[d+1],4,-1530992060),m=md5.md5hh(m,k,l,n,a[d+4],11,1272893353),n=md5.md5hh(n,m,k,l,a[d+7],16,-155497632),l=md5.md5hh(l,n,m,k,a[d+10],23,-1094730640),k=md5.md5hh(k,l,n,m,a[d+13],4,681279174),m=md5.md5hh(m,k,l,n,a[d],11,-358537222),n=md5.md5hh(n,m,k,l,a[d+3],16,-722521979),l=md5.md5hh(l,n,m,k,a[d+6],23,76029189),k=
md5.md5hh(k,l,n,m,a[d+9],4,-640364487),m=md5.md5hh(m,k,l,n,a[d+12],11,-421815835),n=md5.md5hh(n,m,k,l,a[d+15],16,530742520),l=md5.md5hh(l,n,m,k,a[d+2],23,-995338651),k=md5.md5ii(k,l,n,m,a[d],6,-198630844),m=md5.md5ii(m,k,l,n,a[d+7],10,1126891415),n=md5.md5ii(n,m,k,l,a[d+14],15,-1416354905),l=md5.md5ii(l,n,m,k,a[d+5],21,-57434055),k=md5.md5ii(k,l,n,m,a[d+12],6,1700485571),m=md5.md5ii(m,k,l,n,a[d+3],10,-1894986606),n=md5.md5ii(n,m,k,l,a[d+10],15,-1051523),l=md5.md5ii(l,n,m,k,a[d+1],21,-2054922799),
k=md5.md5ii(k,l,n,m,a[d+8],6,1873313359),m=md5.md5ii(m,k,l,n,a[d+15],10,-30611744),n=md5.md5ii(n,m,k,l,a[d+6],15,-1560198380),l=md5.md5ii(l,n,m,k,a[d+13],21,1309151649),k=md5.md5ii(k,l,n,m,a[d+4],6,-145523070),m=md5.md5ii(m,k,l,n,a[d+11],10,-1120210379),n=md5.md5ii(n,m,k,l,a[d+2],15,718787259),l=md5.md5ii(l,n,m,k,a[d+9],21,-343485551),k=md5.safeAdd(k,e),l=md5.safeAdd(l,f),n=md5.safeAdd(n,g),m=md5.safeAdd(m,h);return[k,l,n,m]};
md5.binl2rstr=function(a){var b,d="",e=32*a.length;for(b=0;b<e;b+=8)d+=String.fromCharCode(a[b>>5]>>>b%32&255);return d};md5.rstr2binl=function(a){var b,d=[];d[(a.length>>2)-1]=void 0;for(b=0;b<d.length;b+=1)d[b]=0;var e=8*a.length;for(b=0;b<e;b+=8)d[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return d};md5.rstrMD5=function(a){return md5.binl2rstr(md5.binlMD5(md5.rstr2binl(a),8*a.length))};
md5.rstrHMACMD5=function(a,b){var d,e=md5.rstr2binl(a),f=[],g=[];f[15]=g[15]=void 0;16<e.length&&(e=md5.binlMD5(e,8*a.length));for(d=0;16>d;d+=1)f[d]=e[d]^909522486,g[d]=e[d]^1549556828;d=md5.binlMD5(f.concat(md5.rstr2binl(b)),512+8*b.length);return md5.binl2rstr(md5.binlMD5(g.concat(d),640))};md5.rstr2hex=function(a){var b="",d,e;for(e=0;e<a.length;e+=1)d=a.charCodeAt(e),b+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(d&15);return b};md5.str2rstrUTF8=function(a){return unescape(encodeURIComponent(a))};
md5.rawMD5=function(a){return md5.rstrMD5(md5.str2rstrUTF8(a))};md5.hexMD5=function(a){return md5.rstr2hex(md5.rawMD5(a))};md5.rawHMACMD5=function(a,b){return md5.rstrHMACMD5(md5.str2rstrUTF8(a),md5.str2rstrUTF8(b))};md5.hexHMACMD5=function(a,b){return md5.rstr2hex(md5.rawHMACMD5(a,b))};md5.encrypt=function(a,b,d){return b?d?md5.rawHMACMD5(b,a):md5.hexHMACMD5(b,a):d?md5.rawMD5(a):md5.hexMD5(a)};
var MGBaseEditBox=cc.EditBox.extend({ctor:function(a,b){var d=new cc.Scale9Sprite(b);d.setAnchorPoint(cc.p(.5,.5));cc.EditBox.prototype.ctor.call(this,a.getContentSize(),d);this.cloneTextField(a)},cloneTextField:function(a){this.setName(a.getName());this.setFontColor(cc.color(255,255,255,255));this.setPlaceholderFontColor(cc.color(255,255,255,255));this.setPlaceHolder(a.getPlaceHolder());this.setPlaceholderFontName(a.getFontName());this.setPlaceholderFontSize(a.getFontSize());this.setFontName(a.getFontName());
this.setFontSize(a.getFontSize());this.setPosition(a.getPosition());this.setContentSize(a.getContentSize().width,a.getContentSize().height);this.setReturnType(cc.KEYBOARD_RETURNTYPE_DONE);this.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE);this.setDelegate(this);a.isPasswordEnabled()&&(this.setInputFlag(cc.EDITBOX_INPUT_FLAG_PASSWORD),this.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE),this.setFontSize(a.getFontSize()),this.setPlaceholderFontSize(a.getFontSize()));this.setAnchorPoint(a.getAnchorPoint());
a.removeFromParent(!0);cc.sys.isNative||(this._renderCmd._edTxt.style.textTransform="none",this._renderCmd._edTxt.style.height=a.getContentSize().height+"px")},setVisibleBackground:function(a){cc.sys.isNative||this._backgroundSprite.setVisible(a)},setFocus:function(){!cc.sys.isNative&&this._renderCmd._edTxt&&"none"===this._renderCmd._edTxt.style.display&&(this._renderCmd._edTxt.style.display="",this._renderCmd._edTxt.focus())}}),MGBaseButton=ccui.Button.extend({_listEvents:null,_clickEventListener:null,
_mouseHoverListener:null,_mouseHoverEventCallBack:null,_highlight:null,_isHover:null,onEnter:function(){ccui.Button.prototype.onEnter.call(this);this._isHover=!1},_releaseUpEvent:function(){ccui.Button.prototype._releaseUpEvent.call(this)},initObj:function(){},_initEventsGame:function(){this._listEvents=[]},cloneFromButton:function(a){if(cc.sys.isNative){this.setEnabled(a.isEnabled());this.setVisible(a.isVisible());this.setBright(a.isBright());this.setTouchEnabled(a.isTouchEnabled());this.setLocalZOrder(a.getLocalZOrder());
this.setTag(a.getTag());this.setName(a.getName());this.setActionTag(a.getActionTag());this.setContentSize(a.getVirtualRendererSize());this.setPosition(a.getPosition());this.setAnchorPoint(a.getAnchorPoint());this.setScaleX(a.getScaleX());this.setScaleY(a.getScaleY());this.setRotation(a.getRotation());this.setRotationX(a.getRotationX());this.setRotationY(a.getRotationY());this.setFlippedX(a.isFlippedX());this.setFlippedY(a.isFlippedY());this.setColor(a.getColor());this.setOpacity(a.getOpacity());for(var b in a._layoutParameterDictionary){var d=
a._layoutParameterDictionary[b];d&&this.setLayoutParameter(d.clone())}}else this._copyProperties(a);b=a.getChildren();for(var d=b.length,e=0;e<d;e++)b[e].retain(),b[e].removeFromParent(!1),this.addChild(b[e]),b[e].release();a.removeFromParent(!1)},addMouseHoverEventListener:function(a){!cc.sys.isNative&&a&&(this._mouseHoverEventCallBack=a)},setMouseHoverEnabled:function(a){this._mouseHoverEnabled!==a&&((this._mouseHoverEnabled=a)?(this._mouseHoverListener||(this._mouseHoverListener=cc.EventListener.create({event:cc.EventListener.MOUSE,
swallowTouches:!0,onMouseMove:this._onBaseMouseHover.bind(this)})),cc.eventManager.addListener(this._mouseHoverListener,this)):cc.eventManager.removeListener(this._mouseHoverListener))},_onBaseMouseHover:function(a,b){b=a.getCurrentTarget();var d=a.getLocation(),e=b.getContentSize(),e=cc.rect(0,0,e.width,e.height);if(this._mouseHoverEventCallBack){if(!(this.isVisible()&&this.isEnabled()&&this._isAncestorsEnabled()&&this._isAncestorsVisible(this))){this._isHover&&(ConstantsVariable.ISHOVER=!1);this._isHover=
!1;return}if(cc.rectContainsPoint(e,b.convertToNodeSpace(d)))!1!==this._isHover||ConstantsVariable.ISHOVER||(this._isHover=ConstantsVariable.ISHOVER=!0,this._mouseHoverEventCallBack(b,1));else return!0===this._isHover&&(this._isHover=!1,ConstantsVariable.ISHOVER=!1,this._mouseHoverEventCallBack(b,0)),!1}return!0},setDispose:function(){if(this._listEvents)for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a]);this._listEvents=[];cc.eventManager.removeListener(this._mouseHoverListener)},
onExit:function(){ccui.Button.prototype.onExit.call(this);this.setDispose()}}),MGBaseSprite=cc.Sprite.extend({_mainLayer:null,_mainAction:null,_layerbg:null,_listEvents:null,_listEventTouch:null,_touchEnabled:null,_mouseHoverEnabled:null,_touchListener:null,_touchBeganPosition:null,_touchMovePosition:null,_touchEndPosition:null,_propagateTouchEvents:null,_touchEventListener:null,_touchEventSelector:null,_clickEventListener:null,_mouseHoverListener:null,_mouseHoverEventCallBack:null,_highlight:null,
_isHover:null,ctor:function(a){cc.Sprite.prototype.ctor.call(this,a);this._isHover=this._touchEnabled=!1;this._touchBeganPosition={};this._touchMovePosition={};this._touchEndPosition={};this._highlight=!1},cloneFromSprite:function(a){this.setName(a.getName());this.setPosition(a.getPosition());this.setVisible(a.isVisible());for(this.setLocalZOrder(a.getLocalZOrder());0<a.getChildrenCount();){var b=a.getChildren()[0];b.removeFromParent();this.addChild(b)}a.removeFromParent()},initObj:function(){},isTouchEnabled:function(){return this._touchEnabled},
setSwallowTouches:function(a){this._touchListener&&this._touchListener.setSwallowTouches(a)},isSwallowTouches:function(){return this._touchListener?this._touchListener.isSwallowTouches():!1},onTouchBegan:function(a,b){this._hit=!1;if(this.isVisible()){var d=a.getLocation();this._touchBeganPosition.x=d.x;this._touchBeganPosition.y=d.y;this.hitTest(this._touchBeganPosition)&&(this._highlight=this._hit=!0)}if(!this._hit)return!1;this._pushDownEvent();return!0},onTouchMoved:function(a,b){var d=a.getLocation();
this._touchMovePosition.x=d.x;this._touchMovePosition.y=d.y;this._moveEvent()},onTouchEnded:function(a,b){var d=a.getLocation();this._touchEndPosition.x=d.x;this._touchEndPosition.y=d.y;d=this._highlight;this.setHighlighted(d);d?this._releaseUpEvent():this._cancelUpEvent()},setHighlighted:function(a){this._highlight=a},onTouchCancelled:function(a){this.setHighlighted(!1);this._cancelUpEvent()},_pushDownEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_BEGAN);
this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_BEGAN)},_moveEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_MOVED);this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_MOVED)},_releaseUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_ENDED);this._touchEventListener&&
this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_ENDED);this._clickEventListener&&this._clickEventListener(this)},_cancelUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_CANCELED);this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_CANCELED)},addTouchEventListener:function(a,b){void 0===b?this._touchEventCallback=a:(this._touchEventSelector=
a,this._touchEventListener=b)},addMouseHoverEventListener:function(a){!cc.sys.isNative&&a&&(this._mouseHoverEventCallBack=a)},cloneFromSprite:function(a){this.setName(a.getName());this.setPosition(a.getPosition());this.setVisible(a.isVisible());for(this.setLocalZOrder(a.getLocalZOrder());0<a.getChildrenCount();){var b=a.getChildren()[0];b.removeFromParent();this.addChild(b)}a.removeFromParent()},_initEventsGame:function(){this._listEvents=[];this._listEventTouch=[]},setTouchEnabled:function(a){this._touchEnabled!==
a&&((this._touchEnabled=a)?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)})),cc.eventManager.addListener(this._touchListener,this)):cc.eventManager.removeListener(this._touchListener))},setMouseHoverEnabled:function(a){this._mouseHoverEnabled!==a&&((this._mouseHoverEnabled=a)?(this._mouseHoverListener||
(this._mouseHoverListener=cc.EventListener.create({event:cc.EventListener.MOUSE,swallowTouches:!0,onMouseMove:this._onBaseMouseHover.bind(this)})),cc.eventManager.addListener(this._mouseHoverListener,this)):cc.eventManager.removeListener(this._mouseHoverListener))},_onBaseMouseHover:function(a){var b=a.getCurrentTarget();a=b.convertToNodeSpace(a.getLocation());var d=b.getContentSize(),d=cc.rect(0,0,d.width,d.height);if(!this.isVisible())this._isHover&&(ConstantsVariable.ISHOVER=!1),this._isHover=
!1;else if(this._mouseHoverEventCallBack)if(cc.rectContainsPoint(d,a)){if(!1===this._isHover&&!ConstantsVariable.ISHOVER)return Utilities.showLog(" _onMouseHover "+ConstantsVariable.ISHOVER),this._isHover=ConstantsVariable.ISHOVER=!0,this._mouseHoverEventCallBack(b,1),!0}else return!0===this._isHover&&(this._isHover=!1,ConstantsVariable.ISHOVER=!1,this._mouseHoverEventCallBack(b,0)),!1},addClickEventListener:function(a){this._clickEventListener=a},hitTest:function(a){var b=cc.rect(0,0,this.getContentSize().width,
this.getContentSize().height);return cc.rectContainsPoint(b,this.convertToNodeSpace(a))},onClickBtnFromCocostudio:function(a,b){},setDispose:function(){if(this._listEvents)for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a]),cc.eventManager.removeCustomListeners(this._listEvents[a]);this._listEvents=[];if(this._listEventTouch)for(a=0;a<this._listEventTouch.length;a++)cc.eventManager.removeListener(this._listEventTouch[a]);this._listEventTouch=[];cc.eventManager.removeListener(this._touchListener);
cc.eventManager.removeListener(this._clickEventListener);cc.eventManager.removeListener(this._mouseHoverListener)}}),MGBaseImageView=ccui.ImageView.extend({_listEvents:null,_mouseHoverListener:null,_mouseHoverEventCallBack:null,_isHover:null,ctor:function(){ccui.ImageView.prototype.ctor.call(this);this._isHover=!1},initObj:function(){},_initEventsGame:function(){this._listEvents=[]},cloneImageView:function(a){if(cc.sys.isNative){this.setEnabled(a.isEnabled());this.setVisible(a.isVisible());this.setBright(a.isBright());
this.setTouchEnabled(a.isTouchEnabled());this.setLocalZOrder(a.getLocalZOrder());this.setTag(a.getTag());this.setName(a.getName());this.setActionTag(a.getActionTag());this.setContentSize(a.getVirtualRendererSize());this.setPosition(a.getPosition());this.setAnchorPoint(a.getAnchorPoint());this.setScaleX(a.getScaleX());this.setScaleY(a.getScaleY());this.setRotation(a.getRotation());this.setRotationX(a.getRotationX());this.setRotationY(a.getRotationY());this.setFlippedX(a.isFlippedX());this.setFlippedY(a.isFlippedY());
this.setColor(a.getColor());this.setOpacity(a.getOpacity());for(var b in a._layoutParameterDictionary){var d=a._layoutParameterDictionary[b];d&&this.setLayoutParameter(d.clone())}}else this._copyProperties(a);b=a.getChildren();for(var d=b.length,e=0;e<d;e++)b[e].retain(),b[e].removeFromParent(!1),this.addChild(b[e]),b[e].release();a.removeFromParent(!1)},addMouseHoverEventListener:function(a){!cc.sys.isNative&&a&&(this._mouseHoverEventCallBack=a)},setMouseHoverEnabled:function(a){this._mouseHoverEnabled!==
a&&((this._mouseHoverEnabled=a)?(this._mouseHoverListener||(this._mouseHoverListener=cc.EventListener.create({event:cc.EventListener.MOUSE,swallowTouches:!0,onMouseMove:this._onBaseMouseHover.bind(this)})),cc.eventManager.addListener(this._mouseHoverListener,this)):cc.eventManager.removeListener(this._mouseHoverListener))},_onBaseMouseHover:function(a,b){b=a.getCurrentTarget();var d=a.getLocation(),e=b.getContentSize(),e=cc.rect(0,0,e.width,e.height);if(this._mouseHoverEventCallBack){if(!this.isVisible()||
!this._isAncestorsEnabled()||!this._isAncestorsVisible(this)){this._isHover&&(ConstantsVariable.ISHOVER=!1);this._isHover=!1;return}if(cc.rectContainsPoint(e,b.convertToNodeSpace(d)))!1!==this._isHover||ConstantsVariable.ISHOVER||(Utilities.showLog(" _onMouseHover "+ConstantsVariable.ISHOVER),this._isHover=ConstantsVariable.ISHOVER=!0,this._mouseHoverEventCallBack(b,1));else return!0===this._isHover&&(this._isHover=!1,ConstantsVariable.ISHOVER=!1,this._mouseHoverEventCallBack(b,0)),!1}return!0},setDispose:function(){if(this._listEvents){for(var a=
0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a]),cc.eventManager.removeCustomListeners(this._listEvents[a]);this._listEvents.length=0}cc.eventManager.removeListener(this._mouseHoverListener)},onExit:function(){ccui.ImageView.prototype.onExit.call(this);this.setDispose()}}),MGBaseLayer=ccui.Layout.extend({_mainLayer:null,_mainAction:null,_layerbg:null,_listEvents:null,_mouseHoverListener:null,_mouseHoverEventCallBack:null,_isHover:null,ctor:function(){ccui.Layout.prototype.ctor.call(this);
this._mainLayer=new cc.Node;this.addChild(this._mainLayer);this._isHover=!1},initObj:function(){},cloneFromLayer:function(a){a.removeFromParent(!1);this._mainLayer&&this._mainLayer.removeFromParent(!0);this._mainLayer=a;this._mainLayer.setVisible(!0);this._mainLayer.setName("_mainLayer");this.addChild(this._mainLayer);this._initEventBtnFromCocostudio();this._setccuiLayout();return!0},_cloneButtonToUIButton:function(a){for(var b=0;b<a.getChildrenCount();b++)if(a.getChildren()[b]instanceof ccui.Button){var d=
new MGUIBaseButton;d.cloneFromButton(a.getChildren()[b]);a.getChildren()[b].removeFromParent(!1);a.addChild(d)}else this._cloneButtonToUIButton(a.getChildren()[b])},_initEventsGame:function(){this._listEvents=[]},_initFromCocostudio:function(a,b){var d;d=b?ccs.load(a,b):ccs.load(a,cc.loader.resPath+"res/");this._mainLayer&&this._mainLayer.removeFromParent(!0);this._mainLayer=d.node;this._mainLayer.setVisible(!0);this._mainLayer.setName("_mainLayer");this.addChild(this._mainLayer);this._mainAction=
d.action;this._initEventBtnFromCocostudio();this._setccuiLayout();return!0},_setccuiLayout:function(){var a=this._mainLayer.getChildByName("MGBackground");a&&(this._layerbg=new ccui.Layout,this._mainLayer.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(a.getContentSize()),this._layerbg.setAnchorPoint(a.getAnchorPoint()),this._layerbg.setPosition(a.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},_initEventBtnFromCocostudio:function(){for(var a=
0;a<this._mainLayer.getChildrenCount();a++)(this._mainLayer.getChildren()[a]instanceof ccui.Button||this._mainLayer.getChildren()[a]instanceof ccui.ImageView)&&this._mainLayer.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){},playMainActionByFrame:function(a,b,d){this._mainAction&&this._mainLayer.runAction(this._mainAction);this._mainAction.gotoFrameAndPlay(a,b,d)},addMouseHoverEventListener:function(a){!cc.sys.isNative&&a&&
(this._mouseHoverEventCallBack=a)},setMouseHoverEnabled:function(a){ConstantsVariable.ISHOVER||this._mouseHoverEnabled===a||((this._mouseHoverEnabled=a)?(this._mouseHoverListener||(this._mouseHoverListener=cc.EventListener.create({event:cc.EventListener.MOUSE,swallowTouches:!0,onMouseMove:this._onBaseMouseHover.bind(this)})),cc.eventManager.addListener(this._mouseHoverListener,this)):cc.eventManager.removeListener(this._mouseHoverListener))},_onBaseMouseHover:function(a,b){b=a.getCurrentTarget();
var d=a.getLocation(),e=b.getContentSize(),e=cc.rect(0,0,e.width,e.height);if(this._mouseHoverEventCallBack){if(!(this.isVisible()&&this.isEnabled()&&this._isAncestorsEnabled()&&this._isAncestorsVisible(this))){this._isHover&&(ConstantsVariable.ISHOVER=!1);this._isHover=!1;return}if(cc.rectContainsPoint(e,b.convertToNodeSpace(d)))!1!==this._isHover||ConstantsVariable.ISHOVER||(Utilities.showLog(" _onMouseHover "+ConstantsVariable.ISHOVER),this._isHover=ConstantsVariable.ISHOVER=!0,this._mouseHoverEventCallBack(b,
1));else return!0===this._isHover&&(this._isHover=!1,ConstantsVariable.ISHOVER=!1,this._mouseHoverEventCallBack(b,0)),!1}return!0},setDispose:function(){if(this._listEvents){for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a]),cc.sys.isNative||cc.eventManager.removeCustomListeners(this._listEvents[a]);this._listEvents.length=0}cc.eventManager.removeListener(this._mouseHoverListener)}});
MGBaseMaskComponent=cc.Node.extend({img:null,clippingNode:null,sriteMask:null,ctor:function(){cc.Node.prototype.ctor.call(this)},initObj:function(){},setMask:function(a,b,d,e){this.removeAllChildren(!0);this.img=new cc.Sprite;this.img.setSpriteFrame(a);b&&this.img.setContentSize(b.width,b.height);this.sriteMask=new cc.Sprite;this.sriteMask.setSpriteFrame(d);e&&this.sriteMask.setContentSize(e.width,e.height);this.img.setAnchorPoint(cc.p(0,0));this.clippingNode=new cc.ClippingNode;this.clippingNode.setStencil(this.sriteMask);
this.clippingNode.setInverted(!1);this.clippingNode.setAlphaThreshold(.5);this.clippingNode.addChild(this.img);this.addChild(this.clippingNode);this.img.setScale(this.sriteMask.width/this.img.getContentSize().width,this.sriteMask.height/this.img.getContentSize().height)}});cc.LabelTTF._wordRex=/([a-zA-Z0-9\u00c0\u00c1\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]+|\S)/;
cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\u00c0\u00c1\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]+|\S)$/;
cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\u00c0\u00c1\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]+$/;
cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\u00c0\u00c1\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]/;
var MGBaseRichText=ccui.RichText.extend({fontColor:null,wordWrapWidth:null,wordWrap:null,fontSize:null,fontName:null,strLen:null,ctor:function(a,b,d,e,f){ccui.RichText.prototype.ctor.call(this);this.fontName=a;this.fontSize=b;this.fontColor=d;this.wordWrap=e;this.wordWrapWidth=f;cc.sys.isNative||this.setLineBreakOnSpace(!0);this.initObj()},initObj:function(){this.fontColor=this.fontColor?this.fontColor:cc.color.WHITE;this.wordWrapWidth=this.wordWrapWidth?this.wordWrapWidth:100;this.wordWrap=this.wordWrap?
this.wordWrap:!1;this.fontSize=this.fontSize?this.fontSize:10;this.fontName=this.fontName?this.fontName:"Arial"},setString:function(a,b){this.strLen=a.length;var d=0,e=a.length,f,g="",h=new cc.LabelTTF("",this.fontName,this.fontSize,cc.size(this.wordWrapWidth,0),cc.TEXT_ALIGNMENT_LEFT,cc.VERTICAL_TEXT_ALIGNMENT_TOP);for(d;d<e;d++)b[d]?(g+=a[d],f=new ccui.RichElementText(d+1,cc.hexToColor(b[d]),255,a[d],this.fontName,this.fontSize)):f=new ccui.RichElementText(d+1,cc.hexToColor(b[d]),255,this.fontColor,
this.fontName,this.fontSize),this.pushBackElement(f);this.wordWrap&&(cc.sys.isNative?(h.setString(g),this.setContentSize(h.getContentSize())):this.width=this.wordWrapWidth,this.ignoreContentAdaptWithSize(!1))},formatText:function(){ccui.RichText.prototype.formatText.call(this);if(!cc.sys.isNative){var a=this._elementRenderersContainer.getChildren();0<a.length&&(this.height=(a.length-this.strLen+1)*a[0].getContentSize().height)}}}),MGBaseNode=cc.Node.extend({_mainLayer:null,_mainAction:null,_layerbg:null,
_listEvents:null,ctor:function(){cc.Node.prototype.ctor.call(this);this._mainLayer=new cc.Node;this.addChild(this._mainLayer)},initObj:function(){},cloneFromNode:function(a){this.setName(a.getName());this.setPosition(a.getPosition());this.setVisible(a.isVisible());for(this.setLocalZOrder(a.getLocalZOrder());0<a.getChildrenCount();){var b=a.getChildren()[0];b.removeFromParent(!1);this.addChild(b)}a.removeFromParent(!1)},_initFromCocostudio:function(a,b){var d;d=b?ccs.load(a,b):ccs.load(a,cc.loader.resPath+
"res/");this._mainLayer.removeFromParent(!0);this._mainLayer=d.node;this._mainLayer.setVisible(!0);this._mainLayer.setName("_mainLayer");this.addChild(this._mainLayer);this._mainAction=d.action;this._initEventBtnFromCocostudio();this._setccuiLayout();return!0},_initEventsGame:function(){this._listEvents=[]},_setccuiLayout:function(){var a=this._mainLayer.getChildByName("MGBackground");a&&(this._layerbg=new ccui.Layout,this._mainLayer.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(a.getContentSize()),
this._layerbg.setAnchorPoint(a.getAnchorPoint()),this._layerbg.setPosition(a.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},_initEventBtnFromCocostudio:function(){for(var a=this._mainLayer.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},
onClickBtnFromCocostudio:function(a,b){},setDispose:function(){if(this._listEvents){for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a]),cc.sys.isNative||cc.eventManager.removeCustomListeners(this._listEvents[a]);this._listEvents.length=0}}}),MGBaseGame=MGBaseLayer.extend({netSend:null,resourceGame:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},loadResourceGame:function(a){this.resourceGame?cc.loader.load(this.resourceGame,this.loadResourceGameCB.bind(this,
this.resourceGame,a)):Utilities.showLog("resourceGame is Null")},loadResourceGameCB:function(a,b){for(var d in a)-1!=a[d].indexOf(".plist")&&cc.spriteFrameCache.addSpriteFrames(a[d],a[d].replace(".plist",".png"));b&&b()},initObj:function(){this._initEventsGame()},_initEventsGame:function(){this._listEvents=[]},setDispose:function(){MGBaseLayer.prototype.setDispose.call(this);if(this._listEvents){for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a]),cc.eventManager.removeCustomListeners(this._listEvents[a]);
this._listEvents.length=0}}}),MGGameInfo=cc.Class.extend({ctor:function(){}});MGGameInfo.MGMain;var Utilities={},eNmKpw3aT6=function(){eNmKpw3aT6.prototype.encrypt=function(a){return encodeURIComponent(CryptoJS.AES.encrypt(a,"c33367701511b4f6020ec61ded352059"))};eNmKpw3aT6.prototype.keyForAPI=function(){return"LKSDFCVCXSDFSDFS"}},SzMhg80S8P=new eNmKpw3aT6;
Utilities.Coin=function(a,b){if(void 0==a)return"";b=null==b?".":b;"number"===typeof a&&(a=a.toString());for(var d="",e=-1,f=a.length,g=0;g<f;g++)e++,3==e?(e=0,d="NaN"!=parseInt(a.charAt(f-(g+1)),10).toString()&&"-"!=a.charAt(f-(g+1))?d+(b+a.charAt(f-(g+1))):d+a.charAt(f-(g+1))):d+=a.charAt(f-(g+1));e="";f=d.length;for(g=0;g<f;g++)e+=d.charAt(f-(g+1));return e};
Utilities.CoinString=function(a,b){var d="";1<=a/1E9?d=(a/1E9).toFixed(2)+" Ty":1<=a/1E6?(d=a/1E6,d=0<d%1?d.toFixed(2)+" Tr":d+" Tr"):1<=a/1E5?(a/1E3&&(a/=1E3),d=a+" K"):d=Utilities.Coin(a);return d};
Utilities.getAPIBeforeLogin=function(a,b,d,e){MGGameInfo.MGMain.showLoading();var f="";d.channel=MGGameInfo.apiInfo.channel;d.platform=MGGameInfo.apiInfo.platform;d.version=MGGameInfo.apiInfo.version;d.deviceId=MGGameInfo.apiInfo.deviceId;d.packageName=MGGameInfo.apiInfo.packageName;d.versionDevice=MGGameInfo.apiInfo.versionDevice;d.deviceModel=MGGameInfo.apiInfo.model;d.brand=MGGameInfo.apiInfo.brand;d.service=MGGameInfo.apiInfo.service;d.unix=Utilities.getTimeStamp();var g=d.unix+d.service+SzMhg80S8P.keyForAPI();
d.sign=md5.encrypt(g);for(var h in d)f+=h+"="+d[h]+"&";f=f.substring(0,f.length-1);Utilities.showLog("Utilities.getAPIBeforeLogin head "+a+"vfunction "+b+"data \n"+f);var k=cc.loader.getXMLHttpRequest();k.timeout=3E4;k.open("POST",PreLoaderConfig.apiPath+a+"/"+b+"?unix="+d.unix+"&service="+encodeURIComponent(d.service)+"&sign="+encodeURIComponent(d.sign),!0);k.setRequestHeader("Content-Type","application/x-www-form-urlencoded");k.onreadystatechange=function(){if(4==k.readyState)if(200<=k.status&&
207>=k.status){var a=k.responseText;MGGameInfo.MGMain.hideLoading();a=JSON.parse(a);e(a);if(a.dataPopup&&a.dataPopup.isShow){var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=a.dataPopup.title;d[MG_POPUP_KEY_DATA.POPUP_MSG]=a.dataPopup.content;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}}else d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]=k.responseText?JSON.parse(k.responseText).message:PreLoaderConfig.Messages.ERROR_MASTER_SOCKET,
cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d);Utilities.showLog("getAPIBeforeLogin response: "+b+" "+k.responseText)}.bind(this);k.send(f);Utilities.showLog("getAPIBeforeLogin URLAPI : "+PreLoaderConfig.apiPath+a+"/"+b+"?unix="+d.unix+"&service="+encodeURIComponent(d.service)+"&accessToken="+encodeURIComponent(MGGameInfo.token4web)+"&sign="+encodeURIComponent(d.sign))};
Utilities.getAPIAfterLogin=function(a,b,d,e){MGGameInfo.MGMain.showLoading();var f="";d.channel=MGGameInfo.apiInfo.channel;d.platform=MGGameInfo.apiInfo.platform;d.version=MGGameInfo.apiInfo.version;d.deviceId=MGGameInfo.apiInfo.deviceId;d.packageName=MGGameInfo.apiInfo.packageName;d.versionDevice=MGGameInfo.apiInfo.versionDevice;d.deviceModel=MGGameInfo.apiInfo.model;d.brand=MGGameInfo.apiInfo.brand;d.service=MGGameInfo.apiInfo.service;d.unix=Utilities.getTimeStamp();d.UserID=MGGameInfo.myInfo.UserID;
var g=d.UserID+d.unix+d.service+MGGameInfo.token4web+SzMhg80S8P.keyForAPI();d.sign=md5.encrypt(g);"login_facebook"!=b&&"login_google"!=b&&(d.accesstoken=encodeURIComponent(MGGameInfo.token4web));for(var h in d)f+=h+"="+d[h]+"&";f=f.substring(0,f.length-1);Utilities.showLog("Utilities.getAPIAfterLogin head "+a+"vfunction "+b+" data \n"+f);var k=cc.loader.getXMLHttpRequest();k.timeout=3E4;k.open("POST",PreLoaderConfig.apiPath+a+"/"+b+"?UserID="+d.UserID+"&unix="+encodeURIComponent(d.unix)+"&service="+
encodeURIComponent(d.service)+"&sign="+encodeURIComponent(d.sign),!0);k.setRequestHeader("Content-Type","application/x-www-form-urlencoded");k.onreadystatechange=function(){if(4==k.readyState)if(200<=k.status&&207>=k.status){var a=k.responseText;MGGameInfo.MGMain.hideLoading();a=JSON.parse(a);e(a);"INVALID_TOKEN"==a.code&&cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.INVALID_TOKEN,null);if(a.dataPopup&&a.dataPopup.isShow){var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=a.dataPopup.title;
d[MG_POPUP_KEY_DATA.POPUP_MSG]=a.dataPopup.content;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}}else d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]=k.responseText?JSON.parse(k.responseText).message:PreLoaderConfig.Messages.ERROR_MASTER_SOCKET,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d);Utilities.showLog("getAPIAfterLogin response: "+b+" "+k.responseText)}.bind(this);k.send(f);Utilities.showLog("getAPIAfterLogin URLAPI : "+
PreLoaderConfig.apiPath+a+"/"+b+"?UserID="+d.UserID+"unix="+encodeURIComponent(d.unix)+"&service="+encodeURIComponent(d.service)+"&sign="+encodeURIComponent(d.sign))};Utilities.verifyToken=function(a,b){var d={AccessToken:encodeURIComponent(a)};"function"===typeof b&&Utilities.getAPIBeforeLogin("user","verify_token",d,b)};Utilities.getTimeStamp=function(){return PreLoaderConfig.deltaTimeApiServer?(new Date).getTime()+PreLoaderConfig.deltaTimeApiServer:(new Date).getTime()};Utilities.showLog=function(a){};
Utilities.encrypt=function(a){return SzMhg80S8P.encrypt(a)};var MGComboDatCuoc=MGBaseNode.extend({ctor:function(){MGBaseNode.prototype.ctor.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesCombo.UINodeButtonDatCuocCombo,PreLoaderConfig.PathToResourceDefault).node);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initEventBtnFromNode();this._initUI()},_initUI:function(){},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},
onClickBtnFromCocostudio:function(a,b){var d=MGComboDatCuoc.TAG_CONVERT[a.getTag()];if(0<=d&&void 0!==d){var e={};e.value=d;e.sender=a;cc.eventManager.dispatchCustomEvent(MGComboDatCuoc.ON_CLICK,e)}}});MGComboDatCuoc.ON_CLICK="ON_CLICK_COMBO_DATCUOC";MGComboDatCuoc.TAG_CONVERT={22:0,23:1};
var MGComboXuBet=MGBaseNode.extend({_listButton:null,_posYButton:0,_posXButton:0,_minBet:1,_listRate:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesCombo.UINodeXuBetCombo,PreLoaderConfig.PathToResourceDefault).node);this._listRate=[1,5,10,50,100];this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._listButton=[];this._initEventBtnFromNode();this._initUI()},setMinBet:function(a){this._minBet=a;for(a=0;a<this._listRate.length;a++)this.getChildByName("Text_"+
a).setString(Utilities.Coin(this._minBet*this._listRate[a]))},_initUI:function(){for(var a=0;a<this._listRate.length;a++)this.getChildByName("Text_"+a).ignoreContentAdaptWithSize(!0);this.setMinBet(this._minBet)},reset:function(){this.setSelectXu(0)},setSelectXu:function(a){for(var b=0;b<this._listButton.length;b++)if(this._listButton[b].stopAllActions(),this._listButton[b].setEnabled(!0),this._listButton[b].setBright(!0),this._listButton[b].setScale(1),this._listButton[b].setPositionY(this._posYButton),
this.getChildByName("Text_"+b).setColor(cc.color("#FFFFFF")),this._listButton[b].getTag()===a){this._listButton[b].setEnabled(!1);this._listButton[b].setBright(!1);this._listButton[b].setScale(1.5);this._posXButton=this._listButton[b].getPositionX();var d=cc.sequence(cc.moveBy(.4,cc.p(0,10)),cc.moveBy(.4,cc.p(0,-10)));this._listButton[b].runAction(d.repeatForever())}this.getChildByTag(a);this.getChildByName("Text_"+a).setColor(cc.color("#DF4383"))},getSelectXuPosition:function(){var a=this.getPositionX(),
b=this.getPositionY();return cc.p(this._posXButton+a,this._posYButton+b)},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),cc.sys.isNative&&a[d].setContentSize(cc.size(60,50)),this._listButton.push(a[d]),this._posYButton=a[d].getPositionY())},setScaleButton:function(a){var b=42*a;a*=34;for(var d=this.getChildren(),e=d.length,f=0;f<e;f++)d[f]instanceof ccui.Button&&
d[f].setContentSize(cc.size(b,a))},onClickBtnFromCocostudio:function(a,b){var d=MGComboXuBet.TAG_CONVERT_VALUE[a.getTag()];if(0<=d&&void 0!==d){this.setSelectXu(d);var e={};e.value=d;e.sender=a;cc.eventManager.dispatchCustomEvent(MGComboXuBet.ON_CLICK,e)}}});MGComboXuBet.ON_CLICK="ON_CLICK_COMBO_XU_BET";MGComboXuBet.TAG_CONVERT_VALUE={0:0,1:1,2:2,3:3,4:4};
var CompoChiaBai=ccui.Layout.extend({cardsPool:null,cardWidth:null,cardHeight:null,beginPos:null,delay:.1,_maxCardLen:0,_numUser:0,isDearling:!1,timeOutDearCard:null,listCardsDearling:null,ctor:function(){ccui.Layout.prototype.ctor.call(this);this.cardsPool=[]},initObj:function(a,b,d,e){this.cardWidth=a;this.cardHeight=b;this.beginPos=d;this.delay=e;this.listCardsDearling=[]},_getCard:function(){var a=this.cardsPool.pop();a||(a=new cc.Sprite(ResourceManager.MGResourcesCombo.card52),a.retain());a.setScaleX(a.width/
this.cardWidth);a.setScaleY(a.height/this.cardHeight);a.setPosition(this.beginPos);return a},_returnCard:function(a){this.cardsPool.push(a)},playEffect:function(a,b,d){this.isDearling=!0;this._numUser=a.length;var e,f,g,h=0,k=0;for(e=0;e<this._numUser;e++)h+=b[e].length,b[e].length>this._maxCardLen&&(this._maxCardLen=b[e].length);if(cc.sys.isNative)for(e=0;e<this._maxCardLen;e++)for(f=0;f<this._numUser;f++)b[f][e]&&(k++,g=this._getCard(),this.addChild(g),g.setPosition,g.runAction(cc.sequence(cc.delayTime(this.delay*
e),cc.moveTo(d,a[f]),cc.removeSelf())));else for(e=0;e<this._maxCardLen;e++)for(f=0;f<this._numUser;f++)b[f][e]&&(k++,g=this._getCard(),this.addChild(g),g.setPosition,k==h?g.runAction(cc.sequence(cc.delayTime(this.delay*e),cc.moveTo(d,a[f]),cc.callFunc(this.callBackOpenCard.bind(this,g,b[f][e])),cc.callFunc(this.callBackFinishRand.bind(this)),cc.removeSelf())):g.runAction(cc.sequence(cc.delayTime(this.delay*e),cc.moveTo(d,a[f]),cc.callFunc(this.callBackOpenCard.bind(this,g,b[f][e])),cc.removeSelf())));
this.timeOutDearCard&&clearTimeout(this.timeOutDearCard);this.timeOutDearCard=setTimeout(this._onTimeOutDearCard.bind(this),this.delay*this._maxCardLen*1E3+100)},playEffectStepByStep:function(a,b,d){this.listCardsDearling.length=0;this._numUser=a.length;var e=[],f=b[0].length,g=0,h=0;for(g;g<f;g++)for(h=0;h<this._numUser;h++)e.push(b[h][g]);b=e.length;f=0;for(h=b-1;f<h;)g=this._getCard(),this.addChild(g),this.listCardsDearling.push(g),g.runAction(cc.sequence(cc.delayTime(this.delay*f),cc.moveTo(d,
a[f%this._numUser]),cc.callFunc(this.callBackOpenCard.bind(this,g,e[f])))),f++;g=this._getCard();this.addChild(g);this.listCardsDearling.push(g);g.runAction(cc.sequence(cc.delayTime(this.delay*h),cc.moveTo(d,a[h%this._numUser]),cc.callFunc(this.callBackOpenCard.bind(this,g,e[h])),cc.callFunc(this.callBackFinishRand.bind(this))));this.isDearling=!0;this.timeOutDearCard&&clearTimeout(this.timeOutDearCard);a=Math.floor(this.delay*b*1E3+100);a+=Math.floor(d*b*1E3);this.timeOutDearCard=setTimeout(this._onTimeOutDearCard.bind(this),
a)},callBackOpenCard:function(a,b){a.removeFromParent(!0);this._returnCard(a);cc.eventManager.dispatchCustomEvent(CompoChiaBai.EVENT.OPEN_CARD,b)},callBackFinishRand:function(){this.isDearling&&(this.timeOutDearCard&&clearTimeout(this.timeOutDearCard),cc.eventManager.dispatchCustomEvent(CompoChiaBai.EVENT.FINISH),this.isDearling=!1)},_onTimeOutDearCard:function(){this.stopDearCard();this.callBackFinishRand()},stopDearCard:function(){var a=0,b=this.listCardsDearling.length;for(a;a<b;a++)this.listCardsDearling[a].stopAllActions(),
this.listCardsDearling[a].removeFromParent(!0),this._returnCard(this.listCardsDearling[a]);this.listCardsDearling.length=0}});CompoChiaBai.EVENT={};CompoChiaBai.EVENT.OPEN_CARD="CompoChiaBaiOpenCard";CompoChiaBai.EVENT.FINISH="CompoChiaBaiFinishRand";
var MGCompoGameInfo=MGBaseNode.extend({_gameInfo:null,_minBetInfo:null,_matchIdInfo:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._initFromCocostudio(ResourceManager.MGResourcesCombo.UINodeCompoGameInfo,PreLoaderConfig.PathToResourceDefault);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initUI()},_initUI:function(){this._gameInfo=this._mainLayer.getChildByName("MGGameName");this._gameInfo.ignoreContentAdaptWithSize(!0);this._minBetInfo=this._mainLayer.getChildByName("MGMinBetInfo");
this._minBetInfo.ignoreContentAdaptWithSize(!0);this._matchIdInfo=this._mainLayer.getChildByName("MGMatchID");this._matchIdInfo.ignoreContentAdaptWithSize(!0)},setInfo:function(a,b,d,e){this.setGameNameInfo(a,b);this.setMinBetInfo(d);this.setMatchIdInfo(e);this.setVisible(!0)},setGameNameInfo:function(a,b){b&&void 0!==b?this._gameInfo.setString(a+" "+b):this._gameInfo.setString(a)},setMinBetInfo:function(a){this._minBetInfo.setString("Min : "+Utilities.Coin(a)+" Xu")},setMatchIdInfo:function(a){this._matchIdInfo.setString("#"+
a)}}),MGCompUserInfoPlay=MGBaseNode.extend({alignPos:null,clickObject:null,emptyData:null,infoData:null,userInfoData:null,_userGold:null,_userName:null,_userAvatar:null,_mask:null,_avatar:null,_circleAvatar:null,funClickCall:null,_isHaveData:!1,_userPlayId:null,effectWinLoseTaiXiu:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesCombo.UINodeCompoUserInfo,PreLoaderConfig.PathToResourceDefault).node);this.alignPos=[{x:0,y:65},{x:0,y:-65},
{x:-53,y:0},{x:53,y:0}];this.anchorPointPos=[{x:.5,y:.5},{x:.5,y:.5},{x:1,y:.5},{x:0,y:.5}];this._userPlayId=0;this.initObj()},_initUI:function(){this.clickObject=this.getChildByName("MGCompClick");this.emptyData=this.clickObject.getChildByName("MGCompEmpty");this.infoData=this.clickObject.getChildByName("MGCompData");this.userInfoData=this.infoData.getChildByName("MGCompUserInfoData");this._userGold=this.userInfoData.getChildByName("MGCompUserGold");this._userGold.ignoreContentAdaptWithSize(!0);
this._userName=this.userInfoData.getChildByName("MGCompUserName");this._userName.ignoreContentAdaptWithSize(!0);this.borderAvatar=this.infoData.getChildByName("MGCompUserBorder");this.borderAvatar.setLocalZOrder(MGCompUserInfoPlay.Z_LOCAL.Border_Avatar);this._userAvatar=this.infoData.getChildByName("MGCompUserAvatar");this._mask=new MGBaseImageView;this._mask.setPosition(this._userAvatar.getPosition());this._userAvatar.setPosition(cc.p(0,0));this._userAvatar.removeFromParent();this.infoData.addChild(this._mask,
MGCompUserInfoPlay.Z_LOCAL.Avatar)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initUI();this._initEventsGame();this._initSpine();this.stopActionEffect();this.setAlignInfo(MGCompUserInfoPlay.TopAlign);this.setStateUser(!1)},_initSpine:function(){this._circleAvatar=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.UICircleSpineJson,ResourceManager.MGResourcesCombo.UICircleSpineAtlas);this.infoData.addChild(this._circleAvatar,MGCompUserInfoPlay.Z_LOCAL.Circle)},_initEventsGame:function(){this.clickObject.addClickEventListener(this._onClick.bind(this))},
_onClick:function(a){null!==this.funClickCall&&void 0!==this.funClickCall&&this.funClickCall(this)},setDispose:function(){this.clickObject._clickEventListener&&cc.eventManager.removeListener(this.clickObject._clickEventListener)},runActionEffect:function(a){a&&void 0!==a&&0<a&&this._circleAvatar.setTimeScale(1.6667/a);this._circleAvatar.setVisible(!0);this._circleAvatar.setAnimation(0,"animation",!1)},stopActionEffect:function(){this._circleAvatar.setVisible(!1)},setClickEvent:function(a){this.funClickCall=
a},setStateUser:function(a){this._isHaveData=a;this.infoData.setVisible(a);this.emptyData.setVisible(!a)},getStateUser:function(){return this._isHaveData},setUserInfoData:function(a,b,d,e){this.setUserPlayId(a);this.setUserName(b);this.setUserGold(d);this.setUserAvatar(e);this.setStateUser(!0)},removeUserInfoData:function(){this.setUserPlayId("");this.setUserName("");this.setUserGold("");this.setStateUser(!1)},getUserPlayId:function(){return this._userPlayId},setUserPlayId:function(a){this._userPlayId=
a;a===MGGameInfo.myInfo.UserID?this._userName.setTextColor(cc.color(247,255,0)):this._userName.setTextColor(cc.color(255,255,255))},getUserGold:function(){return this._userGold.getString()},setUserGold:function(a){this._userGold.setString(Utilities.Coin(a))},getUserName:function(){return this._userName.getString()},setUserName:function(a){this._userName.setString(a)},setUserAvatar:function(a){this._mask.loadTexture("ImageAvatar_"+a+".png",ccui.Widget.PLIST_TEXTURE)},setAlignInfo:function(a){0<=a&&
4>a&&(this.userInfoData.setPosition(this.alignPos[a]),this._userName.setAnchorPoint(this.anchorPointPos[a]),this._userGold.setAnchorPoint(this.anchorPointPos[a]))},showEffectGoldWinLose:function(a){if(0!==a){var b=new ccui.Text;b.setFontSize(MGCompUserInfoPlay.FONT_WINLOSE_SIZE);b.setFontName(MGCompUserInfoPlay.TEXT_WINLOSE_FONT);b.setString(Utilities.Coin(a));b.setPosition(0,this._userGold.getPosition().y);0<a?b.setTextColor(MGCompUserInfoPlay.TEXT_WIN_COLOR):0>a&&b.setTextColor(MGCompUserInfoPlay.TEXT_LOSE_COLOR);
this._effectTextAction(b);this.userInfoData.addChild(b,MGCompUserInfoPlay.Z_LOCAL.Text_Effect)}},_effectTextAction:function(a){a.runAction(cc.sequence(cc.spawn(cc.moveTo(1,a.getPosition().x,a.getPosition().y+MGCompUserInfoPlay.TEXT_WINLOSE_DESTINATION_Y),cc.fadeOut(1.5)),cc.callFunc(function(){a.removeFromParent(!0)})))}});MGCompUserInfoPlay.TEXT_WINLOSE_FONT="Roboto-Regular";MGCompUserInfoPlay.TEXT_WINLOSE_POS=cc.p(640,420);MGCompUserInfoPlay.TEXT_WINLOSE_DESTINATION_Y=30;
MGCompUserInfoPlay.FONT_WINLOSE_SIZE=17;MGCompUserInfoPlay.TEXT_WIN_COLOR=cc.color(255,210,0,255);MGCompUserInfoPlay.TEXT_LOSE_COLOR=cc.color(253,67,131,255);MGCompUserInfoPlay.TopAlign=0;MGCompUserInfoPlay.BottomAlign=1;MGCompUserInfoPlay.LeftAlign=2;MGCompUserInfoPlay.RightAlign=3;MGCompUserInfoPlay.Z_LOCAL={Text_Effect:12,Border_Avatar:11,Avatar:10,Circle:9};
ResourceManager.MGResourcesCombo={card52:"res/game/Cards/mat-sau.png",UINodeButtonDatCuocCombo:"res/game/Components/UINodeDatCuocComboButton.json",UINodeXuBetCombo:"res/game/Components/UINodeXuComboButton.json",UIBroadCast:"res/game/Components/UINodeBroadCast.json",UICircleSpineAtlas:"res/game/Components/Spines/CircleSpine/loading.atlas",UICircleSpineJson:"res/game/Components/Spines/CircleSpine/loading.json",UICircleSpinePng:"res/game/Components/Spines/CircleSpine/loading.png",AtlasCompoUserInfoPlay_plist:"res/game/Components/AtlasCompoUserInfoPlay/AtlasCompoUserInfoPlay.plist",
AtlasCompoUserInfoPlay_texture:"res/game/Components/AtlasCompoUserInfoPlay/AtlasCompoUserInfoPlay.png",UINodeCompoUserInfo:"res/game/Components/UINodeCompoUserInfo.json",UINodeCompoGameInfo:"res/game/Components/UINodeCompoGameInfo.json",CCSUIListMiniGameNode:"res/game/Components/UINodeListMiniGame.json",CCSUIListTopNoHuNode:"res/game/Components/UINodeTopNoHu.json",UIGiftCodeButton:"res/game/Components/UINodeGiftCode.json",FontWinXeng_fnt:"res/Fonts/Number.fnt",FontWinXeng_png:"res/Fonts/Number.png",
EffectWinXeng_json:"res/game/Components/EffectThangThua/EffectThangXeng/Xeng_FX.json",EffectWinXeng_atlas:"res/game/Components/EffectThangThua/EffectThangXeng/Xeng_FX.atlas",EffectWinXeng_png:"res/game/Components/EffectThangThua/EffectThangXeng/Xeng_FX.png",EffectSpecialXeng_json:"res/game/Components/EffectThangThua/EffectThangXeng/hu_xeng.json",EffectSpecialXeng_atlas:"res/game/Components/EffectThangThua/EffectThangXeng/hu_xeng.atlas",EffectSpecialXeng1_png:"res/game/Components/EffectThangThua/EffectThangXeng/hu_xeng.png",
EffectSpecialXeng2_png:"res/game/Components/EffectThangThua/EffectThangXeng/hu_xeng2.png",EffectBigWin_json:"res/Effects/big_win.json",EffectBigWin_atlas:"res/Effects/big_win.atlas",EffectBigWin_png:"res/Effects/big_win.png",EffectBonus_json:"res/Effects/NoHu_FX.json",EffectBonus_atlas:"res/Effects/NoHu_FX.atlas",EffectBonus_png:"res/Effects/NoHu_FX.png",EffectWinMiniGame_json:"res/game/Components/EffectThangThua/EffectThangMiniGame/cao_thap.json",EffectWinMiniGame_atlas:"res/game/Components/EffectThangThua/EffectThangMiniGame/cao_thap.atlas",
EffectWinMiniGame_png:"res/game/Components/EffectThangThua/EffectThangMiniGame/cao_thap.png",EffectIconTopNH_json:"res/game/Components/EffectBtnTopNoHu/icon_hu.json",EffectIconTopNH_atlas:"res/game/Components/EffectBtnTopNoHu/icon_hu.atlas",EffectIconTopNH_png:"res/game/Components/EffectBtnTopNoHu/icon_hu.png",PlistEffectReel:"res/game/Components/EffectReel/CompoEffectReel.plist",PNGEffectReel:"res/game/Components/EffectReel/CompoEffectReel.png",PlistEffectItem:"res/game/Components/EffectItems/CompoEffectItem.plist",
PNGEffectItem:"res/game/Components/EffectItems/CompoEffectItem.png",SoundWinBonus:"res/game/Components/Sounds/TrungBonus.mp3",SoundWinScatter:"res/game/Components/Sounds/TrungFreeSpin.mp3"};var resourceComponents=[],i;for(i in ResourceManager.MGResourcesCombo)ResourceManager.MGResourcesCombo[i]=""+cc.loader.resPath+ResourceManager.MGResourcesCombo[i],resourceComponents.push(ResourceManager.MGResourcesCombo[i]);
var MGBaseCard=MGBaseSprite.extend({_idCard:0,_listener:null,_isSelected:!1,_isMove:!1,_spriteLock:null,_eventEnable:!1,callBackOnClick:null,listSelectedCards:null,ctor:function(){MGBaseSprite.prototype.ctor.call(this);this._initEventsGame()},initObj:function(a,b,d){this.setSpriteFrame("card"+a+".png");this.setName("MGCard"+a+".png");this._idCard=b;this.listSelectedCards=d},resetCard:function(){this._isMove=this._isSelected=!1;null!=this._spriteLock&&this._spriteLock.setVisible(!1);this._eventEnable=
!1;this.setRotation(0);this.setScale(1,1);this.setColor(cc.color(255,255,255,255));this.setLocalZOrder(0)},setLock:function(){null==this._spriteLock&&(this._spriteLock=new cc.Sprite,this._spriteLock.setSpriteFrame("Stoke.png"),this._spriteLock.setPosition(cc.p(this._spriteLock.getContentSize().width/2-2,this._spriteLock.getContentSize().height/2-2)),this.addChild(this._spriteLock));this._spriteLock.setVisible(!0)},moveUpDown:function(){if(this._eventEnable&&0==this._isMove){if(0==this._isSelected){this._isMove=
!0;this.listSelectedCards.push(this._idCard);this.setPositionY(0);var a=cc.sequence(cc.moveBy(.1,cc.p(0,MGBaseCard.DISTANCE_UP)),cc.callFunc(function(){this._isSelected=!0;this._isMove=!1}.bind(this)))}else this._isMove=!0,this._removeCard(this._idCard),a=cc.sequence(cc.moveTo(.1,cc.p(this.getPositionX(),0)),cc.callFunc(function(){this._isMove=this._isSelected=!1}.bind(this)));this.runAction(a)}},_removeCard:function(a){0<this.listSelectedCards.length&&(a=this.listSelectedCards.indexOf(a),this.listSelectedCards.splice(a,
1))},setEventEnable:function(a){this._eventEnable=a}});MGBaseCard.DISTANCE_UP=40;
var MGCompoBroadcast=MGBaseNode.extend({txtMess:null,txtAction:null,panelText:null,speedText:null,moveTime:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesCombo.UIBroadCast,PreLoaderConfig.PathToResourceDefault).node);this.initTextBroadCast();this._initEventsGame()},initTextBroadCast:function(){this.panelText=this.getChildByName("PanelBroadCast");this.panelText.setPosition(cc.p(180,
630));this.txtMess=this.panelText.getChildByName("TextBroadCast");this.txtMess.ignoreContentAdaptWithSize(!0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_BROADCAST.toString(),this._systemBroadcast.bind(this)))},_systemBroadcast:function(a){a=a.getUserData();var b={Msg:BinaryConstants.DataTypeID.StringDynamic};a=(new BinaryParser).initObj(b,a.content);this.showBroadcast(a)},showBroadcast:function(a){this.txtMess.stopAllActions();
this.txtMess.setString(a.Msg);this.txtMess.setAnchorPoint(cc.p(1,.5));this.txtMess.setPosition(cc.p(this.txtMess.width+920,18.5));this.speedText=100;this.moveTime=(this.txtMess.width+920)/this.speedText;this.txtAction=cc.moveTo(this.moveTime,cc.p(-this.txtMess.width,18.5));this.txtMess.runAction(this.txtAction)},hide:function(){this.setVisible(!1)}});MGCompoBroadcast.POSITION={x:0,y:0};
var MGComboEffectWinCoinXeng=MGBaseNode.extend({effectWin1:null,effectWin2:null,textWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.effectWin1=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectWinXeng_json,ResourceManager.MGResourcesCombo.EffectWinXeng_atlas);this.effectWin1.setVisible(!1);this.addChild(this.effectWin1);this.effectWin2=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectWinXeng_json,
ResourceManager.MGResourcesCombo.EffectWinXeng_atlas);this.effectWin2.setVisible(!1);this.addChild(this.effectWin2);this.textWin=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesCombo.FontWinXeng_fnt);this.textWin.setVisible(!1);this.addChild(this.textWin)},setProties:function(a,b,d){this.setPositionText(a);this.setScaleEffect(b);this.setPositionAni(d)},setPositionText:function(a){this.textWin.setPositionY(this.textWin.getPositionY()-a)},setScaleEffect:function(a){this.effectWin1.setScale(a);
this.effectWin2.setScale(a)},setPositionAni:function(a){this.effectWin1.setPositionX(this.effectWin1.getPositionX()-a);this.effectWin2.setPositionX(this.effectWin2.getPositionX()+a)},playAnimationWin:function(a){this.effectWin1.setVisible(!0);this.effectWin1.setAnimation(0,"Win",!0);this.effectWin2.setVisible(!0);this.effectWin2.setAnimation(0,"Win",!0);this.textWin.setString(Utilities.Coin(a));this.textWin.setVisible(!0);this.textWin.runAction(cc.sequence(cc.scaleTo(.2,1.2,1.2),cc.scaleTo(.2,1,1)).repeatForever())},
stopAnimationWin:function(){this.effectWin1.setVisible(!1);this.effectWin2.setVisible(!1);this.textWin.setVisible(!1);this.textWin.stopAllActions()}}),MGComboEffectSpecialXeng=MGBaseNode.extend({comboEffect:null,bigWin:null,bonusBox:null,textCoinWin:null,backGround:null,callBackSuccess:null,timeOutHideEffect:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initBackGround();this.comboEffect=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectSpecialXeng_json,
ResourceManager.MGResourcesCombo.EffectSpecialXeng_atlas);this.comboEffect.setVisible(!1);this.addChild(this.comboEffect,1)},initBigWinBonus:function(){this.textCoinWin=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesCombo.FontWinXeng_fnt);this.textCoinWin.setVisible(!1);this.addChild(this.textCoinWin,1);Utilities.showLog(this.textCoinWin.getPositionY());this.bigWin=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectBigWin_json,ResourceManager.MGResourcesCombo.EffectBigWin_atlas);
this.bigWin.setVisible(!1);this.addChild(this.bigWin,1);this.bonusBox=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectBonus_json,ResourceManager.MGResourcesCombo.EffectBonus_atlas);this.bonusBox.setVisible(!1);this.addChild(this.bonusBox,1)},setCallBackSuccess:function(a){this.callBackSuccess=a},setPosYCombo:function(a,b,d){this.bigWin.setPosition(0,a);this.bonusBox.setPosition(0,-b);this.textCoinWin.setPosition(0,-d)},initBackGround:function(){this.backGround=new ccui.Layout;this.backGround.setContentSize(cc.size(cc.winSize.width+
100,cc.winSize.height+300));this.backGround.setPosition(cc.p(-((cc.winSize.width-1280)/2),720));this.backGround.setAnchorPoint(0,1);this.backGround.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);this.backGround.setBackGroundColor(cc.color(0,0,0));this.backGround.setBackGroundColorOpacity(200);this.backGround.setTouchEnabled(!0);this.addChild(this.backGround,0);this.backGround.setVisible(!1)},playEffectWinScatter:function(a){mg.audio.playEffect(ResourceManager.MGResourcesCombo.SoundWinScatter,
MGGameInfo.gameVolume);this.backGround.setVisible(!0);this.comboEffect.setPosition(cc.p(640,a));this.comboEffect.setVisible(!0);this.comboEffect.setAnimation(0,"scatter",!1);this.timeOutHideEffect=setTimeout(this.stopEffectWinSpecial.bind(this),2E3)},playEffectWinBonus:function(a){mg.audio.playEffect(ResourceManager.MGResourcesCombo.SoundWinBonus,MGGameInfo.gameVolume);this.backGround.setVisible(!0);this.comboEffect.setPosition(cc.p(640,a));this.comboEffect.setVisible(!0);this.comboEffect.setAnimation(0,
"bonus",!1);this.timeOutHideEffect=setTimeout(this.stopEffectWinSpecial.bind(this),2E3)},playEffectBigWin:function(a){this.bigWin.setVisible(!0);this.bigWin.setAnimation(0,"animation",!1);this.textCoinWin.setVisible(!0);this.textCoinWin.setString(Utilities.Coin(a));this.textCoinWin.runAction(cc.sequence(cc.scaleTo(.2,1.5),cc.scaleTo(.2,1)).repeat(5));this.timeOutHideEffect=setTimeout(this.stopEffectBigWinBonus.bind(this),2E3)},playEffectBonus:function(a){this.bonusBox.setVisible(!0);this.bonusBox.setAnimation(0,
"animation",!1);this.textCoinWin.setVisible(!0);this.textCoinWin.setString(Utilities.Coin(a));this.textCoinWin.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,.8)).repeatForever());this.timeOutHideEffect=setTimeout(this.stopEffectBigWinBonus.bind(this),2E3)},stopEffectWinSpecial:function(){"function"===typeof this.callBackSuccess&&this.callBackSuccess();this.backGround.setVisible(!1);this.comboEffect.setVisible(!1)},stopEffectBigWinBonus:function(){this.textCoinWin.stopAllActions();this.textCoinWin.setScale(1,
1);this.textCoinWin.setVisible(!1);this.bigWin.setVisible(!1);this.bonusBox.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.timeOutHideEffect&&clearTimeout(this.timeOutHideEffect)}}),MGCompoEffectMiniGame=MGBaseNode.extend({textWin:null,comboEffect:null,timeOutHideEffect:null,coin:null,countCoin:null,haveBonus:!1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.comboEffect=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectWinMiniGame_json,
ResourceManager.MGResourcesCombo.EffectWinMiniGame_atlas);this.comboEffect.setVisible(!1);this.addChild(this.comboEffect);this.textWin=new cc.LabelTTF("100000000000000","tahomabd",45);this.textWin.enableStroke(cc.color(0,191,255),2);this.textWin.setPosition(0,-105);this.textWin.setVisible(!1);this.addChild(this.textWin)},playBigWinMiniGame:function(a){0==this.haveBonus&&(this.textWin.setVisible(!0),this.textWin.setString("0"),this.countCoin=this.coin=parseInt(a/50),this.textWin.runAction(cc.sequence(cc.scaleTo(0,
0,0),cc.delayTime(1),cc.scaleTo(.3,1,1),cc.sequence(cc.callFunc(this.addEffectText.bind(this)),cc.delayTime(.01)).repeat(50),cc.callFunc(this.setTextWin.bind(this,a)))),this.comboEffect.setVisible(!0),this.comboEffect.setAnimation(0,"thanglon",!1),this.timeOutHideEffect=setTimeout(this.hideEffect.bind(this),3E3))},playBonusMiniGame:function(a){this.haveBonus=!0;this.textWin.setVisible(!0);this.textWin.setString("0");this.countCoin=this.coin=parseInt(a/50);this.textWin.runAction(cc.sequence(cc.scaleTo(0,
0,0),cc.delayTime(1),cc.scaleTo(.3,1,1),cc.sequence(cc.callFunc(this.addEffectText.bind(this)),cc.delayTime(.01)).repeat(50),cc.callFunc(this.setTextWin.bind(this,a))));this.comboEffect.setVisible(!0);this.comboEffect.setAnimation(0,"jackpot",!1);this.timeOutHideEffect=setTimeout(this.hideEffect.bind(this),3E3)},addEffectText:function(){this.setTextWin(this.coin);this.coin+=this.countCoin},setTextWin:function(a){this.textWin.setString(Utilities.Coin(a))},hideEffect:function(){this.haveBonus=!1;this.textWin.stopAllActions();
this.textWin.setVisible(!1);this.comboEffect.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.bind(this);this.timeOutHideEffect&&clearTimeout(this.timeOutHideEffect)}}),MGMoveablePopup=MGBaseNode.extend({_mainMoveable:null,_marginTop:0,_marginBottom:0,_marginLeft:0,_marginRight:0,_nodePos:null,_originPos:null,_gap:null,_move:!1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.setOriginPosision(this.getPosition().x,
this.getPosition().y)},setOriginPosision:function(a,b){this._originPos=cc.p(a,b)},setMoveInfo:function(a,b,d,e,f,g){this._mainMoveable=a;this._marginTop=void 0!==b?b:0;this._marginBottom=void 0!==d?d:0;this._marginLeft=void 0!==e?e:0;this._marginRight=void 0!==f?f:0;this._nodePos=this._mainMoveable.getPosition();this._mainMoveable.addTouchEventListener(this.onTouchGameFromCocostudio.bind(this),this);this._mainMoveable.setTouchEnabled(!0);this._mainMoveable.setSwallowTouches(void 0===g?!0:g)},addMoveElement:function(a,
b){a.addTouchEventListener(this.onTouchGameFromCocostudio.bind(this),this);a.setTouchEnabled(!0);a.setSwallowTouches(void 0===b?!0:b)},hide:function(){this.setVisible(!1);this.setPosition(this._originPos)},onTouchGameFromCocostudio:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this._move=!1;var d=this.getParent().convertToNodeSpace(a.getTouchBeganPosition());this._gap=cc.p(this.getPosition().x+.5*cc.winSize.width-d.x,this.getPosition().y+.5*cc.winSize.height-d.y);break;case ccui.Widget.TOUCH_MOVED:this._move=
!0;this.moveGameLayout(a);break;case ccui.Widget.TOUCH_ENDED:this.updatePosisionAfterMoved(a);break;case ccui.Widget.TOUCH_CANCELED:this.updatePosisionAfterMoved(a)}this.moveablePopupTouchBegan(a,b)},moveGameLayout:function(a){a=this.getParent().convertToNodeSpace(a.getTouchMovePosition());this.setPosition(a.x-.5*cc.winSize.width+this._gap.x,a.y-.5*cc.winSize.height+this._gap.y)},updatePosisionAfterMoved:function(a){if(this._move||void 0===a){this._move=!1;var b=this._mainMoveable,d=this.convertToWorldSpace(b.getPosition());
a=d.y;var d=d.x,e=cc.winSize.height-.5*b.getContentSize().height-this._marginTop,f=.5*b.getContentSize().height+this._marginBottom,g=cc.winSize.width-.5*b.getContentSize().width-this._marginRight,b=.5*b.getContentSize().width+this._marginLeft;a>e?a=e:a<f&&(a=f);d>g?d=g:d<b&&(d=b);a=this.getParent().convertToNodeSpace(cc.p(d,a));a.x-=this._nodePos.x;a.y-=this._nodePos.y;this.runAction(cc.moveTo(.1,a))}},moveablePopupTouchBegan:function(a,b){}}),MGCompoListMiniGame=MGMoveablePopup.extend({containListGame:null,
timeBeginTouch:null,timeEndTouch:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesCombo.CCSUIListMiniGameNode,PreLoaderConfig.PathToResourceDefault);this.containListGame=this._mainLayer.getChildByName("MGContainListGame");this._resetHide();this.setMoveInfo(this._mainLayer.getChildByName("MGBtnMiniGame"),8,8,8,8);this._initEventsGame();this.setPosition(cc.p(100,500));this.setOriginPosision(cc.p(this.getPosition().x,
this.getPosition().y));this.actionMiniGame()},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGCompoListMiniGame.EVENTS.UPDATE_LIST,this.createListGame.bind(this)))},onClickGameIcon:function(a,b){if(""!=MGGameInfo.token4web&&MGGameInfo.token4web&&void 0!==MGGameInfo.token4web){if(a.gameInfo&&a.gameInfo.GameType==MGNodeMenuGames.GAME_TYPE.WEB_GAME){var d={};d.GameID=a.gameID;d.GameModuleID=0;d.GameType=a.gameInfo.GameType;
cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOAD_GAME,d)}else MGGameInfo.MGMain.netSend.sendGetListRooms(a.gameID);this.showListGame()}else d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_DO_NOT_LOGIN,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)},createListGame:function(a){a=a.getUserData()[MGCompoListMiniGame.DATA.LIST];var b=0,d=a.length,e;for(b;b<d;b++)e=new ccui.ImageView,
e.gameID=a[b].GameID,e.gameInfo=a[b],e.loadTexture(ResourceManager.MGResourcesMenuGame["GameIcon"+a[b].GameID],ccui.Widget.LOCAL_TEXTURE),e.setTouchEnabled(!0),e.addClickEventListener(this.onClickGameIcon.bind(this)),this.containListGame.getChildByName("MGGameItem"+b).addChild(e)},showListGame:function(){this.containListGame.isVisible()?(this._resetShow(),this.containListGame.runAction(cc.spawn(cc.rotateTo(.3,-180),cc.sequence(cc.scaleTo(.3,.1),cc.callFunc(this._resetHide.bind(this)))))):(this._resetHide(),
this.containListGame.setVisible(!0),this.containListGame.runAction(cc.spawn(cc.rotateTo(.3,0),cc.scaleTo(.3,1))))},hideListGame:function(){},_resetShow:function(){this.containListGame.stopAllActions();this.containListGame.setRotation(0);this.containListGame.setScale(1);this.containListGame.setVisible(!0)},_resetHide:function(){this.containListGame.stopAllActions();this.containListGame.setRotation(-180);this.containListGame.setScale(.1);this.containListGame.setVisible(!1)},moveablePopupTouchBegan:function(a,
b){switch(b){case ccui.Widget.TOUCH_BEGAN:this.timeBeginTouch=new Date;break;case ccui.Widget.TOUCH_ENDED:this.timeEndTouch=new Date,200>this.timeEndTouch-this.timeBeginTouch&&this.showListGame()}},actionMiniGame:function(){this._mainLayer.getChildByName("MGBtnMiniGame").getChildByName("MGCircleMiniGame").runAction(cc.sequence(cc.rotateBy(1,180)).repeatForever())}});MGCompoListMiniGame.EVENTS={UPDATE_LIST:"UpdateListMiniMame"};MGCompoListMiniGame.DATA={LIST:"list"};
var MGCompoGiftCode=MGMoveablePopup.extend({containListGame:null,timeBeginTouch:null,timeEndTouch:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesCombo.UIGiftCodeButton,PreLoaderConfig.PathToResourceDefault);this.setMoveInfo(this._mainLayer.getChildByName("Button_Gift"),8,8,8,8);this.setPosition(cc.p(100,500));this.setOriginPosision(cc.p(this.getPosition().x,this.getPosition().y))},
moveablePopupTouchBegan:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this.timeBeginTouch=new Date;break;case ccui.Widget.TOUCH_ENDED:if(this.timeEndTouch=new Date,200>this.timeEndTouch-this.timeBeginTouch)if(""!=MGGameInfo.token4web&&MGGameInfo.token4web&&void 0!==MGGameInfo.token4web)d={},cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_GIFT_CODE,d);else{var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_DO_NOT_LOGIN;
cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}}}}),MGCompoListTopNoHu=MGMoveablePopup.extend({timeBeginTouch:null,timeEndTouch:null,_gap:null,_move:!1,buttonTopNoHu:null,effectIcon:null,listView:null,isShow:!1,listviewContainer:null,lastPos:null,minHeightNotShow:null,isUpdateValueByTime:!1,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesCombo.CCSUIListTopNoHuNode,
PreLoaderConfig.PathToResourceDefault);this.listviewContainer=this._mainLayer.getChildByName("MGPanelClipping").getChildByName("NodeListView");this.buttonTopNoHu=this._mainLayer.getChildByName("ButtonTopNoHu");this.setMoveInfo(this.buttonTopNoHu,0,350,0,40);this.minHeightNotShow=this.buttonTopNoHu.getContentSize().height/2;this.listView=this.listviewContainer.getChildByName("MGGameListTopNoHu");this.listView.addEventListener(this.scrollview);this._initEventsGame();this.initIconButton();this.hideListView(!1)},
initIconButton:function(){this.effectIcon=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.EffectIconTopNH_json,ResourceManager.MGResourcesCombo.EffectIconTopNH_atlas);this.effectIcon.setVisible(!0);this.effectIcon.setAnimation(0,"animation",!0);this.effectIcon.setPosition(90,30);this.buttonTopNoHu.addChild(this.effectIcon)},scrollview:function(a,b){Utilities.showLog("scroll view type "+b)},addingDataToListview:function(a){for(var b=0;b<a.length;b++){var d=this.listviewContainer.getChildByName("CellTopNoHu").clone();
d.setVisible(!0);var e=this.getReourceByGameID(a[b].GameID);d.getChildByName("IconGame").loadTexture(e.Icon);d.getChildByName("GameName").setString(a[b].Description);d.getChildByName("GoldTop").setString(Utilities.Coin(a[b].AccumulateCoin));this.listView.insertCustomItem(d,b);0===b&&d.getChildByName("line_img").setVisible(!1)}this.listView.jumpToTop()},updateDataToListView:function(a){for(var b=0;b<this.listView.getItems().length;b++){var d=this.listView.getItems()[b];d.setVisible(!0);var e=this.getReourceByGameID(a[b].GameID);
d.getChildByName("IconGame").loadTexture(e.Icon);d.getChildByName("GameName").setString(a[b].Description);d.getChildByName("GoldTop").setString(Utilities.Coin(a[b].AccumulateCoin))}this.listView.jumpToTop()},getReourceByGameID:function(a){var b={Icon:"",Name:""};switch(a){case PreLoaderConfig.IDTaiXiu:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon1;break;case PreLoaderConfig.IDTLMN:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon2;break;case PreLoaderConfig.IDXocDia:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon3;
break;case PreLoaderConfig.IDSamLoc:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon5;break;case PreLoaderConfig.IDBinh:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon6;break;case PreLoaderConfig.IDPhom:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon7;break;case PreLoaderConfig.IDXito:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon8;break;case PreLoaderConfig.IDPoker:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon9;break;case PreLoaderConfig.IDLieng:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon10;
break;case PreLoaderConfig.IDSlotLuxury:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon13;break;case PreLoaderConfig.IDFruitKong:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon14;break;case PreLoaderConfig.IDDemCuu:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon15;break;case PreLoaderConfig.IDDiamonds777:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon16;break;case PreLoaderConfig.IDMiniTrenDuoi:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon17;break;case PreLoaderConfig.IDSlotBAPD:b.Icon=
ResourceManager.MGResourcesMenuGame.GameIcon18;break;case PreLoaderConfig.IDSlotVanPhuc:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon19;break;case PreLoaderConfig.IDSlotPanda:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon20;break;case PreLoaderConfig.IDSlotHoangCung:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon21;break;case PreLoaderConfig.IDSlotThamHiem:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon22;break;case PreLoaderConfig.IDSlotAladin:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon23;
break;case PreLoaderConfig.IDSlotAiCap:b.Icon=ResourceManager.MGResourcesMenuGame.GameIcon24}return b},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this.listviewContainer.getChildByName("BtnClose").setVisible(!1);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.TOP_JACKPOT.toString(),this.ngTopJackPot.bind(this)))},ngTopJackPot:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListInfo:b.Array8,ListInfo_Type:b.Object8,
ListInfo_Type_Struct:{GameID:b.UInt32,Description:b.StringDynamic,AccumulateCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngTopJactPot--"+JSON.stringify(a));this.listValueGame=a.ListInfo;this.isUpdateValueByTime||(this.isUpdateValueByTime=!0,this.unschedule(this.scheduleUpdateValueInListView),this.schedule(this.scheduleUpdateValueInListView,70));0<this.listView.getItems().length?this.updateDataToListView(a.ListInfo):this.addingDataToListview(a.ListInfo)},moveablePopupTouchBegan:function(a,
b){MGMoveablePopup.prototype.moveablePopupTouchBegan.call(this);switch(b){case ccui.Widget.TOUCH_ENDED:this.isButtonMove(this.lastPos,this.getPosition())||(this.isShow?this.hideListView(!1):this.showListView(!1)),this.lastPos=this.getPosition()}},updatePosisionAfterMoved:function(a){if(this._move){this._move=!1;var b=this._mainMoveable,d=this.convertToWorldSpace(b.getPosition());a=d.y;var d=d.x,e=cc.winSize.height-.5*b.getContentSize().height-this._marginTop,f=.5*b.getContentSize().height+this._marginBottom,
g=.5*b.getContentSize().height+this.minHeightNotShow,h=cc.winSize.width-.5*b.getContentSize().width-this._marginRight,b=.5*b.getContentSize().width+this._marginLeft;a>e?a=e:a<f&&this.isShow?a=f:a<g&&!this.isShow&&(a=g);d>h?d=h:d<b&&(d=b);a=this.getParent().convertToNodeSpace(cc.p(d,a));a.x-=this._nodePos.x;a.y-=this._nodePos.y;this.runAction(cc.moveTo(.1,a))}},hideListView:function(a){a?(this.listviewContainer.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,cc.p(120.44,349)),cc.fadeOut(.2)))),this.listView.runAction(cc.sequence(cc.fadeOut(.2),
cc.callFunc(function(){this.listView.setVisible(!1)}.bind(this))))):(this.listviewContainer.setOpacity(0),this.listView.setVisible(!1),this.listView.removeAllItems(),this.unschedule(this.scheduleUpdateValueInListView),this.isUpdateValueByTime=!1);this.isShow=!1},showListView:function(a){this.isShow=!0;a?(this.updateBottom(),this.listviewContainer.stopAllActions(),this.listviewContainer.setPosition(cc.p(120.44,349)),this.listviewContainer.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,cc.p(88.04,142.35)),
cc.fadeIn(.2)))),this.listView.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){this.listView.setVisible(!0)}.bind(this))))):this.isUserLogin()&&(this.listviewContainer.setOpacity(255),this.listView.setVisible(!0),this.listView.setOpacity(255),MGGameInfo.MGMain.netSend.sendGetTopJackpot())},isButtonMove:function(a,b){var d=Math.abs(a.y-b.y);return 10<Math.abs(a.x-b.x)||10<d?!0:!1},updateBottom:function(){this._move=this.isShow=!0;this.updatePosisionAfterMoved(null)},updatePosition:function(a){this.lastPos=
a},isUserLogin:function(){if(""==MGGameInfo.token4web||!MGGameInfo.token4web||void 0===MGGameInfo.token4web){var a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_DO_NOT_LOGIN;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a);return!1}return!0},scheduleUpdateValueInListView:function(){MGGameInfo.MGMain.netSend.sendGetTopJackpot()},setDispose:function(){MGMoveablePopup.prototype.setDispose.call(this);
this.unschedule(this.scheduleUpdateValueInListView)}}),MGLayerCompoButton=MGBaseNode.extend({compoListMiniGame:null,buttonGiftCode:null,compoListTopNoHu:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.initButtonMiniGame();this.initButtonTopNoHu()},checkAPIListEvents:function(){Utilities.checkEventGiftCode(this.onGetAPIListEvents.bind(this))},onGetAPIListEvents:function(a){if(1==a.result){var b=0,d=a.data.length;for(b;b<d;b++)"EventGiftCode"==a.data[b].code&&this.initButtonGiftCode()}},
initButtonMiniGame:function(){this.compoListMiniGame=new MGCompoListMiniGame;this.compoListMiniGame.initObj();cc.sys.isNative||cc.sys.isMobile?this.compoListMiniGame.setPosition(cc.p(1100,580)):this.compoListMiniGame.setPosition(cc.p((window.innerWidth-1280)/2+1100,window.innerHeight-720+580));this.addChild(this.compoListMiniGame)},initButtonGiftCode:function(){this.buttonGiftCode||(this.buttonGiftCode=new MGCompoGiftCode,this.buttonGiftCode.initObj(),cc.sys.isNative||cc.sys.isMobile?this.buttonGiftCode.setPosition(cc.p(1E3,
580)):this.buttonGiftCode.setPosition(cc.p((window.innerWidth-1280)/2+1E3,window.innerHeight-720+580)),this.buttonGiftCode.setPositionX(this.compoListMiniGame.getPositionX()-100),this.addChild(this.buttonGiftCode))},initButtonTopNoHu:function(){this.compoListTopNoHu=new MGCompoListTopNoHu;this.compoListTopNoHu.initObj();cc.sys.isNative||cc.sys.isMobile?this.compoListTopNoHu.setPosition(cc.p(200,500)):this.compoListTopNoHu.setPosition(cc.p((window.innerWidth-1280)/2+200,window.innerHeight-720+450));
this.compoListTopNoHu.updatePosition(this.compoListTopNoHu.getPosition());this.addChild(this.compoListTopNoHu)},onResize:function(){Utilities.showLog("MGLayerCompoButton onResize");this.compoListMiniGame&&this.compoListMiniGame.updatePosisionAfterMoved();this.compoListTopNoHu&&this.compoListTopNoHu.updatePosisionAfterMoved();this.buttonGiftCode&&this.buttonGiftCode.updatePosisionAfterMoved()}}),MGBaseSpriteEffect=MGBaseSprite.extend({_filename:null,_startFrameIdx:0,_numberSpriteFrame:1,_delay:.1,
_animate:null,_playanimation:!1,ctor:function(a,b,d,e){void 0!==b&&(this._startFrameIdx=b);void 0!==d&&(this._numberSpriteFrame=d);void 0!==e&&(this._delay=e);MGBaseSprite.prototype.ctor.call(this,"#"+a+this._startFrameIdx+".png");this._playanimation=!1;this.initObj(a)},initObj:function(a){for(var b=[],d="",e=this._startFrameIdx;e<this._startFrameIdx+this._numberSpriteFrame;e++){var d=a+e+".png",d=cc.spriteFrameCache.getSpriteFrame(d),f=new cc.AnimationFrame;f.initWithSpriteFrame(d,1,null);b.push(f)}a=
new cc.Animation(b,this._delay);this._animate=new cc.Animate(a);this._animate.retain();this.setVisible(!1)},playAnimation:function(a){if(!this._playanimation){var b=0;void 0!==a&&(b=a);0>=b?this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.setVisible(!0);this.runAction(cc.repeatForever(this._animate))}.bind(this)))):(this.runAction(cc.sequence(cc.fadeIn(.2),cc.repeat(this._animate,b),cc.fadeOut(.2),cc.callFunc(function(){this.stopAnimation(!1)}.bind(this)))),this.setVisible(!0));
this._playanimation=!0}},stopAnimation:function(a){this._playanimation=!1;this.stopAllActions();this.setVisible(a)},setDispose:function(){MGBaseSprite.prototype.setDispose.call(this);this._animate&&this._animate.release()}}),MGCompoEffectItem=MGBaseSpriteEffect.extend({ctor:function(a){MGBaseSpriteEffect.prototype.ctor.call(this,"FrameEffectItems",1,8,.1);this._setEffectProperties(a)},_setEffectProperties:function(a){void 0!==a&&this.setScale(a.width/this.getContentSize().width,a.height/this.getContentSize().height)}}),
MGCompoEffectReel=MGBaseSpriteEffect.extend({ctor:function(a){MGBaseSpriteEffect.prototype.ctor.call(this,"FrameEffectReel",1,10,.1);this._setEffectProperties(a)},_setEffectProperties:function(a){void 0!==a&&this.setScale(a.width/this.getContentSize().width,a.height/this.getContentSize().height)}}),MGCompoEffectNode=MGBaseNode.extend({_listEffectItems:null,_listEffectReels:null,_listAddTime:null,_listHaveEffectReel:null,_callbackOnPlayReel:null,_callbackOnHideReel:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);
this._listEffectItems=[];this._listEffectReels=[];this._listAddTime=[];this._listHaveEffectReel=[];this.initObj();this.initEvents()},initObj:function(){MGBaseNode.prototype.initObj.call(this)},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,this.playEffectReel.bind(this)))},addEffectItem:function(a,b){var d=new MGCompoEffectItem(a);d.setPosition(b);this.addChild(d);this._listEffectItems.push(d);return d},addEffectReel:function(a,
b){var d=new MGCompoEffectReel(a);d.setPosition(b);this.addChild(d);this._listEffectReels.push(d);return d},checkSameType:function(a,b){for(var d=0;d<b.length;d++)if(a==b[d])return d;return-1},checkOtherHave:function(a){for(var b=0;b<a.length;b++)if(!0===a[b])return!0;return!1},getMoreTimeEffect:function(a){return this._listAddTime[a]},addReelData:function(a,b,d){this._listAddTime=[0,0,0,0,0];this._listHaveEffectReel=[];b=a.length;for(var e=[],f=0;f<d.length;f++)e[f]=!1;for(f=0;f<b;f++)for(var g=
0;g<a[f].length;g++){var h=this.checkSameType(a[f][g],d);if(0<=h){if(3<=f&&!1===e[h])if(!1===this.checkOtherHave(e))break;else continue;this._listHaveEffectReel[f]=!0;for(g=f+1;g<b;g++)this._listAddTime[g]+=1;e[h]=!0;break}}},showEffectItem:function(a,b){this._listEffectItems[a].playAnimation(b)},showEffectReel:function(a,b){0<this._listHaveEffectReel.length&&this._listHaveEffectReel[a]&&(this._callbackOnPlayReel&&this._callbackOnPlayReel(a),this._listEffectReels[a].playAnimation(b),Utilities.showLog("playEffectReel "+
a))},hideEffectItem:function(a){this._listEffectItems[a].stopAnimation(!1)},hideEffectReel:function(a){this._listEffectReels[a].stopAnimation(!1)},hideAllEffectItem:function(){for(var a=0;a<this._listEffectItems.length;a++)this.hideEffectItem(a)},hideAllEffectReel:function(){for(var a=0;a<this._listEffectReels.length;a++)this.hideEffectReel(a);this._callbackOnHideReel&&this._callbackOnHideReel()},setCallbackOnHideEffectReel:function(a){this._callbackOnHideReel=a},hideAllEffect:function(){this.hideAllEffectItem();
this.hideAllEffectReel()},playEffectReel:function(a){a=a.getUserData();this.showEffectReel(a.Index)},setCallbackOnPlayEffectReel:function(a){this._callbackOnPlayReel=a},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this._listEffectItems;a++)this._listEffectItems[a]&&this._listEffectItems[a].setDispose();for(a=0;a<this._listEffectReels;a++)this._listEffectReels[a]&&this._listEffectReels[a].setDispose()}});MGCompoEffectNode.EVENT={FX_EFFECT_REEL:"fxCompoEffectNodeReel"};
Utilities.checkEventGiftCode=function(a){var b={};"function"===typeof a&&Utilities.getAPIBeforeLogin("event","getlisteventrunning",b,a)};ResourceManager.MGResourcesMainPopup={AtlasPopups_plist:"res/main/atlas/AtlasPopups/AtlasPopups.plist",AtlasPopups:"res/main/atlas/AtlasPopups/AtlasPopups.png",AtlasAvatar_plist:"res/main/atlas/AtlasAvatar/AtlasAvatar.plist",AtlasAvatar:"res/main/atlas/AtlasAvatar/AtlasAvatar.png",CompoMenu_plist:"res/main/atlas/CompoMenu/AtlasCompoMenu.plist",AtlasCompoMenu:"res/main/atlas/CompoMenu/AtlasCompoMenu.png",HDCGBinh:"res/game/Guide/HDCGBinh.png",HDCGPhom:"res/game/Guide/HDCGPhom.png",HDCGSam:"res/game/Guide/HDCGSam.png",
HDCGTaiXiu:"res/game/Guide/HDCGTaiXiu.png",HDCGTLMN:"res/game/Guide/HDCGTLMN.png",HDCGXocDia:"res/game/Guide/HDCGXocDia.png",HDCGXengLuxury:"res/game/Guide/HDCGXengLuxury.png",HDCGLieng:"res/game/Guide/HDCGLieng.png",HDCGXiTo:"res/game/Guide/HDCGXiTo.png",HDCGDiamond777:"res/game/Guide/HDCGDiamond777.png",HDCGFruitKong:"res/game/Guide/HDCGFruitKong.png",HDCGDemCuu:"res/game/Guide/HDGGDemCuu.png",HDCGDaoMo:"res/game/Guide/HDCGDaoMo.png",HDCGCaoThap:"res/game/Guide/HDCGCaoThap.png",HDCGVQMM:"res/game/Guide/HDCGVongQuayMayMan.png",
UIItemMailInfo:"res/main/UIItemMailInfo.json",UIItemMailContent:"res/main/UIItemMailContent.json",FontRoboto:"res/Fonts/RobotoMedium.ttf",UIMGLayerPopupMessage:"res/main/UILayerPopupMessage.json",UIMGLayerPopupRegit:"res/main/UILayerPopupRegit.json",UIMGLayerPopupLogin:"res/main/UILayerPopupLogin.json",UILayerPopupCreateName:"res/main/UILayerPopupCreateName.json",UIMGLayerPopupRules:"res/main/UILayerPopupRules.json",UIMGLayerPopupSecurity:"res/main/UILayerPopupSecurity.json",UIMGLayerPopupChangePassword:"res/main/UILayerPopupChangePassword.json",
UIMGLayerPopupHoTroKH:"res/main/UILayerPopupHoTroKH.json",UIMGLayerPopupPersonal:"res/main/UILayerPopupPersonal.json",UIMGNodePopupBangXepHang:"res/main/UINodePopupBXH.json",UIMGLayerPopupBangXepHang:"res/main/UILayerPopupBangXepHang.json",UIMGLayerPopupTaiUngDung:"res/main/UILayerPopupTaiUngDung.json",UIMGNodePopupTradeHistory:"res/main/UIItemHistoryTrade.json",UIMGNodePopupPageTradeHistory:"res/main/UIItemSelectPage.json",UIMGLayerPopupTradeHistory:"res/main/UILayerPopupTradeHistory.json",UIMGLayerPopupMail:"res/main/UILayerPopupMail.json",
UIMGNodePopupMailInfo:"res/main/UIItemMailInfo.json",UIMGNodePopupMailContent:"res/main/UIItemMailContent.json",UILayerGifCode:"res/main/UILayerGiftCode.json",MGListCardSelect:"res/main/MGListCardSelect.json",MGCardNapInfo:"res/main/MGCardNapInfo.json",MGCardDoiInfo:"res/main/MGCardDoiInfo.json",MGStoreListIcon:"res/main/MGStoreListIcon.json",MGStoreMuaCardDT:"res/main/MGStoreMuaCardDT.json",MGStoreNapCardDT:"res/main/MGStoreNapCardDT.json",MGStoreListIAP:"res/main/MGStoreListIAP.json",UIMGLayerPopupCuaHang:"res/main/UILayerPopupStore.json",
UIMGLayerPopupChangeAvatar:"res/main/UILayerPopupChangeAvatar.json",UIMGItemContentEvent:"res/main/UIItemEvent.json",UIMGLayerCardDT:"res/main/UILayerPopupChonCardDT.json"};var resourcesMainPopup=[];for(i in ResourceManager.MGResourcesMainPopup)ResourceManager.MGResourcesMainPopup[i]=""+cc.loader.resPath+ResourceManager.MGResourcesMainPopup[i],resourcesMainPopup.push(ResourceManager.MGResourcesMainPopup[i]);
Utilities.getEmails=function(a){var b={userid:MGGameInfo.myInfo.UserID,PageNum:1,PageSize:100};"function"===typeof a&&Utilities.getAPIAfterLogin("user","offline_message",b,a)};Utilities.getEmailDetails=function(a,b){var d={receiverId:MGGameInfo.myInfo.UserID,userid:MGGameInfo.myInfo.UserID,MessId:a};"function"===typeof b&&Utilities.getAPIAfterLogin("user","offline_message_detail",d,b)};
Utilities.getCaptcha=function(a){var b=PreLoaderConfig.apiPath,b=b+"captcha/captcha_user?",d={channel:MGGameInfo.apiInfo.channel,platform:MGGameInfo.apiInfo.platform,version:MGGameInfo.apiInfo.version,deviceId:MGGameInfo.apiInfo.deviceId,packageName:MGGameInfo.apiInfo.packageName,versionDevice:MGGameInfo.apiInfo.versionDevice,deviceModel:MGGameInfo.apiInfo.model,brand:MGGameInfo.apiInfo.brand,service:MGGameInfo.apiInfo.service,unix:Utilities.getTimeStamp()},e="",f;for(f in d)b+=f+"="+encodeURIComponent(d[f])+
"&",e+=d[f];d.sign=md5.encrypt(e+MGGameInfo.ApiKey);b+="sign="+d.sign;Utilities.showLog("Utilities.getCaptcha url"+b);"function"===typeof a&&cc.loader.loadImg(b,{isCrossOrigin:!0},a);return b};Utilities.registerUser=function(a,b,d,e,f){a={UserName:a,PassWord:Utilities.encrypt(d),DisplayName:b,CaptCha:e};"function"===typeof f&&Utilities.getAPIBeforeLogin("user","register",a,f)};
Utilities.login=function(a,b,d,e){a={UserName:a,PassWord:b,CaptCha:d};"function"===typeof e&&Utilities.getAPIBeforeLogin("user","login",a,e)};Utilities.changePassword=function(a,b,d,e){a={OldPassWord:Utilities.encrypt(a),NewPassWord:Utilities.encrypt(b),Captcha:d,userId:MGGameInfo.myInfo.UserID};"function"===typeof e&&Utilities.getAPIAfterLogin("user","change_password",a,e)};
Utilities.updateProfile=function(a,b,d){a={userId:MGGameInfo.myInfo.UserID,cmnd:a,phone:b};"function"===typeof d&&Utilities.getAPIAfterLogin("user","update_profile",a,d)};Utilities.getLogCards=function(a,b,d){a={userId:MGGameInfo.myInfo.UserID,PageSize:a,PageNum:b};"function"===typeof d&&Utilities.getAPIAfterLogin("payment","getlogcardtran",a,d)};
Utilities.getLogExchageCards=function(a,b,d){a={userId:MGGameInfo.myInfo.UserID,PageSize:a,PageNum:b};"function"===typeof d&&Utilities.getAPIAfterLogin("payment","GetLogExchangeCardUser",a,d)};Utilities.getListCard=function(a){var b={userId:MGGameInfo.myInfo.UserID};"function"===typeof a&&Utilities.getAPIAfterLogin("payment","getcard",b,a)};
Utilities.getCardPromotion=function(a,b){var d={userId:MGGameInfo.myInfo.UserID,CardTypeId:a};"function"===typeof b&&Utilities.getAPIAfterLogin("payment","getcardpromotion",d,b)};Utilities.dispositCard=function(a,b,d,e,f){a={userId:MGGameInfo.myInfo.UserID,PinCard:a,SerialCard:b,CardType:d,Captcha:e};"function"===typeof f&&Utilities.getAPIAfterLogin("payment","depositcard",a,f)};
Utilities.getListExchangeCard=function(a){var b={userId:MGGameInfo.myInfo.UserID};"function"===typeof a&&Utilities.getAPIAfterLogin("payment","GetCardList",b,a)};Utilities.exchangeCard=function(a,b,d,e){b={userId:MGGameInfo.myInfo.UserID,CardId:a,Quantity:b,Captcha:d};Utilities.showLog("ID: "+a);"function"===typeof e&&Utilities.getAPIAfterLogin("payment","ExchangeCard",b,e)};
Utilities.getBangXepHang=function(a,b,d){b={GameId:b,userId:d};"function"===typeof a&&Utilities.getAPIAfterLogin("game","ListTopGame",b,a)};Utilities.getChoiXu=function(a,b,d){a={userId:MGGameInfo.myInfo.UserID,PageSize:a,PageNum:b};"function"===typeof d&&Utilities.getAPIAfterLogin("payment","gethistorycoin",a,d)};Utilities.updateAvatar=function(a,b,d){a={userid:a,Avatar:b};"function"===typeof d&&Utilities.getAPIAfterLogin("user","update_avatar",a,d)};
Utilities.getAPIUpdateDisplayName=function(a,b){var d={userId:MGGameInfo.myInfo.UserID,nickname:b};"function"===typeof a&&Utilities.getAPIAfterLogin("user","update_nickname",d,a)};Utilities.getListEvent=function(a){var b={userId:MGGameInfo.myInfo.UserID};"function"===typeof a&&Utilities.getAPIAfterLogin("event","getcardevent",b,a)};
Utilities.getEventContent=function(a,b,d){a={userId:MGGameInfo.myInfo.UserID,Id:a,CardType:b};"function"===typeof d&&Utilities.getAPIAfterLogin("event","usecardevent",a,d)};Utilities.checkGiftCode=function(a,b){var d={GiftCode:a};"function"===typeof b&&Utilities.getAPIAfterLogin("event","eventgiftcode",d,b)};
var MGPopupDefine={TXT_NOTICE:"Thông Báo"},MG_POPUP_EVENTS={CLOSE:"POPUP_EVENT_CLOSE",CLOSE_LAST_POPUP:"POPUP_EVENT_CLOSE_LAST",UPDATE_AVATAR:"UPDATE_AVATAR"},POPUP_SHOW_TYPE={ONLY:1,OVERRIDE:2,DELAY:3,OVERRIDE_DELAY:4},MG_POPUPS={SHOW_POPUP_MESSAGE:"SHOW_POPUP_MESSAGE",SHOW_POPUP_LOGIN:"SHOW_POPUP_LOGIN",SHOW_POPUP_REGISTER:"SHOW_POPUP_REGISTER",SHOW_POPUP_RULES:"SHOW_POPUP_RULES",SHOW_POPUP_UPDATE_SECURITY:"SHOW_POPUP_UPDATE_SECURITY",SHOW_POPUP_CHANGE_PASSWORD:"SHOW_POPUP_CHANGE_PASSWORD",SHOW_POPUP_HOTROKH:"SHOW_POPUP_HOTROKHACHHANG",
SHOW_POPUP_PERSONAL:"SHOW_POPUP_PERSONAL",SHOW_POPUP_TAIUNGDUNG:"SHOW_POPUP_TAIUNGDUNG",SHOW_POPUP_CUAHANG:"SHOW_POPUP_CUAHANG",SHOW_POPUP_MAIL:"SHOW_POPUP_MAIL",SHOW_POPUP_BANGXEPHANG:"SHOW_POPUP_BANGXEPHANG",SHOW_POPUP_TRADE_HISTORY:"SHOW_POPUP_TRADE_HISTORY",SHOW_POPUP_LAYER:"SHOW_POPUP_LAYER",SHOW_POPUP_CHANGE_AVATAR:"SHOW_POPUP_CHANGE_AVATAR",SHOW_POPUP_CREATE_NAME:"SHOW_POPUP_CREATE_NAME",SHOW_POPUP_SELECT_CARD:"SHOW_POPUP_SELECT_CARD",SHOW_POPUP_GIFT_CODE:"SHOW_POPUP_GIFT_CODE"},MG_POPUP_KEY_DATA=
{POPUP_TITTLE:"tittle",POPUP_MSG:"message",POPUP_CALLBACK:"callback",POPUP_LAYER_SHOW:"popuplayershow",AVATAR_ID:"AVATAR_ID",POPUP:"popup"},TEXTFIELD_COLOR=cc.color(0,0,0),TEXTFIELD_COLOR_PLACE=cc.color(100,100,100),PopupEventRegister={},MGLayerPopupMessage=MGBaseLayer.extend({txtMsg:null,txtTitle:null,callback:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupMessage);this.txtMsg=this._mainLayer.getChildByName("MGTxtMsg");
this.txtTitle=this._mainLayer.getChildByName("MGTittle");this.txtTitle.ignoreContentAdaptWithSize(!0)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "MGBtnDongY":"function"===typeof this.callback&&this.callback(),d={},d[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},setAcceptCallback:function(a){this.callback=
a},setTitle:function(a){"string"===typeof a&&0<a.length&&this.txtTitle.setString(a)},setMessage:function(a){"string"===typeof a&&0<a.length&&this.txtMsg.setString(a)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}});
PopupEventRegister[MG_POPUPS.SHOW_POPUP_MESSAGE]=function(a){a=a.getUserData();if(null!==a&&!this.checkIsHaveSameMessage(a.message)){var b=new MGLayerPopupMessage;b.initObj();b.setTitle(a.title);b.setMessage(a.message);b.setAcceptCallback(a.callback);this.showPopup(b,POPUP_SHOW_TYPE.OVERRIDE)}};
var MGLayerPopupRegit=MGBaseLayer.extend({_nodeCapcha:null,_userNameInput:null,_nickNameInput:null,_passWordInput:null,_confirmPassInput:null,_capchaInput:null,_capchaImage:null,_token:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupRegit);this._initUI();this._initEventsGame()},_initUI:function(){this.edtiBoxUserName=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtLoginID"),"BackGroundEditBox.png");
this.edtiBoxUserName.setName("MGEditBoxUserName");this.edtiBoxUserName.maxLength=15;this.edtiBoxUserName.setVisibleBackground(!1);this.addChild(this.edtiBoxUserName);this.edtiBoxNickName=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtNickName"),"BackGroundEditBox.png");this.edtiBoxNickName.setName("MGEditBoxNickName");this.edtiBoxNickName.maxLength=15;this.edtiBoxNickName.setVisibleBackground(!1);this.addChild(this.edtiBoxNickName);this.edtiBoxPassword=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtPass"),
"BackGroundEditBox.png");this.edtiBoxPassword.setName("MGEditBoxPassword");this.edtiBoxPassword.setVisibleBackground(!1);this.edtiBoxPassword.maxLength=15;this.addChild(this.edtiBoxPassword);this.edtiBoxConfirmPassword=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtConfirmPass"),"BackGroundEditBox.png");this.edtiBoxConfirmPassword.setName("MGEditBoxConfirmPassword");this.edtiBoxConfirmPassword.maxLength=15;this.edtiBoxConfirmPassword.setVisibleBackground(!1);this.addChild(this.edtiBoxConfirmPassword);
cc.sys.isNative||(this.edtiBoxUserName._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.edtiBoxUserName)),this.edtiBoxNickName._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.edtiBoxNickName)),this.edtiBoxPassword._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.edtiBoxPassword)));cc.sys.isNative||this.edtiBoxConfirmPassword._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.edtiBoxConfirmPassword));
this.edtiBoxCapcha=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtCapcha"),"BackGroundEditBox.png");this.edtiBoxCapcha.setName("MGEdtiBoxCapcha");this.edtiBoxCapcha.maxLength=4;this.edtiBoxCapcha.setVisibleBackground(!1);this.addChild(this.edtiBoxCapcha);this._nodeCapcha=this._mainLayer.getChildByName("MGNode_Capcha");this._capchaImage=new cc.Node;this._capchaImage.setPosition(this._nodeCapcha.getPosition());this.addChild(this._capchaImage);this._loadCapcha()},_initEventsGame:function(){for(var a in MGLayerPopupRegit.REGIT_BUTTON)this._mainLayer.getChildByName(MGLayerPopupRegit.REGIT_BUTTON[a]).addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},
onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGLayerPopupRegit.REGIT_BUTTON.CLOSE:var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case MGLayerPopupRegit.REGIT_BUTTON.REFRESH_CAPCHA:this._loadCapcha();break;case MGLayerPopupRegit.REGIT_BUTTON.REGISTER:this._onClickRegister();break;case MGLayerPopupRegit.REGIT_BUTTON.LOGIN_FACE:cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOGIN_FACEBOOK,{});d={};d[MG_POPUP_KEY_DATA.POPUP]=
this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case MGLayerPopupRegit.REGIT_BUTTON.LOGIN_GOOGLE:cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOGIN_GOOGLE,{}),d={},d[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},_loadCapcha:function(){Utilities.getCaptcha(this._loadCapchaComplete.bind(this))},_loadCapchaComplete:function(a,b){if(b){this._capchaImage.removeAllChildren(!0);
var d=new cc.Sprite(b);this._capchaImage.addChild(d)}},_onClickRegister:function(){var a=getTextInput(this.edtiBoxUserName),b=getTextInput(this.edtiBoxNickName),d=getTextInput(this.edtiBoxPassword),e=getTextInput(this.edtiBoxConfirmPassword),f=getTextInput(this.edtiBoxCapcha);""===a||""===b||""===d||""===e||""===f?showPopupMessage("Thất Bại","Thông tin không thể để trống"):a.length<MGLayerPopupRegit.MINIMUM_CHARS?showPopupMessage("Thất Bại","Tên đăng nhập không được nhỏ hơn 6 ký tự"):b.length<MGLayerPopupRegit.MINIMUM_CHARS?
showPopupMessage("Thất Bại","Tên hiển thị không được nhỏ hơn 6 ký tự"):d.length<MGLayerPopupRegit.MINIMUM_CHARS?showPopupMessage("Thất Bại","Mật khẩu không được nhỏ hơn 6 ký tự"):d!==e?showPopupMessage("Thất Bại","Mật khẩu nhập lại không khớp"):(this._token=null,Utilities.registerUser(a,b,d,f,this._onRegister.bind(this)))},_onRegister:function(a){a.result?(this._token=a.data.accessToken,Utilities.showLog("_onRegister content.data.accessToken:"+a.data.accessToken),Utilities.verifyToken(a.data.accessToken,
this._saveUserData.bind(this))):this._loadCapcha()},_saveUserData:function(a){a.result?(MGGameInfo.myInfo={UserID:a.data.userId,NickName:a.data.nickName,UserName:a.data.userName,Avatar:a.data.avatar},MGGameInfo.token4web=this._token,Utilities.showLog("_saveUserData this._token:"+this._token),Utilities.getAPIAfterLogin("common","socket_info",{},this.onCallBackGetSocketInfo.bind(this))):this._token=null},onCallBackGetSocketInfo:function(a){a.result&&(""!=this.edtiBoxUserName.getString()&&(cc.sys.localStorage.setItem("UserName",
this.edtiBoxUserName.getString()),cc.sys.localStorage.setItem("Password",this.edtiBoxPassword.getString()),cc.sys.localStorage.setItem("LastLoginType",ConstantsVariable.LoginProviderID.Normal),cc.sys.localStorage.setItem("LastToken",MGGameInfo.token4web)),a=a.data[0],PreLoaderConfig.ServerAndPortSocketManager=a.ServerIP+":"+a.PortWS,MGNetCore.MGSocket.setSocketModuleID(a.ModuleId),MGGameInfo.MGMain.showLoading(),MGGameInfo.MGMain.connectSocketServer(),cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.LOGGED,
null));a={};a[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a)},onUserKeyDown:function(a,b){if(b.keyCode===cc.KEY.tab)switch(b.stopPropagation(),b.preventDefault(),a.getName()){case "MGEditBoxUserName":this.edtiBoxNickName.setFocus();break;case "MGEditBoxNickName":this.edtiBoxPassword.setFocus();break;case "MGEditBoxPassword":this.edtiBoxConfirmPassword.setFocus();break;case "MGEditBoxConfirmPassword":this.edtiBoxCapcha.setFocus()}}});
showPopupMessage=function(a,b,d){a={title:a,message:b};"function"===typeof d&&(a.callback=d);cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)};getTextInput=function(a){return a.getString()};MGLayerPopupRegit.REGIT_BUTTON={CLOSE:"MGButton_Close",REFRESH_CAPCHA:"MGButton_Refesh",REGISTER:"MGButton_Regit",LOGIN_FACE:"MGButton_Facebook",LOGIN_GOOGLE:"MGButton_Google"};
PopupEventRegister[MG_POPUPS.SHOW_POPUP_REGISTER]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupRegit,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.ONLY))};MGLayerPopupRegit.MINIMUM_CHARS=6;
var MGLayerPopupLogin=MGBaseLayer.extend({_nodeCapcha:null,_userNameInput:null,_passWordInput:null,_token:null,btnClose:null,dataPopup:null,textUser:"",textPass:"",ctor:function(a){MGBaseLayer.prototype.ctor.call(this);this.dataPopup=a},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupLogin);this._initUI();this._initEventsGame()},_initUI:function(){this.edtiBoxUserName=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtLoginID"),"BackGroundEditBox.png");
this.edtiBoxUserName.setName("MGEditBoxUserName");this.edtiBoxUserName.maxLength=15;this.edtiBoxUserName.setVisibleBackground(!1);this.addChild(this.edtiBoxUserName);this.edtiBoxPassword=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtPass"),"BackGroundEditBox.png");this.edtiBoxPassword.setName("MGEditBoxPassword");this.edtiBoxPassword.setVisibleBackground(!1);this.edtiBoxPassword.maxLength=15;this.addChild(this.edtiBoxPassword);this.btnClose=this._mainLayer.getChildByName("MGButton_Close");
this.btnClose.setVisible(!1);this.dataPopup[MGLayerPopupLogin.DATA.USER]&&this.edtiBoxUserName.setString(this.dataPopup[MGLayerPopupLogin.DATA.USER]);this.dataPopup[MGLayerPopupLogin.DATA.PASS]&&this.edtiBoxPassword.setString(this.dataPopup[MGLayerPopupLogin.DATA.PASS])},_initEventsGame:function(){for(var a in MGLayerPopupLogin.LOGIN_BUTTON)this._mainLayer.getChildByName(MGLayerPopupLogin.LOGIN_BUTTON[a]).addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,
b){switch(a.getName()){case MGLayerPopupLogin.LOGIN_BUTTON.REGISTER:cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_REGISTER,{});break;case MGLayerPopupLogin.LOGIN_BUTTON.LOGIN:this._onClickLogin();break;case MGLayerPopupLogin.LOGIN_BUTTON.FORGET:cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_HOTROKH,{});var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case MGLayerPopupLogin.LOGIN_BUTTON.LOGIN_FACE:cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOGIN_FACEBOOK,
{});d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case MGLayerPopupLogin.LOGIN_BUTTON.LOGIN_GOOGLE:cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOGIN_GOOGLE,{}),d={},d[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},_onClickLogin:function(){var a=this.getTextInput(this.edtiBoxUserName),b=this.getTextInput(this.edtiBoxPassword);
if(""===a||""===b)this.showPopupMessage("Thất Bại","Thông tin không thể để trống");else if(a.length<MGLayerPopupLogin.MINIMUM_CHARS)this.showPopupMessage("Thất Bại","Tên đăng nhập không được nhỏ hơn 6 ký tự");else if(b.length<MGLayerPopupLogin.MINIMUM_CHARS)this.showPopupMessage("Thất Bại","Mật khẩu không được nhỏ hơn 6 ký tự");else{this.textUser=a;this.textPass=b;cc.sys.localStorage.setItem("UserName",a);cc.sys.localStorage.setItem("Password",b);var d={};d.password=Utilities.encrypt(b);d.userName=
a;Utilities.getAPIBeforeLogin("user","login",d,this.onCallBackLogin.bind(this))}},onCallBackLogin:function(a){if(a.result){var b={};b[MGCompoHeaderLogin.DATA.LOGIN_DATA]=a;b[MGLayerPopupLogin.DATA.USER]=this.textUser;b[MGLayerPopupLogin.DATA.PASS]=this.textPass;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MOBILE_LOGIN,b);a={};a[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a)}},showPopupMessage:function(a,b,d){a={title:a,message:b};"function"===
typeof d&&(a.callback=d);cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)},getTextInput:function(a){return a.getString()}});MGLayerPopupLogin.LOGIN_BUTTON={CLOSE:"MGButton_Close",REGISTER:"MGButton_Regit",LOGIN:"MGButton_Login",FORGET:"MGButton_Forget",LOGIN_FACE:"MGButton_Facebook",LOGIN_GOOGLE:"MGButton_Google"};MGLayerPopupLogin.DATA={USER:"USER",PASS:"PASS"};PopupEventRegister[MG_POPUPS.SHOW_POPUP_LOGIN]=function(a){a.getUserData()};MGLayerPopupLogin.MINIMUM_CHARS=6;
var MGLayerPopupChangePassword=MGBaseLayer.extend({_capchaImage:null,_nodeCapcha:null,_currentPassInput:null,_newPassInput:null,_confirmPassInput:null,_capchaInput:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupChangePassword);this._initUI();this._initEventsGame()},_initUI:function(){this._nodeCapcha=this._mainLayer.getChildByName("MGNode_Capcha");this.editBoxCurrentPass=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtCurrentPass"),
"BGWhite.png");this.editBoxCurrentPass.setName("MGEditBoxCurrentPass");this.editBoxCurrentPass.setVisibleBackground(!1);this.editBoxCurrentPass.setFontColor(TEXTFIELD_COLOR);this.editBoxCurrentPass.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this.editBoxCurrentPass.maxLength=15;this.addChild(this.editBoxCurrentPass);this.editBoxNewPass=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtNewPass"),"BGWhite.png");this.editBoxNewPass.setName("MGEditBoxNewPass");this.editBoxNewPass.setVisibleBackground(!1);
this.editBoxNewPass.setFontColor(TEXTFIELD_COLOR);this.editBoxNewPass.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this.editBoxNewPass.maxLength=15;this.addChild(this.editBoxNewPass);this.editBoxConfirmPass=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtConfirmPass"),"BGWhite.png");this.editBoxConfirmPass.setName("MGEditBoxConfirmPass");this.editBoxConfirmPass.setVisibleBackground(!1);this.editBoxConfirmPass.setFontColor(TEXTFIELD_COLOR);this.editBoxConfirmPass.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);
this.editBoxConfirmPass.maxLength=15;this.addChild(this.editBoxConfirmPass);this.editBoxCapcha=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtCapcha"),"BGWhite.png");this.editBoxCapcha.setName("MGEditBoxCapcha");this.editBoxCapcha.setDelegate(this);this.editBoxCapcha.setVisibleBackground(!1);this.editBoxCapcha.setFontColor(TEXTFIELD_COLOR);this.editBoxCapcha.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this.editBoxCapcha.maxLength=4;this.addChild(this.editBoxCapcha);this._loadCapcha()},
_initEventsGame:function(){for(var a in MGLayerPopupChangePassword.CHANGEPW_BUTTON){var b=this._mainLayer.getChildByName(MGLayerPopupChangePassword.CHANGEPW_BUTTON[a]);b&&void 0!==b&&b.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))}cc.sys.isNative||(this.editBoxCurrentPass._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.editBoxCurrentPass)),this.editBoxNewPass._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.editBoxNewPass)),
this.editBoxConfirmPass._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.editBoxConfirmPass)))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGLayerPopupChangePassword.CHANGEPW_BUTTON.CLOSE:var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case MGLayerPopupChangePassword.CHANGEPW_BUTTON.CONFIRM_CHANGE:this._onClickChangePass();break;case MGLayerPopupChangePassword.CHANGEPW_BUTTON.REFRESH_CAPCHA:this._loadCapcha()}},
show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},_loadCapcha:function(){Utilities.getCaptcha(this._loadCapchaComplete.bind(this))},_loadCapchaComplete:function(a,b){b?(this._capchaImage&&void 0!==this._capchaImage&&this._capchaImage.removeFromParent(!0),this._capchaImage=new cc.Sprite(b),this._capchaImage.setPosition(this._nodeCapcha.getPosition()),this.addChild(this._capchaImage)):this._loadCapcha()},_onClickChangePass:function(){var a=getTextInput(this.editBoxCurrentPass),
b=getTextInput(this.editBoxNewPass),d=getTextInput(this.editBoxConfirmPass),e=getTextInput(this.editBoxCapcha);""===a||""===b||""===d||""===e?showPopupMessage("Thất Bại","Thông tin không thể để trống"):b!==d?showPopupMessage("Thất Bại","Mật khẩu nhập lại không khớp"):Utilities.changePassword(a,b,e,this._onChange.bind(this))},_onChange:function(a){a.result?(a={},a[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a)):this._loadCapcha()},onUserKeyDown:function(a,
b){if(b.keyCode===cc.KEY.tab)switch(b.stopPropagation(),b.preventDefault(),a.getName()){case "MGEditBoxCurrentPass":this.editBoxNewPass.setFocus();break;case "MGEditBoxNewPass":this.editBoxConfirmPass.setFocus();break;case "MGEditBoxConfirmPass":this.editBoxCapcha.setFocus()}},editBoxReturn:function(a){this._onClickChangePass()}});MGLayerPopupChangePassword.CHANGEPW_BUTTON={CLOSE:"MGButton_Close",REFRESH_CAPCHA:"MGButton_Refesh",CONFIRM_CHANGE:"MGButton_Change"};
PopupEventRegister[MG_POPUPS.SHOW_POPUP_CHANGE_PASSWORD]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupChangePassword,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGLayerPopupSecurity=MGBaseLayer.extend({_accountID:null,_cmndInput:null,_phoneInput:null,_btnUpdate:null,_cmndTxt:null,_phoneTxt:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupSecurity);this._initUI();this._initEventsGame()},_initUI:function(){this._accountID=this._mainLayer.getChildByName("MGAccountID");this._accountID.ignoreContentAdaptWithSize(!0);this._cmndInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtCMND"),
"BGWhite.png");this._cmndInput.setName("MGEditBoxCMND");this._cmndInput.setVisibleBackground(!1);this._cmndInput.setFontColor(TEXTFIELD_COLOR);this._cmndInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this._cmndInput.maxLength=12;this.addChild(this._cmndInput);this._phoneInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtPhone"),"BGWhite.png");this._phoneInput.setName("MGEditBoxPhone");this._phoneInput.setVisibleBackground(!1);this._phoneInput.setFontColor(TEXTFIELD_COLOR);this._phoneInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);
this._phoneInput.maxLength=12;this.addChild(this._phoneInput);this._cmndTxt=this._mainLayer.getChildByName("MGTxtCMNDNoTouch");this._cmndTxt.ignoreContentAdaptWithSize(!0);this._phoneTxt=this._mainLayer.getChildByName("MGTxtPhoneNoTouch");this._phoneTxt.ignoreContentAdaptWithSize(!0);this._btnUpdate=this._mainLayer.getChildByName("MGButton_Update");this.setAccountID(MGGameInfo.myInfo.DisplayName);this._checkAlreadyUpdate()},_initEventsGame:function(){this._mainLayer.getChildByName("MGButton_Close").addClickEventListener(this.onClickBtnFromCocostudio.bind(this));
cc.sys.isNative||this._cmndInput._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this._cmndInput));this._btnUpdate.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButton_Close":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "MGButton_Update":this._onUpdateSecurity()}},setAccountID:function(a){15<a.length&&(a=a.slice(0,14)+"...");
this._accountID.setString(a)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},_checkAlreadyUpdate:function(){var a=MGGameInfo.myInfo.CMND,b=MGGameInfo.myInfo.Phone;a&&void 0!==a&&""!==a||b&&void 0!==b&&""!==b?(this._cmndTxt.setString(a),this._phoneTxt.setString(b),this._unLockInput(!1)):this._unLockInput(!0)},_unLockInput:function(a){this._cmndInput.setVisible(a);this._phoneInput.setVisible(a);this._btnUpdate.setVisible(a);if(!a){var b=this._cmndTxt.getString().slice(0,this._cmndTxt.getString().length-
3);this._cmndTxt.setString(b+"***");b=this._phoneTxt.getString().slice(0,this._phoneTxt.getString().length-3);this._phoneTxt.setString(b+"***")}this._cmndTxt.setVisible(!a);this._phoneTxt.setVisible(!a)},_onUpdateSecurity:function(){var a=getTextInput(this._cmndInput),b=getTextInput(this._phoneInput);""===a||""===b?showPopupMessage("Thất Bại","Thông tin không thể để trống"):9>a.length?showPopupMessage("Thất Bại","CMND phải có ít nhất 9 kí tự"):9>b.length?showPopupMessage("Thất Bại","Số điện thoại phải có ít nhất 9 kí tự"):
Utilities.updateProfile(a,b,this._onUpdate.bind(this))},_onUpdate:function(a){a.result&&(MGGameInfo.myInfo.CMND=getTextInput(this._cmndInput),MGGameInfo.myInfo.Phone=getTextInput(this._phoneInput),a={},a[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a))},onUserKeyDown:function(a,b){if(b.keyCode===cc.KEY.tab)switch(b.stopPropagation(),b.preventDefault(),a.getName()){case "MGEditBoxCMND":this._phoneInput.setFocus()}}});
MGLayerPopupSecurity.SECURITY_TEXTFIELD={CMND:"MGTxtCMND",EMAIL:"MGTxtEmail",PHONE:"MGTxtPhone"};PopupEventRegister[MG_POPUPS.SHOW_POPUP_UPDATE_SECURITY]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupSecurity,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.ONLY))};
var MGCardDoiInfo=MGBaseNode.extend({_data:null,PanelUI:null,_txtMenhGia:null,_txtDiscount:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this._data=a;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.MGCardDoiInfo);this._initUI();this._initEventsGame()},_initUI:function(){this.PanelUI=this._mainLayer.getChildByName("MGInfoTitle");this._txtMenhGia=this.PanelUI.getChildByName("MGTxtMenhGia");this._txtMenhGia.ignoreContentAdaptWithSize(!0);
this._txtXuExchange=this.PanelUI.getChildByName("MGTxtXuExchange");this._txtXuExchange.ignoreContentAdaptWithSize(!0);this._initData()},_initData:function(){this._data&&void 0!==this._data&&(this._setTxtMenhGia(this._data.amount),this._setTxtXuExchange(this._data.valueExchange))},_setTxtMenhGia:function(a){this._txtMenhGia.setString(Utilities.Coin(a))},_setTxtXuExchange:function(a){this._txtXuExchange.setString(Utilities.Coin(a))},setImageBG:function(a){this.PanelUI.loadTexture(MGCardNapInfo.BACKGROUND_IMAGE[a],
ccui.Widget.PLIST_TEXTURE)}}),MGStoreIAP=MGBaseNode.extend({listBtns:null,iapController:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);cc.sys.isNative&&this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listBtns=[];this.cloneFromNode(ccs.load(ResourceManager.MGResourcesMainPopup.MGStoreListIAP,PreLoaderConfig.PathToResourceDefault).node);this.iapController=new MGStoreIAPController;this.iapController.setOnProductRequestSuccessCB(this.onProductRequestSuccess.bind(this));
this.iapController.initIAP();this._initUI();this._initEventsGame()},_initUI:function(){for(var a=0,b=0;b<this.getChildren().length;b++){var d=this.getChildByName("Item"+b);d&&(d.getChildByName("MGButton").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),d.getChildByName("MGButton").setTag(a),d.setVisible(!1),this.listBtns.push(d),a++)}},onProductRequestSuccess:function(a){Utilities.showLog("onProductRequestSuccess");for(var b=0;b<a.length;b++)this.listBtns[b].setVisible(!0),this.listBtns[b].getChildByName("Coin_Text").setString(Utilities.Coin(a[b].priceValue)),
this.listBtns[b].getChildByName("Money_Text").setString(products[b].price),this.listBtns[b].Name=products[b].name},onClickBtnFromCocostudio:function(a,b){void 0!==a.Name&&this.iapController.purchaseItemName(a.Name)}}),MGStoreIAPController=cc.Class.extend({onProductRequestSuccessCB:null,ctor:function(){},initIAP:function(){var a=this;sdkbox.IAP.setListener({onSuccess:function(a){Utilities.showLog("Purchase successful: "+a.name);a=cc.sys.os===cc.sys.OS_IOS?{purchaseToken:a.receiptCipheredPayload}:JSON.parse(a.receipt);
Utilities.showLog("receipt"+a)},onFailure:function(a,d){Utilities.showLog("Purchase failed: "+a.name+" error: "+d)},onCanceled:function(a){Utilities.showLog("Purchase canceled: "+a.name)},onRestored:function(a){Utilities.showLog("Restored: "+a.name)},onProductRequestSuccess:function(b){for(var d=0;d<b.length;d++)Utilities.showLog("================"),Utilities.showLog("name: "+b[d].name),Utilities.showLog("price: "+b[d].price),Utilities.showLog("================"),Utilities.showLog("priceValue: "+
b[d].priceValue);if(a.onProductRequestSuccessCB)a.onProductRequestSuccessCB(b)},onProductRequestFailure:function(a){Utilities.showLog("Failed to get products")},onShouldAddStorePayment:function(a){Utilities.showLog("onShouldAddStorePayment:"+a);return!0},onFetchStorePromotionOrder:function(a,d){Utilities.showLog("onFetchStorePromotionOrder:  e:"+d)},onFetchStorePromotionVisibility:function(a,d,e){Utilities.showLog("onFetchStorePromotionVisibility:"+a+" v:"+d+" e:"+e)},onUpdateStorePromotionOrder:function(a){Utilities.showLog("onUpdateStorePromotionOrder:"+
a)},onUpdateStorePromotionVisibility:function(a){Utilities.showLog("onUpdateStorePromotionVisibility:"+a)}});this.refreshIAP()},setOnProductRequestSuccessCB:function(a){this.onProductRequestSuccessCB=a},refreshIAP:function(){sdkbox.IAP.refresh()},purchaseItemName:function(a){sdkbox.IAP.purchase(a)}}),MGListItemSelect=MGBaseNode.extend({_listControl:null,_data:null,KeyView:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a,b){this._data=a;this.KeyView=b;this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.MGListCardSelect);
this._initUI();this._initEventsGame()},_initUI:function(){this._listControl=this._mainLayer.getChildByName("ListItem");this._listControl.setScaleY(0);this._listControl.setTouchEnabled(!1);this._initDataUI()},_initEventsGame:function(){},_initDataUI:function(){if(this._data&&void 0!==this._data)for(var a=0;a<this._data.length;a++){var b=new MGElement(this._data[a],this.KeyView);this._pushInfo(b)}this._resizeList();this.onActionList(!0)},_pushInfo:function(a){a&&void 0!==a&&this._listControl.pushBackCustomItem(a.PanelUI)},
_resizeList:function(){for(var a=0,b=this._listControl.getChildren(),d=0;d<b.length;d++)a+=b[d].getContentSize().height;this._listControl.setContentSize(this._listControl.getContentSize().width,a+10)},onActionList:function(a){a?this._listControl.runAction(cc.scaleTo(MGListItemSelect.ACTION_SCALE_TIME,1,1)):this._listControl.runAction(cc.scaleTo(MGListItemSelect.ACTION_SCALE_TIME,1,0))}}),MGElement=cc.Class.extend({PanelUI:null,_nameData:null,_imageSelect:null,KeyView:null,_data:null,_isBlock:!1,ctor:function(a,
b){this._data=a;this.KeyView=b;this.initObj()},initObj:function(){this._initUI();this._initEventsGame()},_initUI:function(){this.PanelUI=new MGBaseImageView;this.PanelUI.initObj();this.PanelUI._initEventsGame();this.PanelUI.loadTexture("BackGroundEditBox.png",ccui.Widget.PLIST_TEXTURE);this.PanelUI.setContentSize(338,30);this.PanelUI.setPosition(0,0);this._nameData=new ccui.Text;this._nameData.setFontName("arial");this._nameData.setFontSize(20);this._nameData.setTextColor(cc.color(0,0,0));this._nameData.setAnchorPoint(0,
.5);this._nameData.setPosition(15,10);this._nameData.ignoreContentAdaptWithSize(!0);this.PanelUI.addChild(this._nameData);this._setNameData(this._data[this.KeyView])},_initEventsGame:function(){this.PanelUI.setTouchEnabled(!0);this.PanelUI.addClickEventListener(this._onClickSelect.bind(this));this.PanelUI.addMouseHoverEventListener(this._onMouseHover.bind(this))},_setNameData:function(a){this.KeyView===MGStoreMuaCardDT.KEY_MENHGIA?this._nameData.setString("Mệnh giá "+Utilities.Coin(a)+" VNĐ"):this._nameData.setString("Thẻ "+
a)},_onClickSelect:function(a){this._isBlock||(cc.eventManager.dispatchCustomEvent(MGStoreMuaCardDT.SELECT_ELEMENT,{Data:this._data,KeyView:this.KeyView}),this._isBlock=!0)},_onMouseHover:function(a,b){switch(b){case 0:this.PanelUI.getTag()===a.getTag()&&this.PanelUI.setColor(MGElement.COLOR_SELECTED[1]);break;case 1:this.PanelUI.setColor(MGElement.COLOR_SELECTED[0])}}});MGElement.COLOR_SELECTED=[cc.color(30,144,255),cc.color(255,255,255)];MGListItemSelect.ACTION_SCALE_TIME=.2;
var MGStoreNapCardDT=MGBaseNode.extend({TypeIcon:null,_data:null,_cardType:null,_seriInput:null,_codeCardInput:null,_capChaInput:null,_nodeCapcha:null,_backgroundInfo:null,_lineOne:null,_lineTwo:null,_listView:null,ctor:function(a,b){MGBaseNode.prototype.ctor.call(this);this._data=a;this.TypeIcon=b;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.MGStoreNapCardDT);this._initUI();this._initEventsGame()},_initUI:function(){this._backgroundInfo=
this._mainLayer.getChildByName("MGMenhGiaBG");this._lineOne=this._mainLayer.getChildByName("Line_0");this._lineTwo=this._mainLayer.getChildByName("Line_1");this._listView=this._mainLayer.getChildByName("MGInfoList");this._nodeCapcha=this._mainLayer.getChildByName("MGNode_Capcha");this._cardType=this._mainLayer.getChildByName("MGTxtCardType");this._cardType.ignoreContentAdaptWithSize(!0);this._seriInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtSeri"),"BGWhite.png");this._seriInput.setName("MGEditBoxSeri");
this._seriInput.setVisibleBackground(!1);this._seriInput.setFontColor(TEXTFIELD_COLOR);this._seriInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this._seriInput.maxLength=20;this.addChild(this._seriInput);this._codeCardInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtMaThe"),"BGWhite.png");this._codeCardInput.setName("MGEditBoxMaThe");this._codeCardInput.setVisibleBackground(!1);this._codeCardInput.setFontColor(TEXTFIELD_COLOR);this._codeCardInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);
this._codeCardInput.maxLength=20;this.addChild(this._codeCardInput);this._capChaInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtCapcha"),"BGWhite.png");this._capChaInput.setName("MGEditBoxCapcha");this._capChaInput.setVisibleBackground(!1);this._capChaInput.setFontColor(TEXTFIELD_COLOR);this._capChaInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this._capChaInput.maxLength=4;this._capChaInput.setInputFlag(cc.EDITBOX_INPUT_MODE_SINGLELINE);this.addChild(this._capChaInput);Utilities.getCardPromotion(this._data.id,
this._initDataUI.bind(this));this._loadCapcha()},_initEventsGame:function(){this._mainLayer.getChildByName("MGButton_Nap").addClickEventListener(this._onClickBtnNap.bind(this));this._mainLayer.getChildByName("MGButton_Refresh").addClickEventListener(this._onClickRefreshCapcha.bind(this));cc.sys.isNative||(this._seriInput._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this._seriInput)),this._codeCardInput._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,
this._codeCardInput)))},_initDataUI:function(a){if(a.result){this._data&&void 0!==this._data&&this._setCardType(this._data.name);if((a=a.data)&&void 0!==a)for(var b=0;b<a.length;b++){var d=new MGCardNapInfo(a[b]);d.setImageBG(b%2);this.pushInfo(d)}this._resizeBGInfo()}},_onBackMain:function(){cc.eventManager.dispatchCustomEvent(MGLayerPopupCuaHang.STORE_CLICK_BACK)},pushInfo:function(a){a&&void 0!==a&&(a.PanelUI.removeFromParent(),this._listView.pushBackCustomItem(a.PanelUI))},_resizeBGInfo:function(){var a=
this._backgroundInfo.getContentSize(),b=this._lineOne.getContentSize(),d=this._getHeightAndCheckTouch();this._backgroundInfo.setContentSize(a.width,d+50);this._lineOne.setContentSize(d+40,b.height);this._lineTwo.setContentSize(d+40,b.height)},_getHeightAndCheckTouch:function(){var a=0;if(!this._listView.isTouchEnabled()){for(var b=this._listView.getChildren(),d=0;d<b.length;d++)a+=b[d].getContentSize().height;a>this._listView.getContentSize().height&&(this._listView.setTouchEnabled(!0),a=this._listView.getContentSize().height)}return a},
_setCardType:function(a){this._cardType.setString(a)},_onClickBtnNap:function(a){a=getTextInput(this._seriInput);var b=getTextInput(this._codeCardInput),d=getTextInput(this._capChaInput);""===a||""===b||""===d?showPopupMessage("Thất Bại","Thông tin không thể để trống"):Utilities.dispositCard(b,a,this._data.cardTypeId,d,this._onNapResult.bind(this))},_onNapResult:function(a){a.result&&(MGGameInfo.myInfo.Gold=a.data.currentCoin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,
{}),this._seriInput.setString(""),this._codeCardInput.setString(""),this._capChaInput.setString(""));this._loadCapcha()},_onClickRefreshCapcha:function(a){this._loadCapcha()},_loadCapcha:function(){Utilities.getCaptcha(this._loadCapchaComplete.bind(this))},_loadCapchaComplete:function(a,b){b?(this._capchaImage&&void 0!==this._capchaImage&&this._capchaImage.removeFromParent(!0),this._capchaImage=new cc.Sprite(b),this._capchaImage.setPosition(this._nodeCapcha.getPosition()),this.addChild(this._capchaImage)):
this._loadCapcha()},onUserKeyDown:function(a,b){if(b.keyCode===cc.KEY.tab)switch(b.stopPropagation(),b.preventDefault(),a.getName()){case "MGEditBoxSeri":this._codeCardInput.setFocus();break;case "MGEditBoxMaThe":this._capChaInput.setFocus()}}}),MGCardNapInfo=MGBaseNode.extend({_data:null,PanelUI:null,_txtMenhGia:null,_txtDiscount:null,_txtXuExchange:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this._data=a;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.MGCardNapInfo);
this._initUI();this._initEventsGame()},_initUI:function(){this.PanelUI=this._mainLayer.getChildByName("MGInfoTitle");this._txtMenhGia=this.PanelUI.getChildByName("MGTxtMenhGia");this._txtMenhGia.ignoreContentAdaptWithSize(!0);this._txtDiscount=this.PanelUI.getChildByName("MGTxtDiscount");this._txtDiscount.ignoreContentAdaptWithSize(!0);this._txtXuExchange=this.PanelUI.getChildByName("MGTxtXuExchange");this._txtXuExchange.ignoreContentAdaptWithSize(!0);this._initData()},_initData:function(){this._data&&
void 0!==this._data&&(this._setTxtMenhGia(this._data.amount),this._setTxtDiscount(this._data.promotion),this._setTxtXuExchange(this._data.totalXu))},_setTxtMenhGia:function(a){this._txtMenhGia.setString(a)},_setTxtDiscount:function(a){this._txtDiscount.setString(a)},_setTxtXuExchange:function(a){this._txtXuExchange.setString(a)},setImageBG:function(a){this.PanelUI.loadTexture(MGCardNapInfo.BACKGROUND_IMAGE[a],ccui.Widget.PLIST_TEXTURE)}});
MGCardNapInfo.BACKGROUND_IMAGE=["BackGroundLine50000.png","BackGroundLine100000.png"];
var MGStoreMuaCardDT=MGBaseNode.extend({TypeIcon:null,_data:null,_dataMenhGia:null,_listCardInfo:null,_cardType:null,_cardFullName:null,_costValue:null,_numberCardInput:null,_capChaInput:null,_nodeCapcha:null,_backgroundInfo:null,_lineOne:null,_listView:null,isBlockTouch:!1,currentShowList:null,_currentSelectData:null,ctor:function(a,b){MGBaseNode.prototype.ctor.call(this);this.TypeIcon=b;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.MGStoreMuaCardDT);
this._initUI();this._initEventsGame()},_initUI:function(){this._backgroundInfo=this._mainLayer.getChildByName("MGMenhGiaBG");this._lineOne=this._mainLayer.getChildByName("Line_0");this._listView=this._mainLayer.getChildByName("MGInfoList");this._listView.setTouchEnabled(!0);this._nodeCapcha=this._mainLayer.getChildByName("MGNode_Capcha");this._cardType=this._mainLayer.getChildByName("MGTxtCardType");this._cardType.ignoreContentAdaptWithSize(!0);this._cardTypePosition=this._mainLayer.getChildByName("MGTxtBgCardType");
this._cardTypePosition.setTouchEnabled(!0);this._cardMenhGiaPos=this._mainLayer.getChildByName("MGTxtBgCardName");this._cardMenhGiaPos.setTouchEnabled(!0);this._cardFullName=this._mainLayer.getChildByName("MGTxtCardName");this._cardFullName.ignoreContentAdaptWithSize(!0);this._costValue=this._mainLayer.getChildByName("MGTxtCost");this._costValue.ignoreContentAdaptWithSize(!0);this._setCostValue(0);this._numberCardInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtNum"),"BGWhite.png");this._numberCardInput.setDelegate(this);
this._numberCardInput.setString(1);this._numberCardInput.setName("MGEditBoxNumberCard");this._numberCardInput.setVisibleBackground(!1);this._numberCardInput.setFontColor(TEXTFIELD_COLOR);this._numberCardInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this._numberCardInput.maxLength=15;this.addChild(this._numberCardInput);this._capChaInput=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtCapcha"),"BGWhite.png");this._capChaInput.setName("MGEditBoxCapcha");this._capChaInput.setVisibleBackground(!1);
this._capChaInput.setFontColor(TEXTFIELD_COLOR);this._capChaInput.setPlaceholderFontColor(TEXTFIELD_COLOR_PLACE);this._capChaInput.maxLength=4;this.addChild(this._capChaInput);this._initDataUI()},_initDataUI:function(){Utilities.getListExchangeCard(this._getListCardInfo.bind(this));this._loadCapcha()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._mainLayer.getChildByName("MGButton_Continue").addClickEventListener(this._onClickBtnContinue.bind(this));this._mainLayer.getChildByName("MGButton_Refresh").addClickEventListener(this._onClickRefreshCapcha.bind(this));
for(var a=0;a<MGStoreMuaCardDT.BTN_SHOW_LIST.length;a++){var b=this._mainLayer.getChildByName(MGStoreMuaCardDT.BTN_SHOW_LIST[a]);b.setTouchEnabled(!0);b.addClickEventListener(this._showList.bind(this))}cc.sys.isNative||this._numberCardInput._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this._numberCardInput));this._listEvents.push(cc.eventManager.addCustomListener(MGStoreMuaCardDT.SELECT_ELEMENT,this._onSelectElement.bind(this)))},editBoxTextChanged:function(a,b){this._txtFieldNumberCheck(a,
b)},_getListCardInfo:function(a){a.result&&(this._data=a.data,this._checkData(this._data)&&(this._dataMenhGia=this._data[0].listAmount,this._getMenhGiaInfo(this._dataMenhGia),this._setCardType(this._formatNameCard(this._data[0][MGStoreMuaCardDT.KEY_CARDTYPE],!1)),this._checkData(this._dataMenhGia)&&this._updateCostValue(this._dataMenhGia[0])))},_showList:function(a){this.isBlockTouch?this._closeList():this._checkData(this._data)&&("MGTxtBgCardType"===a.getName()||"MGButton_Arrow_0"===a.getName()?
(this._setBlockTouch(!0),a=new MGListItemSelect,a.initObj(this._data,MGStoreMuaCardDT.KEY_CARDTYPE),a.setPosition(-344,133),this.currentShowList=a,this.addChild(a)):"MGTxtBgCardName"!==a.getName()&&"MGButton_Arrow_1"!==a.getName()||!this._checkData(this._dataMenhGia)||(this._setBlockTouch(!0),a=new MGListItemSelect,a.initObj(this._dataMenhGia,MGStoreMuaCardDT.KEY_MENHGIA),a.setPosition(-344,70),this.currentShowList=a,this.addChild(a)))},_closeList:function(){this.currentShowList&&null!==this.currentShowList&&
(this.currentShowList.onActionList(!1),setTimeout(this._onEndCloseList.bind(this),100*MGListItemSelect.ACTION_SCALE_TIME))},_onSelectElement:function(a){a=a.getUserData();null!==a&&(a.KeyView===MGStoreMuaCardDT.KEY_MENHGIA?this._updateCostValue(a.Data):(this._dataMenhGia=a.Data.listAmount,this._getMenhGiaInfo(this._dataMenhGia),this._setCardType(this._formatNameCard(a.Data[MGStoreMuaCardDT.KEY_CARDTYPE],!1)),this._checkData(this._dataMenhGia)&&this._updateCostValue(this._dataMenhGia[0])),this._closeList())},
_checkData:function(a){return a&&void 0!==a&&0<a.length?!0:!1},_onEndCloseList:function(){this._setBlockTouch(!1);this.currentShowList.removeFromParent(!0);this.currentShowList=null},_setBlockTouch:function(a){this.isBlockTouch=a},_getMenhGiaInfo:function(a){this._listView.removeAllChildren(!0);if(a&&void 0!==a)for(var b=0;b<a.length;b++){var d=new MGCardDoiInfo(a[b]);d.setImageBG(b%2);this.pushInfo(d)}},_onClose:function(){var a={};a[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,
a)},pushInfo:function(a){a&&void 0!==a&&(a.PanelUI.removeFromParent(),this._listView.pushBackCustomItem(a.PanelUI))},_resizeBGInfo:function(){var a=this._backgroundInfo.getContentSize(),b=this._lineOne.getContentSize(),d=this._getHeightAndCheckTouch();this._backgroundInfo.setContentSize(a.width,d+57);this._lineOne.setContentSize(d+37,b.height)},_getHeightAndCheckTouch:function(){var a=0;if(!this._listView.isTouchEnabled()){for(var b=this._listView.getChildren(),d=0;d<b.length;d++)a+=b[d].getContentSize().height;
a>this._listView.getContentSize().height&&(this._listView.setTouchEnabled(!0),a=this._listView.getContentSize().height)}return a},_setCardType:function(a){this._cardType.setString(a)},_setCardFullName:function(a){this._cardFullName.setString(a)},_setCostValue:function(a){this._costValue.setString(Utilities.Coin(a))},_txtFieldNumberCheck:function(a,b){""===b&&this._numberCardInput.setString(1);var d=this._getNumberCardInput();3<d?this._numberCardInput.setString(3):1>d&&this._numberCardInput.setString(1);
this._updateCostValue(this._currentSelectData)},_getNumberCardInput:function(){var a=Number(this._numberCardInput.string);return Number.isNaN(a)?(this._numberCardInput.setString(1),1):a},_onClickBtnContinue:function(a){a=getTextInput(this._capChaInput);var b=this._getNumberCardInput();""===a||""===b?showPopupMessage("Thất Bại","Thông tin không thể để trống"):this._currentSelectData&&void 0!==this._currentSelectData&&Utilities.exchangeCard(this._currentSelectData.id,b,a,this._onExchangeResult.bind(this))},
_onExchangeResult:function(a){a.result&&(MGGameInfo.myInfo.Gold=a.data.currentCoin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{}));this._loadCapcha()},_onClickRefreshCapcha:function(a){this._loadCapcha()},_loadCapcha:function(){Utilities.getCaptcha(this._loadCapchaComplete.bind(this))},_loadCapchaComplete:function(a,b){b&&(this._capchaImage&&void 0!==this._capchaImage&&this._capchaImage.removeFromParent(!0),this._capchaImage=new cc.Sprite(b),this._capchaImage.setPosition(this._nodeCapcha.getPosition()),
this.addChild(this._capchaImage))},_formatNameCard:function(a,b){return b?"Mệnh giá "+Utilities.Coin(a)+" VNĐ":"Thẻ "+a},_updateCostValue:function(a){this._currentSelectData=a;this._setCardFullName(this._formatNameCard(a[MGStoreMuaCardDT.KEY_MENHGIA],!0));this._setCostValue(this._getNumberCardInput()*this._currentSelectData.valueExchange)},onUserKeyDown:function(a,b){if(b.keyCode===cc.KEY.tab)switch(b.stopPropagation(),b.preventDefault(),a.getName()){case "MGEditBoxNumberCard":this._capChaInput.setFocus()}}});
MGStoreMuaCardDT.BTN_SHOW_LIST=["MGTxtBgCardType","MGTxtBgCardName","MGButton_Arrow_0","MGButton_Arrow_1"];MGStoreMuaCardDT.KEY_CARDTYPE="cardName";MGStoreMuaCardDT.KEY_MENHGIA="amount";MGStoreMuaCardDT.SELECT_ELEMENT="CLICK_SELECT_ELEMENT";
var MGStoreListIcon=MGBaseNode.extend({TypeIcon:null,ListIconData:{},ctor:function(a,b){MGBaseNode.prototype.ctor.call(this);this.ListIconData=a;this.TypeIcon=b;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.MGStoreListIcon);this._mainLayer.getChildByName("MGIconBG_0").setVisible(!1);this._mainLayer.getChildByName("MGIconBG_1").setVisible(!1);this._mainLayer.getChildByName("MGIconBG_2").setVisible(!1);this._initUI();
this._initEventsGame()},_initUI:function(){var a=0;if(this.ListIconData&&void 0!==this.ListIconData)for(var b=0;b<this.ListIconData.length;b++)if(this.ListIconData[b].isEnable){var d=this._mainLayer.getChildByName("MGIconBG_"+a);a++;d&&void 0!==d&&((new MGIconController).initObj(this.ListIconData[b],d,this.TypeIcon),d.setTag(this.ListIconData[b].id),d.setVisible(!0))}}}),MGIconController=cc.Class.extend({CardData:null,IconUI:null,TypeIcon:null,_noTxtUI:null,_iconImg:null,_discountUI:null,ctor:function(){},
initObj:function(a,b,d){this.TypeIcon=d;this.CardData=a;this.IconUI=b;this._initElement();this._initEventsGame()},_initElement:function(){this.CardData&&void 0!==this.CardData&&(this._iconImg=this._noTxtUI=this.IconUI.getChildByName("MGNoText"),this._discountUI=this.IconUI.getChildByName("MGBGDiscount"),this._setVisibleUI(this.CardData))},_initEventsGame:function(){this.IconUI.addClickEventListener(this._onClickUI.bind(this))},_onClickUI:function(a){this.CardData.isMaintenance?(a={},a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=
ConstantsVariable.TEXT.NOTICE,a[MG_POPUP_KEY_DATA.POPUP_MSG]=this.CardData.message,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)):cc.eventManager.dispatchCustomEvent(MGLayerPopupCuaHang.EVENT_CLICK,{TypeIcon:this.TypeIcon,id:a.getTag(),Target:a,CardData:this.CardData})},_setVisibleUI:function(a){this._noTxtUI.setVisible(!0);this._discountUI.setVisible(!1);this._setIconImg(a.imageUrl)},_setDiscountValue:function(a){var b=this._discountUI.getChildByName("MGDiscountValue");b.ignoreContentAdaptWithSize(!0);
b.setString(a)},_setIconImg:function(a){cc.loader.loadImg(a,{isCrossOrigin:!0},this._loadImageComplete.bind(this))},_loadImageComplete:function(a,b){if(b){var d=new cc.Sprite(b),e=this.IconUI.getChildByName("MGNoText");e.removeAllChildren(!0);e.addChild(d);e.setVisible(!0)}}}),MGLayerPopupCuaHang=MGBaseLayer.extend({_panelMain:null,_btnNapXu:null,_btnTieuXu:null,_btnNapIAP:null,_backPanel:null,_currentPanel:null,_btnBackMain:null,isIAPEnable:!1,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},
initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupCuaHang,PreLoaderConfig.PathToResourceDefault);this._btnBackMain=this._mainLayer.getChildByName(MGLayerPopupCuaHang.CUAHANG_BUTTON.BACK);this._setBtnBackVisible(!1);this._initUI();this._initEventsGame();this._onClickHeaderType(!1);this.checkIAPValue()},_initUI:function(){this._panelMain=this._mainLayer.getChildByName("MGPanelMain")},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this);
for(var a in MGLayerPopupCuaHang.CUAHANG_BUTTON){var b=this._mainLayer.getChildByName(MGLayerPopupCuaHang.CUAHANG_BUTTON[a]);"NAP_XU"===a.toString()?this._btnNapXu=b:"TIEU_XU"===a.toString()?this._btnTieuXu=b:"NAP_IAP"===a.toString()&&(this._btnNapIAP=b);b.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))}this._listEvents.push(cc.eventManager.addCustomListener(MGLayerPopupCuaHang.EVENT_CLICK,this._onClickIcon.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGLayerPopupCuaHang.STORE_CLICK_BACK,
this._onClickBack.bind(this)))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGLayerPopupCuaHang.CUAHANG_BUTTON.CLOSE:this._onClose();break;case MGLayerPopupCuaHang.CUAHANG_BUTTON.NAP_XU:this._onClickHeaderType(!1);break;case MGLayerPopupCuaHang.CUAHANG_BUTTON.TIEU_XU:this._onClickHeaderType(!0);break;case MGLayerPopupCuaHang.CUAHANG_BUTTON.BACK:this._onClickBack();break;case MGLayerPopupCuaHang.CUAHANG_BUTTON.NAP_IAP:this._onClickHeaderIAP()}},show:function(){this.setVisible(!0)},
hide:function(){this.setVisible(!1)},_onClickBack:function(a){this._currentPanel&&void 0!==this._currentPanel&&(this._currentPanel.TypeIcon===MGLayerPopupCuaHang.TYPE_ICON.NAP?this._onClickHeaderType(!1):this._onClickHeaderType(!0))},_setBtnBackVisible:function(a){this._btnBackMain.setVisible(a)},_onClickIcon:function(a){a=a.getUserData();if(null!==a){var b=null;a.TypeIcon===MGLayerPopupCuaHang.TYPE_ICON.NAP?(b=new MGStoreNapCardDT(a.CardData,a.TypeIcon),this._setBtnBackVisible(!0)):b=new MGStoreMuaCardDT(a.CardData,
a.TypeIcon);b.setPosition(this._panelMain.getPosition());this._setCurrentPanel(b);this.addChild(this._currentPanel)}},_onClickHeaderType:function(a){this._setBtnBackVisible(!1);this._setVisibleSelectedImg(a)},_onClickHeaderIAP:function(){this._setBtnBackVisible(!1);this.setPanelIAP()},setPanelIAP:function(){var a=new MGStoreIAP;a.setPosition(this._panelMain.getPosition());this._setCurrentPanel(a);this.addChild(this._currentPanel)},_setVisibleSelectedImg:function(a){var b=this._btnNapXu.getChildByName("MGHeaderSelected"),
d=this._btnTieuXu.getChildByName("MGHeaderSelected");b&&void 0!==b&&d&&void 0!==d&&(a?(b.setVisible(!1),d.setVisible(!0),a=new MGStoreMuaCardDT({},MGLayerPopupCuaHang.TYPE_ICON.TIEU),a.setPosition(this._panelMain.getPosition()),this._setCurrentPanel(a),this.addChild(this._currentPanel)):(b.setVisible(!0),d.setVisible(!1),Utilities.getListCard(this._onGetListNap.bind(this))))},_onGetListNap:function(a){a.result&&!this.isIAPEnable&&MGGameInfo.IsChargeCard&&(a=new MGStoreListIcon(a.data,MGLayerPopupCuaHang.TYPE_ICON.NAP),
a.setPosition(this._panelMain.getPosition()),this._setCurrentPanel(a),this.addChild(this._currentPanel))},_onClose:function(){var a={};a[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a)},_setCurrentPanel:function(a){this._currentPanel&&void 0!==this._currentPanel&&(this._currentPanel.removeFromParent(!0),this._backPanel=this._currentPanel);this._currentPanel=a},checkIAPValue:function(){MGGameInfo.IsReview?this.setIAPValue(!0):(this.setIAPValue(!1),this._btnNapXu.setVisible(MGGameInfo.IsChargeCard),
this._btnTieuXu.setVisible(MGGameInfo.IsExchangeCard),MGGameInfo.IsChargeCard||MGGameInfo.IsChargeCard==MGGameInfo.IsExchangeCard||this._setVisibleSelectedImg(!0))},setIAPValue:function(a){this.isIAPEnable=a;this._btnNapIAP.setVisible(a);this._btnNapXu.setVisible(!a);this._btnTieuXu.setVisible(!a);a&&this.setPanelIAP();cc.sys.isNative||cc.sys.isMobile||this._btnNapIAP.setVisible(!1)}});MGLayerPopupCuaHang.EVENT_CLICK="ICON_CLICK_EVENT";MGLayerPopupCuaHang.MUA_CARD="CLICK_DOI_XU";
MGLayerPopupCuaHang.STORE_CLICK_BACK="STORE_CLICK_BACK";MGLayerPopupCuaHang.CUAHANG_BUTTON={CLOSE:"MGButton_Close",NAP_XU:"MGButton_NapXu",TIEU_XU:"MGButton_TieuXu",BACK:"MGButton_Back",NAP_IAP:"MGButton_NapIAP"};MGLayerPopupCuaHang.MAX_LIST=8;MGLayerPopupCuaHang.TYPE_ICON={NAP:500,TIEU:501};PopupEventRegister[MG_POPUPS.SHOW_POPUP_CUAHANG]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupCuaHang,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGLayerPopupRules=MGBaseLayer.extend({button_rule:[],listView:null,layerID:0,listviewButton:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);this.initObj();this.initButton();this.initLayer();this.initEvent();this.listviewButton=this._mainLayer.getChildByName("RulePlayGame").getChildByName("ListViewRule")},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupRules);this.listView=this._mainLayer.getChildByName("MGListView")},initButton:function(){var a=
this._mainLayer.getChildByName("RuleGeneral");this.button_rule[0]=a.getChildByName("MGBtnRule0");this.initBtnDK(this.button_rule[0],"ĐIỀU KHOẢN SỬ DỤNG");this.button_rule[1]=a.getChildByName("MGBtnRule1");this.initBtnDK(this.button_rule[1],"GIỚI THIỆU");this.button_rule[2]=a.getChildByName("MGBtnRule2");this.initBtnDK(this.button_rule[2],"HỎI ĐÁP");a=this._mainLayer.getChildByName("RulePlayGame").getChildByName("ListViewRule");this.button_rule[4]=a.getChildByName("MGBtnRule4");this.initBtnHD(this.button_rule[4],
ResourceManager.MGResourcesMainPopup.HDCGTaiXiu,"TÀI XỈU");this.button_rule[5]=a.getChildByName("MGBtnRule5");this.initBtnHD(this.button_rule[5],ResourceManager.MGResourcesMainPopup.HDCGTLMN,"TIẾN LÊN MIỀN NAM");this.button_rule[6]=a.getChildByName("MGBtnRule6");this.initBtnHD(this.button_rule[6],ResourceManager.MGResourcesMainPopup.HDCGXocDia,"XÓC ĐĨA");this.button_rule[7]=a.getChildByName("MGBtnRule7");this.initBtnHD(this.button_rule[7],ResourceManager.MGResourcesMainPopup.HDCGSam,"XÂM LỐC");this.button_rule[8]=
a.getChildByName("MGBtnRule8");this.initBtnHD(this.button_rule[8],ResourceManager.MGResourcesMainPopup.HDCGXengLuxury,"XÈNG LUXURY");this.button_rule[9]=a.getChildByName("MGBtnRule9");this.initBtnHD(this.button_rule[9],ResourceManager.MGResourcesMainPopup.HDCGBinh,"BINH");this.button_rule[10]=a.getChildByName("MGBtnRule10");this.initBtnHD(this.button_rule[10],ResourceManager.MGResourcesMainPopup.HDCGPhom,"PHỎM");this.button_rule[11]=a.getChildByName("MGBtnRule11");this.initBtnHD(this.button_rule[11],
ResourceManager.MGResourcesMainPopup.HDCGXiTo,"XÌ TỐ");this.button_rule[12]=a.getChildByName("MGBtnRule12");this.initBtnHD(this.button_rule[12],ResourceManager.MGResourcesMainPopup.HDCGLieng,"LIÊNG");this.button_rule[13]=a.getChildByName("MGBtnRule13");this.initBtnHD(this.button_rule[13],ResourceManager.MGResourcesMainPopup.HDCGDemCuu,"ĐẾM CỪU");this.button_rule[14]=a.getChildByName("MGBtnRule14");this.initBtnHD(this.button_rule[14],ResourceManager.MGResourcesMainPopup.HDCGFruitKong,"FRUIT KONG");
this.button_rule[15]=a.getChildByName("MGBtnRule15");this.initBtnHD(this.button_rule[15],ResourceManager.MGResourcesMainPopup.HDCGDiamond777,"DIAMOND 777");this.button_rule[16]=a.getChildByName("MGBtnRule16");this.initBtnHD(this.button_rule[16],ResourceManager.MGResourcesMainPopup.HDCGDaoMo,"ĐÀO MỎ");this.button_rule[17]=a.getChildByName("MGBtnRule17");this.initBtnHD(this.button_rule[17],ResourceManager.MGResourcesMainPopup.HDCGCaoThap,"CAO THẤP");this.button_rule[18]=a.getChildByName("MGBtnRule18");
this.initBtnHD(this.button_rule[18],ResourceManager.MGResourcesMainPopup.HDCGVQMM,"VÒNG QUAY MAY MẮN")},initBtnDK:function(a,b){a.txtTitle="Điều khoản chung";a.txtHeader=b},initBtnHD:function(a,b,d){a.txtTitle="Luật chơi";a.linkImg=b;a.txtHeader=d},initEvent:function(){for(var a=0;a<this.button_rule.length;a++)this.button_rule[a]&&this.button_rule[a].addClickEventListener(this.showRule.bind(this))},initLayer:function(){this.hideAllBackGround();this.button_rule[0].getChildByName("MGBackgroundBtn").setVisible(!0);
this.button_rule[0].getChildByName("iconPointer").setVisible(!0);this.button_rule[0].getChildByName("txtRuleGeneral").setPositionX(30)},showRule:function(a){this.hideAllBackGround();a.getChildByName("MGBackgroundBtn").setVisible(!0);a.getChildByName("iconPointer").setVisible(!0);a.getChildByName("txtRuleGeneral").setPositionX(30);this._mainLayer.getChildByName("RuleTitle").setString(a.txtTitle);this._mainLayer.getChildByName("RuleTitleMain").setString(a.txtHeader);this.listView.removeAllItems();var b=
new MGBaseImageView;b.initObj();a.linkImg&&b.loadTexture(a.linkImg,ccui.Widget.LOCAL_TEXTURE);this.listView.pushBackCustomItem(b)},hideAllBackGround:function(){for(var a=0;a<this.button_rule.length;a++)this.button_rule[a]&&(this.button_rule[a].getChildByName("MGBackgroundBtn").setVisible(!1),this.button_rule[a].getChildByName("iconPointer").setVisible(!1),this.button_rule[a].getChildByName("txtRuleGeneral").setPositionX(23))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d=
{};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},show:function(){this.setVisible(!0)},showByRuleID:function(){var a=this.button_rule[this.layerID];a&&this.showRule(a)},scrollButtonRule:function(){11<=this.layerID?this.listviewButton.jumpToBottom():this.listviewButton.jumpToTop()},hide:function(){this.setVisible(!1)}});
MGLayerPopupRules.LAYER={POLICY:0,ABOUT:1,FAQ:2,TAIXIU:4,TLMN:5,XOCDIA:6,SAMLOC:7,LUXURY:8,BINH:9,PHOM:10,XITO:11,LIENG:12,DEMCUU:13,KONG:14,DIAMOND:15,DAOMO:16,CAOTHAP:17,VQMM:18};PopupEventRegister[MG_POPUPS.SHOW_POPUP_RULES]=function(a){a=a.getUserData();if(null!==a){var b=new MGLayerPopupRules;b.layerID=null!=a.layerID?a.layerID:0;b.showByRuleID();this.showPopup(b,POPUP_SHOW_TYPE.ONLY);b.scrollButtonRule()}};
var MGLayerPopupHoTroKH=MGBaseLayer.extend({ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupHoTroKH);this._mainLayer.getChildByName("MGLableSDT").setString(PreLoaderConfig.LINKS.HOTLINE)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "MGButtonGoFanpage":cc.sys.openURL(PreLoaderConfig.LINKS.FANPAGE)}},
show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}});PopupEventRegister[MG_POPUPS.SHOW_POPUP_HOTROKH]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupHoTroKH,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGLayerPopupTaiUngDung=MGBaseLayer.extend({ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupTaiUngDung)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}});
PopupEventRegister[MG_POPUPS.SHOW_POPUP_TAIUNGDUNG]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupTaiUngDung,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGLayerPopupPersonal=MGBaseLayer.extend({btn_ChangePass:null,btn_NapThe:null,tab_Archive:null,tab_Event:null,tab_Friend:null,label_Content:null,txt_Coin:null,itemAvatar:null,txtNgayThamGia:null,txtChungThuc:null,titleEvent:null,listContentEvent:null,listEvent:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);this.listEvent=[]},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupPersonal);this.btn_ChangePass=this._mainLayer.getChildByName("AvatarInfo").getChildByName("ButtonChangePass");
this.btn_NapThe=this._mainLayer.getChildByName("AvatarInfo").getChildByName("ButtonCharge");this.tab_Archive=this._mainLayer.getChildByName("MGButtonArchive").getChildByName("TabArchive");this.tab_Event=this._mainLayer.getChildByName("MGButtonEvent").getChildByName("TabEvent");this.tab_Friend=this._mainLayer.getChildByName("MGButtonFriend").getChildByName("TabFriend");this.label_Content=this._mainLayer.getChildByName("MGLabelContent");this.txt_Coin=this._mainLayer.getChildByName("AvatarInfo").getChildByName("txtCoin");
this.itemAvatar=this._mainLayer.getChildByName("ItemAvatar");this.txtNgayThamGia=this._mainLayer.getChildByName("AvatarInfo").getChildByName("MGTxtDate");this.txtChungThuc=this._mainLayer.getChildByName("AvatarInfo").getChildByName("MGTextChungThuc");this.titleEvent=this._mainLayer.getChildByName("MGTitleEvent");this.listContentEvent=this._mainLayer.getChildByName("MGListViewEventContent");this.initAvatar();this.initText();this.initButtonDoiMK();this._initEventsGame()},initButtonDoiMK:function(){!0===
MGGameInfo.myInfo.IsOpenID?this.btn_ChangePass.setVisible(!1):this.btn_ChangePass.setVisible(!0)},initText:function(){this.txt_Coin.setString(Utilities.Coin(MGGameInfo.myInfo.Gold));if(15<MGGameInfo.myInfo.DisplayName.length){var a=MGGameInfo.myInfo.DisplayName.slice(0,14)+"...";this.itemAvatar.getChildByName("MGTextName").setString(a)}else this.itemAvatar.getChildByName("MGTextName").setString(MGGameInfo.myInfo.DisplayName);this.itemAvatar.getChildByName("MGTextUID").setString("MTK: "+MGGameInfo.myInfo.UserID);
this.getProfileNgayThamGia()},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MG_POPUP_EVENTS.UPDATE_AVATAR.toString(),this._updateAvatar.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("GET_HIDE_SELECT_EVENT",this.getFalseEvents.bind(this)));this.btn_ChangePass.addClickEventListener(this.callChangePass.bind(this));this.btn_NapThe.addClickEventListener(this.callCuaHang.bind(this))},initAvatar:function(){var a=
MGGameInfo.myInfo.Avatar;this.itemAvatar.getChildByName("CircleAvatar").loadTexture(PreLoaderConfig.PathToAvatar+a+".png",ccui.Widget.PLIST_TEXTURE)},_updateAvatar:function(a){var b=null;a&&(b=a.getUserData());b?(b[MG_POPUP_KEY_DATA.AVATAR_ID]=b[MG_POPUP_KEY_DATA.AVATAR_ID]||0,this.itemAvatar.getChildByName("CircleAvatar").loadTexture(PreLoaderConfig.PathToAvatar+b[MG_POPUP_KEY_DATA.AVATAR_ID]+".png",ccui.Widget.PLIST_TEXTURE)):this.itemAvatar.getChildByName("CircleAvatar").loadTexture(PreLoaderConfig.PathToAvatarDefault,
ccui.Widget.PLIST_TEXTURE)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "MGButtonArchive":this.hideTab();this.tab_Archive.setVisible(!0);this.label_Content.setVisible(!0);this.label_Content.setString("Bạn chưa có thành tích nào");break;case "MGButtonEvent":this.hideTab();this.tab_Event.setVisible(!0);this.titleEvent.setVisible(!0);this.listContentEvent.setVisible(!0);
this.getListEventGame();break;case "MGButtonFriend":this.hideTab();this.tab_Friend.setVisible(!0);this.label_Content.setVisible(!0);this.label_Content.setString("Chức năng đang được cập nhật");break;case "MGButtonUploadAvatar":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_CHANGE_AVATAR,{})}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},callChangePass:function(){cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_CHANGE_PASSWORD,{})},callCuaHang:function(){cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_CUAHANG,
{})},hideTab:function(){this.tab_Archive.setVisible(!1);this.tab_Event.setVisible(!1);this.tab_Friend.setVisible(!1);this.titleEvent.setVisible(!1);this.listContentEvent.setVisible(!1);this.label_Content.setVisible(!1)},getProfileNgayThamGia:function(a){Utilities.verifyToken(MGGameInfo.token4web,this._loadNgayThamGia.bind(this))},_loadNgayThamGia:function(a){a.result&&(this.txtNgayThamGia.setString(a.data.createOn.slice(0,10)),!1===a.data.isUpdateInfo?this.txtChungThuc.setString("Chưa chứng thực"):
this.txtChungThuc.setString("Chứng thực"))},getListEventGame:function(){Utilities.getListEvent(this._getContentEvent.bind(this))},_getContentEvent:function(a){this.listContentEvent.removeAllChildren();var b=this.listContentEvent.getPosition();if(!0===a.result)for(var d=0;d<a.data.length;d++){var e=new MGItemContentEvent;e.initObj();e.setIDEvent(a.data[d].id);e.setTextGiaiThuong(a.data[d].description);e.setTextSuKien(a.data[d].eventName);e.setTextNgayTrung(a.data[d].createDate);e.setTextNgayHetHan(a.data[d].expireDate);
e.setQua(a.data[d].isGift);e.setPosition(b.x,b.y-38);this.listContentEvent.addChild(e.contentEvent);this.listEvent.push(e)}},getFalseEvents:function(a){for(a=0;a<this.listEvent.length;a++)this.listEvent[a]._isShowEvent=!1}});PopupEventRegister[MG_POPUPS.SHOW_POPUP_PERSONAL]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupPersonal,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGItemContentEvent=MGBaseNode.extend({contentEvent:null,_textGiaiThuong:null,_textSuKien:null,_textNgayTrung:null,_textNgayHetHan:null,_textQua:null,_buttonNhan:null,_idEvent:null,_isShowEvent:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._isShowEvent=!1},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGItemContentEvent);this.contentEvent=this.getChildByName("MGContentEvent");this._textGiaiThuong=this.contentEvent.getChildByName("MGTextGiaiThuong");
this._textGiaiThuong.ignoreContentAdaptWithSize(!0);this._textSuKien=this.contentEvent.getChildByName("MGTextSuKien");this._textSuKien.ignoreContentAdaptWithSize(!0);this._textNgayTrung=this.contentEvent.getChildByName("MGTextNgayTrung");this._textNgayTrung.ignoreContentAdaptWithSize(!0);this._textNgayHetHan=this.contentEvent.getChildByName("MGTextNgayHetHan");this._textNgayHetHan.ignoreContentAdaptWithSize(!0);this._textQua=this.contentEvent.getChildByName("MGTextQua");this._buttonNhan=this.contentEvent.getChildByName("MGButtonNhanEvent");
this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._buttonNhan.addClickEventListener(this.openEvent.bind(this));cc.eventManager.addCustomListener("GET_CARD_TYPE",this.changeActiveQua.bind(this))},setIDEvent:function(a){this._idEvent=a},setTextGiaiThuong:function(a){this._textGiaiThuong.setString(a)},setTextSuKien:function(a){this._textSuKien.setString(a)},setTextNgayTrung:function(a){this._textNgayTrung.setString(a)},setTextNgayHetHan:function(a){this._textNgayHetHan.setString(a)},
setQua:function(a){!0===a?(this._textQua.setVisible(!0),this._buttonNhan.setVisible(!1)):(this._textQua.setVisible(!1),this._buttonNhan.setVisible(!0))},openEvent:function(){cc.eventManager.dispatchCustomEvent("GET_HIDE_SELECT_EVENT",{});cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_SELECT_CARD,{});this._isShowEvent=!0},changeActiveQua:function(a){a=a.getUserData();!0===this._isShowEvent&&this._buttonNhan.isVisible()&&Utilities.getEventContent(this._idEvent,a.target,this.showPopupResult.bind(this))},
showPopupResult:function(a){a&&(a.result&&this.setQua(!0),this._isShowEvent=!1)}}),MGLayerPopupSelectCard=MGBaseLayer.extend({_listCard:null,_idCard:null,_idEvents:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);this._listCard=[];this._idCard=3},initObj:function(){MGBaseLayer.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerCardDT);this._initEventsGame()},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this);for(var a=
0;3>a;a++)this._listCard[a]=this._mainLayer.getChildByName("MGCard"+a),this._listCard[a].setTouchEnabled(!0),this._listCard[a].setTag("10"+a),this._listCard[a].addClickEventListener(this.selectCard.bind(this))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "MGButtonCapNhat":cc.eventManager.dispatchCustomEvent("GET_CARD_TYPE",{target:this._idCard}),d={},
d[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},selectCard:function(a){a=a.getTag();this.hideAllStoke();for(var b=0;3>b;b++)this._listCard[b].getTag()===a&&(this._listCard[b].getChildByName("MGStokeCard").setVisible(!0),this._idCard=b+1)},hideAllStoke:function(){for(var a=0;3>a;a++)this._listCard[a].getChildByName("MGStokeCard").setVisible(!1)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}});
PopupEventRegister[MG_POPUPS.SHOW_POPUP_SELECT_CARD]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupSelectCard,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGLayerPopupBangXepHang=MGBaseLayer.extend({data:[],ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupBangXepHang)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},loadTopGames:function(a){a=
null;if(MGGameInfo.GAME_INFO)for(var b in MGGameInfo.GAME_INFO)a=MGGameInfo.GAME_INFO[b].GameID;Utilities.getBangXepHang(this._loadDataLine.bind(this),a,MGGameInfo.myInfo.UserID)},_loadDataLine:function(a){if(!0===a.result)for(var b=0;b<a.data.length;b++){var d=new MGNodePopupBangXepHang,e=this._mainLayer.getChildByName("MGBackgroundTab");d.setPosition(e.x,e.y-35*b);d.loadData(b+1,a.data[b].Nick,a.data[b].CoinWinLose);this.addChild(d)}}});
PopupEventRegister[MG_POPUPS.SHOW_POPUP_BANGXEPHANG]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupBangXepHang,a.initObj(),a.loadTopGames(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGNodePopupBangXepHang=MGBaseNode.extend({top:null,nhanvat:null,tienthang:null,background:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.initObj()},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGNodePopupBangXepHang);this.top=this._mainLayer.getChildByName("MGTextLineTop");this.top.ignoreContentAdaptWithSize(!0);this.nhanvat=this._mainLayer.getChildByName("MGTextLineNhanVat");this.nhanvat.ignoreContentAdaptWithSize(!0);this.tienthang=this._mainLayer.getChildByName("MGTextLineTienThang");
this.tienthang.ignoreContentAdaptWithSize(!0);this.background=this._mainLayer.getChildByName("MGBackgroundLine")},loadBackgroundLine:function(a){1===a%2?this.background.setVisible(!1):this.background.setVisible(!0)},loadData:function(a,b,d){this.loadBackgroundLine(a);this.top.setString(a);this.nhanvat.setString(b);this.tienthang.setString(Utilities.Coin(Math.floor(d)))}}),MGNodePopupPageTradeHistory=MGBaseNode.extend({textPage:null,onVisible:null,value:null,onPage:-1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},
initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGNodePopupPageTradeHistory);this.buttonPage=this._mainLayer.getChildByName("buttonPage");this.backgroundPage=this._mainLayer.getChildByName("buttonPage").getChildByName("backGroundSelect");this.textPage=this._mainLayer.getChildByName("buttonPage").getChildByName("txtPageNum");this.setBackground(!1);this.setVisiblePage(!0);this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);
this.buttonPage.addClickEventListener(this.changePageHistory.bind(this))},setBackground:function(a){!0===a?this.backgroundPage.setVisible(!0):this.backgroundPage.setVisible(!1)},setVisiblePage:function(a){!0===a?(this.setVisible(!0),this.onVisible=1):(this.setVisible(!1),this.onVisible=0)},setText:function(a){this.textPage.setString(a)},setValue:function(a){this.value=a},changePageHistory:function(a){cc.eventManager.dispatchCustomEvent("SHOW_HISTORY",{target:this})}}),MGNodePopupTradeHistory=MGBaseNode.extend({background:null,
maGD:null,ngay:null,dichvu:null,phatsinh:null,sodu:null,mota:null,chitiet:null,isTextCT:0,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._init()},_init:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGNodePopupTradeHistory);this.background=this._mainLayer.getChildByName("MGBackground");this.maGD=this._mainLayer.getChildByName("ItemMGD");this.ngay=this._mainLayer.getChildByName("ItemTG");this.dichvu=this._mainLayer.getChildByName("ItemDV");this.phatsinh=this._mainLayer.getChildByName("ItemPS");
this.sodu=this._mainLayer.getChildByName("ItemSD");this.mota=this._mainLayer.getChildByName("ItemMT");this.chitiet=this._mainLayer.getChildByName("ItemCT")},setBackGround:function(a){1===a%2?this.background.setVisible(!0):this.background.setVisible(!1)},setMaGD:function(a){this.maGD.setString(a)},setThoiGian:function(a){this.ngay.setString(a)},setDichVu:function(a){var b=a.search("-");-1===b?this.dichvu.setString(a.slice(0,a.length)):this.dichvu.setString(a.slice(b+2,a.length))},setPhatSinh:function(a){a=
Utilities.Coin(a);this.phatsinh.setString(a)},setSoDu:function(a){a=Utilities.Coin(a);this.sodu.setString(a)},setMoTa:function(a,b){1===b?this.mota.setString("Phiên "+a):this.mota.setString(a)},setChiTiet:function(a){"Thắng xu"===a?this.chitiet.setString("Cộng tiền"):"Thua xu"===a?this.chitiet.setString("Trừ tiền"):this.chitiet.setString(a)}}),MGLayerPopupTradeHistory=MGBaseLayer.extend({_onTab:1,_panelGiaoDich:null,_buttonChoiXu:null,_buttonNapXu:null,_buttonDoiXu:null,_backgroundChoiXu:null,_backgroundNapXu:null,
_backgroundDoiXu:null,_totalPage:null,_arrPageH:[],ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupTradeHistory);this._panelGiaoDich=this._mainLayer.getChildByName("panelGiaoDich");this._buttonChoiXu=this._mainLayer.getChildByName("ButtonChoiXu");this._buttonNapXu=this._mainLayer.getChildByName("ButtonNapXu");this._buttonDoiXu=this._mainLayer.getChildByName("ButtonDoiXu");this._backgroundChoiXu=this._mainLayer.getChildByName("ButtonChoiXu").getChildByName("TabSelectChoiXu");
this._backgroundNapXu=this._mainLayer.getChildByName("ButtonNapXu").getChildByName("TabSelectNapXu");this._backgroundDoiXu=this._mainLayer.getChildByName("ButtonDoiXu").getChildByName("TabSelectDoiXu");this._backgroundNapXu.setVisible(!1);this._backgroundDoiXu.setVisible(!1);this.checkIAPValue();this._initEventsGame()},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this);this._buttonChoiXu.addClickEventListener(this.clickButtonChoiXu.bind(this));this._buttonNapXu.addClickEventListener(this.clickButtonNapXu.bind(this));
this._buttonDoiXu.addClickEventListener(this.clickButtonDoiXu.bind(this));this._listEvents.push(cc.eventManager.addCustomListener("SHOW_HISTORY",this.showPageHistory.bind(this)))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d)}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},setVisibleTab:function(){this._backgroundChoiXu.setVisible(!1);
this._backgroundNapXu.setVisible(!1);this._backgroundDoiXu.setVisible(!1)},clickButtonChoiXu:function(){this.setVisibleTab();this._backgroundChoiXu.setVisible(!0);this._onTab=1;this.getLichSuGD()},clickButtonNapXu:function(){this.setVisibleTab();this._backgroundNapXu.setVisible(!0);this._onTab=2;this.getLichSuGD()},clickButtonDoiXu:function(){this.setVisibleTab();this._backgroundDoiXu.setVisible(!0);this._onTab=3;this.getLichSuGD()},getLichSuGD:function(){1===this._onTab?Utilities.getChoiXu(10,1,
this._initGetHistory.bind(this)):2===this._onTab?Utilities.getLogCards(10,1,this._initGetHistory.bind(this)):Utilities.getLogExchageCards(10,1,this._initGetHistory.bind(this))},_initGetHistory:function(a){var b=this._panelGiaoDich.getPosition();this.removePage();if(0<a.data.length){for(var d=0;d<a.data.length;d++){var e=new MGNodePopupTradeHistory;e.setBackGround(d);1===this._onTab&&(e.setMaGD(a.data[d].id),e.setThoiGian(a.data[d].createDate),e.setDichVu(a.data[d].reasonName),e.setPhatSinh(a.data[d].amount),
e.setSoDu(a.data[d].afterMoney),e.setMoTa(a.data[d].matchId,1),e.setChiTiet(a.data[d].detail));2===this._onTab&&(e.setMaGD(a.data[d].id),e.setThoiGian(a.data[d].transDate),e.setDichVu("Nạp"),e.setPhatSinh(a.data[d].cardAmount),e.setSoDu(a.data[d].coin),e.setMoTa(a.data[d].cardTypePartner,2),e.setChiTiet(a.data[d].description));3===this._onTab&&(e.setMaGD(a.data[d].id),e.setThoiGian(a.data[d].createDate),e.setDichVu("Đổi"),e.setPhatSinh(a.data[d].valueExchange),e.setSoDu(a.data[d].cardAmount),e.setMoTa(a.data[d].cardType,
2),e.setChiTiet(a.data[d].description));this._panelGiaoDich.addChild(e);e.setPosition(b.x-b.x/4,b.y-37*(d+4))}this._totalPage=Math.ceil((100<a.data[0].totalRow?100:a.data[0].totalRow)/10);b=this._mainLayer.getChildByName("PageNum");a=null;for(d=0;d<this._totalPage;d++)a=new MGNodePopupPageTradeHistory,a.initObj(),a.setText(d+1),a.setValue(d+1),1>=this._totalPage?a.setPosition(b.x,b.y):(2>=this._totalPage?a.setPosition(b.x-15+25*d,b.y):3>=this._totalPage?a.setPosition(b.x-25+25*d,b.y):4>=this._totalPage?
a.setPosition(b.x-40+25*d,b.y):(a.setPosition(b.x-40+25*d,b.y),3<d&&a.setVisiblePage(!1)),this.addChild(a),this._arrPageH.push(a));4<this._totalPage&&(a=new MGNodePopupPageTradeHistory,a.initObj(),a.setText(">"),a.setPosition(b.x+60,b.y),a.setValue(11),a.setVisiblePage(!0),this.addChild(a),this._arrPageH.push(a),a=new MGNodePopupPageTradeHistory,a.initObj(),a.setText(">>"),a.setPosition(b.x+85,b.y),a.setValue(12),a.setVisiblePage(!0),this.addChild(a),this._arrPageH.push(a),a=new MGNodePopupPageTradeHistory,
a.initObj(),a.setText("<<"),a.setPosition(b.x-90,b.y),a.setValue(13),a.setVisiblePage(!1),this.addChild(a),this._arrPageH.push(a),a=new MGNodePopupPageTradeHistory,a.initObj(),a.setText("<"),a.setPosition(b.x-65,b.y),a.setValue(14),a.setVisiblePage(!1),this.addChild(a),this._arrPageH.push(a));0!==this._arrPageH.length&&(this._arrPageH[0].setBackground(!0),this._arrPageH[0].onPage=1);for(d=0;d<this._arrPageH.length;d++);}},loadPage:function(a){var b=this._panelGiaoDich.getPosition();this._panelGiaoDich.removeAllChildren(!0);
if(0<a.data.length)for(var d=0;d<a.data.length;d++){var e=new MGNodePopupTradeHistory;e.setBackGround(d);1===this._onTab&&(e.setMaGD(a.data[d].id),e.setThoiGian(a.data[d].createDate),e.setDichVu(a.data[d].reasonName),e.setPhatSinh(a.data[d].amount),e.setSoDu(a.data[d].afterMoney),e.setMoTa(a.data[d].matchId,1),e.setChiTiet(a.data[d].detail));2===this._onTab&&(e.setMaGD(a.data[d].id),e.setThoiGian(a.data[d].transDate),e.setDichVu("Nạp"),e.setPhatSinh(a.data[d].cardAmount),e.setSoDu(a.data[d].coin),
e.setMoTa(a.data[d].cardTypePartner,2),e.setChiTiet(a.data[d].description));3===this._onTab&&(e.setMaGD(a.data[d].id),e.setThoiGian(a.data[d].createDate),e.setDichVu("Đổi"),e.setPhatSinh(a.data[d].valueExchange),e.setSoDu(a.data[d].cardAmount),e.setMoTa(a.data[d].cardType,2),e.setChiTiet(a.data[d].description));this._panelGiaoDich.addChild(e);e.setPosition(b.x-b.x/4,b.y-37*(d+4))}},getAPIPage:function(a){1===this._onTab?Utilities.getChoiXu(10,a,this.loadPage.bind(this)):2===this._onTab?Utilities.getLogCards(10,
a,this.loadPage.bind(this)):Utilities.getLogExchageCards(10,a,this.loadPage.bind(this))},showPageHistory:function(a){a=a.getUserData().target.value;11>a?this.changePage(a):(11===a&&this.nextPage(),12===a&&this.endPage(),13===a&&this.beganPage(),14===a&&this.previousPage())},changePage:function(a){for(var b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(this._arrPageH[b].setBackground(!1),this._arrPageH[b].onPage=0);for(b=0;b<this._arrPageH.length;b++)if(this._arrPageH[b].value===a)return this._arrPageH[b].setBackground(!0),
this._arrPageH[b].onPage=1,4<this._arrPageH.length&&(0===b?(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0)):b===this._arrPageH.length-5?(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1),
this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1)):(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0))),this.getAPIPage(this._arrPageH[b].value),!0},nextPage:function(){for(var a=0,b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(a=b);if(0===this._arrPageH[a+1].onVisible){var d=this._mainLayer.getChildByName("PageNum");
this._arrPageH[a-3].setVisiblePage(!1);for(b=0;4>b;b++)this._arrPageH[a-2+b].setVisiblePage(!0),this._arrPageH[a-2+b].setPosition(d.x-40+25*b,d.y)}if(11>this._arrPageH[a+1].value)return this._arrPageH[a].setBackground(!1),this._arrPageH[a+1].setBackground(!0),this._arrPageH[a].onPage=0,this._arrPageH[a+1].onPage=1,this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH.length-5===a+1&&(this._arrPageH[this._arrPageH.length-
3].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1)),this.getAPIPage(this._arrPageH[a+1].value),!0},previousPage:function(){for(var a=0,b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(a=b);if(0===this._arrPageH[a-1].onVisible){var d=this._mainLayer.getChildByName("PageNum");this._arrPageH[a+3].setVisiblePage(!1);for(b=0;4>b;b++)this._arrPageH[a-1+b].setVisiblePage(!0),this._arrPageH[a-1+b].setPosition(d.x-40+25*b,d.y)}11>this._arrPageH[a-1].value&&(this._arrPageH[a].setBackground(!1),
this._arrPageH[a-1].setBackground(!0),this._arrPageH[a].onPage=0,this._arrPageH[a-1].onPage=1,this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0),0===a-1&&(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1)),this.getAPIPage(this._arrPageH[a-1].value))},beganPage:function(){for(var a=0;a<this._arrPageH.length;a++)1===this._arrPageH[a].onPage&&(this._arrPageH[a].setBackground(!1),
this._arrPageH[a].onPage=0);for(a=0;a<this._arrPageH.length-4;a++)this._arrPageH[a].setVisiblePage(!1);for(a=0;4>a;a++){var b=this._mainLayer.getChildByName("PageNum");this._arrPageH[a].setVisiblePage(!0);this._arrPageH[a].setPosition(b.x-40+25*a,b.y)}this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0);this._arrPageH[0].onPage=
1;this._arrPageH[0].setBackground(!0);this.getAPIPage(this._arrPageH[0].value)},endPage:function(){for(var a=0;a<this._arrPageH.length;a++)1===this._arrPageH[a].onPage&&(this._arrPageH[a].setBackground(!1),this._arrPageH[a].onPage=0);for(var b=0;b<this._arrPageH.length-4;b++)this._arrPageH[b].setVisiblePage(!1);a=0;for(b=this._arrPageH.length-8;b<this._arrPageH.length-4;b++){var d=this._mainLayer.getChildByName("PageNum");this._arrPageH[b].setVisiblePage(!0);this._arrPageH[b].setPosition(d.x-40+25*
a,d.y);a++}this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-5].onPage=1;this._arrPageH[this._arrPageH.length-5].setBackground(!0);this.getAPIPage(this._arrPageH[this._arrPageH.length-5].value)},checkIAPValue:function(){MGGameInfo.IsReview?(this._buttonNapXu.setVisible(!1),this._buttonDoiXu.setVisible(!1)):
(this._buttonNapXu.setVisible(MGGameInfo.IsChargeCard),this._buttonDoiXu.setVisible(MGGameInfo.IsExchangeCard))},removePage:function(){this._panelGiaoDich.removeAllChildren(!0);for(var a=0;a<this._arrPageH.length;a++)this._arrPageH[a].setVisiblePage(!1);this._arrPageH=[]}});PopupEventRegister[MG_POPUPS.SHOW_POPUP_TRADE_HISTORY]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupTradeHistory,a.initObj(),a.getLichSuGD(),this.showPopup(a,POPUP_SHOW_TYPE.ONLY))};
var MGNodePopupMailInfo=MGBaseNode.extend({backgroundMail:null,mailTitle:null,mailSender:null,mailContent:null,strMailContent:null,alreadyReadMail:null,buttonMo:null,messid:123,_nickName:null,contentMail:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._initObj();this._initEvent()},_initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGNodePopupMailInfo);this.panelMail=this._mainLayer.getChildByName("panelMail");this.backgroundMail=this.panelMail.getChildByName("MGBackground");
this.mailTitle=this.panelMail.getChildByName("txtMailTitle");this.mailSender=this.panelMail.getChildByName("txtMailSender");this.mailContent=this.panelMail.getChildByName("txtMail");this.buttonMo=this.panelMail.getChildByName("ButtonReceive");this.setBackgroundMail(!0)},_initEvent:function(){this.panelMail.addClickEventListener(this.showMail.bind(this));this.buttonMo.addClickEventListener(this.showMail.bind(this))},showMail:function(){Utilities.getEmailDetails(this.messid,this._loadEmailContent.bind(this))},
setBackgroundMail:function(a){!0===a?this.backgroundMail.setVisible(!1):this.backgroundMail.setVisible(!0)},setMailTitle:function(a){this.mailTitle.setString(a)},setMailContent:function(a){this.strMailContent=a;80<a.length?(a=a.slice(0,23),this.mailContent.setString(a+" ...")):this.mailContent.setString(a)},setMessId:function(a,b){this.messid=a;this.alreadyReadMail=b},_loadEmailContent:function(a){this.contentMail=a.data;cc.eventManager.dispatchCustomEvent("SHOW_MAIL_CONTENT",{target:this})},setMailSenderNickName:function(a,
b){var d=b.slice(0,10)+" "+b.slice(11,19);this.mailSender.setString(a+" - "+d);this._nickName=a}}),MGNodePopupMailContent=MGBaseNode.extend({mailContentTitle:null,mailContentSender:null,mailContentContent:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.initObj()},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGNodePopupMailContent);this.mailContentTitle=this._mainLayer.getChildByName("txtMailTitle");this.mailContentSender=this._mainLayer.getChildByName("txtMailSender");
this.mailContentContent=this._mainLayer.getChildByName("txtMailContent")},setMailContentTitle:function(a){this.mailContentTitle.setString(a)},setMailContentSender:function(a){this.mailContentSender.setString(a)},setMailContentContent:function(a){this.mailContentContent.setString(a)}}),MGLayerPopupMail=MGBaseLayer.extend({_mailNumber:null,_scollMail:null,_buttonBack:null,_mailContent:null,_alreadyRead:null,_tempMessId:null,_arr_mail:[],_countMail:0,ctor:function(){MGBaseLayer.prototype.ctor.call(this);
this._initEventsGame()},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupMail);this._mailNumber=this._mainLayer.getChildByName("txtMailNumber");this._scollMail=this._mainLayer.getChildByName("listViewMail");this._buttonBack=this._mainLayer.getChildByName("ButtonBack");this._buttonBack.setVisible(!1);this._mailContent=this._mainLayer.getChildByName("node_mailContent")},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener("SHOW_MAIL_CONTENT",
this.showMailContent.bind(this)))},showMailContent:function(a){a=a.getUserData();this._scollMail.setVisible(!1);this._mailContent.setVisible(!0);this._buttonBack.setVisible(!0);var b=new MGNodePopupMailContent;b.setMailContentTitle(a.target.contentMail.data.title);b.setMailContentSender(a.target._nickName);b.setMailContentContent(a.target.contentMail.data.messageContent);this._mailContent.addChild(b);!1===a.target.alreadyReadMail&&(a.target.setBackgroundMail(!0),a.target.alreadyReadMail=!0);-1<a.target.contentMail.countMess&&
(this._mailNumber.setString("("+a.target.contentMail.countMess+")"),cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.NEW_EMAIL,{haveNew:0<a.target.contentMail.countMess}))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "ButtonBack":this._scollMail.setVisible(!0);this._buttonBack.setVisible(!1);this._mailContent.removeAllChildren(!0);this._mailContent.setVisible(!1);
break;case "MGButtonTongThu":this._scollMail.setVisible(!0),this._buttonBack.setVisible(!1),this._mailContent.removeAllChildren(!0),this._mailContent.setVisible(!1)}},getEmail:function(a){Utilities.getEmails(this._onLoadedEmail.bind(this))},_onLoadedEmail:function(a){if(!0===a.result){for(var b=this._scollMail.getPosition(),d=0;d<a.data.length;d++){var e=new MGNodePopupMailInfo,f=e._mainLayer.getChildByName("panelMail");e.setMessId(a.data[d].messID,a.data[d].alreadyRead);e.setMailTitle(a.data[d].title);
e.setMailSenderNickName(a.data[d].senderNickName,a.data[d].dateSend);e.setMailContent(a.data[d].messageContent);e.setPosition(b.x,b.y-90*d);e.setBackgroundMail(a.data[d].alreadyRead);f.removeFromParent(!1);this._scollMail.pushBackCustomItem(f);this._arr_mail.push(f);!1===a.data[d].alreadyRead&&this._countMail++}this._mailNumber.setString("("+this._countMail+")");cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.NEW_EMAIL,{haveNew:0<this._countMail})}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},
setDispose:function(){MGBaseLayer.prototype.setDispose.call(this)}});PopupEventRegister[MG_POPUPS.SHOW_POPUP_MAIL]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupMail,a.initObj(),a.getEmail(),this.showPopup(a,POPUP_SHOW_TYPE.ONLY))};
var MGItemAvatar=MGBaseImageView.extend({_imgHover:null,_isChoice:null,id:null,ctor:function(){MGBaseImageView.prototype.ctor.call(this)},initObj:function(){MGBaseImageView.prototype.initObj.call(this);this._imgHover=new MGBaseSprite;this._imgHover.setSpriteFrame("ImageAvatarHover.png");this._imgHover.setVisible(!1);this.addChild(this._imgHover);this._initEventsGame();this._imgHover.setPosition(cc.p(this.getContentSize().width/2,this.getContentSize().height/2));this._isChoice=!1},_initEventsGame:function(){MGBaseImageView.prototype._initEventsGame.call(this);
this.setMouseHoverEnabled(!0);this.addMouseHoverEventListener(this._onHover.bind(this))},loadImage:function(a){this.loadTexture("ImageAvatar_"+a+".png",ccui.Widget.PLIST_TEXTURE)},_onHover:function(a,b){b===ConstantsVariable.MG_MOUSE_EVENT.MOUSE_HOVER?this._imgHover.setVisible(!0):this._isChoice||this._imgHover.setVisible(!1)},setChoise:function(a){this._isChoice=a;this._imgHover.setVisible(a)}}),MGLayerPopupChangeAvatar=MGBaseLayer.extend({_idAvatar:null,listAvatar:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);
this.listAvatar=[];this.initObj();this._initEventsGame()},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UIMGLayerPopupChangeAvatar);for(var a=1;a<=MGLayerPopupChangeAvatar.AVATAR_LENGTH;a++){var b=new MGItemAvatar;b.setPosition(this._mainLayer.getChildByName("MGImgAvatar_"+a).getPosition());b.loadImage(a);b.setTouchEnabled(!0);b.addClickEventListener(this.onClickBtnItemAvatar.bind(this));b.id=a;b.initObj();this.listAvatar.push(b);this._mainLayer.addChild(b)}this._idAvatar=
MGGameInfo.myInfo.Avatar;this.setChoiseInListImage(this._idAvatar,!0)},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this)},onClickBtnItemAvatar:function(a,b){for(var d=1;d<=MGLayerPopupChangeAvatar.AVATAR_LENGTH;d++)this.setChoiseInListImage(d,!1);a.id&&(this._idAvatar=a.id,this.setChoiseInListImage(a.id,!0))},setChoiseInListImage:function(a,b){for(var d=0;d<MGLayerPopupChangeAvatar.AVATAR_LENGTH;d++)a==this.listAvatar[d].id&&this.listAvatar[d].setChoise(b)},onClickBtnFromCocostudio:function(a,
b){switch(a.getName()){case "MGButtonClose":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "MGBtnChon":d={},d[MG_POPUP_KEY_DATA.AVATAR_ID]=this._idAvatar,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.UPDATE_AVATAR,d),Utilities.updateAvatar(MGGameInfo.myInfo.UserID,this._idAvatar.toString(),this._onCompleteUpdateAvatar.bind(this))}},_onCompleteUpdateAvatar:function(a){a.result&&(this.hide(),a={},a[MG_POPUP_KEY_DATA.POPUP]=this,
cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a))},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},setDispose:function(){for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a])}});PopupEventRegister[MG_POPUPS.SHOW_POPUP_CHANGE_AVATAR]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupChangeAvatar,this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};MGLayerPopupChangeAvatar.AVATAR_LENGTH=12;
var MGLayerPopupCreateName=MGBaseLayer.extend({txtNickName:null,strNickName:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UILayerPopupCreateName);this._initUI();this._initEventsGame()},_initUI:function(){this.txtNickName=new MGBaseEditBox(this._mainLayer.getChildByName("MGTxtNickName"),"BGWhite.png");this.txtNickName.setFontColor(cc.color(0,0,0,255));this.txtNickName.setPlaceholderFontColor(cc.color(0,0,
0,255));this.txtNickName.setVisibleBackground(!1);this.txtNickName.maxLength=15;this.addChild(this.txtNickName)},_initEventsGame:function(){for(var a in MGLayerPopupCreateName.REGIT_BUTTON)this._mainLayer.getChildByName(MGLayerPopupCreateName.REGIT_BUTTON[a]).addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGLayerPopupCreateName.REGIT_BUTTON.CLOSE:var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,
d);break;case MGLayerPopupCreateName.REGIT_BUTTON.BTN_CONFIRM:this._onClickSetName()}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},_onClickSetName:function(){var a=getTextInput(this.txtNickName);""===a?showPopupMessage("Thất Bại","Thông tin không thể để trống"):6>a.length||0==this.isName(a)?showPopupMessage("Thất Bại","Tên hiển thị phải có tối thiểu 6 kí tự và tối đa 15 kí tự, chỉ bao gồm ký tự từ a-z, A-Z và 0-9."):(this.strNickName=a,Utilities.getAPIUpdateDisplayName(this.onGettedApi.bind(this),
a))},onGettedApi:function(a){a.result&&(MGGameInfo.myInfo.DisplayName=this.strNickName,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{}),a={},a[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a))},isName:function(a){for(var b=null,d=0,e=0;e<a.length;e++)if(b=a.charCodeAt([e]),64<b&&91>b||96<b&&123>b||47<b&&58>b)d++;else return!1;return!0}});
showPopupMessage=function(a,b,d){a={title:a,message:b};"function"===typeof d&&(a.callback=d);cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)};getTextInput=function(a){return a.getString()};MGLayerPopupCreateName.REGIT_BUTTON={CLOSE:"MGButtonClose",BTN_CONFIRM:"MGButton_Confirm"};PopupEventRegister[MG_POPUPS.SHOW_POPUP_CREATE_NAME]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupCreateName,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var MGLayerPopupGiftCode=MGBaseLayer.extend({edtiBoxCode:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMainPopup.UILayerGifCode);this.edtiBoxCode=new MGBaseEditBox(this._mainLayer.getChildByName("TextField_Code"),"BackGroundLineHoTroKH.png");this.edtiBoxCode.setName("MGEditBoxCode");this.edtiBoxCode.maxLength=15;this.edtiBoxCode.setVisibleBackground(!1);this.addChild(this.edtiBoxCode);this._mainLayer.getChildByName("MGBackGround").setTouchEnabled(!0)},
onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "Button_Close":var d={};d[MG_POPUP_KEY_DATA.POPUP]=this;cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,d);break;case "Button_Nap":d=this.edtiBoxCode.getString(),""==d?showPopupMessage("Thất Bại","GiftCode không thể để trống"):Utilities.checkGiftCode(d,this.onCheckGiftCode.bind(this))}},onCheckGiftCode:function(a){Utilities.showLog(JSON.stringify(a));a.result?-1==a.data.code?showPopupMessage("Thất Bại",a.data.message):(showPopupMessage("Thành Công",
a.data.message),a={},a[MG_POPUP_KEY_DATA.POPUP]=this,cc.eventManager.dispatchCustomEvent(MG_POPUP_EVENTS.CLOSE,a)):showPopupMessage("Thất Bại",a.message)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}});PopupEventRegister[MG_POPUPS.SHOW_POPUP_GIFT_CODE]=function(a){null!==a.getUserData()&&(a=new MGLayerPopupGiftCode,a.initObj(),this.showPopup(a,POPUP_SHOW_TYPE.OVERRIDE))};
var DEFAULT_TIME_DELAY=2,MGLayerPopup=MGBaseLayer.extend({_currentPopup:null,_listPopup:null,_listEvent:null,_backGround:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);this._listPopup=[];this._listEvent=[];this._initBackground();this._initEvents();this.hide()},_initBackground:function(){var a=cc.winSize;this.setName("MGLayerPopup");this.setContentSize(a.width,a.height);this.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);this.setBackGroundColor(cc.color(0,0,0));this.setBackGroundColorOpacity(0);
this.setTouchEnabled(!0);this.setMouseHoverEnabled(!0);this._backGround=new MGBaseImageView;this._backGround.loadTexture("BackgroundTab.png",ccui.Widget.PLIST_TEXTURE);this._backGround.ignoreContentAdaptWithSize(!1);this._backGround.setTouchEnabled(!0);this._backGround.addClickEventListener(this.onClickBackground.bind(this));this._backGround.setSwallowTouches(!0);this._backGround.setMouseHoverEnabled(!0);this._backGround.addMouseHoverEventListener(this.onBackgroundHover.bind(this));this.addChild(this._backGround);
this._backGround.setOpacity(200);this._initEventsGame()},onBackgroundHover:function(a,b){Utilities.showLog("onBackgroundHover BG "+ConstantsVariable.ISHOVER);return!0},_initEventsGame:function(){},_onResize:function(){},getCurrentPopup:function(){return this._currentPopup},onClickBackground:function(){!this.isTouchEnabled()||null===this._currentPopup||this._currentPopup instanceof MGLayerPopupLogin||(this.hideAllPopup(),this._currentPopup=null,this._listPopup=[])},_initEvents:function(){this.registerEvent(MG_POPUP_EVENTS.CLOSE,
this.hideChosedPopup.bind(this));this.registerEvent(MG_POPUP_EVENTS.CLOSE_LAST_POPUP,this.hideCurrentPopup.bind(this));if(null!=window.PopupEventRegister)for(var a in PopupEventRegister)"function"===typeof PopupEventRegister[a]&&this.registerEvent(a,PopupEventRegister[a].bind(this))},hideAllPopup:function(){this._removeAllPopup();this.hide()},_removeAllPopup:function(){for(var a=0;a<this._listPopup.length;a++)this._listPopup[a].removeFromParent(),this._listPopup[a]=null;this._listPopup=[];this._currentPopup=
null},show:function(){this.setVisible(!0);cc.size(1536,864);var a={};a[MG_POPUP_KEY_DATA.POPUP_LAYER_SHOW]=!0;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_LAYER,a);cc.sys.isNative?this._backGround.setContentSize(cc.size(cc.winSize.width,cc.winSize.height)):this._backGround.setContentSize(cc.size(2560,1440));this._backGround.setPosition(cc.p(640,.5*-this._backGround.getContentSize().height+720));this._backGround.setScale9Enabled(!0);this._backGround.setBright(!1)},hide:function(){this.setVisible(!1);
var a={};a[MG_POPUP_KEY_DATA.POPUP_LAYER_SHOW]=!1;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_LAYER,a)},registerEvent:function(a,b){this._listEvent.push(a);cc.eventManager.addCustomListener(a,b)},showPopup:function(a,b,d){d=d?d:DEFAULT_TIME_DELAY;switch(b){case POPUP_SHOW_TYPE.OVERRIDE:this._listPopup.push(a);this._currentPopup=a;1<this._listPopup.length&&this._attachBackground(a);break;case POPUP_SHOW_TYPE.DELAY:this._removeAllPopup();this._listPopup.push(a);this._currentPopup=a;this.scheduleOnce(this.hideAllPopup.bind(this),
d);break;case POPUP_SHOW_TYPE.OVERRIDE_DELAY:this._listPopup.push(a);this._currentPopup=a;1<this._listPopup.length&&this._attachBackground(a);this.scheduleOnce(this.hidePopup.bind(this,a),d);break;default:case POPUP_SHOW_TYPE.ONLY:this._removeAllPopup(),this._listPopup.push(a),this._currentPopup=a}this.addChild(a);this.show();a.show()},checkIsHaveSameMessage:function(a){for(var b=0;b<this._listPopup.length;b++)if(this._listPopup[b]instanceof MGLayerPopupMessage&&this._listPopup[b].txtMsg.getString()==
a)return!0;return!1},_attachBackground:function(a){if(a&&a.addChild){var b=new ccui.Layout;b.setContentSize(cc.size(2560,1440));b.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);b.setPosition(cc.p(640,.5*-b.getContentSize().height+720));b.setBackGroundColor(cc.color(0,0,0));b.setBackGroundColorOpacity(200);b.setTouchEnabled(this.isTouchEnabled());b.setAnchorPoint(.5,.5);b.addClickEventListener(this.hidePopup.bind(this,a));a._mainLayer?a._mainLayer.addChild(b,-1):a.addChild(b,-1)}},hideCurrentPopup:function(a){this.hidePopup(this._currentPopup)},
hideChosedPopup:function(a){a=a.getUserData();a[MG_POPUP_KEY_DATA.POPUP]&&this.hidePopup(a[MG_POPUP_KEY_DATA.POPUP])},hidePopup:function(a){a.setDispose();a.removeFromParent();for(var b=this._listPopup.length,d=0;d<b;d++)if(this._listPopup[d]===a){this._listPopup.splice(d,1);0<=b-2&&(this._currentPopup=this._listPopup[b-2]);break}0===this._listPopup.length&&(this._currentPopup=null,this.hide())},removeAllListener:function(){if(this._listEvent)for(var a=0;a<this._listEvent.length;a++)cc.eventManager.removeCustomListeners(this._listEvent[a])},
dispose:function(){this.removeAllListener();this.hideAllPopup()}});var MGCCTabChat=cc.Class.extend({chatContain:null,listView:null,btnTG:null,btnRoom:null,btnBoard:null,btnEnter:null,btnFastChat:null,fastChatContain:null,bottonTabContent:null,txtInput:null,maxLine:null,chatData:null,currentTab:null,gameID:null,ChannelID:null,lockChat:null,touchMove:!1,ctor:function(a){this.chatContain=a;this.initObj();this.initEvent()},initObj:function(){this.listView=this.chatContain.getChildByName("MGListViewChat");this.txtInput=new MGBaseEditBox(this.chatContain.getChildByName("MGChatTextField"),
"TxtChatBackground.png");this.chatContain.addChild(this.txtInput);this.txtInput.setDelegate(this);this.bottonTabContent=this.chatContain.getChildByName("MGTabChatBotton");this.btnTG=this.bottonTabContent.getChildByName("MGBtnChatTG");this.btnRoom=this.bottonTabContent.getChildByName("MGBtnChatLobby");this.btnBoard=this.bottonTabContent.getChildByName("MGBtnChatBoard");this.btnEnter=this.chatContain.getChildByName("MGBtnChatEnter");this.btnFastChat=this.chatContain.getChildByName("MGBtnChatEmo");this.fastChatContain=
this.chatContain.getChildByName("MGFastChatContain");this.btnRoom.setColor(cc.color(113,78,158));this.btnBoard.setColor(cc.color(145,101,206));this.chatData=[];this.chatData[MGCCTabChat.TAB_GLOBAL]=[];this.chatData[MGCCTabChat.TAB_BOARD]=[];this.chatData[MGCCTabChat.TAB_ROOM]=[];this.currentTab=MGCCTabChat.TAB_GLOBAL;this.ChannelID=this.gameID=0;this.lockChat=!1;this.updateChangeTag()},initEvent:function(){this.btnTG.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.btnRoom.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));
this.btnBoard.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.btnEnter.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.btnFastChat.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));for(var a=this.fastChatContain.getChildren(),b=a.length,d=0;d<b;d++)a[d].addClickEventListener(this.onClickFastChat.bind(this))},setTouchMove:function(a){this.touchMove=a},onClickBtnFromCocostudio:function(a,b){if(!this.touchMove)switch(a.getName()){case "MGBtnChatEnter":this.onchatEnter();
break;case "MGBtnChatTG":this.currentTab=MGCCTabChat.TAB_GLOBAL;this.updateChangeTag();break;case "MGBtnChatLobby":this.currentTab=MGCCTabChat.TAB_ROOM;this.updateChangeTag();break;case "MGBtnChatBoard":this.currentTab=MGCCTabChat.TAB_BOARD;this.updateChangeTag();break;case "MGBtnChatEmo":this.fastChatContain.isVisible()?(this.bottonTabContent.setPositionY(0),this.fastChatContain.setVisible(!1),this.listView.height+=120,this.listView.y-=120):(this.bottonTabContent.setPositionY(117),this.fastChatContain.setVisible(!0),
this.listView.height-=120,this.listView.y+=120)}},onClickFastChat:function(a){if(!this.touchMove){switch(a.getName()){case "MGButton_Hi":this.txtInput.setString("Hi");break;case "MGButton_Hen":this.txtInput.setString("Hên vãi");break;case "MGButton_Nho":this.txtInput.setString("Quá nhọ");break;case "MGButton_Thua":this.txtInput.setString("Thua đi cưng");break;case "MGButton_Thank":this.txtInput.setString("Thank you vinamilk");break;case "MGButton_Do":this.txtInput.setString("Đỡ nè")}this.txtInput.setFocus()}},
addChat:function(a){var b=this._getTab(a);this.chatData[b].length>=this.maxLine&&this.chatData[b].shift();this.chatData[b].push({ArrMsg:a.ArrMsg,ArrColor:a.ArrColor});b==this.currentTab&&(this.listView.getItems().length>=this.maxLine&&this.listView.removeItem(0),b=new MGBaseRichText("Arial",13,cc.color.WHITE,!0,180),b.setString(a.ArrMsg,a.ArrColor),this.listView.pushBackCustomItem(b),this.listView.jumpToBottom())},_getTab:function(a){return 0==a.GroupID?MGCCTabChat.TAB_GLOBAL:0==a.ChannelID?MGCCTabChat.TAB_ROOM:
MGCCTabChat.TAB_BOARD},onchatEnter:function(){if(this.currentTab!=MGCCTabChat.TAB_GLOBAL){if(this.lockChat){var a=this.createHeaderDataChat();a.ArrMsg=["Bạn chat quá nhanh!"];a.ArrColor=["#FFFF00"];this.addChat(a)}else{var b=this.txtInput.getString();""!=b&&(a=this.createHeaderDataChat(),a.ArrMsg=[this.userName+":",b],a.ArrColor=["#d27efd","#FFFFFF"],cc.eventManager.dispatchCustomEvent(MGCompoChat.EVENTS.USER_ENTER_CHAT,a),this.lockChat=!0,setTimeout(this.timeOutLockChat.bind(this),1E3));this.txtInput.setString("")}setTimeout(this.timeOutFocus.bind(this),
100)}},createHeaderDataChat:function(){var a={};this.currentTab==MGCCTabChat.TAB_ROOM?(a.GroupID=this.gameID,a.ChannelID=0):(a.GroupID=this.gameID,a.ChannelID=this.boardID);return a},editBoxReturn:function(a){this.onchatEnter()},timeOutFocus:function(a){this.txtInput.setFocus()},timeOutLockChat:function(a){this.lockChat=!1},updateChangeTag:function(){this.listView.removeAllItems();var a=0,b=this.chatData[this.currentTab].length,d;for(a;a<b;a++)d=new MGBaseRichText("Arial",13,cc.color.WHITE,!0,180),
d.setString(this.chatData[this.currentTab][a].ArrMsg,this.chatData[this.currentTab][a].ArrColor),this.listView.pushBackCustomItem(d);this.listView.jumpToBottom();this.btnTG.setEnabled(!0);this.btnRoom.setEnabled(!0);this.btnBoard.setEnabled(!0);this.btnTG.setColor(cc.color(113,78,158));this.btnRoom.setColor(cc.color(113,78,158));this.btnBoard.setColor(cc.color(113,78,158));this.btnEnter.setEnabled(!0);this.btnFastChat.setEnabled(!0);this.txtInput.setVisible(!0);switch(this.currentTab){case MGCCTabChat.TAB_GLOBAL:this.btnEnter.setEnabled(!1);
this.btnFastChat.setEnabled(!1);this.txtInput.setVisible(!1);this.btnTG.setEnabled(!1);this.btnTG.setColor(cc.color(255,255,255));this.bottonTabContent.setPositionY(0);this.fastChatContain.isVisible()&&(this.fastChatContain.setVisible(!1),this.listView.height+=120,this.listView.y-=120);break;case MGCCTabChat.TAB_ROOM:this.btnRoom.setEnabled(!1);this.btnRoom.setColor(cc.color(255,255,255));break;case MGCCTabChat.TAB_BOARD:this.btnBoard.setEnabled(!1),this.btnBoard.setColor(cc.color(255,255,255))}},
updateInfo:function(a){this.userName=a},updateStage:function(a,b){this.gameID=a;this.boardID=b;0<this.boardID?(this.btnBoard.setVisible(!0),this.btnRoom.setVisible(!1),this.currentTab==MGCCTabChat.TAB_ROOM&&(this.currentTab=MGCCTabChat.TAB_GLOBAL,this.updateChangeTag())):(this.btnBoard.setVisible(!1),this.btnRoom.setVisible(!0),this.currentTab==MGCCTabChat.TAB_BOARD&&(this.currentTab=MGCCTabChat.TAB_GLOBAL,this.updateChangeTag()))},getGroupID:function(){return this.gameID},getChannelID:function(){return this.boardID},
show:function(){this.listView.setVisible(!0);this.bottonTabContent.setVisible(!0);this.chatContain.getChildByName("MGTxtChatBackground").setVisible(!0);this.btnEnter.setVisible(!0);this.btnFastChat.setVisible(!0);this.bottonTabContent.setPositionY(0);this.fastChatContain.isVisible()&&(this.listView.height+=120,this.listView.y-=120);this.listView.setTouchEnabled(!0);this.currentTab!=MGCCTabChat.TAB_GLOBAL&&this.txtInput.setVisible(!0)},hide:function(){this.listView.setVisible(!1);this.bottonTabContent.setVisible(!1);
this.chatContain.getChildByName("MGTxtChatBackground").setVisible(!1);this.fastChatContain.isVisible()&&(this.fastChatContain.setVisible(!1),this.listView.height+=120,this.listView.y-=120);this.txtInput.setVisible(!1);this.btnEnter.setVisible(!1);this.btnFastChat.setVisible(!1);this.listView.setTouchEnabled(!1)}});MGCCTabChat.TAB_GLOBAL=0;MGCCTabChat.TAB_ROOM=1;MGCCTabChat.TAB_BOARD=2;
var MGCCTabUser=cc.Class.extend({chatContain:null,listView:null,listUser:null,ctor:function(a){this.chatContain=a;this.listView=this.chatContain.getChildByName("MGListViewUser");this.initObj()},initObj:function(){this.listUser={}},setTouchMove:function(a){},addListUser:function(a){this.listView.removeAllItems();this.listUser={};a=a.ListUser;var b=0,d=a.length,e;for(b;b<d;b++)e=new MGBaseRichText("Arial",13,cc.color.WHITE,!0,180),e.setString([a[b].nickName],["#FFFFFF"]),this.listView.pushBackCustomItem(e),
this.listUser[a[b].UserID]=e},addUser:function(a){},removeUser:function(a){},show:function(){this.listView.setVisible(!0);this.listView.setTouchEnabled(!0)},hide:function(){this.listView.setVisible(!1);this.listView.setTouchEnabled(!1)}}),MGCompoChat=MGMoveablePopup.extend({btnChat:null,btnTabChat:null,btnTabUser:null,tabChat:null,tabUser:null,isShow:null,timeAction:null,background:null,chatBoard:null,touchMove:!1,touchButtonPanel:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this);this.timeAction=
.4},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesMenuGame.CCSUICompoChatMainGameNode,PreLoaderConfig.PathToResourceDefault);this.chatBoard=this._mainLayer.getChildByName("MGPanelClipping");this.btnChat=this._mainLayer.getChildByName("MGButtonChat");this.chatContain=this.chatBoard.getChildByName("MGChatContain");this.chatContain.getChildByName("MGbackground").setSwallowTouches(!0);this.background=this.chatContain.getChildByName("MGTouchMoveArea");
this.touchButtonPanel=this._mainLayer.getChildByName("MGButtonPanel");cc.sys.isNative?this.setMoveInfo(this.background,0,0,80,0,!1):this.setMoveInfo(this.background,0,80,0,0,!1);this.addMoveElement(this.touchButtonPanel,!1);this.btnTabChat=this.chatContain.getChildByName("MGTabChatTop").getChildByName("MGBtnTabChat");this.btnTabUser=this.chatContain.getChildByName("MGTabChatTop").getChildByName("MGBtnTabUser");this.btnTabChat.setSwallowTouches(!1);this.btnTabUser.setSwallowTouches(!1);this.initTabChat();
this.initTabUser();this.btnChat.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.btnTabChat.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.btnTabUser.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.isShow=!0},initTabChat:function(){this.tabChat=new MGCCTabChat(this.chatContain);this.setMaxLineChat(100);this.tabChat.show()},initTabUser:function(){this.tabUser=new MGCCTabUser(this.chatContain);this.tabUser.hide()},onClickBtnFromCocostudio:function(a,
b){if(!this.touchMove)switch(a.getName()){case "MGBtnTabChat":this.btnTabChat.setEnabled(!1);this.btnTabUser.setEnabled(!0);this.tabChat.show();this.tabUser.hide();break;case "MGBtnTabUser":this.btnTabChat.setEnabled(!0);this.btnTabUser.setEnabled(!1);this.tabChat.hide();this.tabUser.show();cc.eventManager.dispatchCustomEvent(MGCompoChat.EVENTS.GET_LIST_USER,{GroupID:this.tabChat.getGroupID(),ChannelID:this.tabChat.getChannelID()});break;case "MGButtonChat":this.isShow?(this.isShow=!1,this.chatContain.stopAllActions(),
this.chatContain.setPosition(cc.p(0,0)),this.chatContain.runAction(cc.sequence(cc.spawn(cc.moveTo(this.timeAction,cc.p(0,-this.chatBoard.getContentSize().height)),cc.fadeOut(this.timeAction)),cc.callFunc(function(){this.tabChat.hide();this.tabUser.hide();this.btnTabChat.setTouchEnabled(!1);this.btnTabUser.setTouchEnabled(!1)}.bind(this))))):(this.isShow=!0,this.chatContain.stopAllActions(),this.chatContain.setPosition(cc.p(0,-this.chatBoard.getContentSize().height)),this.chatContain.runAction(cc.sequence(cc.spawn(cc.moveTo(this.timeAction,
cc.p(0,0)),cc.fadeIn(this.timeAction)),cc.callFunc(function(){this.btnTabChat.setEnabled(!1);this.btnTabUser.setEnabled(!0);this.btnTabChat.setTouchEnabled(!0);this.btnTabUser.setTouchEnabled(!0);this.tabChat.show();this.tabUser.hide()}.bind(this)))))}},addChat:function(a){this.tabChat.addChat(a)},addListUser:function(a){this.tabUser.addListUser(a)},addUser:function(a){this.tabUser.addUser(a)},removeUser:function(a){this.tabUser.removeUser(a)},setMaxLineChat:function(a){this.tabChat.maxLine=a},updateInfo:function(a){this.tabChat.updateInfo(a)},
updateStage:function(a,b){this.btnTabChat.setEnabled(!1);this.btnTabUser.setEnabled(!0);if(0<b){switch(a){case PreLoaderConfig.IDSlotLuxury:case PreLoaderConfig.IDFruitKong:case PreLoaderConfig.IDDemCuu:case PreLoaderConfig.IDDiamonds777:case PreLoaderConfig.IDSlotBAPD:case PreLoaderConfig.IDSlotVanPhuc:case PreLoaderConfig.IDSlotPanda:case PreLoaderConfig.IDSlotThamHiem:case PreLoaderConfig.IDSlotHoangCung:case PreLoaderConfig.IDSlotAiCap:case PreLoaderConfig.IDSlotAladin:this.btnChat.setVisible(!1);
this.touchButtonPanel.setVisible(!1);break;default:this.btnChat.setVisible(!0),this.touchButtonPanel.setVisible(!0)}this.hideCompoChat()}else 0<a?this.showChatLobby():(this.btnChat.setVisible(!1),this.touchButtonPanel.setVisible(!1),this.hideCompoChat());this.tabChat.updateStage(a,b)},hideCompoChat:function(){this.isShow=!1;this.chatContain.setPosition(cc.p(0,-this.chatBoard.getContentSize().height));this.tabChat.hide();this.tabUser.hide();this.chatContain.setOpacity(0);this.btnTabChat.setTouchEnabled(!1);
this.btnTabUser.setTouchEnabled(!1)},showChatLobby:function(){this.hide();this.setVisible(!0);this.touchButtonPanel.setPosition(this.btnChat.getPosition());this.btnChat.setVisible(!1);this.touchButtonPanel.setVisible(!1);this.isShow=!0;this.chatContain.stopAllActions();this.chatContain.setPosition(cc.p(0,0));this.chatContain.setOpacity(255);this.tabChat.bottonTabContent.setPositionY(0);this.tabChat.fastChatContain.setVisible(!1);this.btnTabChat.setTouchEnabled(!0);this.btnTabUser.setTouchEnabled(!0);
this.btnTabChat.setEnabled(!1);this.btnTabUser.setEnabled(!0);this.tabChat.show();this.tabUser.hide()},moveablePopupTouchBegan:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this.touchMove=!1;this.tabChat.setTouchMove(!1);this.tabUser.setTouchMove(!1);break;case ccui.Widget.TOUCH_MOVED:if(5<Math.abs(a.getTouchMovePosition().x-a.getTouchBeganPosition().x)||5<Math.abs(a.getTouchMovePosition().y-a.getTouchBeganPosition().y))this.touchMove=!0,this.tabChat.setTouchMove(!0),this.tabUser.setTouchMove(!0)}}});
MGCompoChat.EVENTS={USER_ENTER_CHAT:"userEnterChat",GET_LIST_USER:"userGetListUserChat"};var ScreenPolicy=function(){var a=function(){document.addEventListener&&(document.addEventListener("webkitfullscreenchange",Utilities.fullScreen,!1),document.addEventListener("mozfullscreenchange",Utilities.fullScreen,!1),document.addEventListener("fullscreenchange",Utilities.fullScreen,!1),document.addEventListener("MSFullscreenChange",Utilities.fullScreen,!1));if(cc.sys.isMobile)if(cc.sys.os===cc.sys.OS_IOS){window.addEventListener("orientationchange",function(){setTimeout(Utilities.fullScreen,
500)});try{$(document).ready(function(){window.onorientationchange=function(a){switch(window.orientation){case 0:case 180:$("body").css("padding-top","0px");break;case -90:case 90:$("body").css("padding-top","200px")}setTimeout(function(){var a=$("#Cocos2dGameContainer").offset();window.scrollTo(0,a.top)},1E3)}})}catch(a){}}else{var b=screen.orientation||screen.mozOrientation||screen.msOrientation;b.addEventListener("change",function(){"landscape-primary"==b.type&&setTimeout(Utilities.fullScreen,
500)});document.addEventListener("click",function(){document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||cc.screen.requestFullScreen(document.getElementsByTagName("body")[0])})}};return{apply:function(){a()}}}();Utilities.logOut=function(a){var b={userid:MGGameInfo.myInfo.UserID,accesstoken:MGGameInfo.myInfo.token4web};"function"===typeof a&&Utilities.getAPIAfterLogin("user","logout",b,a)};
Utilities.loginFB=function(a,b){var d={FacebookAccessToken:b};"function"===typeof a&&Utilities.getAPIAfterLogin("user","login_facebook",d,a)};Utilities.getTokenFB=function(a){"function"===typeof a&&Dialog.OpenAuthFacebook&&(Utilities.showLog("Dialog.OpenAuthFacebook"),Dialog.OpenAuthFacebook(a))};
Utilities.getTokenGoogle=function(a){if("function"===typeof a)if(cc.sys.isNative){if(!MGGameInfo.isDevVer){if(cc.sys.os==cc.sys.OS_ANDROID){var b=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","loginGoogle","()Ljava/lang/String;");Utilities.showLog(b)}else cc.sys.os==cc.sys.OS_IOS&&(b=jsb.reflection.callStaticMethod("RootViewController","loginGoogle:",""),Utilities.showLog(b));Utilities.cbGetTokenGoogle=a}}else Dialog.OpenAuthGoogle&&Dialog.OpenAuthGoogle(a)};
Utilities.onGetTokenGoogleMobile=function(a){Utilities.cbGetTokenGoogle(a)};Utilities.loginGoogle=function(a,b){var d={GoogleAccessToken:b};"function"===typeof a&&Utilities.getAPIAfterLogin("user","login_google",d,a)};Utilities.getContact=function(a){var b={};"function"===typeof a&&Utilities.getAPIBeforeLogin("common","getcontact",b,a)};Utilities.getTimeServer=function(a){var b={};"function"===typeof a&&Utilities.getAPIBeforeLogin("common","gettimeserver",b,a)};
Utilities.checkOperatorName=function(a,b){var d={TelcoCode:b};"function"===typeof a&&Utilities.getAPIBeforeLogin("common","getconfigserver",d,a)};Utilities.getDeviceInfo=function(){var a="";cc.sys.isNative&&(cc.sys.os===cc.sys.OS_ANDROID?a=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","jsbGetDeviceInfo","()Ljava/lang/String;"):cc.sys.os===cc.sys.OS_IOS&&(a=jsb.reflection.callStaticMethod("InvokeCocos","GetDeviceInfo")));return a};
Utilities.getOperatorName=function(){var a="";cc.sys.isNative&&(cc.sys.os===cc.sys.OS_ANDROID?a=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","jsbGetOperatorName","()Ljava/lang/String;"):cc.sys.os===cc.sys.OS_IOS&&(a=jsb.reflection.callStaticMethod("InvokeCocos","getOperatorName")));return a};
Utilities.getPackageName=function(){var a="";cc.sys.isNative&&(cc.sys.os===cc.sys.OS_ANDROID?a=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","jsbGetPackageName","()Ljava/lang/String;"):cc.sys.os===cc.sys.OS_IOS&&(a=jsb.reflection.callStaticMethod("InvokeCocos","GetBundleID")));return a};Utilities.getPlatformID=function(){if(cc.sys.isMobile&&cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:return ConstantsVariable.PlatformID.Android;case cc.sys.OS_IOS:return ConstantsVariable.PlatformID.Ios}return ConstantsVariable.PlatformID.Web};
Utilities.fullScreen=function(){var a=null,b=null,d=screen.orientation||screen.mozOrientation||screen.msOrientation;document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?($("#Cocos2dGameContainer").width(),$("#Cocos2dGameContainer").height(),a=cc.sys.browserType===cc.sys.BROWSER_TYPE_IE?document.body.offsetWidth:screen.width,b=screen.height,$("#Cocos2dGameContainer").css({width:a+"px",height:b+"px","background-color":"background-color: rgb(0, 0, 0);"}),$("#"+cc.game.config.id).removeClass("fullscreen").css({width:a+
"px",height:b+"px"}),cc.view.setDesignResolutionSize(cc.game.config.gameWidth,cc.game.config.gameHeight,cc.view._resolutionPolicy),!cc.sys.isNative&&cc.sys.isMobile&&d.lock("landscape-primary")):(!cc.sys.isNative&&cc.sys.isMobile&&d.unlock(),$("#Cocos2dGameContainer").css({width:"nullpx",height:"nullpx","background-color":""}),$("#"+cc.game.config.id).css({width:"nullpx",height:"nullpx"}),cc.view.setDesignResolutionSize(cc.game.config.gameWidth,cc.game.config.gameHeight,cc.view._resolutionPolicy))};
Utilities.enabled_sdkbox=function(){if(cc.sys.isNative&&cc.sys.isMobile)return!0};Utilities.logScreenGA=function(a){if(Utilities.enabled_sdkbox())try{Utilities.showLog("Utilities.logScreenGA "+a),sdkbox.PluginGoogleAnalytics.logScreen(a)}catch(b){Utilities.showLog("Utilities.logScreenGA error "+b)}};ConstantsVariable.LAYERS={MENU_LAYER_LOGIN:0,MENU_LAYER_LIST_ROOM:1,MENU_LAYER_GAME:2};ConstantsVariable.PlatformID={Unknown:0,Android:1,Ios:2,WindowsPhone:3,Web:4};
ConstantsVariable.LoginProviderID={Normal:0,Facebook:1,Google:2,Yahoo:3};ConstantsVariable.CHANNEL_ID=1;ConstantsVariable.TEXT={NOTICE:"THÔNG BÁO",INVALID_TOKEN:"Phiên đăng nhập đã hết hạn vui lòng đăng nhập lại"};
ConstantsVariable.EVENTS={MENU_LAYER_SWIPE:"MENU_LAYER_SWIPE",MENU_LAYER_UPDATE_USER:"MENU_LAYER_UPDATE_USER",HEADER_UPDATE_USER_INFO:"HEADER_UPDATE_USER_INFO",CHANGE_MAIN_BACKGROUND:"CHANGE_MAIN_BACKGROUND",CREATE_INPUT_USERNAME_PASSWORD:"CREATE_INPUT_USERNAME_PASSWORD",WINDOWS_RESIZED:"WINDOWS_RESIZED",UPDATE_UI_COMPOCHAT:"UPDATE_UI_COMPOCHAT",GLOBAL_CLICK:"GLOBAL_CLICK",LOGIN_FACEBOOK:"LOGIN_FACEBOOK",LOGIN_GOOGLE:"LOGIN_GOOGLE",MOBILE_LOGIN:"MOBILE_LOGIN",CHAT_SYSTEM:"CHAT_SYSTEM",CHAT_IN_GAME:"CHAT_IN_GAME",
INVALID_TOKEN:"INVALID_TOKEN",MASTER_LOGOUT:"MASTER_LOGOUT",BACK_ON_ANDROID:"BACK_ON_ANDROID",LOAD_GAME:"LOAD_GAME",LEAVE_WEB_GAME:"LEAVE_WEB_GAME"};
ConstantsVariable.NETWORK={GET_MASTERID:0,MASTER_PING:10,LOGIN_MASTER:11,SYSTEM_MESSAGE:12,UPDATE_MY_GOLD:13,SYSTEM_KICK:14,SYSTEM_BROADCAST:15,LIST_ROOM:16,JOIN_ROOM:17,CREATE_NICK_NAME:18,SET_NICK_NAME:19,LEAVE_GAME:20,TOP_JACKPOT:22,LOGIN_CHAT_CHANNEL:50,LEAVE_CHAT_CHANNEL:51,CHAT_MESSAGE:52,CHAT_LIST_USER:53,CHAT_ADD_USER:54,CHAT_REMOVE_USER:56,LOGIN_GAME:101,USER_INFO:102,UDATE_COIN:103,LEAVE_DESK:104,CHAT_MSG:105,EMOTION_MSG:106,JOIN_DESK:107,DISCONNECT:200,GAME_PING:100};
ConstantsVariable.UIZONE={LOADING:100,COMPO_CHAT:50,POPUP:90,COMPONENT:9};ConstantsVariable.MG_MOUSE_EVENT={MOUSE_HOVER:1,MOUSE_OUT:0};ConstantsVariable.LOG_SCREEN_GA={MAIN_SCREEN:"Chọn game"};ConstantsVariable.EVENTS_KEY={URL_BACKGROUND:"UrlBackground",GAME_ID:"GAME_ID",BOARD_ID:"BOARD_ID"};
ResourceManager.MGResourcesMenuGame={AtlasPopups_plist:"res/main/atlas/AtlasPopups/AtlasPopups.plist",AtlasPopups_texture:"res/main/atlas/AtlasPopups/AtlasPopups.png",AtlasCompoMenu_plist:"res/main/atlas/CompoMenu/AtlasCompoMenu.plist",AtlasCompoMenu_texture:"res/main/atlas/CompoMenu/AtlasCompoMenu.png",GameIcon1:"res/main/GameIcons/IconTaiXiu.png",GameIcon2:"res/main/GameIcons/IconTienLen.png",GameIcon3:"res/main/GameIcons/IconXocDia.png",GameIcon5:"res/main/GameIcons/IconSamLoc.png",GameIcon6:"res/main/GameIcons/IconBinh.png",
GameIcon7:"res/main/GameIcons/IconU.png",GameIcon8:"res/main/GameIcons/IConXiTo.png",GameIcon9:"res/main/GameIcons/IconPoker.png",GameIcon10:"res/main/GameIcons/IconLieng.png",GameIcon13:"res/main/GameIcons/IconXengLuxury.png",GameIcon14:"res/main/GameIcons/IconFruitKong.png",GameIcon15:"res/main/GameIcons/IconDemCuu.png",GameIcon16:"res/main/GameIcons/IconDiamonds777.png",GameIcon17:"res/main/GameIcons/IconMiniTaiXiu.png",GameIcon18:"res/main/GameIcons/IconSlotBAPD.png",GameIcon19:"res/main/GameIcons/IconXengVanPhuc.png",
GameIcon20:"res/main/GameIcons/IconXengPanda.png",GameIcon21:"res/main/GameIcons/IconXengHoangCung.png",GameIcon22:"res/main/GameIcons/IconXengNhaThamHiem.png",GameIcon23:"res/main/GameIcons/IconXengAladin.png",GameIcon24:"res/main/GameIcons/IconXengAiCap.png",GameIcon25:"res/main/GameIcons/IconMiniCaoThap.png",GameIcon26:"res/main/GameIcons/IconVQMM.png",GameIcon27:"res/main/GameIcons/IconDaoMo.png",ImageLeft:"res/main/GameIcons/ImageLeft.png",ImgContent:"res/main/GameIcons/ImgContent.jpg",BackgroundGame:"res/main/GameIcons/BackgroundGame.jpg",
arialbd:"res/Fonts/arialbd.ttf",tahoma:"res/Fonts/tahoma.ttf",tahomabd:"res/Fonts/tahomabd.ttf",CCSUICompoChatMainGameNode:"res/main/UICompoChatMainGameNode.json",CCSUICompoHeaderNode:"res/main/UICompoHeaderNode.json",CCSUIComponentsLayer:"res/main/UIComponentsLayer.json",CCSUIFooterLobbyNode:"res/main/UIFooterLobbyNode.json",CCSUIFooterNode:"res/main/UIFooterNode.json",CCSUIGameBtnControlNode:"res/main/UIGameBtnControlNode.json",CCSUIHeaderLoggedNode:"res/main/UIHeaderLoggedNode.json",CCSUIHeaderLoginNode:"res/main/UIHeaderLoginNode.json",
CCSUILayerLoading:"res/main/UILayerLoading.json",CCSUIListRoomsNode:"res/main/UIListRoomsNode.json",CCSUILobbyLayer:"res/main/UILobbyLayer.json",CCSUILobyControlNode:"res/main/UILobyControlNode.json",CCSUILobyRoomControlNode:"res/main/UILobyRoomControlNode.json",CCSUINodeListGame:"res/main/UINodeListGame.json",CCSUINodeMenuExtend:"res/main/UINodeMenuExtend.json",CCSUIRoomItemNode:"res/main/UIRoomItemNode.json",CCSUITabNode:"res/main/UITabNode.json",CCSUIMenuGameLayer:"res/main/UIMenuGameLayer.json"};
var resourcesMenuGame=[];for(i in ResourceManager.MGResourcesMenuGame)ResourceManager.MGResourcesMenuGame[i]=""+cc.loader.resPath+ResourceManager.MGResourcesMenuGame[i],resourcesMenuGame.push(ResourceManager.MGResourcesMenuGame[i]);
var MGNetSend=cc.Class.extend({ctor:function(){},sendUpdateName:function(a){var b={};b.DisplayName=a;a=Message.buildMasterMsg(ConstantsVariable.NETWORK.SET_NICK_NAME,{DisplayName:BinaryConstants.DataTypeID.StringDynamic},b);MGNetCore.MGSocket.sendMsg(a)},sendGetMasterModuleID:function(){var a=Message.buildSocketMsg(ConstantsVariable.NETWORK.GET_MASTERID,null,null);MGNetCore.MGSocket.sendMsg(a);data=null},sendLoginMaster:function(a){var b={};b.Token=a;b.AppVersion=MGGameInfo.AppVersion;a=Message.buildMasterMsg(ConstantsVariable.NETWORK.LOGIN_MASTER,
{Token:BinaryConstants.DataTypeID.StringDynamic,AppVersion:BinaryConstants.DataTypeID.StringDynamic},b);MGNetCore.MGSocket.sendMsg(a)},sendPingMaster:function(){var a=Message.buildMasterMsg(ConstantsVariable.NETWORK.MASTER_PING,null,null);MGNetCore.MGSocket.sendMsg(a)},sendGetListRooms:function(a){var b={};b.GameID=a;a=Message.buildMasterMsg(ConstantsVariable.NETWORK.LIST_ROOM,{GameID:BinaryConstants.DataTypeID.UInt32},b);MGNetCore.MGSocket.sendMsg(a)},sendJoinRoom:function(a,b){var d={};d.GameID=
a;d.RoomType=b;d=Message.buildMasterMsg(ConstantsVariable.NETWORK.JOIN_ROOM,{GameID:BinaryConstants.DataTypeID.UInt32,RoomType:BinaryConstants.DataTypeID.UInt32},d);MGNetCore.MGSocket.sendMsg(d)},sendLoginGame:function(a){var b={};b.Token=a.Token;b.BetCoin=a.BetCoin;b.RoomType=a.RoomTypeID;b.AppVersion=MGGameInfo.AppVersion;b.MasterModuleID=MGNetCore.MGSocket.getMasterModuleID();b.ChatModuleID=MGNetCore.MGSocket.getChatModuleID();a=Message.buildGameMsg(ConstantsVariable.NETWORK.LOGIN_GAME,{BetCoin:BinaryConstants.DataTypeID.UInt64,
RoomType:BinaryConstants.DataTypeID.UInt16,AppVersion:BinaryConstants.DataTypeID.StringDynamic,Token:BinaryConstants.DataTypeID.StringDynamic,MasterModuleID:BinaryConstants.DataTypeID.UInt16,ChatModuleID:BinaryConstants.DataTypeID.UInt16},b);MGNetCore.MGSocket.sendMsg(a)},sendLeaveDesk:function(){for(var a in MGGameInfo.GAME_INFO){var b=Message.buildMsgWithModule(MGGameInfo.GAME_INFO[a].GameModuleID,ConstantsVariable.NETWORK.LEAVE_DESK,null,null);MGNetCore.MGSocket.sendMsg(b)}},sendLoginChatChannel:function(a,
b,d,e){var f={UserID:BinaryConstants.DataTypeID.UInt32,NickName:BinaryConstants.DataTypeID.StringDynamic,GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32},g={};g.UserID=a;g.NickName=b;g.GroupID=d;g.ChannelID=e;a=Message.buildChatMsg(ConstantsVariable.NETWORK.LOGIN_CHAT_CHANNEL,f,g);MGNetCore.MGSocket.sendMsg(a)},sendLeaveChatChannel:function(a,b,d){var e={UserID:BinaryConstants.DataTypeID.UInt32,GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32},
f={};f.UserID=a;f.GroupID=b;f.ChannelID=d;a=Message.buildChatMsg(ConstantsVariable.NETWORK.LEAVE_CHAT_CHANNEL,e,f);MGNetCore.MGSocket.sendMsg(a)},sendMsgChat:function(a){a=Message.buildChatMsg(ConstantsVariable.NETWORK.CHAT_MESSAGE,{GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32,ArrMsg:BinaryConstants.DataTypeID.Array8,ArrMsg_Type:BinaryConstants.DataTypeID.StringDynamic,ArrColor:BinaryConstants.DataTypeID.Array8,ArrColor_Type:BinaryConstants.DataTypeID.StringDynamic},
a);MGNetCore.MGSocket.sendMsg(a)},sendGetListUserChat:function(a){a=Message.buildChatMsg(ConstantsVariable.NETWORK.CHAT_LIST_USER,{GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32},a);MGNetCore.MGSocket.sendMsg(a)},sendLeaveGame:function(){var a={};a.GameID=MGGameInfo.GameID;a=Message.buildMasterMsg(ConstantsVariable.NETWORK.LEAVE_GAME,{GameID:BinaryConstants.DataTypeID.UInt32},a);MGNetCore.MGSocket.sendMsg(a)},sendGetTopJackpot:function(){var a=Message.buildMasterMsg(ConstantsVariable.NETWORK.TOP_JACKPOT,
null,null);MGNetCore.MGSocket.sendMsg(a)}}),MGLayerLoading=MGBaseLayer.extend({imgLoading:null,backGroundPopup:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMenuGame.CCSUILayerLoading);this.backGroundPopup=new ccui.ImageView("ImgMenuSub.png",ccui.Widget.PLIST_TEXTURE);this.backGroundPopup.setScale9Enabled(!0);this.backGroundPopup.setColor(cc.color("#000000"));this.backGroundPopup.setOpacity(210);this.backGroundPopup.setTouchEnabled(!0);
this.backGroundPopup.setSwallowTouches(!0);this.addChild(this.backGroundPopup);this.imgLoading=this._mainLayer.getChildByName("MGImgLoading");this._mainLayer.setLocalZOrder(10)},show:function(){this.backGroundPopup.setContentSize(cc.size(2560,1440));this.backGroundPopup.setPosition(cc.p(640,.5*-this.backGroundPopup.getContentSize().height+720));this.imgLoading&&this.imgLoading.stopAllActions();this.imgLoading.setRotation(0);this.imgLoading.runAction(cc.sequence(cc.rotateBy(30,1080),cc.callFunc(this.hide.bind(this))));
this.setVisible(!0)},hide:function(){this.imgLoading&&this.imgLoading.stopAllActions();this.imgLoading.setRotation(0);this.setVisible(!1)}}),MGGameItem=MGBaseButton.extend({gameID:null,gameName:null,isEnable:null,isHot:null,isNew:null,linkIcon:null,ctor:function(){MGBaseButton.prototype.ctor.call(this)},initObj:function(){this._initEventsGame()},_initEventsGame:function(){MGBaseButton.prototype._initEventsGame.call(this)},loadDataItem:function(a){this.gameID=a.GameID;this.gameName=a.GameName;this.isEnable=
a.IsEnable;this.isHot=a.IsHot;this.isNew=a.IsNew;this.linkIcon=a.LinkIcon;this.setSwallowTouches(!1);this._updateIcon()},_updateIcon:function(){this.loadTextureNormal(ResourceManager.MGResourcesMenuGame["GameIcon"+this.gameID],ccui.Widget.LOCAL_TEXTURE);this.setBright(!0)}}),MGListGames=MGBaseNode.extend({_scrollView:null,timeStartTouch:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this._scrollView=a},initObj:function(){this._initFromCocostudio(ResourceManager.MGResourcesMenuGame.CCSUINodeListGame);
this.initUI()},initUI:function(){for(var a=1;10>=a;a++)this._mainLayer.getChildByName("MGGameIcon"+a).setVisible(!1)},onBtnTouch:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this.timeStartTouch=new Date;break;case ccui.Widget.TOUCH_ENDED:if(10<Math.abs(a.getTouchBeganPosition().x-a.getTouchEndPosition().x))return!0;170>new Date-this.timeStartTouch&&a.gameID&&MGGameInfo.MGMain.netSend.sendGetListRooms(a.gameID)}},setEnableWidgetControl:function(a){this._scrollView.setTouchEnabled(a);for(var b=
0;b<this.getChildrenCount();b++)this.getChildren()[b]instanceof ccui.Button&&this.getChildren()[b].setTouchEnabled(a);for(b=0;b<this._mainLayer.getChildrenCount();b++)this._mainLayer.getChildren()[b]instanceof ccui.Button&&this._mainLayer.getChildren()[b].setTouchEnabled(a)},loadDataItems:function(a){var b;if(a)for(var d=0;d<a.length;d++){var e=new MGGameItem;b=this._mainLayer.getChildByName("MGGameIcon"+(d+1));b.setVisible(!0);e.cloneFromButton(b);e.initObj();e.loadDataItem(a[d]);this._mainLayer.addChild(e);
e.setOpacity(255);e.addTouchEventListener(this.onBtnTouch.bind(this))}}}),MGNodeMenuGames=MGBaseLayer.extend({button_All:null,button_RichMan:null,button_Top:null,button_About:null,button_Card:null,button_Xeng:null,btnNext:null,btnPrevious:null,tabContent:null,containGames:null,listAllGame:null,listGameCard:null,listGameXeng:null,currTab:0,ctor:function(){MGBaseLayer.prototype.ctor.call(this);this.listAllGame=[];this.listGameCard=[];this.listGameXeng=[]},initObj:function(){this.button_All=this._mainLayer.getChildByName("MGBtnAll");
this.button_RichMan=this._mainLayer.getChildByName("MGBtnTopRich");this.button_RichMan.setVisible(!1);this.button_Top=this._mainLayer.getChildByName("MGTopRank");this.button_Top.setVisible(!1);this.button_About=this._mainLayer.getChildByName("MGAbout");this.button_About.setVisible(!1);this.button_Card=this._mainLayer.getChildByName("MGBtnCard");this.button_Xeng=this._mainLayer.getChildByName("MGBtnXeng");this.btnNext=this._mainLayer.getChildByName("MGButtonNext");this.btnPrevious=this._mainLayer.getChildByName("MGButtonPrevious");
this.btnNext.setVisible(!1);this.btnPrevious.setVisible(!1);this.tabContent=this._mainLayer.getChildByName("MGPageViewListGame");this.tabContent.addEventListener(this._onScrollEvent.bind(this));this.tabContent.isScrolling=!1;this.tabContent.setSwallowTouches(!1);this.tabContent.setBounceEnabled(!0);this.fillBlackButtons();this.button_All.setColor(cc.color(255,255,255,255))},setEnableWidgetControl:function(a){this.tabContent.setTouchEnabled(a);this.containGames&&this.containGames.setEnableWidgetControl(a)},
onClickBtnFromCocostudio:function(a,b){if(""!=MGGameInfo.token4web&&MGGameInfo.token4web&&void 0!==MGGameInfo.token4web)switch(a.getName()){case "MGBtnAll":if(this.currTab==MGNodeMenuGames.LIST_TAB.ALL)break;this.currTab=MGNodeMenuGames.LIST_TAB.ALL;this.fillBlackButtons();this.button_All.setColor(cc.color(255,255,255,255));this.updateDataListGame(this.listAllGame);break;case "MGBtnCard":if(this.currTab==MGNodeMenuGames.LIST_TAB.CARD)break;this.currTab=MGNodeMenuGames.LIST_TAB.CARD;this.fillBlackButtons();
this.button_Card.setColor(cc.color(255,255,255,255));this.updateDataListGame(this.listGameCard);break;case "MGBtnXeng":if(this.currTab==MGNodeMenuGames.LIST_TAB.SLOT)break;this.currTab=MGNodeMenuGames.LIST_TAB.SLOT;this.fillBlackButtons();this.button_Xeng.setColor(cc.color(255,255,255,255));this.updateDataListGame(this.listGameXeng);break;case "MGButtonNext":this.tabContent.getCurrentPageIndex()<this.tabContent.getPages().length-1&&this.tabContent.setCurrentPageIndex(this.tabContent.getCurrentPageIndex()+
1);this._onScrollEvent();break;case "MGButtonPrevious":0<this.tabContent.getCurrentPageIndex()&&this.tabContent.setCurrentPageIndex(this.tabContent.getCurrentPageIndex()-1),this._onScrollEvent()}else{var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_DO_NOT_LOGIN;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}},onExit:function(){MGBaseLayer.prototype.onExit.call(this)},fillBlackButtons:function(){this.button_All.setColor(cc.color(127,
127,127,255));this.button_Xeng.setColor(cc.color(127,127,127,255));this.button_Card.setColor(cc.color(127,127,127,255))},setListGameData:function(a){this.listAllGame=a;a=this.listAllGame.length;for(var b=0;b<a;b++)this.listAllGame[b].GameType==MGNodeMenuGames.GAME_TYPE.SLOT?this.listGameXeng.push(this.listAllGame[b]):this.listGameCard.push(this.listAllGame[b]);this.fillBlackButtons();this.button_All.setColor(cc.color(255,255,255,255));this.updateDataListGame(this.listAllGame)},updateDataListGame:function(a){this.tabContent.removeAllPages();
var b=[],d=a.length,e=0,f=-1;for(e;e<d;e++)0==e%10&&(f++,b[f]=[]),b[f].push(a[e]);d=b.length;1<d?(this.tabContent.setIndicatorEnabled(!0),this.tabContent.setIndicatorIndexNodesTexture("IconNavigateW.png",ccui.Widget.PLIST_TEXTURE),this.tabContent.setIndicatorIndexNodesColor(cc.color(159,109,206,255)),this.tabContent.setIndicatorSelectedIndexColor(cc.color.WHITE),this.tabContent.setIndicatorSpaceBetweenIndexNodes(8),this.tabContent.setIndicatorPosition(cc.p(437,0)),this.btnNext.setVisible(!0)):(this.tabContent.setIndicatorEnabled(!1),
this.btnNext.setVisible(!1),this.btnPrevious.setVisible(!1));for(e=0;e<d;e++)a=new MGListGames(this.tabContent),a.initObj(),a.loadDataItems(b[e]),f=new ccui.Layout,this.tabContent.addPage(f),f.addChild(a),f.setSwallowTouches(!1),a.setPosition(cc.p(this.tabContent.getContentSize().width/2,this.tabContent.getContentSize().height/2));this.tabContent.setCurrentPageIndex(0)},_onScrollEvent:function(a,b){var d=this.tabContent.getPages().length;1<d&&(0<this.tabContent.getCurrentPageIndex()?this.btnPrevious.setVisible(!0):
this.btnPrevious.setVisible(!1),this.tabContent.getCurrentPageIndex()<d-1?this.btnNext.setVisible(!0):this.btnNext.setVisible(!1))}});MGNodeMenuGames.GAME_TYPE={CARD:1,BET:2,SLOT:3,WEB_GAME:4};MGNodeMenuGames.LIST_TAB={ALL:1,CARD:2,SLOT:3};
var MGCompoHeaderMenuInGame=MGBaseNode.extend({_btnBackGame:null,_btnMenuInGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initEventsGame();cc.sys.isNative||cc.sys.isMobile?(this._btnBackGame=this.getChildByName("MgBtnBackLobby"),this._btnBackGame.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnMenuInGame=this.getChildByName("MgBtnBoardMenu"),this._btnMenuInGame.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),
this.setScale(1.5,1.5),this.setPosition(460,-65)):(this._btnBackGame=new MGBaseButton,this._btnBackGame.cloneFromButton(this.getChildByName("MgBtnBackLobby")),this._btnBackGame._initEventsGame(),this.addChild(this._btnBackGame),this._btnBackGame.setMouseHoverEnabled(!0),this._btnBackGame.addMouseHoverEventListener(this._onMouseHover.bind(this)),this._btnMenuInGame=new MGBaseButton,this._btnMenuInGame.cloneFromButton(this.getChildByName("MgBtnBoardMenu")),this._btnMenuInGame._initEventsGame(),this.addChild(this._btnMenuInGame),
this._btnMenuInGame.setMouseHoverEnabled(!0),this._btnMenuInGame.addMouseHoverEventListener(this._onMouseHover.bind(this)));this._btnBackGame.setLocalZOrder(0);this._btnBackGame.setGlobalZOrder(0);this._btnMenuInGame.setLocalZOrder(0);this._btnMenuInGame.setGlobalZOrder(0);this.getChildByName("TextPhongCho").setLocalZOrder(1);this.getChildByName("TextMenu").setLocalZOrder(1);this.getChildByName("ImgBtnArrowUpDown").setLocalZOrder(1);this.getChildByName("ImgBtnArrowUpDown").setRotation(0)},_initEventsGame:function(){this._listEvents=
[];this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)(a[d]instanceof ccui.Button||a[d]instanceof ccui.ImageView)&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},_onMouseHover:function(a,b){switch(a.getName()){case "MgBtnBackLobby":b===ConstantsVariable.MG_MOUSE_EVENT.MOUSE_HOVER?this._btnBackGame.setOpacity(255):this._btnBackGame.setOpacity(0);break;case "MgBtnBoardMenu":b===ConstantsVariable.MG_MOUSE_EVENT.MOUSE_HOVER?
this._btnMenuInGame.setOpacity(255):this._btnMenuInGame.setOpacity(0)}},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MgBtnBackLobby":if(this.getParent().isShow){var d={};d[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]=!0;d[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]=!this.getParent().isShow;cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SET_SHOW,d)}this.getParent().isShow?this.getChildByName("ImgBtnArrowUpDown").setRotation(0):this.getChildByName("ImgBtnArrowUpDown").setRotation(180);
this._btnBackGame.setOpacity(0);this._btnMenuInGame.setOpacity(0);cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK,null);break;case "MgBtnBoardMenu":d={},d[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]=!0,d[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]=!this.getParent().isShow,cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SET_SHOW,d),this.getParent().isShow?this.getChildByName("ImgBtnArrowUpDown").setRotation(0):this.getChildByName("ImgBtnArrowUpDown").setRotation(180)}}}),
MGCompoHeaderSubMenu=MGBaseNode.extend({ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initEventBtnFromNode();this.runAction(cc.sequence(cc.moveTo(0,MGCompoHeaderSubMenu.POSITION.HIDE).easeBackOut(3),cc.callFunc(this.onShow.bind(this,!this.isVisible()))));this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.CHANGE_VOLUME,
this.onSetValue.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.OPEN_SUB_MENU,this.onShowEvent.bind(this)))},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)(a[d]instanceof ccui.Button||a[d]instanceof ccui.ImageView)&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGBtnLogout":MGGameInfo.isUserLogout=!0;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MASTER_LOGOUT,
null);break;case "MGBtnLichSu":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_TRADE_HISTORY,{});break;case "MGBtnDieuKhoan":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{});break;case "MGBtnSound":this.onSetValue(null)}},onShow:function(a){this.setVisible(a)},onShowEvent:function(a){a=a.getUserData();this.stopAllActions();switch(a.data){case MGCompoHeaderSubMenu.EVENT_DATA.SHOW:this._showAction(!0);break;case MGCompoHeaderSubMenu.EVENT_DATA.HIDE:this._showAction(!1);break;
case MGCompoHeaderSubMenu.EVENT_DATA.AUTO:this._showAction(!this.isVisible())}},_showAction:function(a){this.isVisible()?a?this.setPosition(MGCompoHeaderSubMenu.POSITION.HIDE):this.runAction(cc.sequence(cc.moveTo(.3,MGCompoHeaderSubMenu.POSITION.HIDE).easeBackOut(3),cc.callFunc(this.onShow.bind(this,!this.isVisible())))):a?this.runAction(cc.sequence(cc.callFunc(this.onShow.bind(this,!this.isVisible())),cc.moveTo(.3,MGCompoHeaderSubMenu.POSITION.SHOW).easeBackOut(3))):this.setPosition(MGCompoHeaderSubMenu.POSITION.SHOW)},
onSetValue:function(a){0<MGGameInfo.gameVolume?(MGGameInfo.gameVolume=0,this.getChildByName("MGTxtSound").setString("Âm thanh: Tắt")):(MGGameInfo.gameVolume=1E4,this.getChildByName("MGTxtSound").setString("Âm thanh: Mở"));mg.audio.setEffectsVolume(MGGameInfo.gameVolume);mg.audio.setMusicVolume(MGGameInfo.gameVolume);cc.sys.localStorage.setItem("GameVolume",MGGameInfo.gameVolume)}});MGCompoHeaderSubMenu.POSITION={SHOW:cc.p(510,-88),HIDE:cc.p(510,70)};
MGCompoHeaderSubMenu.EVENT_DATA={SHOW:"SHOW",HIDE:"HIDE",AUTO:"AUTO"};
var MGCompoHeaderLogged=MGBaseNode.extend({btnHome:null,avatar:null,nodeAvartar:null,txtUserName:null,txtPuplicID:null,txtCoin:null,btnRecharge:null,btnEmail:null,btnShop:null,btnMenu:null,btnSecurity:null,countBug:0,_avatarLink:null,iconNewMail:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.nodeAvartar=new MGBaseSprite;this.nodeAvartar.setContentSize(this.getChildByName("MGNodeAvatar").getContentSize());this.nodeAvartar.cloneFromSprite(this.getChildByName("MGNodeAvatar"));
this.nodeAvartar.setTouchEnabled(!0);this.nodeAvartar.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.addChild(this.nodeAvartar);this.txtUserName=this.getChildByName("MGTxtUserName");this.txtPuplicID=this.getChildByName("MGTxtPublicID");this.txtCoin=this.getChildByName("MGTxtCoin");this.txtUserName.ignoreContentAdaptWithSize(!0);this.txtPuplicID.ignoreContentAdaptWithSize(!0);this.txtPuplicID.setVisible(!1);this.txtCoin.ignoreContentAdaptWithSize(!0);this._initEventBtnFromNode();
this.btnSecurity=this.getChildByName("MGButton_Security");this.iconNewMail=this.getChildByName("MGIconNewMail");this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MG_POPUP_EVENTS.UPDATE_AVATAR.toString(),this._updateAvatar.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.NEW_EMAIL,this.onMailInfo.bind(this)))},_updateAvatar:function(a){if(a=a.getUserData())MGGameInfo.myInfo.Avatar=
a[MG_POPUP_KEY_DATA.AVATAR_ID]||0,a[MG_POPUP_KEY_DATA.AVATAR_ID]=a[MG_POPUP_KEY_DATA.AVATAR_ID]||0,this.nodeAvartar.setSpriteFrame(PreLoaderConfig.PathToAvatar+a[MG_POPUP_KEY_DATA.AVATAR_ID]+".png")},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){if(""!=MGGameInfo.token4web&&MGGameInfo.token4web&&void 0!==MGGameInfo.token4web)switch(a.getName()){case "MGButton_Email":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MAIL,
{});break;case "MGButton_Shop":d={};cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_CUAHANG,d);break;case "MGButton_Plus":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_CUAHANG,d);break;case "MGButton_Menu":cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.OPEN_SUB_MENU,{data:MGCompoHeaderSubMenu.EVENT_DATA.AUTO});break;case "MGNodeAvatar":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_PERSONAL,{});break;case "MGButton_Security":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_UPDATE_SECURITY,
{})}else if("MGNodeAvatar"!=a.getName()){var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_DO_NOT_LOGIN;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}},updateCoin:function(a){this.txtCoin.setString(Utilities.Coin(a))},updateInfoUser:function(a){if(a.DisplayName){var b=12<a.DisplayName.length?a.DisplayName.substr(0,12)+"...":a.DisplayName;this.txtUserName.setString(b);this.txtCoin.setString(Utilities.Coin(a.Gold.toString()));
this._avatarLink=a.Avatar;0<=parseInt(this._avatarLink)?this.nodeAvartar.setSpriteFrame(PreLoaderConfig.PathToAvatar+this._avatarLink+".png"):this.nodeAvartar.setSpriteFrame(PreLoaderConfig.PathToAvatarDefault);this.nodeAvartar.setScaleX(66/this.nodeAvartar.getContentSize().width);this.nodeAvartar.setScaleY(66/this.nodeAvartar.getContentSize().height)}},_onLoadImgComplete:function(a,b){if(b){var d=new cc.Texture2D;d.initWithElement(b);d.handleLoadedTexture();var e=cc.SpriteFrame.create();e.setTexture(d);
e.setRect(cc.rect(0,0,d.width,d.height));e.setRectInPixels(cc.rect(0,0,d.width,d.height));cc.spriteFrameCache.addSpriteFrame(e,this._avatarLink);this.avatar.setMask(this._avatarLink,cc.rect(0,0,d.width,d.height),"HeaderAvatarMask.png");this.nodeAvartar.removeAllChildren(!0);this.nodeAvartar.addChild(this.avatar);this.avatar.setPosition(cc.p(this.nodeAvartar.getContentSize().width/2,this.nodeAvartar.getContentSize().height/2))}},onMailInfo:function(a){a.getUserData().haveNew?this.iconNewMail.setVisible(!0):
this.iconNewMail.setVisible(!1)}}),MGCompoHeaderLogin=MGBaseNode.extend({btnLogo:null,btnRegister:null,btnLogin:null,btnFaccebook:null,btnGoogle:null,txtUserName:null,txtPassword:null,edtiBoxUserName:null,edtiBoxPassword:null,countBug:0,_listEvents:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.btnLogo=this.getChildByName("MGButton_Logo");this.btnLogo.setVisible(!1);this.btnRegister=this.getChildByName("MGButton_Regit");this.btnLogin=this.getChildByName("MGButton_Login");
this.btnFaccebook=this.getChildByName("MGButton_LoginFaceBook");this.btnGoogle=this.getChildByName("MGButton_LoginGoogle");this.edtiBoxUserName=new MGBaseEditBox(this.getChildByName("MGTxtNickName"),"BackgroundTextInput.png");this.edtiBoxUserName.setName("MGEditBoxTxtNickName");this.edtiBoxUserName.maxLength=15;cc.sys.isNative||(this.edtiBoxUserName.setContentSize(169,37),this.edtiBoxUserName.setDelegate(this));this.edtiBoxPassword=new MGBaseEditBox(this.getChildByName("MGTxtPassword"),"BackgroundTextInput.png");
this.edtiBoxPassword.setName("MGEditBoxTxtPassword");this.edtiBoxPassword.maxLength=15;this.edtiBoxPassword.setDelegate(this);if(cc.sys.isNative)this.addChild(this.edtiBoxUserName),this.addChild(this.edtiBoxPassword);else{var a=this.edtiBoxUserName.getPosition(),b=new cc.Sprite("#BackgroundTextInput.png"),b=new cc.ClippingNode(b);b.alphaThreshold=1;this.addChild(b);this.edtiBoxUserName.setPosition(0,0);b.addChild(this.edtiBoxUserName);b.setPosition(a);a=this.edtiBoxPassword.getPosition();b=new cc.Sprite("#BackgroundTextInput.png");
b=new cc.ClippingNode(b);b.alphaThreshold=1;this.edtiBoxPassword.setPosition(0,0);b.addChild(this.edtiBoxPassword);b.setPosition(a);this.addChild(b);this.edtiBoxUserName._renderCmd._edTxt.addEventListener("keydown",this.onUserKeyDown.bind(this,this.edtiBoxUserName))}this._initEventBtnFromNode();this._initEventsGame()},_initEventsGame:function(){this._listEvents=[];this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.LOGIN_FACEBOOK,this.onEventLoginFaceBook.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.LOGIN_GOOGLE,this.onEventLoginGoogle.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.MOBILE_LOGIN,this.onEventMobileLogin.bind(this)));Utilities.enabled_sdkbox()&&sdkbox.PluginFacebook.setListener({onLogin:this.onFacebookSDKLogin.bind(this)})},checkLastLogin:function(){var a=cc.sys.localStorage.getItem("LastToken");a&&""!=a?(MGGameInfo.token4web=a,Utilities.verifyToken(MGGameInfo.token4web,
this.checkAutoLogin.bind(this))):this.updateRememberAccount()},setEnableWidgetControl:function(a){this.edtiBoxUserName.setVisible(a);this.edtiBoxPassword.setVisible(a)},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButton_Login":this.onLogin();break;case "MGButton_Regit":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_REGISTER,
{});break;case "MGButton_ForgetPass":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_HOTROKH,{});break;case "MGButton_LoginFaceBook":this.onEventLoginFaceBook(null);break;case "MGButton_LoginGoogle":this.onEventLoginGoogle(null)}},onEventLoginFaceBook:function(a){Utilities.enabled_sdkbox()?(sdkbox.PluginFacebook.isLoggedIn()&&sdkbox.PluginFacebook.logout(),sdkbox.PluginFacebook.login()):(MGGameInfo.myInfo.UserID=0,Utilities.getTokenFB(this.onLoginFBcalLBack.bind(this)))},onEventLoginGoogle:function(a){MGGameInfo.myInfo.UserID=
0;Utilities.getTokenGoogle(this.onLoginGooglecalLBack.bind(this))},onLoginFBcalLBack:function(a){Utilities.showLog("get Token FB "+a);this.onLoginFB(a)},onLoginGooglecalLBack:function(a){Utilities.showLog("get Token google "+a);this.onLoginGoogle(a)},onLoginFB:function(a){Utilities.loginFB(this.onLoginFBCallBack.bind(this,ConstantsVariable.LoginProviderID.Facebook),a)},onLoginGoogle:function(a){Utilities.loginGoogle(this.onLoginFBCallBack.bind(this,ConstantsVariable.LoginProviderID.Google),a)},onLoginFBCallBack:function(a,
b){if(b.result)MGGameInfo.token4web=b.data.accessToken,Utilities.getAPIBeforeLogin("common","socket_info",{},this.onCallBackGetSocketInfo.bind(this)),MGGameInfo.myInfo.IsOpenID=!0,cc.sys.localStorage.setItem("LastLoginType",a),cc.sys.localStorage.setItem("LastToken",MGGameInfo.token4web);else{var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]=b.message;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}},onLogin:function(){var a=
this.edtiBoxUserName.getString(),b=this.edtiBoxPassword.getString();cc.sys.localStorage.setItem("UserName",a);cc.sys.localStorage.setItem("Password",b);this.checkValue(a,b)&&Utilities.encrypt(b);this.onCallBackGetSocketInfo({result:1,data:[{ServerIP:"isoftage.com",PortWS:1230,ModuleId:1}]})},onCallBackLogin:function(a,b,d){d.result&&(MGGameInfo.token4web=d.data.accessToken,MGGameInfo.myInfo.IsOpenID=!1,cc.sys.localStorage.setItem("LastLoginType",ConstantsVariable.LoginProviderID.Normal),cc.sys.localStorage.setItem("LastToken",
MGGameInfo.token4web),Utilities.getAPIBeforeLogin("common","socket_info",{},this.onCallBackGetSocketInfo.bind(this)))},onCallBackGetSocketInfo:function(a){a.result&&(a=a.data[0],PreLoaderConfig.ServerAndPortSocketManager=a.ServerIP+":"+a.PortWS,MGNetCore.MGSocket.setSocketModuleID(a.ModuleId),MGGameInfo.MGMain.showLoading(),MGGameInfo.MGMain.connectSocketServer())},checkValue:function(a,b){if(""==a){var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]=
"Vui lòng nhập tên đăng nhập.";cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d);return!1}return""==b?(d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]="Vui lòng nhập mật khẩu.",cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d),!1):!0},onUserKeyDown:function(a,b){if(b.keyCode===cc.KEY.tab)switch(b.stopPropagation(),b.preventDefault(),a.getName()){case "MGEditBoxTxtNickName":this.edtiBoxPassword.setFocus()}},checkAutoLogin:function(a){a.result?
Utilities.getAPIBeforeLogin("common","socket_info",{},this.onCallBackGetSocketInfo.bind(this)):this.updateRememberAccount()},editBoxEditingDidEnded:function(a){this.updateRenderWeb(a)},updateRenderWeb:function(a){if(!cc.sys.isNative){var b=a._renderCmd._textLabel.getDimensions();a._renderCmd._textLabel.setDimensions(300,b.height)}},editBoxReturn:function(a){switch(a.getName()){case "MGEditBoxTxtPassword":this.onLogin()}},onFacebookSDKLogin:function(a,b){if(a&&Utilities.enabled_sdkbox())this.onLoginFBcalLBack(sdkbox.PluginFacebook.getAccessToken())},
onEventMobileLogin:function(a){a=a.getUserData();this.onCallBackLogin(a[MGLayerPopupLogin.DATA.USER],a[MGLayerPopupLogin.DATA.PASS],a[MGCompoHeaderLogin.DATA.LOGIN_DATA])},updateRememberAccount:function(){var a="",b="";switch(cc.sys.localStorage.getItem("LastLoginType")){case ConstantsVariable.LoginProviderID.Normal.toString():a=cc.sys.localStorage.getItem("UserName"),b=cc.sys.localStorage.getItem("Password"),""!=a&&""!=b&&null!=a&&null!=b&&(this.edtiBoxUserName.setString(a),this.edtiBoxPassword.setString(b),
this.updateRenderWeb(this.edtiBoxUserName),this.updateRenderWeb(this.edtiBoxPassword))}if(cc.sys.isNative){var d={};d[MGLayerPopupLogin.DATA.USER]=a;d[MGLayerPopupLogin.DATA.PASS]=b;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_LOGIN,d)}},show:function(){this.setVisible(!0);this.edtiBoxUserName.setPositionY(0);this.edtiBoxPassword.setPositionY(0)},hide:function(){this.setVisible(!1);this.edtiBoxUserName.setPositionY(100);this.edtiBoxPassword.setPositionY(100)}});
MGCompoHeaderLogin.DATA={LOGIN_DATA:"LOGIN_DATA"};
var MGCompoHeader=MGBaseNode.extend({_nodeSubMenu:null,_nodeMenuInGame:null,_nodeHeaderLogin:null,_nodeHeaderLogged:null,isShow:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.isShow=!0;this._nodeMenuInGame=new MGCompoHeaderMenuInGame;this._nodeMenuInGame.cloneFromNode(this.getChildByName("MGNodeBtnMenuInGame"));this._nodeMenuInGame.initObj();this.addChild(this._nodeMenuInGame);this._nodeSubMenu=new MGCompoHeaderSubMenu;this._nodeSubMenu.cloneFromNode(this.getChildByName("MGNodeSubMenu"));
this._nodeSubMenu.initObj();this.addChild(this._nodeSubMenu);this._nodeHeaderLogin=new MGCompoHeaderLogin;this._nodeHeaderLogin.cloneFromNode(this.getChildByName("MGNodeHeaderLogin"));this._nodeHeaderLogin.initObj();this.addChild(this._nodeHeaderLogin);this._nodeHeaderLogged=new MGCompoHeaderLogged;this._nodeHeaderLogged.cloneFromNode(this.getChildByName("MGNodeHeaderLogged"));this._nodeHeaderLogged.initObj();this.addChild(this._nodeHeaderLogged);this._nodeHeaderLogged.setVisible(!1);this._nodeMenuInGame.setVisible(!1);
this._initEventsGame()},setEnableWidgetControl:function(a){this._nodeHeaderLogin.setEnableWidgetControl(a)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.LOGGED,this._onHeaderLogged.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.SET_SHOW,this.setShow.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.GLOBAL_CLICK,
this.onGlobalClick.bind(this)))},setShow:function(a){(a=a.getUserData())&&void 0!=a[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]&&null!=a[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]&&this.setVisibleSubMenuInGame(a[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]);this.stopAllActions();void 0!=a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]&&null!=a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]?!1===a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]?this.isShow?(this.setPosition(MGCompoHeader.POSITION.SHOW),
this.runAction(cc.sequence(cc.moveTo(.3,MGCompoHeader.POSITION.HIDE).easeBackOut(3),cc.callFunc(this.onShow.bind(this,a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]))))):this.setPosition(MGCompoHeader.POSITION.HIDE):this.isShow?this.setPosition(MGCompoHeader.POSITION.SHOW):(this.setPosition(MGCompoHeader.POSITION.HIDE),this.runAction(cc.sequence(cc.callFunc(this.onShow.bind(this,a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER])),cc.moveTo(.3,MGCompoHeader.POSITION.SHOW).easeBackOut(3)))):Utilities.showLog("Error dispatch data")},
onShow:function(a){this.isShow=a},setVisibleSubMenuInGame:function(a){this._nodeMenuInGame.setVisible(a)},onUpdateUserInfo:function(a){this._nodeHeaderLogged.updateInfoUser(a)},_onHeaderLogged:function(a){a.getUserData();this._nodeHeaderLogged.setVisible(!0);this._nodeHeaderLogin.hide()},setUILogout:function(){this._nodeHeaderLogged.setVisible(!1);this._nodeHeaderLogin.show();this._nodeSubMenu.setVisible(!1)},onGlobalClick:function(a){cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.OPEN_SUB_MENU,
{data:MGCompoHeaderSubMenu.EVENT_DATA.HIDE})}});MGCompoHeader.EVENTS={LOGGED:"MGCompoHeader.EVENTS.LOGGED",OPEN_SUB_MENU:"MGCompoHeader.EVENT.OPEN_SUB_MENU",UPDATE_USER_INFO:"MGCompoHeader.EVENT.UPDATE_USER_INFO",SET_SHOW:"MGCompoHeader.EVENT.SET_SHOW",SUB_MENU_IN_GAME_BTN_BACK:"MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK",NEW_EMAIL:"MGCompoHeader.EVENTS.NEW_EMAIL",CHANGE_VOLUME:"MGCompoHeader.EVENTS.CHANGE_VOLUME"};
MGCompoHeader.DISPATCHDATA={VISIBLE_SUB_MENU_INGAME:"VISIBLE_SUB_MENU_INGAME",VISIBLE_SUB_MENU_LOBBY:"VISIBLE_SUB_MENU_LOBBY",VISIBLE_HEADER:"VISIBLE_HEADER"};MGCompoHeader.DATA={Gold:0,Avatar:"",UserID:0,PubUserID:0,DisplayName:""};MGCompoHeader.POSITION={SHOW:cc.p(640,682),HIDE:cc.p(640,763)};
var MGCompoFooter=MGBaseNode.extend({txtPageInfo:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.txtPageInfo=this.getChildByName("LblPageInfo");this.txtPageInfo.setString(PreLoaderConfig.Messages.Footer);this._initEventsGame()},_initEventsGame:function(){this._listEvents=[];this._initEventBtnFromNode()},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButton_News":Utilities.showLog("MGButton_News  cc.sys.openURL "+PreLoaderConfig.LINKS.FORUM);cc.sys.openURL(PreLoaderConfig.LINKS.FORUM);
break;case "MGButton_Guide":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{});break;case "MGButton_Fanpage":Utilities.showLog("MGButton_News  cc.sys.openURL "+PreLoaderConfig.LINKS.FANPAGE);cc.sys.openURL(PreLoaderConfig.LINKS.FANPAGE);break;case "MGButton_Support":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_HOTROKH,{});break;case "MGButton_DowloadApp":var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]="Tính năng đang xây dựng.";
cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}}}),MGLayerComponent=MGBaseLayer.extend({compoHeader:null,menuExtend:null,footer:null,compoBroadcast:null,_listEvents:null,compoLobbyControl:null,compoChat:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initEventsGame();this.initHeader();this.initBroadcast();this.initFooter();this.initCompoChat()},initBtnControl:function(){this.compoLobbyControl=new MGCompoLobbyControl;this.compoLobbyControl.cloneFromNode(this._mainLayer.getChildByName("JCNode_Control"));
this.compoLobbyControl.initObj();this._mainLayer.addChild(this.compoLobbyControl)},initCompoChat:function(){this.compoChat=new MGCompoChat;this.compoChat.initObj();this._mainLayer.getChildByName("MGNodeCompoChat").addChild(this.compoChat);this._mainLayer.getChildByName("MGNodeCompoChat").setLocalZOrder(ConstantsVariable.UIZONE.COMPO_CHAT);this.compoChat.setVisible(!1);this.compoChat.updateStage(0,0)},_initEventsGame:function(){this._listEvents=[];this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),
this._onUpdateCoinUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO.toString(),this._updateHeaderUserInfo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.CHAT_MESSAGE.toString(),this._receiveMsgChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoChat.EVENTS.USER_ENTER_CHAT.toString(),this._onSendMsgChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoChat.EVENTS.GET_LIST_USER.toString(),
this._onRequestGetListUserChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.UPDATE_UI_COMPOCHAT.toString(),this.updateUICompoChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.CHAT_LIST_USER.toString(),this._onGetListUserChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.CHAT_ADD_USER.toString(),this._onAddUserChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.CHAT_REMOVE_USER.toString(),
this._onRemoveUserChat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.JOIN_DESK.toString(),this._onJoinDesk.bind(this)))},_onJoinDesk:function(a){a=a.getUserData();var b={GameID:BinaryConstants.DataTypeID.Int8,DeskID:BinaryConstants.DataTypeID.UInt16,IsBigGame:BinaryConstants.DataTypeID.UInt8};a=(new BinaryParser).initObj(b,a.content);a.IsBigGame?(this.compoChat&&this.compoChat.updateStage(a.GameID,a.DeskID),MGGameInfo.GAME_INFO[a.GameID].DeskID=a.DeskID,
MGGameInfo.MGMain.netSend.sendLeaveChatChannel(MGGameInfo.myInfo.UserID,a.GameID,0)):MGGameInfo.MINI_GAME_INFO[a.GameID].DeskID=a.DeskID;MGGameInfo.MGMain.netSend.sendLoginChatChannel(MGGameInfo.myInfo.UserID,MGGameInfo.myInfo.DisplayName,a.GameID,a.DeskID)},updateUICompoChat:function(a){a=a.getUserData();this.compoChat&&(this.compoChat.updateStage(a[ConstantsVariable.EVENTS_KEY.GAME_ID],a[ConstantsVariable.EVENTS_KEY.BOARD_ID]),this.compoChat.updateInfo(MGGameInfo.myInfo.DisplayName))},_onGetListUserChat:function(a){a=
a.getUserData();var b={GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32,ListUser:BinaryConstants.DataTypeID.Array8,ListUser_Type:BinaryConstants.DataTypeID.Object8,ListUser_Struct:{UserID:BinaryConstants.DataTypeID.UInt32,nickName:BinaryConstants.DataTypeID.StringDynamic}};a=(new BinaryParser).initObj(b,a.content);this.compoChat.addListUser(a)},_onAddUserChat:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32,Nickname:BinaryConstants.DataTypeID.StringDynamic,
GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32};a=(new BinaryParser).initObj(b,a.content);this.compoChat.addUser(a)},_onRemoveUserChat:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32,GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32};a=(new BinaryParser).initObj(b,a.content);this.compoChat.removeUser(a)},_receiveMsgChat:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32,
Nickname:BinaryConstants.DataTypeID.StringDynamic,GroupID:BinaryConstants.DataTypeID.UInt32,ChannelID:BinaryConstants.DataTypeID.UInt32,ArrMsg:BinaryConstants.DataTypeID.Array8,ArrMsg_Type:BinaryConstants.DataTypeID.StringDynamic,ArrColor:BinaryConstants.DataTypeID.Array8,ArrColor_Type:BinaryConstants.DataTypeID.StringDynamic};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("_receiveMsgChat "+JSON.stringify(a));0==a.GroupID&&0==a.ChannelID&&cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHAT_SYSTEM,
a);0!=a.GroupID&&0!=a.ChannelID&&cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHAT_IN_GAME,a);this.compoChat.addChat(a)},_onSendMsgChat:function(a){a=a.getUserData();MGGameInfo.MGMain.netSend.sendMsgChat(a)},_onRequestGetListUserChat:function(a){a=a.getUserData();MGGameInfo.MGMain.netSend.sendGetListUserChat(a)},updateUiLoginSuccess:function(){this.updateInfoUser();this.showHeaderLogged()},updateUiLogout:function(){this.showHeaderLogin()},_onUpdateCoinUser:function(a){a=a.getUserData();
var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("UpdateCoinUser: "+JSON.stringify(a));MGGameInfo.myInfo.Gold=a.Gold;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{})},_onRefeshMyGold:function(a){(a=a.getUserData())&&a.Gold?MGGameInfo.myInfo.Gold=a.Gold:this.updateCoin(MGGameInfo.myInfo.Gold)},_updateHeaderUserInfo:function(){var a={};a.Gold=MGGameInfo.myInfo.Gold;a.UserID=MGGameInfo.myInfo.UserID;a.PubUserID=
MGGameInfo.myInfo.PubUserID;a.DisplayName=MGGameInfo.myInfo.DisplayName;a.Avatar=MGGameInfo.myInfo.Avatar;a.IsUpdateInfo=MGGameInfo.myInfo.IsUpdateInfo;this.compoHeader.onUpdateUserInfo(a)},_updateNickname:function(a){a=a.getUserData();Utilities.showLog("####_updateNickname "+a);var b={DisplayName:BinaryConstants.DataTypeID.StringDynamic};a=(new BinaryParser).initObj(b,a.content);MGGameInfo.myInfo.DisplayName=a.DisplayName;this.updateInfoUser()},openMenuExtend:function(){this.menuExtend.setVisible(!this.menuExtend.isVisible())},
initHeader:function(){this.compoHeader=new MGCompoHeader;this.compoHeader.cloneFromNode(this._mainLayer.getChildByName("MGCompoHeaderMenu"));this.compoHeader.initObj();this._mainLayer.addChild(this.compoHeader,0)},initBroadcast:function(){this.compoBroadcast=new MGCompoBroadcast;this.compoBroadcast.setPosition(cc.p(MGCompoBroadcast.POSITION.x,MGCompoBroadcast.POSITION.y));this._mainLayer.addChild(this.compoBroadcast)},initFooter:function(){this.footer=new MGCompoFooter;this.footer.cloneFromNode(this._mainLayer.getChildByName("MGGameFooter"));
this.footer.initObj();this._mainLayer.addChild(this.footer);cc.sys.isNative&&(this.footer.setScale(1.5,1.5),this.footer.getChildByName("MGButton_DowloadApp").setVisible(!1))},showBroadcast:function(a){this.compoBroadcast.showBroadcast(a)},hideBroadcast:function(){this.compoBroadcast.hide()},swipCompoChatControlByLayer:function(a){switch(a){case ConstantsVariable.LAYERS.MENU_LAYER_LOGIN:this.compoChat.setVisible(!1);this.compoChat.updateStage(0,0);break;case ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM:this.compoChat.setVisible(!0);
break;case ConstantsVariable.LAYERS.MENU_LAYER_GAME:this.compoChat.setVisible(!0)}},swipBtnControlByLayer:function(a){switch(a){case ConstantsVariable.LAYERS.MENU_LAYER_LOGIN:a={};a[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]=!1;a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]=!0;cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SET_SHOW,a);this.showFooter();break;case ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM:a={};a[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]=!1;a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]=
!0;cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SET_SHOW,a);this.showFooter();break;case ConstantsVariable.LAYERS.MENU_LAYER_GAME:a={},a[MGCompoHeader.DISPATCHDATA.VISIBLE_SUB_MENU_INGAME]=!0,a[MGCompoHeader.DISPATCHDATA.VISIBLE_HEADER]=!1,cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SET_SHOW,a),this.hideFooter()}},showHeaderLogin:function(){this.compoHeader.setVisible(!0);console.error("MGLayerComponent showHeaderLogin")},showHeaderLogged:function(){this.compoHeader.setVisible(!1);
console.error("MGLayerComponent showHeaderLogged")},showHeaderGame:function(){this.compoHeader.setVisible(!1);console.error("MGLayerComponent showHeaderGame")},updateHeaderLogged:function(a){console.error("MGLayerComponent updateHeaderLogged")},updateCoin:function(a){console.error("MGLayerComponent updateCoin")},hideFooter:function(){this.footer.setVisible(!1)},showFooter:function(){this.footer.setVisible(!0)},updateInfoUser:function(){console.error("MGLayerComponent updateInfoUser")},setEnableWidgetControl:function(a){this.compoHeader.setEnableWidgetControl(a)},
setDispose:function(){for(var a=0;a<this._listEvents.length;a++)cc.eventManager.removeListener(this._listEvents[a])}}),MGNodeBtnLobbyControl=MGBaseNode.extend({_btnBackLobby:null,_btnRank:null,_btnHelp:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this._initEventsGame();cc.sys.isNative||cc.sys.isMobile?(this._btnBackLobby=this.getChildByName("MGBtnBackLobby"),this._btnBackLobby.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnRank=this.getChildByName("MGBtnRank"),
this._btnRank.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnHelp=this.getChildByName("MGBtnHelp"),this._btnHelp.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.setScale(1.5,1.5)):(this._btnBackLobby=new MGBaseButton,this._btnBackLobby.cloneFromButton(this.getChildByName("MGBtnBackLobby")),this._btnBackLobby._initEventsGame(),this.addChild(this._btnBackLobby),this._btnBackLobby.setMouseHoverEnabled(!0),this._btnBackLobby.addMouseHoverEventListener(this._onMouseHover.bind(this)),
this._btnRank=new MGBaseButton,this._btnRank.cloneFromButton(this.getChildByName("MGBtnRank")),this._btnRank._initEventsGame(),this.addChild(this._btnRank),this._btnRank.setMouseHoverEnabled(!0),this._btnRank.addMouseHoverEventListener(this._onMouseHover.bind(this)),this._btnHelp=new MGBaseButton,this._btnHelp.cloneFromButton(this.getChildByName("MGBtnHelp")),this._btnHelp._initEventsGame(),this.addChild(this._btnHelp),this._btnHelp.setMouseHoverEnabled(!0),this._btnHelp.addMouseHoverEventListener(this._onMouseHover.bind(this)));
this._btnBackLobby.setLocalZOrder(0);this._btnBackLobby.setGlobalZOrder(0);this._btnRank.setLocalZOrder(0);this._btnRank.setGlobalZOrder(0);this._btnHelp.setLocalZOrder(0);this._btnHelp.setGlobalZOrder(0);this.getChildByName("TextVeSanh").setLocalZOrder(1);this.getChildByName("ImgIconRank").setLocalZOrder(1);this.getChildByName("ImgIconHelp").setLocalZOrder(1)},_initEventsGame:function(){this._listEvents=[];this._initEventBtnFromNode()},cloneFromButton:function(a){for(this._copyProperties(a);0<a._children.length;)a._children[0].retain(),
a._children[0].removeFromParent(),this.addChild(a._children[0]),a._children[0].release();a.removeFromParent()},_onMouseHover:function(a,b){switch(a.getName()){case "MGBtnBackLobby":b===ConstantsVariable.MG_MOUSE_EVENT.MOUSE_HOVER?this._btnBackLobby.setOpacity(255):this._btnBackLobby.setOpacity(0);break;case "MGBtnRank":b===ConstantsVariable.MG_MOUSE_EVENT.MOUSE_HOVER?this._btnRank.setOpacity(255):this._btnRank.setOpacity(0);break;case "MGBtnHelp":b===ConstantsVariable.MG_MOUSE_EVENT.MOUSE_HOVER?this._btnHelp.setOpacity(255):
this._btnHelp.setOpacity(0)}},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGBtnBackLobby":cc.eventManager.dispatchCustomEvent(MGNodeBtnLobbyControl.EVENT.BACK.toString(),{});this._btnBackLobby.setOpacity(0);this._btnRank.setOpacity(0);this._btnHelp.setOpacity(0);break;case "MGBtnRank":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_BANGXEPHANG.toString(),{});break;case "MGBtnHelp":cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{})}}});
MGNodeBtnLobbyControl.EVENT={BACK:"MGNodeBtnLobbyControl.EVENT.BACK"};
var MGRoomItem=MGBaseNode.extend({RoomType:null,txtBetCoin:null,goldLimitJoin:null,GameID:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.txtBetCoin=this.getChildByName("MGBetCoin");this.txtBetCoin.ignoreContentAdaptWithSize(!0);this._initEventBtnFromNode()},loadDataItem:function(a){this.RoomType=a.RoomTypeID;this.txtBetCoin.setString(Utilities.Coin(a.DisplayName));this.goldLimitJoin=a.GoldLimitJoin},onClickBtnFromCocostudio:function(a,b){if(this.RoomType)if(MGGameInfo.myInfo.Gold>=
this.goldLimitJoin)MGGameInfo.MGMain.netSend.sendJoinRoom(this.GameID,this.RoomType);else{var d={};d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;d[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_NOT_ENOUGH_GOLD;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)}}}),MGCompoListRooms=MGBaseNode.extend({ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.initUIDefault()},initUIDefault:function(){for(var a=0;a<this.getChildrenCount();a++)this.getChildByName("MGRoom"+
a)&&this.getChildByName("MGRoom"+a).setVisible(!1)},updateData:function(a){this.initUIDefault();for(var b=a.ListRoomType,d,e,f=b.length,g=0;g<f;g++){d=new MGRoomItem;d.GameID=a.GameID;e=this.getChildByName("MGRoom"+g);if(cc.sys.isNative){d.setName(e.getName());d.setPosition(e.getPosition());d.setVisible(e.isVisible());for(d.setLocalZOrder(e.getLocalZOrder());0<e.getChildrenCount();){var h=e.getChildren()[0];h.retain();h.removeFromParent(!1);d.addChild(h);h.release()}e.removeFromParent(!1)}else d.cloneFromNode(e);
d.initObj();d.loadDataItem(b[g]);this.addChild(d);d.setVisible(!0)}}}),MGLayerLobby=MGBaseLayer.extend({compoListRoom:null,txtGameName:null,_nodeBtnLobbyControl:null,_listEvents:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initEvents();this.compoListRoom=new MGCompoListRooms;this.compoListRoom.cloneFromNode(this._mainLayer.getChildByName("MGNodeListRoom"));this.compoListRoom.initObj();this.addChild(this.compoListRoom);this.txtGameName=this._mainLayer.getChildByName("MGTittleGameName");
this._nodeBtnLobbyControl=new MGNodeBtnLobbyControl;this._nodeBtnLobbyControl.cloneFromNode(this._mainLayer.getChildByName("MGNodeBtnLobbyController"));this._nodeBtnLobbyControl.initObj();this.addChild(this._nodeBtnLobbyControl)},_initEvents:function(){this._listEvents=[];this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.LIST_ROOM.toString(),this._onHaveListRoom.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGNodeBtnLobbyControl.EVENT.BACK.toString(),
this._onBackToMenuGame.bind(this)))},updateData:function(a){this.compoListRoom.updateData(a);a.IsBigGame&&this.txtGameName.setString(MGGameInfo.getGameNameByID(a.GameID))},_onHaveListRoom:function(a){a=a.getUserData();var b={GameID:BinaryConstants.DataTypeID.UInt32,ListRoomType:BinaryConstants.DataTypeID.Array8,ListRoomType_Type:BinaryConstants.DataTypeID.Object8,ListRoomType_Type_Struct:{GameID:BinaryConstants.DataTypeID.UInt32,DisplayName:BinaryConstants.DataTypeID.StringDynamic,RoomTypeID:BinaryConstants.DataTypeID.UInt16,
GoldLimitJoin:BinaryConstants.DataTypeID.UInt64},IsBigGame:BinaryConstants.DataTypeID.UInt8},b=(new BinaryParser).initObj(b,a.content);Utilities.showLog("_onHaveListRoom "+JSON.stringify(b));switch(b.GameID){case MGGameInfo.IDSlotLuxury:case MGGameInfo.IDFruitKong:case MGGameInfo.IDDemCuu:case MGGameInfo.IDDiamonds777:case MGGameInfo.IDSlotBAPD:case MGGameInfo.IDSlotVanPhuc:case MGGameInfo.IDSlotPanda:case MGGameInfo.IDSlotHoangCung:case MGGameInfo.IDSlotThamHiem:case MGGameInfo.IDSlotAladin:case MGGameInfo.IDSlotAiCap:MGGameInfo.myInfo.Gold>=
b.ListRoomType[0].GoldLimitJoin?(MGGameInfo.MGMain.netSend.sendJoinRoom(b.GameID,b.ListRoomType[0].RoomTypeID),this.setVisible(!1)):(a={},a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,a[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_NOT_ENOUGH_GOLD,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a));break;case MGGameInfo.IDMiniTrenDuoi:case MGGameInfo.IDMiniCaoThap:case MGGameInfo.IDMiniDaoMo:MGGameInfo.myInfo.Gold>=b.ListRoomType[0].GoldLimitJoin?MGGameInfo.MGMain.netSend.sendJoinRoom(b.GameID,
b.ListRoomType[0].RoomTypeID):(a={},a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,a[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_NOT_ENOUGH_GOLD,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a));break;default:this.updateData(b),b.IsBigGame&&(MGGameInfo.GAME_INFO[b.GameID]={},MGGameInfo.GAME_INFO[b.GameID].GameID=b.GameID,a={},a[ConstantsVariable.EVENTS_KEY.GAME_ID]=b.GameID,a[ConstantsVariable.EVENTS_KEY.BOARD_ID]=0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.UPDATE_UI_COMPOCHAT.toString(),
a)),this.setVisible(!0),MGGameInfo.MGMain.netSend.sendLoginChatChannel(MGGameInfo.myInfo.UserID,MGGameInfo.myInfo.DisplayName,b.GameID,0),MGGameInfo.MGMain.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM)}},_onBackToMenuGame:function(a){a.getUserData();this.setVisible(!1);for(var b in MGGameInfo.GAME_INFO)MGGameInfo.MGMain.netSend.sendLeaveChatChannel(MGGameInfo.myInfo.UserID,MGGameInfo.GAME_INFO[b].GameID,0),delete MGGameInfo.GAME_INFO[b];MGGameInfo.MGMain.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_LOGIN)}}),
MGGameInfo=cc.Class.extend({ctor:function(){}});MGGameInfo._paused=!1;MGGameInfo.token4web="toekenekforWeb";MGGameInfo.totalUserOnline="0";MGGameInfo.appRealWidth=cc.game.config.gameWidth;MGGameInfo.appRealHeight=cc.game.config.gameHeight;MGGameInfo.AppVersion=cc.game.config.AppVersion;MGGameInfo.deviceID="897DE058-695A-435D-9EE9-8657924B018D";MGGameInfo.VersionDevice=9;MGGameInfo.DeviceModel="IPhone 5S";MGGameInfo.gameVolume=1E4;MGGameInfo.GameID=0;MGGameInfo.IDTaiXiu=PreLoaderConfig.IDTaiXiu;
MGGameInfo.IDTLMN=PreLoaderConfig.IDTLMN;MGGameInfo.IDXocDia=PreLoaderConfig.IDXocDia;MGGameInfo.IDXengMini=PreLoaderConfig.IDXengMini;MGGameInfo.IDSamLoc=PreLoaderConfig.IDSamLoc;MGGameInfo.IDBinh=PreLoaderConfig.IDBinh;MGGameInfo.IDPhom=PreLoaderConfig.IDPhom;MGGameInfo.IDXito=PreLoaderConfig.IDXito;MGGameInfo.IDPoker=PreLoaderConfig.IDPoker;MGGameInfo.IDLieng=PreLoaderConfig.IDLieng;MGGameInfo.IDDanhChan=PreLoaderConfig.IDDanhChan;MGGameInfo.IDSlotPoker=PreLoaderConfig.IDSlotPoker;
MGGameInfo.IDSlotLuxury=PreLoaderConfig.IDSlotLuxury;MGGameInfo.IDFruitKong=PreLoaderConfig.IDFruitKong;MGGameInfo.IDDemCuu=PreLoaderConfig.IDDemCuu;MGGameInfo.IDDiamonds777=PreLoaderConfig.IDDiamonds777;MGGameInfo.IDMiniTrenDuoi=PreLoaderConfig.IDMiniTrenDuoi;MGGameInfo.IDSlotBAPD=PreLoaderConfig.IDSlotBAPD;MGGameInfo.IDSlotVanPhuc=PreLoaderConfig.IDSlotVanPhuc;MGGameInfo.IDSlotPanda=PreLoaderConfig.IDSlotPanda;MGGameInfo.IDSlotHoangCung=PreLoaderConfig.IDSlotHoangCung;
MGGameInfo.IDSlotThamHiem=PreLoaderConfig.IDSlotThamHiem;MGGameInfo.IDSlotAladin=PreLoaderConfig.IDSlotAladin;MGGameInfo.IDSlotAiCap=PreLoaderConfig.IDSlotAiCap;MGGameInfo.IDMiniCaoThap=PreLoaderConfig.IDMiniCaoThap;MGGameInfo.IDMiniVQMM=PreLoaderConfig.IDMiniVQMM;MGGameInfo.IDMiniDaoMo=PreLoaderConfig.IDMiniDaoMo;MGGameInfo.isUserLogout=!1;MGGameInfo.IsExchangeCard=!0;MGGameInfo.IsChargeCard=!0;MGGameInfo.IsReview=!1;
MGGameInfo.apiInfo={userName:"",channel:"",platform:"",version:"",deviceId:"",packageName:"",versionDevice:0,brand:"",model:"",service:"game"};MGGameInfo.MINI_GAME_INFO={};MGGameInfo.WEB_GAME_INFO={};MGGameInfo.GAME_INFO={};MGGameInfo.myInfo={UserID:0,DeskID:0,chairId:null,Gold:0,Level:0,Exp:0,DisplayName:"",WSToken:"",VipLevel:0,Avatar:"",IsUpdateInfo:!1,CMND:0,Phone:0,IsOpenID:!1};MGGameInfo.gameInfo={deskID:0,minBet:0,maxBet:0,betCoin:0,MatchID:0,totalBet:0};
MGGameInfo.getGameNameByID=function(a){switch(a){case MGGameInfo.IDXocDia:return"XÓC ĐĨA";case MGGameInfo.IDTaiXiu:return"TÀI XỈU";case MGGameInfo.IDTLMN:return"TIẾN LÊN";case MGGameInfo.IDXengMini:return"XÈNG";case MGGameInfo.IDSamLoc:return"SÂM LỐC";case MGGameInfo.IDPhom:return"Ù";case MGGameInfo.IDBinh:return"BINH";case MGGameInfo.IDSlotLuxury:return"SLOT LUXURY";case MGGameInfo.IDFruitKong:return"FruitKong";case MGGameInfo.IDDemCuu:return"ĐẾM CỪU";case MGGameInfo.IDDiamonds777:return"DIAMONDS 777";
case MGGameInfo.IDMiniTrenDuoi:return"TRÊN DƯỚI";case MGGameInfo.IDXito:return"XÌ TỐ";case MGGameInfo.IDLieng:return"LIÊNG";case MGGameInfo.IDSlotBAPD:return"BÍ ẨN PHƯƠNG ĐÔNG";case MGGameInfo.IDSlotVanPhuc:return"XÈNG VẠN PHÚC";case MGGameInfo.IDSlotPanda:return"XÈNG PANDA";case MGGameInfo.IDSlotHoangCung:return"XÈNG HOÀNG CUNG";case MGGameInfo.IDSlotThamHiem:return"XÈNG NHÀ THÁM HIÊM";case MGGameInfo.IDSlotAladin:return"XÈNG ALADIN";case MGGameInfo.IDSlotAiCap:return"XÈNG AI CẬP";case MGGameInfo.IDMiniCaoThap:return"CAO THẤP";
case MGGameInfo.IDMiniVQMM:return"VÒNG QUAY MAY MAN";case MGGameInfo.IDMiniDaoMo:return"ĐÀO MỎ"}return MGGameInfo.GameID.toString()};MGGameInfo.MGMain;MGGameInfo.MGScreenController;
var MGBannerEventItem=ccui.Layout.extend({linkImg:null,eventUrl:"",ctor:function(){ccui.Layout.prototype.ctor.call(this)},initObj:function(a,b){this.setTouchEnabled(!0);this.addClickEventListener(this.onOpenEvent.bind(this));this.eventUrl=b;(this.linkImg=a)&&cc.loader.loadImg(this.linkImg,{isCrossOrigin:!0},this._onLoadImgComplete.bind(this))},_onLoadImgComplete:function(a,b){if(b){var d=new cc.Sprite(b);d.setAnchorPoint(cc.p(0,0));this.addChild(d)}},onOpenEvent:function(a,b){""!=this.eventUrl&&cc.sys.openURL(this.eventUrl)}}),
MGBannerEvent=cc.Class.extend({pageView:null,pageIndex:0,totalPage:null,ctor:function(){},initObj:function(a){this.pageView=a},loadData:function(){},onGetEventInfo:function(a){if(a.result){var b=0,d=a.data.length;this.pageView.removeAllPages();var e;for(b;b<d;b++)e=new MGBannerEventItem,e.initObj(a.data[b].image,a.data[b].link),this.pageView.addPage(e);1<d&&(this.totalPage=d,this.pageView.schedule(this.showNetBase.bind(this),3))}},showNetBase:function(){this.pageIndex++;this.pageIndex>=this.totalPage&&
(this.pageIndex=0);this.pageView.scrollToItem(this.pageIndex)},hide:function(){this.pageView.setVisible(!1)},show:function(){this.pageView.setVisible(!0)}});ResourceManager.MGResourcesLoading={BackgroundMain:"res/main/GameIcons/BackgroundMain.jpg",AtlasLoading_plist:"res/main/atlas/AtlasLoading/AtlasLoading.plist",AtlasLoading_png:"res/main/atlas/AtlasLoading/AtlasLoading.png",CCSUILoadingLayer:"res/main/UILoadingLayer.json"};var resourcesLoading=[];
for(i in ResourceManager.MGResourcesLoading)ResourceManager.MGResourcesLoading[i]=""+cc.loader.resPath+ResourceManager.MGResourcesLoading[i],resourcesLoading.push(ResourceManager.MGResourcesLoading[i]);
var MGLoadingScreen=MGBaseLayer.extend({callBackFinishLoading:null,totalFile:0,currentFile:0,loadingBar:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this)},initObj:function(a){this.callBackFinishLoading=a;this._initFromCocostudio(ResourceManager.MGResourcesLoading.CCSUILoadingLayer);this.loadingBar=this._mainLayer.getChildByName("LoadingBar")},loadResources:function(){MGGameInfo.myInfo.loginState=-1;this.totalFile=resourcesMenuGame.length+resourcesMainPopup.length+resourceComponents.length;
this.currentFile=0;cc.loader.load(resourcesMenuGame,this.onloading.bind(this),this._onLoadResourceMenuGameComplete.bind(this,resourcesMenuGame))},_onLoadResourceMenuGameComplete:function(a){for(var b in a)-1!=a[b].indexOf(".plist")&&cc.spriteFrameCache.addSpriteFrames(a[b],a[b].replace(".plist",".png"));cc.loader.load(resourcesMainPopup,this.onloading.bind(this),this._onLoadResourcePopupGameComplete.bind(this,resourcesMainPopup))},_onLoadResourcePopupGameComplete:function(a){for(var b in a)-1!=a[b].indexOf(".plist")&&
cc.spriteFrameCache.addSpriteFrames(a[b],a[b].replace(".plist",".png"));cc.loader.load(resourceComponents,this.onloading.bind(this),this._onLoadResourceComponentComplete.bind(this,resourceComponents))},_onLoadResourceComponentComplete:function(a){for(var b in a)-1!=a[b].indexOf(".plist")&&cc.spriteFrameCache.addSpriteFrames(a[b],a[b].replace(".plist",".png"));this.callBackFinishLoading()},onloading:function(a,b,d){cc.sys.isNative||(this.currentFile++,a=Math.round(this.currentFile/this.totalFile*100),
this.loadingBar.setPercent(a-a%4.15))}}),MGMainScreen=MGBaseLayer.extend({layerMenuGames:null,layerLobby:null,layerGame:null,layerMiniGame:null,layerComponents:null,_background:null,netSend:null,_game:null,layerLoading:null,currentMainLayer:null,banerEvent:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);MGGameInfo.MGMain=this;this.currentMainLayer=0},initObj:function(){this._initBaseData();this._initFromCocostudio(ResourceManager.MGResourcesMenuGame.CCSUIMenuGameLayer);this._initNetwork();
this._initEventsGame();this._initLayerMenuGame();this._initlayerComponents();this._initLayerLobby();this._initLayerGame();this._initBannerEvent();this._initConfigIAP()},_initBaseData:function(){if(!MGGameInfo.isDevVer){var a=Utilities.getDeviceInfo().split(":");""!=a&&(MGGameInfo.deviceID=a[0],MGGameInfo.DeviceModel=a[1],MGGameInfo.VersionDevice=a[2]);a=Utilities.getPackageName();""!=a&&(PreLoaderConfig.PackageName=a)}MGGameInfo.apiInfo.channel=ConstantsVariable.CHANNEL_ID;MGGameInfo.apiInfo.platform=
Utilities.getPlatformID();MGGameInfo.apiInfo.version=MGGameInfo.AppVersion;MGGameInfo.apiInfo.deviceId=MGGameInfo.deviceID;MGGameInfo.apiInfo.packageName=PreLoaderConfig.PackageName;MGGameInfo.apiInfo.versionDevice=MGGameInfo.VersionDevice;MGGameInfo.apiInfo.model=MGGameInfo.DeviceModel;MGGameInfo.apiInfo.brand="pc";MGGameInfo.apiInfo.service=PreLoaderConfig.Service},swipLayer:function(a){this.layerComponents.swipCompoChatControlByLayer(a);switch(a){case ConstantsVariable.LAYERS.MENU_LAYER_LOGIN:this.currentMainLayer===
ConstantsVariable.LAYERS.MENU_LAYER_GAME&&this.layerComponents.swipBtnControlByLayer(a);var b={id:0};b[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesLoading.BackgroundMain;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,b);this.currentMainLayer=ConstantsVariable.LAYERS.MENU_LAYER_LOGIN;this.layerLobby.runAction(cc.moveTo(.5,cc.p(0,0)).easing(cc.easeInOut(3)));this.onExitGame();this.layerLobby.setVisible(!1);this.layerGame.setVisible(!1);
this.layerMenuGames.setVisible(!0);this.banerEvent.show();this._mainLayer.getChildByName("MGBackgroundImageLeft").setVisible(!0);break;case ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM:this.currentMainLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&this.layerComponents.swipBtnControlByLayer(a);b={id:1};b[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesMenuGame.BackgroundGame;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,b);this.onExitGame();
this.currentMainLayer=ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM;this.layerLobby.setVisible(!0);this.layerMenuGames.setVisible(!1);this.banerEvent.hide();this._mainLayer.getChildByName("MGBackgroundImageLeft").setVisible(!1);break;case ConstantsVariable.LAYERS.MENU_LAYER_GAME:this.currentMainLayer=ConstantsVariable.LAYERS.MENU_LAYER_GAME,b={id:2},b[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesMenuGame.BackgroundGame,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,
b),this.layerComponents.swipBtnControlByLayer(a),this.layerLobby.setVisible(!1),this.layerMenuGames.setVisible(!1),this.layerGame.setVisible(!0),this.banerEvent.hide(),this._mainLayer.getChildByName("MGBackgroundImageLeft").setVisible(!1)}},_initLayerMenuGame:function(){this.layerMenuGames=new MGNodeMenuGames;this.layerMenuGames.cloneFromLayer(this._mainLayer.getChildByName("MGTabNode"));this.layerMenuGames.initObj();this.addChild(this.layerMenuGames);this.layerMenuGames.setVisible(!0)},_initlayerComponents:function(){this.layerComponents=
new MGLayerComponent;this.layerComponents.setName("layerComponents");this.layerComponents.cloneFromLayer(this._mainLayer.getChildByName("MGLayerComponent"));this.layerComponents.initObj();this.addChild(this.layerComponents,ConstantsVariable.UIZONE.COMPONENT)},_initLayerLobby:function(){this.layerLobby=new MGLayerLobby;this.layerLobby.setName("layerLobby");this.layerLobby.cloneFromLayer(this._mainLayer.getChildByName("MGLayerLobby"));this.layerLobby.initObj();this.addChild(this.layerLobby);this.layerLobby.setVisible(!1)},
_initLayerGame:function(){this.layerGame=new MGBaseLayer;this.layerGame._initEventsGame();this.addChild(this.layerGame);this.layerGame.setVisible(!1)},_initBannerEvent:function(){this.banerEvent=new MGBannerEvent;this.banerEvent.initObj(this._mainLayer.getChildByName("MGPageViewEvent"))},onGetApiListGames:function(){this.onHaveListGames()},onHaveListGames:function(a){a={result:1,data:[{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:1,GameName:"Tai Xiu  ",GameModuleID:1001,IsEnable:!0,
IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:3,GameName:"Xoc Dia  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:14,GameName:"Fruit Kong  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:15,GameName:"Dem Cuu  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,
GameID:13,GameName:"Slot Luxury  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:21,GameName:"Slot Hoang Cung  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:19,GameName:"Van Phuc  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:18,GameName:"Bi An Phuong Dong  ",GameModuleID:1001,
IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:22,GameName:"Slot Nham tham hiem  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:23,GameName:"Slot Aladin  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:20,GameName:"Slot Panda  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,
GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:24,GameName:"Slot Aicap  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.SLOT,GameID:16,GameName:"Slot Diamond 777  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.CARD,GameID:10,GameName:"Lieng",IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.CARD,GameID:2,GameName:"Tien Len Mien Nam  ",
GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.CARD,GameID:5,GameName:"Sam Loc  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.CARD,GameID:8,GameName:"XiTo  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,GameType:MGNodeMenuGames.GAME_TYPE.CARD,GameID:7,GameName:"Phom  ",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:0,
GameType:MGNodeMenuGames.GAME_TYPE.CARD,GameID:6,GameName:"Binh",GameModuleID:1001,IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:1,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:27,GameName:" IDMiniDaoMo   ",IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:1,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:17,GameName:" Tai Xiu   ",IsEnable:!0,IsHot:!1,IsNew:!1,LinkIcon:""},{IsMiniGame:1,GameType:MGNodeMenuGames.GAME_TYPE.BET,GameID:25,GameName:" Cao Thap   ",IsEnable:!0,IsHot:!1,IsNew:!1,
LinkIcon:""}]};if(a.result){var b=[],d=[],e=0;a=a.data;var f=a.length;for(e;e<f;e++)a[e].IsMiniGame?b.push(a[e]):d.push(a[e]);this.layerMenuGames.setListGameData(d);d={};d[MGCompoListMiniGame.DATA.LIST]=b;cc.eventManager.dispatchCustomEvent(MGCompoListMiniGame.EVENTS.UPDATE_LIST,d)}},showLoading:function(){this.layerLoading&&this.layerLoading.show()},hideLoading:function(){this.layerLoading&&this.layerLoading.hide()},setlayerLoading:function(a){this.layerLoading=a},_initEventsGame:function(){MGBaseLayer.prototype._initEventsGame.call(this);
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GET_MASTERID.toString(),this._getMasterModuleId.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.LOGIN_MASTER.toString(),this._ngloginSuccess.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.CREATE_NICK_NAME.toString(),this._ngUpdateNickName.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_KICK.toString(),
this._systemKick.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.DISCONNECT.toString(),this.onDisconnectGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.MASTER_LOGOUT.toString(),this.logoutGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.USER_INFO.toString(),this.onGetUserInfo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK.toString(),
this.onSendLeaveDesk.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MG_POPUPS.SHOW_POPUP_LAYER.toString(),this.onLayerPopupShowHide.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_MESSAGE.toString(),this._systemMessage.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.INVALID_TOKEN,this.onInvalidToken.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.LEAVE_WEB_GAME,
this._leaveWebGame.bind(this)))},_initConfigIAP:function(){cc.sys.isNative&&cc.sys.isMobile&&Utilities.getOperatorName();this.layerComponents.compoHeader._nodeHeaderLogin.onLogin()},onLayerPopupShowHide:function(a){a=a.getUserData();this.layerComponents.setEnableWidgetControl(!a[MG_POPUP_KEY_DATA.POPUP_LAYER_SHOW]);this.layerMenuGames.setEnableWidgetControl(!a[MG_POPUP_KEY_DATA.POPUP_LAYER_SHOW])},_systemMessage:function(a){a=a.getUserData();var b={Msg:BinaryConstants.DataTypeID.StringDynamic},b=
(new BinaryParser).initObj(b,a.content);a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]=b.Msg;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)},onExitGame:function(){if(this._game&&this._game.resourceGame)for(var a in this._game.resourceGame)-1!=this._game.resourceGame[a].indexOf(".plist")&&cc.spriteFrameCache.removeSpriteFramesFromFile(this._game.resourceGame[a]);cc.sys.isNative?(this.layerGame&&(this.layerGame.setDispose(),this.layerGame.setVisible(!1)),
this._game&&(this._game.setDispose(),this._game=null)):(this.layerGame&&(this.layerGame.setDispose(),this.layerGame.setVisible(!1),this.layerGame.removeAllChildren(!0)),this._game&&(this._game.setDispose(),this._game.removeAllChildren(!0),this._game=null))},onSendLeaveDesk:function(){this.netSend.sendLeaveDesk()},_initNetwork:function(){this.netSend=new MGNetSend;MGNetCore.MGSocket=new MGNetCore;MGNetCore.MGSocket.callBackOnError=this._onErrorMasterServer.bind(this);MGNetCore.MGSocket.callBackOnClose=
this._onCloseMasterServer.bind(this);MGNetCore.MGSocket.callBackOnConnected=this._onConnectedSocketServer.bind(this);MGNetCore.MGSocket.callBackOnReceiveData=this._onReceiveMasterServer.bind(this)},connectSocketServer:function(){MGGameInfo.isUserLogout=!1;MGNetCore.MGSocket.initObj(PreLoaderConfig.ServerAndPortSocketManager);MGNetCore.MGSocket.connect()},_onConnectedSocketServer:function(a){this.netSend.sendGetMasterModuleID()},_onReceiveMasterServer:function(a){cc.eventManager.dispatchCustomEvent(a.requestId.toString(),
a)},_onErrorMasterServer:function(a){Utilities.showLog("--MGNetCore-- onErrorMasterServer "+a);this.setUILogout();a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]="THÔNG BÁO";a[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_MASTER_SOCKET;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)},_onCloseMasterServer:function(a){Utilities.showLog("--MGNetCore-- onCloseMasterServer ");this.setUILogout();this.logoutGame();MGGameInfo.isUserLogout||(a={},a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=
"THÔNG BÁO",a[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_MASTER_SOCKET,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a))},logoutGame:function(){Utilities.showLog("--MGNetCore-- logoutGame");MGNetCore.MGSocket.close()},setUILogout:function(){Utilities.showLog("--MGNetCore-- setUILogout");cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.OPEN_SUB_MENU,{data:MGCompoHeaderSubMenu.EVENT_DATA.HIDE});this.layerComponents.compoHeader.setUILogout();this.layerComponents.compoHeader._nodeHeaderLogin.updateRememberAccount();
this.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_LOGIN);MGGameInfo.token4web="";MGGameInfo.apiInfo.userName="";cc.sys.localStorage.setItem("LastToken","");for(var a in MGGameInfo.MINI_GAME_INFO)MGGameInfo.MINI_GAME_INFO[a].game.setDispose(),MGGameInfo.MINI_GAME_INFO[a].game.removeFromParent(!0),delete MGGameInfo.MINI_GAME_INFO[a];for(a in MGGameInfo.GAME_INFO)delete MGGameInfo.GAME_INFO[a];for(a in MGGameInfo.WEB_GAME_INFO)MGGameInfo.WEB_GAME_INFO[a].game.setDispose(),MGGameInfo.WEB_GAME_INFO[a].game.removeFromParent(!0),
delete MGGameInfo.WEB_GAME_INFO[a]},_onCallBackLogout:function(a){},_getMasterModuleId:function(a){a=a.getUserData();Utilities.showLog("####_getmastermoduleid ");var b={MasterModuleID:BinaryConstants.DataTypeID.UInt16};a=(new BinaryParser).initObj(b,a.content);MGNetCore.MGSocket.setMasterModuleID(a.MasterModuleID);MGGameInfo.MGMain.netSend.sendLoginMaster(MGGameInfo.token4web)},_ngloginSuccess:function(a){MGGameInfo.MGMain.hideLoading();a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32,
Gold:BinaryConstants.DataTypeID.UInt64,DisplayName:BinaryConstants.DataTypeID.StringDynamic,Avatar:BinaryConstants.DataTypeID.StringDynamic,ChatModuleID:BinaryConstants.DataTypeID.Int16,IsUpdateInfo:BinaryConstants.DataTypeID.UInt8,CMND:BinaryConstants.DataTypeID.StringDynamic,Phone:BinaryConstants.DataTypeID.StringDynamic};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("####_ngloginSuccess "+JSON.stringify(a));MGGameInfo.myInfo.UserID=a.UserID;MGGameInfo.myInfo.Gold=a.Gold;MGGameInfo.myInfo.DisplayName=
a.DisplayName;MGGameInfo.myInfo.Avatar=a.Avatar;MGGameInfo.myInfo.IsUpdateInfo=a.IsUpdateInfo;MGGameInfo.myInfo.CMND=a.CMND;MGGameInfo.myInfo.Phone=a.Phone;MGNetCore.MGSocket.setChatModuleID(a.ChatModuleID);MGGameInfo.MGMain.netSend.sendLoginChatChannel(MGGameInfo.myInfo.UserID,MGGameInfo.myInfo.DisplayName,0,0);cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{});cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.LOGGED,null)},_ngUpdateNickName:function(a){cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_CREATE_NAME,
{})},_ngOnCheckOperatorName:function(a){a.result&&(Utilities.showLog("_ngOnCheckOperatorName"+JSON.stringify(a.data)),MGGameInfo.IsExchangeCard=a.data.isExchangeCard,MGGameInfo.IsChargeCard=a.data.isChargeCard,MGGameInfo.IsReview=a.data.isReview)},_systemKick:function(a){a=a.getUserData();var b={GameID:BinaryConstants.DataTypeID.Int8,State:BinaryConstants.DataTypeID.UInt8,IsBigGame:BinaryConstants.DataTypeID.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("_systemKick "+JSON.stringify(a));
a.IsBigGame?(a.State==ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM?(MGGameInfo.MGMain.netSend.sendLeaveChatChannel(MGGameInfo.myInfo.UserID,a.GameID,MGGameInfo.GAME_INFO[a.GameID].DeskID),MGGameInfo.MGMain.netSend.sendLoginChatChannel(MGGameInfo.myInfo.UserID,MGGameInfo.myInfo.DisplayName,a.GameID,0),MGGameInfo.MGMain.netSend.sendGetListRooms(a.GameID),MGGameInfo.GAME_INFO[a.GameID].DeskID=0):a.State==ConstantsVariable.LAYERS.MENU_LAYER_LOGIN&&(MGGameInfo.MGMain.netSend.sendLeaveChatChannel(MGGameInfo.myInfo.UserID,
a.GameID,MGGameInfo.GAME_INFO[a.GameID].DeskID),MGGameInfo.MGMain.netSend.sendLeaveChatChannel(MGGameInfo.myInfo.UserID,a.GameID,0)),delete MGGameInfo.GAME_INFO[a.GameID],this.swipLayer(a.State)):(MGGameInfo.MGMain.netSend.sendLeaveChatChannel(MGGameInfo.myInfo.UserID,a.GameID,MGGameInfo.MINI_GAME_INFO[a.GameID].DeskID),MGGameInfo.MINI_GAME_INFO[a.GameID].game&&(MGGameInfo.MINI_GAME_INFO[a.GameID].game.setDispose(),MGGameInfo.MINI_GAME_INFO[a.GameID].game.removeFromParent()),delete MGGameInfo.MINI_GAME_INFO[a.GameID])},
_leaveWebGame:function(a){a=a.getUserData();MGGameInfo.WEB_GAME_INFO[a.GameID]&&(MGGameInfo.WEB_GAME_INFO[a.GameID].game.setDispose(),MGGameInfo.WEB_GAME_INFO[a.GameID].game.removeFromParent(!0),delete MGGameInfo.WEB_GAME_INFO[a.GameID])},_nsPingMaster:function(){MGGameInfo.MGMain.netSend.sendPingMaster()},_runGame:function(a,b){this.layerGame.removeAllChildren(!0);this.layerGame.addChild(a);this._game=a;this._connetGameServer(b);this.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_GAME)},_connetGameServer:function(a){this.netSend.sendLoginGame(a)},
onChatMessage:function(a){a=a.getUserData();Utilities.showLog("####onChatMessage "+a)},onEmotionMessage:function(a){a=a.getUserData();Utilities.showLog("####onEmotionMessage "+a)},onDisconnectGame:function(a){a=a.getUserData();Utilities.showLog("####onDisconnectGame "+a)},onGetUserInfo:function(a){a=a.getUserData();Utilities.showLog("####onGetUserInfo "+a);this._game.getUserInfo&&this._game.getUserInfo(a)},onApiGetNewMail:function(a){a.result&&cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.NEW_EMAIL,
{haveNew:a.data.isNewMess})},onInvalidToken:function(a){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MASTER_LOGOUT,null);a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]=ConstantsVariable.TEXT.INVALID_TOKEN;cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a)},onAPITimeServer:function(){this.layerComponents.compoHeader._nodeHeaderLogin.checkLastLogin();this.banerEvent.loadData();this.onGetApiListGames()}}),MGGameController=
cc.Scene.extend({background:null,_loadingScreen:null,_mainScreen:null,layerMiniGame:null,layerCompoButton:null,jfReceiveController:null,jfRequestController:null,jfPopupController:null,backGroundMain:null,layerPopup:null,clickClobalPanel:null,webWorker:null,layerLoading:null,AppScale:null,ctor:function(){cc.Scene.prototype.ctor.call(this);MGGameInfo.MGScreenController=this;MGGameInfo.IDTaiXiu=PreLoaderConfig.IDTaiXiu;MGGameInfo.IDTLMN=PreLoaderConfig.IDTLMN;MGGameInfo.IDXocDia=PreLoaderConfig.IDXocDia;
MGGameInfo.IDXengMini=PreLoaderConfig.IDXengMini;MGGameInfo.IDSamLoc=PreLoaderConfig.IDSamLoc;MGGameInfo.IDBinh=PreLoaderConfig.IDBinh;MGGameInfo.IDPhom=PreLoaderConfig.IDPhom;MGGameInfo.IDXito=PreLoaderConfig.IDXito;MGGameInfo.IDPoker=PreLoaderConfig.IDPoker;MGGameInfo.IDLieng=PreLoaderConfig.IDLieng;MGGameInfo.IDDanhChan=PreLoaderConfig.IDDanhChan;MGGameInfo.IDSlotPoker=PreLoaderConfig.IDSlotPoker;MGGameInfo.IDSlotLuxury=PreLoaderConfig.IDSlotLuxury;MGGameInfo.IDFruitKong=PreLoaderConfig.IDFruitKong;
MGGameInfo.IDDemCuu=PreLoaderConfig.IDDemCuu;MGGameInfo.IDDiamonds777=PreLoaderConfig.IDDiamonds777;MGGameInfo.IDMiniTrenDuoi=PreLoaderConfig.IDMiniTrenDuoi;MGGameInfo.IDMiniCaoThap=PreLoaderConfig.IDMiniCaoThap;MGGameInfo.IDMiniVQMM=PreLoaderConfig.IDMiniVQMM;MGGameInfo.IDMiniDaoMo=PreLoaderConfig.IDMiniDaoMo;this.AppScale=1;this.loadResourcesLoading();!cc.sys.isNative&&cc.sys.isMobile&&(cc.view.setOrientation(cc.ORIENTATION_LANDSCAPE_LEFT),ScreenPolicy.apply())},initObj:function(a){this.loadResources();
this.configCocosDefault()},configCocosDefault:function(){cc.LabelTTF._wordRex=/([a-zA-Z0-9\u00c0\u00c1\u00c2\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]+|\S)/;
cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\u00c0\u00c1\u00c2\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]+|\S)$/;
cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\u00c0\u00c1\u00c2\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]+$/;
cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\u00c0\u00c1\u00c2\u00c3\u00c8\u00c9\u00ca\u00cc\u00cd\u00d2\u00d3\u00d4\u00d5\u00d9\u00da\u00e0\u00e1\u00e2\u00e3\u00e8\u00e9\u00ea\u00ec\u00ed\u00f2\u00f3\u00f4\u00f5\u00f9\u00fa\u0102\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0\u1ea1\u1ea2\u1ea3\u1ea4\u1ea5\u1ea6\u1ea7\u1ea8\u1ea9\u1eaa\u1eab\u1eac\u1ead\u1eae\u1eaf\u1eb0\u1eb1\u1eb2\u1eb3\u1eb4\u1eb5\u1eb6\u1eb7\u1eb8\u1eb9\u1eba\u1ebb\u1ebc\u1ebd\u1ebe\u1ebf\u1ec0\u1ec1\u1ec2\u1ec3\u1ec4\u1ec5\u1ec6\u1ec7\u1ec8\u1ec9\u1eca\u1ecb\u1ecc\u1ecd\u1ece\u1ecf\u1ed0\u1ed1\u1ed2\u1ed3\u1ed4\u1ed5\u1ed6\u1ed7\u1ed8\u1ed9\u1eda\u1edb\u1edc\u1edd\u1ede\u1edf\u1ee0\u1ee1\u1ee2\u1ee3\u1ee4\u1ee5\u1ee6\u1ee7\u1ee8\u1ee9\u1eea\u1eeb\u1eec\u1eed\u1eee\u1eef\u1ef0\u1ef1\u00dd\u1ef2\u1ef6\u1ef8\u1ef4\u00fd\u1ef3\u1ef7\u1ef9\u1ef5]/;
cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D},loadResourcesLoading:function(){if(cc.sys.isNative)this.background=new cc.Sprite,this.background.setPosition(cc.p(640,360)),this.addChild(this.background);else if(cc.sys.isMobile){this.background=new cc.Sprite;this.background.setPosition(cc.p(640,360));this.addChild(this.background);var a=document.getElementsByTagName("body")[0];a.style.background="none"}else a=document.getElementsByTagName("body")[0],a.style.background='url("'+(PreLoaderConfig.pathResource+
PreLoaderConfig.BackgroundMain)+'") no-repeat center center fixed',a.style.backgroundRepeat="no-repeat",a.style.backgroundSize="cover";cc.director.runScene(this);cc.loader.load(resourcesLoading,this._onLoadResourceLoadingComplete.bind(this,resourcesLoading))},_onLoadResourceLoadingComplete:function(a){for(var b in a)-1!=a[b].indexOf(".plist")&&cc.spriteFrameCache.addSpriteFrames(a[b],a[b].replace(".plist",".png"));this.initLoadingScreen()},initLoadingScreen:function(){this._loadingScreen=new MGLoadingScreen;
this._loadingScreen.initObj(this.loadResourcesComplete.bind(this));this.addChild(this._loadingScreen);this._loadingScreen.setAnchorPoint(cc.p(0,0));cc.sys.isNative?(this._loadingScreen.setPosition(cc.p(0,0)),this._loadingScreen.loadingBar.setPercent(100),this.background.setTexture(ResourceManager.MGResourcesLoading.BackgroundMain)):cc.sys.isMobile?(this._loadingScreen.setPosition(cc.p(0,0)),this.background.setTexture(ResourceManager.MGResourcesLoading.BackgroundMain)):this._loadingScreen.setPosition(cc.p((window.innerWidth-
1280*this.AppScale)/2,window.innerHeight-720*this.AppScale));this._loadingScreen.loadResources();cc.view.setResizeCallback(this._onResize.bind(this));this._onResize()},loadResourcesComplete:function(){this._listEvents=[];this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND.toString(),this.changeBackground.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.JOIN_ROOM.toString(),this._onJoinRoom.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.LOAD_GAME,this.loadGame.bind(this)));this._loadingScreen.removeFromParent(!0);this.initMainScreen();this.initMiniGameLayer();this.initLayerCompoButton();this.initGlobalListener();this._initLayerPopupController();this.initLoadingLayer();this.changeEnterFrame(this);this._mainScreen.onAPITimeServer();this._mainScreen.onHaveListGames();this._onResize();var a=cc.sys.localStorage.getItem("GameVolume");a&&(0<parseInt(a)?MGGameInfo.gameVolume=
0:MGGameInfo.gameVolume=1E4,cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.CHANGE_VOLUME,{}))},changeBackground:function(a){a=a.getUserData();if(cc.sys.isNative)this.background.setTexture(a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]);else if(cc.sys.isMobile)this.background.setTexture(a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]);else{var b=document.getElementsByTagName("body")[0];b.style.background='url("'+a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]+'") no-repeat center center fixed';
b.style.backgroundRepeat="no-repeat";b.style.backgroundSize="cover"}},_onResize:function(){if(!cc.sys.isNative&&!cc.sys.isMobile&&(this.AppScale=window.innerHeight/720,this.AppScale=1.7<=window.innerWidth/window.innerHeight?window.innerHeight/720:window.innerWidth/1280,.7>this.AppScale&&(this.AppScale=.7),this._mainScreen&&(this._mainScreen.setScale(this.AppScale,this.AppScale),this._mainScreen.setPosition(cc.p((window.innerWidth-1280*this.AppScale)/2,window.innerHeight-720*this.AppScale)),this.layerLoading.setScale(this.AppScale,
this.AppScale),this.layerPopup.setScale(this.AppScale,this.AppScale),this.layerPopup.setPosition(cc.p((window.innerWidth-1280*this.AppScale)/2,window.innerHeight-720*this.AppScale)),720<window.innerHeight&&1280<window.innerWidth&&this.layerPopup._onResize(),this.clickClobalPanel.setScaleX(cc.view.getScaleX()),this.clickClobalPanel.setScaleY(cc.view.getScaleY()),cc.view.setDesignResolutionSize(window.innerWidth,window.innerHeight,cc.ResolutionPolicy.NO_BORDER),this.layerLoading.setPosition(cc.p((window.innerWidth-
1280*this.AppScale)/2,window.innerHeight-720*this.AppScale))),this._loadingScreen&&(this._mainScreen?this._loadingScreen.setPosition(this._mainScreen.getPosition()):this._loadingScreen.setPosition(cc.p((window.innerWidth-1280)/2,(window.innerHeight-720)/2))),this.layerCompoButton))this.layerCompoButton.onResize()},initMainScreen:function(){this._mainScreen=new MGMainScreen;this._mainScreen.initObj();cc.sys.isNative||cc.sys.isMobile||(720>window.innerHeight?(this.AppScale=window.innerHeight/720,.7>
this.AppScale&&(this.AppScale=.7)):this.AppScale=1,this._mainScreen.setScale(this.AppScale,this.AppScale));this.addChild(this._mainScreen);this._mainScreen.setAnchorPoint(cc.p(0,0))},initMiniGameLayer:function(){this.layerMiniGame=new MGBaseLayer;this.layerMiniGame.initObj();this.addChild(this.layerMiniGame)},initLayerCompoButton:function(){this.layerCompoButton=new MGLayerCompoButton;this.layerCompoButton.initObj();this.addChild(this.layerCompoButton)},initLoadingLayer:function(){this.layerLoading=
new MGLayerLoading;this.layerLoading.initObj();this.addChild(this.layerLoading);this.layerLoading.hide();this._mainScreen.setlayerLoading(this.layerLoading);this.layerLoading.setLocalZOrder(ConstantsVariable.UIZONE.LOADING)},initGlobalListener:function(){this.clickClobalPanel=new ccui.Layout;this.addChild(this.clickClobalPanel);this.clickClobalPanel.setAnchorPoint(cc.p(0,0));cc.sys.isNative?this.clickClobalPanel.setContentSize(cc.size(1280,720)):this.clickClobalPanel.setContentSize(cc.size(window.innerWidth,
window.innerHeight));this.clickClobalPanel.setTouchEnabled(!0);this.clickClobalPanel.setSwallowTouches(!1);this.clickClobalPanel.addClickEventListener(function(a){Utilities.showLog("clickClobalPanel");cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.GLOBAL_CLICK,null)})},_initLayerPopupController:function(){this.layerPopup=new MGLayerPopup;this.layerPopup.setContentSize(1280,720);this.addChild(this.layerPopup);this.layerPopup.setLocalZOrder(ConstantsVariable.UIZONE.POPUP);this.layerPopup.setAnchorPoint(cc.p(0,
0));this.layerPopup.setVisible(!1);this.layerPopup.setMouseHoverEnabled(!0);this.layerPopup.setPosition(this._mainScreen.getPosition())},changeEnterFrame:function(a){cc.sys.isNative||cc.sys.isMobile||("undefined"!==typeof Worker?this.webWorker||(cc.game.pause=function(){MGGameInfo._paused=!0;a.startWorker()},cc.game.resume=function(){MGGameInfo._paused=!1;a.stopWorker()}):Utilities.showLog("Sorry, your browser does not support Web Workers..."))},startWorker:function(){this.webWorker||(this.webWorker=
new Worker(URL.createObjectURL(new Blob(["var onmessage=function(g){var a,b,c,d=Date.now(),e=g.data[0],f=function(){clearTimeout(a);b=Date.now();c=b-d;d=b;postMessage(c);a=setTimeout(f,e)};a=setTimeout(f,e)};"],{type:"text/javascript"}))),this.webWorker.onmessage=function(a){cc.director.mainLoop()},MGGameInfo.GAME_INFO[PreLoaderConfig.IDSlotLuxury]||MGGameInfo.GAME_INFO[PreLoaderConfig.IDDiamonds777]?this.webWorker.postMessage([16]):this.webWorker.postMessage([100]))},stopWorker:function(){this.webWorker&&
(this.webWorker.terminate(),this.webWorker=void 0)},_onJoinRoom:function(a){a=a.getUserData();var b={GameModuleID:BinaryConstants.DataTypeID.UInt16,BetCoin:BinaryConstants.DataTypeID.UInt64,RoomTypeID:BinaryConstants.DataTypeID.UInt16,Token:BinaryConstants.DataTypeID.StringDynamic,GameID:BinaryConstants.DataTypeID.UInt32,IsMiniGame:BinaryConstants.DataTypeID.Int8,GameType:BinaryConstants.DataTypeID.Int8};a=(new BinaryParser).initObj(b,a.content);MGGameInfo.myInfo.token4web=a.Token;MGGameInfo.token4web=
a.Token;MGNetCore.MGSocket.setGameModuleID(a.GameModuleID);cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOAD_GAME,a)},updateGameInfo:function(a){var b={DeskID:0};b.GameID=a.GameID;b.GameModuleID=a.GameModuleID;b.loaded=!0;a.GameType==MGNodeMenuGames.GAME_TYPE.WEB_GAME?MGGameInfo.WEB_GAME_INFO[a.GameID]=b:a.IsMiniGame?MGGameInfo.MINI_GAME_INFO[a.GameID]=b:MGGameInfo.GAME_INFO[a.GameID]=b},checkLoadedGame:function(a){return(a=a.GameType==MGNodeMenuGames.GAME_TYPE.WEB_GAME?MGGameInfo.WEB_GAME_INFO[a.GameID]:
a.IsMiniGame?MGGameInfo.MINI_GAME_INFO[a.GameID]:MGGameInfo.GAME_INFO[a.GameID])&&a.loaded?!0:!1},loadGame:function(a){a=a.getUserData();if(!this.checkLoadedGame(a)){this.updateGameInfo(a);var b=this.getRecByGameID(a.GameID);if(b)try{MGGameInfo.MGMain.showLoading(),cc.loader.load(b,this._runGame.bind(this,b,a))}catch(d){Utilities.showLog("loadResourceGame "+d)}else Utilities.showLog("loadResourceGame can't get rec ")}},getRecByGameID:function(a){switch(a){case MGGameInfo.IDXocDia:return resourcesGameXocDia;
case MGGameInfo.IDTaiXiu:return resourcesGameTaiXiu;case MGGameInfo.IDTLMN:return resourcesGameTienLen;case MGGameInfo.IDSamLoc:return resourcesGameSam;case MGGameInfo.IDBinh:return resourcesGameBinh;case MGGameInfo.IDPhom:return resourcesGamePhom;case MGGameInfo.IDSlotLuxury:return resourcesGameXengLuxury;case MGGameInfo.IDFruitKong:return resourcesGameFruitKong;case MGGameInfo.IDDemCuu:return resourcesGameSheep;case MGGameInfo.IDDiamonds777:return resourcesGameDiamond777;case MGGameInfo.IDMiniTrenDuoi:return resourcesGameTrenDuoi;
case MGGameInfo.IDXito:return resourcesGameXiTo;case MGGameInfo.IDLieng:return resourcesGameLieng;case MGGameInfo.IDSlotBAPD:return resourcesBAPD;case MGGameInfo.IDSlotVanPhuc:return resourcesVanPhuc;case MGGameInfo.IDSlotPanda:return resourcesPanda;case MGGameInfo.IDSlotHoangCung:return resourcesXengHoangCung;case MGGameInfo.IDSlotThamHiem:return resourcesXengThamHiem;case MGGameInfo.IDSlotAladin:return resourcesXengAladin;case MGGameInfo.IDSlotAiCap:return resourcesXengAiCap;case MGGameInfo.IDMiniCaoThap:return resourcesGameCaoThap;
case MGGameInfo.IDMiniVQMM:return resourcesGameVongQuayMayMan;case MGGameInfo.IDMiniDaoMo:return resourcesDaoMo}},getGameByGameID:function(a){var b=null;switch(a){case MGGameInfo.IDXocDia:b=new MGXocDia;b.setName("MGXocDia");break;case MGGameInfo.IDTaiXiu:b=new MGTaiXiu;b.setName("MGTaiXiu");break;case MGGameInfo.IDTLMN:b=new MGTienLen;b.setName("MGTienLen");break;case MGGameInfo.IDSamLoc:b=new MGSamLoc;b.setName("MGSamLoc");break;case MGGameInfo.IDBinh:b=new MGBinh;b.setName("MGBinh");break;case MGGameInfo.IDPhom:b=
new MGPhom;b.setName("MGPhom");break;case MGGameInfo.IDSlotLuxury:b=new MGSlotLuxury;b.setName("MGSlotLuxury");break;case MGGameInfo.IDFruitKong:b=new MGFruitKong;b.setName("MGFruitKong");break;case MGGameInfo.IDDemCuu:b=new MGSheep;b.setName("MGSheep");break;case MGGameInfo.IDDiamonds777:b=new MGDiamonds777;b.setName("MGDiamonds777");break;case MGGameInfo.IDMiniTrenDuoi:b=new MGTrenDuoi;b.setName("MGTrenDuoi");break;case MGGameInfo.IDXito:b=new MGXiTo;b.setName("MGXiTo");break;case MGGameInfo.IDLieng:b=
new MGLieng;b.setName("MGLieng");break;case MGGameInfo.IDSlotBAPD:b=new MGBiAnPhuongDong;b.setName("MGBiAnPhuongDong");break;case MGGameInfo.IDSlotVanPhuc:b=new MGXengVanPhuc;b.setName("MGXengVanPhuc");break;case MGGameInfo.IDSlotPanda:b=new MGXengPanda;b.setName("MGXengPanda");break;case MGGameInfo.IDSlotHoangCung:b=new MGXengHoangCung;b.setName("MGXengHoangCung");break;case MGGameInfo.IDSlotThamHiem:b=new MGXengThamHiem;b.setName("MGXengThamHiem");break;case MGGameInfo.IDSlotAladin:b=new MGXengAladin;
b.setName("MGXengAladin");break;case MGGameInfo.IDSlotAiCap:b=new MGXengAiCap;b.setName("MGXengAiCap");break;case MGGameInfo.IDMiniCaoThap:b=new MGCaoThap;b.setName("MGCaoThap");break;case MGGameInfo.IDMiniVQMM:b=new MGVongQuayMayMan;b.setName("MGVongQuayMayMan");break;case MGGameInfo.IDMiniDaoMo:b=new MGDaoMo,b.setName("MGDaoMo")}return b},_runGame:function(a,b){MGGameInfo.MGMain.hideLoading();for(var d in a)-1!=a[d].indexOf(".plist")&&(Utilities.showLog("_runGame res[index] "+a[d]),cc.spriteFrameCache.addSpriteFrames(a[d],
a[d].replace(".plist",".png")));d=this.getGameByGameID(b.GameID);d.initObj();b.GameType==MGNodeMenuGames.GAME_TYPE.WEB_GAME?(MGGameInfo.WEB_GAME_INFO[b.GameID].game=d,this.layerMiniGame.addChild(d)):(d.netSend.gameModuleID=b.GameModuleID,1==b.IsMiniGame?(MGGameInfo.MINI_GAME_INFO[b.GameID].game=d,this.layerMiniGame.addChild(d),this._mainScreen._connetGameServer(b)):(MGGameInfo.GAME_INFO[b.GameID].game=d,this._mainScreen._runGame(d,b)))},onAPITimeServer:function(a){a.result&&(PreLoaderConfig.deltaTimeApiServer=
(new Date).getTime()-a.data);Utilities.getContact(this._callBackGetContact.bind(this));this._mainScreen.onAPITimeServer();cc.sys.isNative&&cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:this.onKeyReleased.bind(this)},this)},_callBackGetContact:function(a){a.result&&(PreLoaderConfig.LINKS.FANPAGE=a.data.facebook,PreLoaderConfig.LINKS.FORUM=a.data.forum,PreLoaderConfig.LINKS.HOTLINE=a.data.hotline)},onKeyReleased:function(a,b){b.getCurrentTarget();switch(a){case cc.KEY.back:Utilities.showLog("cc.KEY.back");
var d=this.layerPopup.getCurrentPopup();if(d)Utilities.showLog("cc.KEY.back currentPopup"),d instanceof MGLayerPopupLogin||d instanceof MGLayerPopupRegit?(d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]="Bạn có muốn thoát game không?",d[MG_POPUP_KEY_DATA.POPUP_CALLBACK]=this.onClose,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d),Utilities.showLog("cc.KEY.back currentPopup MGLayerPopupLogin MGLayerPopupRegit")):(this.layerPopup.hideAllPopup(),
Utilities.showLog("cc.KEY.back currentPopup hideAllPopup"+d.constructor.name));else switch(this._mainScreen.currentMainLayer){case ConstantsVariable.LAYERS.MENU_LAYER_LOGIN:MGGameInfo.token4web&&""!=MGGameInfo.token4web?(MGGameInfo.isUserLogout=!0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MASTER_LOGOUT,null),Utilities.showLog("cc.KEY.back MENU_LAYER_LOGIN token4web")):(d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]="Bạn có muốn thoát game không?",
d[MG_POPUP_KEY_DATA.POPUP_CALLBACK]=this.onClose,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d),Utilities.showLog("cc.KEY.back MENU_LAYER_LOGIN no token4web"));break;case ConstantsVariable.LAYERS.MENU_LAYER_LIST_ROOM:cc.eventManager.dispatchCustomEvent(MGNodeBtnLobbyControl.EVENT.BACK.toString(),{});Utilities.showLog("cc.KEY.back MENU_LAYER_LIST_ROOM");break;case ConstantsVariable.LAYERS.MENU_LAYER_GAME:cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK,
null),Utilities.showLog("cc.KEY.back MENU_LAYER_GAME")}}},onClose:function(){cc.game.end()}});MGCompoListMiniGame=MGMoveablePopup.extend({containListGame:null,timeBeginTouch:null,timeEndTouch:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesCombo.CCSUIListMiniGameNode,PreLoaderConfig.PathToResourceDefault);this.containListGame=this._mainLayer.getChildByName("MGContainListGame");this._resetHide();this.setMoveInfo(this._mainLayer.getChildByName("MGBtnMiniGame"),
8,8,8,8);this._initEventsGame();this.setPosition(cc.p(100,500));this.setOriginPosision(cc.p(this.getPosition().x,this.getPosition().y));this.actionMiniGame()},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGCompoListMiniGame.EVENTS.UPDATE_LIST,this.createListGame.bind(this)))},onClickGameIcon:function(a,b){if(""!=MGGameInfo.token4web&&MGGameInfo.token4web&&void 0!==MGGameInfo.token4web){if(a.gameInfo&&a.gameInfo.GameType==
MGNodeMenuGames.GAME_TYPE.WEB_GAME){var d={};d.GameID=a.gameID;d.GameModuleID=a.gameInfo.GameModuleID;d.GameType=a.gameInfo.GameType;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOAD_GAME,d)}else MGGameInfo.MGMain.netSend.sendGetListRooms(a.gameID);this.showListGame()}else d={},d[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE,d[MG_POPUP_KEY_DATA.POPUP_MSG]=PreLoaderConfig.Messages.ERROR_DO_NOT_LOGIN,cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,d)},
createListGame:function(a){a=a.getUserData()[MGCompoListMiniGame.DATA.LIST];var b=0,d=a.length,e;for(b;b<d;b++)e=new ccui.ImageView,e.gameID=a[b].GameID,e.gameInfo=a[b],e.loadTexture(ResourceManager.MGResourcesMenuGame["GameIcon"+a[b].GameID],ccui.Widget.LOCAL_TEXTURE),e.setTouchEnabled(!0),e.addClickEventListener(this.onClickGameIcon.bind(this)),this.containListGame.getChildByName("MGGameItem"+b).addChild(e)},showListGame:function(){this.containListGame.isVisible()?(this._resetShow(),this.containListGame.runAction(cc.spawn(cc.rotateTo(.3,
-180),cc.sequence(cc.scaleTo(.3,.1),cc.callFunc(this._resetHide.bind(this)))))):(this._resetHide(),this.containListGame.setVisible(!0),this.containListGame.runAction(cc.spawn(cc.rotateTo(.3,0),cc.scaleTo(.3,1))))},hideListGame:function(){},_resetShow:function(){this.containListGame.stopAllActions();this.containListGame.setRotation(0);this.containListGame.setScale(1);this.containListGame.setVisible(!0)},_resetHide:function(){this.containListGame.stopAllActions();this.containListGame.setRotation(-180);
this.containListGame.setScale(.1);this.containListGame.setVisible(!1)},moveablePopupTouchBegan:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this.timeBeginTouch=new Date;break;case ccui.Widget.TOUCH_ENDED:this.timeEndTouch=new Date,200>this.timeEndTouch-this.timeBeginTouch&&this.showListGame()}},actionMiniGame:function(){this._mainLayer.getChildByName("MGBtnMiniGame").getChildByName("MGCircleMiniGame").runAction(cc.sequence(cc.rotateBy(1,180)).repeatForever())}});
MGCompoListMiniGame.EVENTS={UPDATE_LIST:"UpdateListMiniMame"};MGCompoListMiniGame.DATA={LIST:"list"};MGMoveablePopup=MGBaseNode.extend({_mainMoveable:null,_marginTop:0,_marginBottom:0,_marginLeft:0,_marginRight:0,_nodePos:null,_originPos:null,_gap:null,_move:!1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.setOriginPosision(this.getPosition().x,this.getPosition().y)},setOriginPosision:function(a,b){this._originPos=cc.p(a,b)},setMoveInfo:function(a,b,d,e,f,g){this._mainMoveable=a;this._marginTop=void 0!==b?b:0;this._marginBottom=
void 0!==d?d:0;this._marginLeft=void 0!==e?e:0;this._marginRight=void 0!==f?f:0;this._nodePos=this._mainMoveable.getPosition();this._mainMoveable.addTouchEventListener(this.onTouchGameFromCocostudio.bind(this),this);this._mainMoveable.setTouchEnabled(!0);this._mainMoveable.setSwallowTouches(void 0===g?!0:g)},addMoveElement:function(a,b){a.addTouchEventListener(this.onTouchGameFromCocostudio.bind(this),this);a.setTouchEnabled(!0);a.setSwallowTouches(void 0===b?!0:b)},hide:function(){this.setVisible(!1);
this.setPosition(this._originPos)},onTouchGameFromCocostudio:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this._move=!1;var d=this.getParent().convertToNodeSpace(a.getTouchBeganPosition());this._gap=cc.p(this.getPosition().x+.5*cc.winSize.width-d.x,this.getPosition().y+.5*cc.winSize.height-d.y);break;case ccui.Widget.TOUCH_MOVED:this._move=!0;this.moveGameLayout(a);break;case ccui.Widget.TOUCH_ENDED:this.updatePosisionAfterMoved(a);break;case ccui.Widget.TOUCH_CANCELED:this.updatePosisionAfterMoved(a)}this.moveablePopupTouchBegan(a,
b)},moveGameLayout:function(a){a=this.getParent().convertToNodeSpace(a.getTouchMovePosition());this.setPosition(a.x-.5*cc.winSize.width+this._gap.x,a.y-.5*cc.winSize.height+this._gap.y)},updatePosisionAfterMoved:function(a){if(this._move||void 0===a){this._move=!1;var b=this._mainMoveable,d=this.convertToWorldSpace(b.getPosition());a=d.y;var d=d.x,e=cc.winSize.height-.5*b.getContentSize().height-this._marginTop,f=.5*b.getContentSize().height+this._marginBottom,g=cc.winSize.width-.5*b.getContentSize().width-
this._marginRight,b=.5*b.getContentSize().width+this._marginLeft;a>e?a=e:a<f&&(a=f);d>g?d=g:d<b&&(d=b);a=this.getParent().convertToNodeSpace(cc.p(d,a));a.x-=this._nodePos.x;a.y-=this._nodePos.y;this.runAction(cc.moveTo(.1,a))}},moveablePopupTouchBegan:function(a,b){}});ConstantsVariable.NETWORK_TAI_XIU={GameData:1101,AddBet:1102,StartGame:1103,Result:1104,GetUserOnBoard:1106,UserLeftDesk:1107,AddUser:1108,DoubleBet:1110,ReBet:1111,EndMatch:1116,ResultHistory:1105,ListUser:1112,SetTool:1117};ConstantsVariable.EVENT_TAI_XIU={};ConstantsVariable.LIST_RATE_TAIXIU=[1,5,10,50,100];ConstantsVariable.LIST_IMG_XU_TAIXIU=["xu100.png","xu500.png","xu1000.png","xu5000.png","xu10000.png"];
ConstantsVariable.UIZONE_TAIXIU={XU_Z_LOCAL:10,POPUP:800,TOOLTIP:600,HISTORY_POPUP:2,RESULT_POPUP:1,COMPOUSERINFO:1};ResourceManager.MGResourcesGameTaiXiu={Dice_Atlas:"res/game/taixiu/Effect/Dice_Only.atlas",Dice_PNG:"res/game/taixiu/Effect/Dice_Only.png",Dice_Json:"res/game/taixiu/Effect/Dice_Only.json",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",
Hoa_Atlas:"res/game/Components/EffectThangThua/hoa.atlas",Hoa_PNG:"res/game/Components/EffectThangThua/hoa.png",Hoa_Json:"res/game/Components/EffectThangThua/hoa.json",Dealer_Atlas:"res/game/taixiu/Effect/dealer_Blue.atlas",Dealer_PNG:"res/game/taixiu/Effect/dealer_Blue.png",Dealer_Json:"res/game/taixiu/Effect/dealer_Blue.json",UITaiXiuToolTip:"res/game/taixiu/UIToolTipBet.json",UITaiXiuLayer:"res/game/taixiu/UITaiXiuLayer.json",JCInviteBetNode:"res/game/taixiu/JCInviteBetNode.json",AtlasTaiXiuPlist:"res/game/taixiu/AtlasTaiXiu/AtlasTaiXiu.plist",
AtlasTaiXiuPng:"res/game/taixiu/AtlasTaiXiu/AtlasTaiXiu.png",UIPopupHistory:"res/game/taixiu/UIPopupHistory.json",UIObjectHistoryInfo:"res/game/taixiu/UIObjectHistoryInfo.json",AtlasHistoryPopupPlist:"res/game/taixiu/AtlasHistoryPopup/atlasHistoryPopup.plist",AtlasHistoryPopupPng:"res/game/taixiu/AtlasHistoryPopup/atlasHistoryPopup.png",UIPopUpResult:"res/game/taixiu/UIPopupResult.json",UIObjectResultInfo:"res/game/taixiu/UIObjectResultInfo.json",AtlasResultPopupPlist:"res/game/taixiu/AtlasResultPopup/atlasResultPopup.plist",
AtlasResultPopupPng:"res/game/taixiu/AtlasResultPopup/atlasResultPopup.png",BackgroundSound:"res/game/taixiu/Sounds/NhacNen.mp3",BetSound:"res/game/taixiu/Sounds/CuocPhinh.mp3",WinSound:"res/game/taixiu/Sounds/Thang.mp3",TimeOutSound:"res/game/taixiu/Sounds/GanHetGio.mp3"};var resourcesGameTaiXiu=[];for(i in ResourceManager.MGResourcesGameTaiXiu)ResourceManager.MGResourcesGameTaiXiu[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameTaiXiu[i],resourcesGameTaiXiu.push(ResourceManager.MGResourcesGameTaiXiu[i]);var MGHistoryDefine=cc.Class.extend({Index:0,ListBet:null,ResultGold:0,ctor:function(a,b,d){this.Index=a;this.ListBet=b;this.ResultGold=d},convertInfoToString:function(){var a=[];if(this.ListBet&&void 0!=this.ListBet&&0<this.ListBet.length)for(var b in this.ListBet){var d=this.ListBet[b];a.push(MGHistoryDefine.BetMatching[d.BetID]+": "+Utilities.Coin(d.BetCoin))}return a}});
MGHistoryDefine.BetMatching={1:"Đơn lẻ 1",2:"Đơn lẻ 2",3:"Đơn lẻ 3",4:"Đơn lẻ 4",5:"Đơn lẻ 5",6:"Đơn lẻ 6",7:"Đôi 1:2",8:"Đôi 1:3",9:"Đôi 1:4",10:"Đôi 1:5",11:"Đôi 1:6",12:"Đôi 2:3",13:"Đôi 2:4",14:"Đôi 2:5",15:"Đôi 2:6",16:"Đôi 3:4",17:"Đôi 3:5",18:"Đôi 3:6",19:"Đôi 4:5",20:"Đôi 4:6",21:"Đôi 5:6",22:"4 Điểm",23:"5 Điểm",24:"6 Điểm",25:"7 Điểm",26:"8 Điểm",27:"9 Điểm",28:"10 Điểm",29:"11 Điểm",30:"12 Điểm",31:"13 Điểm",32:"14 Điểm",33:"15 Điểm",34:"16 Điểm",35:"17 Điểm",36:"Cặp 1:1",37:"Cặp 2:2",
38:"Cặp 3:3",39:"Cặp 4:4",40:"Cặp 5:5",41:"Cặp 6:6",42:"3 con 1",43:"3 con 2",44:"3 con 3",45:"3 con 4",46:"3 con 5",47:"3 con 6",48:"Xỉu",49:"Tài",50:"3 con tùy ý",51:"Lẻ",52:"Chẵn"};var MGLayerPopupTaiXiu=MGBaseLayer.extend({popupHistory:null,popupResult:null,ctor:function(){MGBaseLayer.prototype.ctor.call(this);this._listEvents=[];this.initObj();this._initEventGame()},initObj:function(){this.popupHistory=new MGUIPopupHistory;this.popupHistory.setPosition(300,210);this.popupHistory.setOriginPosision(this.popupHistory.getPosition().x,this.popupHistory.getPosition().y);this.closePopupHistory();this.addChild(this.popupHistory,ConstantsVariable.UIZONE_TAIXIU.HISTORY_POPUP);this.popupResult=
new MGUIPopupResult;this.popupResult.setPosition(180,520);this.popupResult.setOriginPosision(this.popupResult.getPosition().x,this.popupResult.getPosition().y);this.closePopupResult();this.addChild(this.popupResult,ConstantsVariable.UIZONE_TAIXIU.RESULT_POPUP)},setUIMobile:function(){this.popupResult.setPosition(210,410);this.popupHistory.setPosition(300,190);this.popupHistory.setOriginPosision(this.popupHistory.getPosition().x,this.popupHistory.getPosition().y);this.popupResult.setOriginPosision(this.popupResult.getPosition().x,
this.popupResult.getPosition().y);this.closePopupHistory();this.closePopupResult()},_initEventGame:function(){this.popupHistory.CloseBtn.addClickEventListener(this.closePopupHistory.bind(this));this.popupResult.CloseBtn.addClickEventListener(this.closePopupResult.bind(this));this.popupResult.HistoryBtn.addClickEventListener(this.showPopupHistoryTaiXiu.bind(this))},closePopupHistory:function(){this.popupHistory.setVisible(!1);this.popupHistory.hide()},showPopupHistoryTaiXiu:function(){this.popupHistory.setVisible(!0)},
closePopupResult:function(){this.popupResult.setVisible(!1);this.popupResult.hide()},showPopupResultTaiXiu:function(){this.popupResult.setVisible(!0)}});var MGUIHistoryObject=MGBaseNode.extend({_defaultMinHeight:30,_panelUI:null,_index:null,_chiTietCuocLeft:null,_chiTietCuocRight:null,_ketQuaCuoc:null,_lineEnding:null,defineObject:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameTaiXiu.UIObjectHistoryInfo,PreLoaderConfig.PathToResourceDefault).node);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initUI()},_initUI:function(){this._panelUI=this.getChildByName("PanelObject");
this._index=this._panelUI.getChildByName("Index");this._index.ignoreContentAdaptWithSize(!0);this._chiTietCuocLeft=this._panelUI.getChildByName("ChiTietCuocText");this._chiTietCuocLeft.ignoreContentAdaptWithSize(!0);this._chiTietCuocRight=this._panelUI.getChildByName("ChiTietCuocText_2");this._chiTietCuocRight.ignoreContentAdaptWithSize(!0);this._ketQuaCuoc=this._panelUI.getChildByName("KetQuaText");this._ketQuaCuoc.ignoreContentAdaptWithSize(!0);this._lineEnding=this._panelUI.getChildByName("LineEnding")},
initInfoHistory:function(a){this.defineObject=a;this._setIndex(a.Index);this.addCuoc(a.convertInfoToString());this._setKetQuaCuoc(a.ResultGold);this._completeInitHistory()},updateBet:function(a){this.defineObject.ListBet=a;this._addChiTietCuocLeft("");this._addChiTietCuocRight("");this.addCuoc(this.defineObject.convertInfoToString());this._completeInitHistory()},addCuoc:function(a){for(var b in a)0==b%2?this._addChiTietCuocLeft(a[b]):this._addChiTietCuocRight(a[b])},_addChiTietCuocLeft:function(a){var b=
this._chiTietCuocLeft.getString(),b=""==b?b+a:this._chiTietCuocLeft.getContentSize().height<this._defaultMinHeight?b+("\n"+a+"\n"):b+(a+"\n");this._chiTietCuocLeft.setString(b)},_addChiTietCuocRight:function(a){var b=this._chiTietCuocRight.getString(),b=""==b?b+a:this._chiTietCuocRight.getContentSize().height<this._defaultMinHeight?b+("\n"+a+"\n"):b+(a+"\n");this._chiTietCuocRight.setString(b)},getIndexUI:function(){return this._index.getString()},_setIndex:function(a){this._index.setString(a)},_setKetQuaCuoc:function(a){this._ketQuaCuoc.setString(Utilities.Coin(a))},
_completeInitHistory:function(){var a=this._panelUI.getContentSize(),b=this._chiTietCuocLeft.getContentSize();b.height<this._defaultMinHeight?(this._panelUI.setContentSize(a.width,this._defaultMinHeight),this._resetPosition(!0)):(this._panelUI.setContentSize(a.width,b.height),this._resetPosition(!1))},_resetPosition:function(a){a=a?5:8;var b=this._panelUI.getContentSize();this._index.setPositionY(.5*b.height);this._ketQuaCuoc.setPositionY(.5*b.height);this._chiTietCuocLeft.setPositionY(b.height-a);
this._chiTietCuocRight.setPositionY(b.height-a);this._lineEnding.setPositionY(b.height-5)}});var MGUIPopupHistory=MGMoveablePopup.extend({_lstViewHistory:null,CloseBtn:null,_lastData:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this);this.initObj()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameTaiXiu.UIPopupHistory,PreLoaderConfig.PathToResourceDefault)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initUI();this.setMoveInfo(this._mainLayer.getChildByName("BGPopup"));this._lstViewHistory=this._mainLayer.getChildByName("ListHistory");
this.CloseBtn=this._mainLayer.getChildByName("CloseBtn");this._lstViewHistory.setBounceEnabled(!0)},setHistoryInfo:function(a,b){var d=this._getMyDataUser(a);this._checkAndRemoveItem(a.MatchID);this._setNewHistory(a,b,d)},updateHistoryBet:function(a,b){this._checkAndRemoveItem(a);this._createHistoryObject(a,b,0)},_setNewHistory:function(a,b,d){null!==d?this._createHistoryObject(a.MatchID,b,d.CoinWinLose):this._createHistoryObject(a.MatchID,null,0)},_createHistoryObject:function(a,b,d){a=new MGHistoryDefine(a,
b,d);b=new MGUIHistoryObject;b.initInfoHistory(a);this.pushHistory(b)},_getMyDataUser:function(a){for(var b=0;b<a.ListUser.length;b++)if(MGGameInfo.myInfo.UserID===a.ListUser[b].UserID)return a.ListUser[b];return null},_checkAndRemoveItem:function(a){this._lastData&&void 0!==this._lastData&&this._lastData.getIndexUI()===a.toString()&&this._lstViewHistory.removeItem(0)},_getLastInitHistory:function(){return this._lstViewHistory.getItem(0)},pushHistory:function(a){a&&void 0!==a&&(this._lastData=a,a._panelUI.removeFromParent(),
this._lstViewHistory.insertCustomItem(a._panelUI,0))},removeInfo:function(){this._lstViewHistory.removeAllItems()},pushListHistory:function(a){this.removeInfo();if(a&&void 0!==a&&0<a.length)for(var b in a)a[b]._panelUI.removeFromParent(),this._lstViewHistory.pushBackCustomItem(a[b]._panelUI)}});var MGUIResultObject=MGBaseNode.extend({IconData:null,ResultInfo:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameTaiXiu.UIObjectResultInfo,PreLoaderConfig.PathToResourceDefault).node);this._initUI()},_initUI:function(){this.IconData=this.getChildByName("IconInfo");this.ResultInfo=this.getChildByName("ResultInfo");this.ResultInfo.ignoreContentAdaptWithSize(!0)},
setTextureImage:function(a){switch(a){case MGUIPopupResult.TAI_RESULT:this.IconData.setSpriteFrame("TaiIcon.png");break;case MGUIPopupResult.XIU_RESULT:this.IconData.setSpriteFrame("XiuIcon.png");break;case MGUIPopupResult.BOBA_RESULT:this.IconData.setSpriteFrame("BoBaIcon.png")}},setResultInfo:function(a){this.ResultInfo.setString(a)}});var MGUIPopupResult=MGMoveablePopup.extend({CloseBtn:null,HistoryBtn:null,_matchId:null,_totalTai:null,_totalXiu:null,_totalBoBa:null,_stickAutoShow:null,_percentOne:null,_percentTwo:null,_percentThree:null,_percentFour:null,_percentFive:null,_percentSix:null,btnAutoShowHistory:null,ListSixMatch:null,FirstObjectResult:null,ListIcon:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this);this.ListSixMatch=[];this.ListIcon=[];this.initObj()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameTaiXiu.UIPopUpResult,
PreLoaderConfig.PathToResourceDefault)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initUI();this.setMoveInfo(this._mainLayer.getChildByName("BGPopup"));this.CloseBtn=this._mainLayer.getChildByName("CloseBtn");this.HistoryBtn=this._mainLayer.getChildByName("HistoryBtn");this._stickAutoShow=this._mainLayer.getChildByName("AutoShowHistory");this.btnAutoShowHistory=this._mainLayer.getChildByName("BtnAutoShowHistory");this.btnAutoShowHistory.addClickEventListener(this.onChangeAutoShowHistory.bind(this));
this._matchId=this._mainLayer.getChildByName("MatchId");this._matchId.ignoreContentAdaptWithSize(!0);this._totalTai=this._mainLayer.getChildByName("TaiTitle");this._totalTai.ignoreContentAdaptWithSize(!0);this._totalXiu=this._mainLayer.getChildByName("XiuTitle");this._totalXiu.ignoreContentAdaptWithSize(!0);this._totalBoBa=this._mainLayer.getChildByName("BoBaTitle");this._totalBoBa.ignoreContentAdaptWithSize(!0);this._percentOne=this._mainLayer.getChildByName("PercentOne");this._percentOne.ignoreContentAdaptWithSize(!0);
this._percentTwo=this._mainLayer.getChildByName("PercentTwo");this._percentTwo.ignoreContentAdaptWithSize(!0);this._percentThree=this._mainLayer.getChildByName("PercentThree");this._percentThree.ignoreContentAdaptWithSize(!0);this._percentFour=this._mainLayer.getChildByName("PercentFour");this._percentFour.ignoreContentAdaptWithSize(!0);this._percentFive=this._mainLayer.getChildByName("PercentFive");this._percentFive.ignoreContentAdaptWithSize(!0);this._percentSix=this._mainLayer.getChildByName("PercentSix");
this._percentSix.ignoreContentAdaptWithSize(!0);this.FirstObjectResult=this._mainLayer.getChildByName("SlotPos")},setNormalInfoResult:function(a){this._setNormalInfo(a.numTai,a.numXiu,a.numBao,a.percentOne,a.percentTwo,a.percentThree,a.percentFour,a.percentFive,a.percentSix)},_setNormalInfo:function(a,b,d,e,f,g,h,k,l){this._setTotalTai(a);this._setTotalXiu(b);this._setTotalBoBa(d);this._setPercentInfo(1,e);this._setPercentInfo(2,f);this._setPercentInfo(3,g);this._setPercentInfo(4,h);this._setPercentInfo(5,
k);this._setPercentInfo(6,l)},initSixMatchInfo:function(a){3>a.length||(this.ListSixMatch.splice(0,0,a),this.ListSixMatch.length>MGUIPopupResult.MAX_DETAIL_INFO&&this.ListSixMatch.splice(MGUIPopupResult.MAX_DETAIL_INFO,1),this._initResultInfoIcon(a),this._updateUISixMatch())},setSixMatchInfo:function(a){this.ListSixMatch=a;this._updateUISixMatch();this._updateResultIconSixMatch()},_updateResultIconSixMatch:function(){for(var a=this.ListSixMatch.length-1;0<=a;a--)this._initResultInfoIcon(this.ListSixMatch[a])},
_updateUISixMatch:function(){for(var a=0;a<this.ListSixMatch.length;a++){var b=this._mainLayer.getChildByName("Panel_"+a);if(b&&void 0!==b){for(var d=this.ListSixMatch[a],e=0,f=0;f<d.length;f++){var g=b.getChildByName("XiNgau_"+f);g.ignoreContentAdaptWithSize(!0);e+=d[f];g.setString(d[f])}f=b.getChildByName("TongXiNgau");f.ignoreContentAdaptWithSize(!0);f.setString(e);b=b.getChildByName("KetQuaType");b.ignoreContentAdaptWithSize(!0);b.setString(this._checkTypeResult(d,e));b.setTextColor(this._setColorResult(b.getString()))}}},
_initResultInfoIcon:function(a){if(!(3>a.length)){this.ListIcon.length>MGUIPopupResult.MAX_INFO_TAIXIU&&(this.ListIcon[MGUIPopupResult.MAX_INFO_TAIXIU-1].removeFromParent(!0),this.ListIcon.splice(MGUIPopupResult.MAX_INFO_TAIXIU,1));for(var b=new MGUIResultObject,d=0,e=0;e<a.length;e++)d+=a[e];a=this._checkTypeResult(a,d);b.setResultInfo(d);b.setTextureImage(a);this.addChild(b,10);this.ListIcon.splice(0,0,b);this.updateResultIcon()}},updateResultIcon:function(){for(var a=0;a<this.ListIcon.length;a++){var b=
a%MGUIPopupResult.COL,d=Math.floor(a/MGUIPopupResult.COL);this.ListIcon[a].stopAllActions();this.ListIcon[a].setPosition(new cc.p(this.FirstObjectResult.getPositionX()+b*MGUIPopupResult.SIZE_RESULT.x,this.FirstObjectResult.getPositionY()-d*MGUIPopupResult.SIZE_RESULT.y));0===a&&this.ListIcon[a].runAction(cc.repeatForever(cc.sequence(cc.moveTo(.5,cc.p(this.ListIcon[a].getPosition().x,this.ListIcon[a].getPosition().y+2)),cc.moveTo(.5,cc.p(this.ListIcon[a].getPosition().x,this.ListIcon[a].getPosition().y-
2)))))}},_checkTypeResult:function(a,b){return 3>a.length?"":a[0]===a[1]&&a[1]===a[2]?MGUIPopupResult.BOBA_RESULT:10<b?MGUIPopupResult.TAI_RESULT:MGUIPopupResult.XIU_RESULT},_setColorResult:function(a){switch(a){case MGUIPopupResult.TAI_RESULT:return cc.color(255,255,0,255);case MGUIPopupResult.XIU_RESULT:return cc.color(255,0,0,255);case MGUIPopupResult.BOBA_RESULT:return cc.color(130,253,0,255);default:return cc.color(0,0,0,0)}},setMatchId:function(a){this._matchId.setString("#"+a)},_setTotalTai:function(a){this._totalTai.setString("Tài: "+
a)},_setTotalXiu:function(a){this._totalXiu.setString("Xỉu: "+a)},_setTotalBoBa:function(a){this._totalBoBa.setString("Bộ Ba: "+a)},_setPercentInfo:function(a,b){var d=Number(b);if(!Number.isNaN(d))switch(d=Math.round(d),a){case 1:this._percentOne.setString(d+"%");break;case 2:this._percentTwo.setString(d+"%");break;case 3:this._percentThree.setString(d+"%");break;case 4:this._percentFour.setString(d+"%");break;case 5:this._percentFive.setString(d+"%");break;case 6:this._percentSix.setString(d+"%")}},
onChangeAutoShowHistory:function(a,b){this._stickAutoShow.setSelected(!this._stickAutoShow.isSelected())}});MGUIPopupResult.MAX_INFO_TAIXIU=83;MGUIPopupResult.ROW=6;MGUIPopupResult.COL=14;MGUIPopupResult.MAX_DETAIL_INFO=6;MGUIPopupResult.TAI_RESULT="Tài";MGUIPopupResult.XIU_RESULT="Xỉu";MGUIPopupResult.BOBA_RESULT="BộBa";MGUIPopupResult.SIZE_RESULT=cc.p(23.7,24);var MGUserController=cc.Class.extend({ctor:function(){},isMine:function(a){return a===MGGameInfo.myInfo.UserID},setSlotUser:function(a,b,d){if(null!==a&&void 0!==a&&!UserController.isMine(a.UserID)){var e=this._getEmptySlot(d);d=this.findUserSlot(a.UserID,d);null!==e&&null===d&&(b?e.setUserInfoData(a.UserID,a.NickName,a.Coin,a.avatar):e.setUserInfoData(a.UserID,a.Nickname,a.Coin,a.avatar))}},removeSlotUser:function(a,b){var d=this.findUserSlot(a,b);null!==d&&d.removeUserInfoData()},_getEmptySlot:function(a){for(var b=
0;b<a.length;b++)if(!a[b].getStateUser())return a[b];return null},findUserSlot:function(a,b){for(var d=0;d<b.length;d++)if(b[d].getUserPlayId()===a)return b[d];return null}}),UserController=new MGUserController;var MGNetSendTaiXiu=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBet:function(a,b){var d={};d.BetID=a;d.CoinBet=b;d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TAI_XIU.AddBet,{BetID:BinaryConstants.DataTypeID.UInt8,CoinBet:BinaryConstants.DataTypeID.UInt64},d);MGNetCore.MGSocket.sendMsg(d)},sendBetDouble:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TAI_XIU.DoubleBet,null,null);MGNetCore.MGSocket.sendMsg(a)},sendReBet:function(){var a=
Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TAI_XIU.ReBet,null,null);MGNetCore.MGSocket.sendMsg(a)},sendToolTaiXiu:function(a){var b={};b.Dice=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TAI_XIU.SetTool,{Dice:BinaryConstants.DataTypeID.Array8,Dice_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGUIActionDices=cc.Class.extend({_gameLayer:null,mainLayer:null,_spineXiNgau:null,_disk:null,_dice0:null,_dice1:null,_dice2:null,_valueScale:.45,_diskPos:cc.p(0,0),ctor:function(a){this.mainLayer=a;this._gameLayer=a._mainLayer;this._diskPos=this._gameLayer.getChildByName("disk").getPosition();this._spineXiNgau=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTaiXiu.Dice_Json,ResourceManager.MGResourcesGameTaiXiu.Dice_Atlas);this._spineXiNgau.setPosition(this._diskPos);this._spineXiNgau.setScale(.45);
this.mainLayer.addChild(this._spineXiNgau);this._dice0=new cc.Sprite("#Dice1.png");this._dice0.setPositionX(this._diskPos.x+15);this._dice0.setPositionY(this._diskPos.y+11);this._dice0.setScale(.65);this.mainLayer.addChild(this._dice0);this._dice1=new cc.Sprite("#Dice2.png");this._dice1.setPositionX(this._diskPos.x-15);this._dice1.setPositionY(this._diskPos.y+11);this._dice1.setScale(.65);this.mainLayer.addChild(this._dice1);this._dice2=new cc.Sprite("#Dice3.png");this._dice2.setPositionX(this._diskPos.x);
this._dice2.setPositionY(this._diskPos.y-19);this._dice2.setScale(.65);this.mainLayer.addChild(this._dice2);this._disk=new cc.Sprite("#Nap.png");this._disk.setPosition(this._diskPos);this.mainLayer.addChild(this._disk);this._disk.setScale(this._valueScale);this.reset()},hide:function(){},reset:function(){this._disk.stopAllActions();this._disk.setOpacity(255);this._disk.setPosition(this._diskPos);this._spineXiNgau.setVisible(!1);this._dice0.setVisible(!1);this._dice1.setVisible(!1);this._dice2.setVisible(!1);
this._disk.setVisible(!0);this._disk.setScale(this._valueScale)},run:function(a,b,d){var e="Dice"+a.toString()+".png",f="Dice"+b.toString()+".png",g="Dice"+d.toString()+".png";this._disk.stopAllActions();this._disk.setVisible(!0);this._disk.runAction(cc.sequence(cc.moveBy(.3,cc.p(80,-80)),cc.callFunc(function(){this._disk.setVisible(!1);this._spineXiNgau.setVisible(!0);this._spineXiNgau.setAnimation(0,"Shaking",!1)},this),cc.delayTime(1.5),cc.callFunc(function(){this._disk.runAction(cc.scaleTo(.2,
this._valueScale));this._disk.setVisible(!0);this._disk.runAction(cc.moveTo(.3,this._diskPos));this._disk.runAction(cc.fadeIn(.2))},this),cc.delayTime(1.6),cc.callFunc(function(){this._spineXiNgau.setVisible(!1);this._dice0.setSpriteFrame(e);this._dice1.setSpriteFrame(f);this._dice2.setSpriteFrame(g);this._dice0.setVisible(!0);this._dice1.setVisible(!0);this._dice2.setVisible(!0);this._disk.runAction(cc.moveBy(.15,cc.p(80,-80)));this._disk.runAction(cc.fadeOut(.2));this._disk.runAction(cc.scaleTo(.2,
1.3*this._valueScale))},this)));this._disk.runAction(cc.fadeOut(.3));this._disk.runAction(cc.scaleTo(.3,1.3*this._valueScale))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this._disk.stopAllActions()}});var MGEffectThangThua=cc.Class.extend({_mainLayer:null,_spineThang:null,_spineThua:null,_spineHoa:null,ctor:function(a){this._mainLayer=a;this._spineThang=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTaiXiu.Thang_Json,ResourceManager.MGResourcesGameTaiXiu.Thang_Atlas);this._mainLayer.addChild(this._spineThang);this._spineThua=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTaiXiu.Thua_Json,ResourceManager.MGResourcesGameTaiXiu.Thua_Atlas);this._mainLayer.addChild(this._spineThua);
this._spineHoa=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTaiXiu.Hoa_Json,ResourceManager.MGResourcesGameTaiXiu.Hoa_Atlas);this._mainLayer.addChild(this._spineHoa);this.hide()},hide:function(){this._spineThua.setVisible(!1);this._spineThang.setVisible(!1);this._spineHoa.setVisible(!1)},showThang:function(a){this._spineThang.setVisible(!0);this._spineThang.setPosition(a);this._spineThang.setAnimation(0,"thang",!1)},showThua:function(a){this._spineThua.setVisible(!0);this._spineThua.setPosition(a);
this._spineThua.setAnimation(0,"thua",!1)},showHoa:function(a){this._spineHoa.setVisible(!0);this._spineHoa.setPosition(a);this._spineHoa.setAnimation(0,"hoa",!1)}});var MGUIToolTip=MGBaseNode.extend({isShow:!1,_title:null,_yourBet:null,_totalBet:null,_maxBet:null,_ration:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameTaiXiu.UITaiXiuToolTip,PreLoaderConfig.PathToResourceDefault).node);this._title=this.getChildByName("title");this._yourBet=this.getChildByName("your_bet");this._totalBet=this.getChildByName("total_bet");this._maxBet=this.getChildByName("max_bet");this._ration=this.getChildByName("ration");
this.hide()},updateToolTip:function(a,b,d,e,f){b||(b=0);d||(d=0);this._title.setString(a);this._yourBet.setString(Utilities.Coin(b));this._totalBet.setString(Utilities.Coin(d));this._maxBet.setString(Utilities.Coin(e));this._ration.setString(f)},show:function(){this.setVisible(!0);this.isShow=!0},hide:function(){this.setVisible(!1);this.isShow=!1}});var MGXuController=cc.Class.extend({sprite:null,mainControl:null,_lisXuFly:null,_lisXuWin:null,_listXuPosition:null,coinContain:null,ctor:function(a){this.mainControl=a;this.coinContain=new cc.Node;this.mainControl.addChild(this.coinContain);this._lisXuFly=[];this._lisXuWin=[];this._listXuPosition={}},createXu:function(a,b,d,e,f){var g=Math.floor(e/this.mainControl._minBet),h=e-g*this.mainControl._minBet;e=[];for(var k=ConstantsVariable.LIST_RATE_TAIXIU.length-1;-1<k;k--){var l=ConstantsVariable.LIST_RATE_TAIXIU[k];
if(g>=ConstantsVariable.LIST_RATE_TAIXIU[k]){var n=Math.floor(g/l),g=g-l*n,l={XU_RATE:l,XU_NUM:n,IMAGE_NAME:ConstantsVariable.LIST_IMG_XU_TAIXIU[k],REAL_XU:l*this.mainControl._minBet};e.push(l);if(0>=g)break}}0<h&&(l={XU_RATE:ConstantsVariable.LIST_RATE_TAIXIU[0],XU_NUM:1,IMAGE_NAME:ConstantsVariable.LIST_IMG_XU_TAIXIU[0],REAL_XU:h},e.push(l));for(g=0;g<e.length;g++)for(h=e[g],k=0;k<h.XU_NUM;k++)if(h.IMAGE_NAME){var l=d.BetID,n=this.getPositionXu(d,b),m=this._listXuPosition[l].LAST_XU_POS,u=new MGXuElement(h.IMAGE_NAME,
h.XU_RATE);u.setXuCol(this._listXuPosition[l].CURRENT_POS_COL);u.setDataTaiXiu(d.BetID,h.XU_RATE*this.mainControl._minBet,d.UserID,h.REAL_XU);this.coinContain.addChild(u,ConstantsVariable.UIZONE_TAIXIU.XU_Z_LOCAL);this._lisXuFly.push(u);f?(u.setPosition(a),this._processXuMove(u,a,m,this._afterXuInit.bind(this,u,d,b,n))):(u.setPosition(m),this._sortXuLocal(),UserController.isMine(d.UserID)&&b.setOpacity(255))}},getTotalBetByBetID:function(a){for(var b=0,d=0;d<this._lisXuFly.length;d++){var e=this._lisXuFly[d];
e.dataTaiXiu.BetID==a&&(b+=e.dataTaiXiu.RealValue)}return b},backXuMove:function(a){for(var b=0;b<this._lisXuFly.length;b++){var d=this._lisXuFly[b];d&&this._endGameAction(d,a)}for(b=0;b<this._lisXuWin.length;b++)(d=this._lisXuWin[b])&&this._endGameAction(d,a)},resetXu:function(){for(;0<this._lisXuFly.length;)this._lisXuFly.pop();for(;0<this._lisXuWin.length;)this._lisXuWin.pop();this._lisXuWin.length=0;this._lisXuFly.length=0;this._listXuPosition={}},cloneXuWin:function(a){for(var b=this._lisXuFly,
d=0;d<b.length;d++){var e=b[d];if(-1!=a.indexOf(e.dataTaiXiu.BetID)){var f=new MGXuElement(e.getSpriteFrame(),e.xuRate);f.setDataTaiXiu(e.dataTaiXiu.BetID,e.dataTaiXiu.BetCoin,e.dataTaiXiu.UserID);this.coinContain.addChild(f);this._lisXuWin.push(f);if(e=this._findButtonByTag(e.dataTaiXiu.BetID))f.setPosition(MGTaiXiu.DEALER_POS),this._processXuMove(f,MGTaiXiu.DEALER_POS,this._rndPosition(e))}}},_afterXuInit:function(a,b,d,e){this._sortXuLocal();UserController.isMine(b.UserID)&&d.setOpacity(255);1==
e&&a.setVisible(!1)},_endGameAction:function(a,b){var d=this.mainControl._listUser,e=a.dataTaiXiu;if(-1!=b.indexOf(e.BetID)){var f=MGTaiXiu.EMPTY_POS_BET[this.mainControl.randomIntFromInterval(0,MGTaiXiu.EMPTY_POS_BET.length-1)];e.UserID==MGGameInfo.myInfo.UserID?f=MGTaiXiu.MY_POS:(d=UserController.findUserSlot(e.UserID,d))&&(f=d.getPosition());this._processXuMove(a,a.getPosition(),f,null,!0)}else this._processXuMove(a,a.getPosition(),MGTaiXiu.DEALER_POS,null,!0)},_processXuMove:function(a,b,d,e,
f){a.stopAllActions();a.runAction(cc.sequence(cc.moveTo(MGTaiXiu.TIME_FLY,d),cc.callFunc(function(){e&&void 0!=e&&e();f&&a.removeFromParent(!0)}.bind(this),this)))},getPositionXu:function(a,b){var d=b.getPosition(),e=b.getContentSize(),f=a.BetID,g=Math.random()*(e.width-MGXuController.XU_SIZE.x-1)+(d.x-e.width/2+MGXuController.XU_SIZE.x/2-1),d=Math.random()*(e.height-MGXuController.XU_SIZE.y-1)+(d.y-e.height/2+MGXuController.XU_SIZE.y/2-1);this._listXuPosition[f]?this._listXuPosition[f].LAST_XU_POS=
cc.p(g,d):this._listXuPosition[f]={CURRENT_POS_COL:cc.p(g,d),LAST_XU_POS:cc.p(g,d)}},_sumXuGold:function(a){for(var b=0,d=0;d<a.length;d++)b+=a[d].dataTaiXiu.BetCoin;return b},_findListXu:function(a,b){for(var d=[],e=0;e<=this._lisXuFly.length;e++){var f=this._lisXuFly[e];f&&f.dataTaiXiu.BetID==a.BetID&&f.xuColPosition==b&&d.push(f)}return d},_findButtonByTag:function(a){return this.mainControl._getButtonByTag(a)},_rndPosition:function(a){var b=a.getPosition(),d=a.getContentSize();a=b.y-(d.height/
2-10);var e=b.y+(d.height/2-10),b=this.mainControl.randomIntFromInterval(b.x-(d.width/2-15),b.x+(d.width/2-15));a=this.mainControl.randomIntFromInterval(a,e);return cc.p(b,a)},_sortXuLocal:function(){this._lisXuFly.sort(function(a,d){return a.xuColPosition.y==d.xuColPosition.y?a.getPositionY()-d.getPositionY():d.xuColPosition.y-a.xuColPosition.y}.bind(this));for(var a=0;a<this._lisXuFly.length;a++)this._lisXuFly[a].setLocalZOrder(ConstantsVariable.UIZONE_TAIXIU.XU_Z_LOCAL+a)}}),MGXuElement=cc.Sprite.extend({xuRate:null,
dataTaiXiu:null,xuColPosition:cc.p(0,0),ctor:function(a,b){cc.Sprite.prototype.ctor.call(this);this.setSpriteFrame(a);this.xuRate=b;this.xuColPosition=cc.p(0,0)},setDataTaiXiu:function(a,b,d,e){this.dataTaiXiu={BetID:a,BetCoin:b,UserID:d,RealValue:e}},setXuCol:function(a){this.xuColPosition=a}});MGXuController.MAX_VALUE=2E5;MGXuController.MAX_XU_COL=5;MGXuController.XU_SIZE=cc.p(20,20);MGXuController.SIZE_ELEMENT=cc.p(17,17);MGXuController.PADING_X=4;MGXuController.PADING_Y=4;var MGEffectResultController=cc.Class.extend({mainControl:null,_effectWinLose:null,_txtCoin:null,ctor:function(a){this.mainControl=a;this._effectWinLose=new MGEffectThangThua(this.mainControl._mainLayer);this._txtCoin=this.mainControl._mainLayer.getChildByName("MGCoinEndMatchEffect");this._txtCoin.setVisible(!1);this._txtCoin.removeFromParent(!0);this._txtCoin.setLocalZOrder(ConstantsVariable.UIZONE_TAIXIU.TOOLTIP);this.mainControl.addChild(this._txtCoin)},showEffectWinLose:function(a){for(var b=
0;b<a.ListUser.length;b++){var d=a.ListUser[b];if(UserController.isMine(d.UserID))this._txtCoin.setString(Utilities.Coin(d.CoinWinLose)),this._txtCoin.setPosition(MGEffectResultController.TEXT_WINLOSE_POS),0<d.CoinWinLose?(this._txtCoin.setTextColor(MGEffectResultController.TEXT_WIN_COLOR),this._effectTextAction(this._txtCoin),this._effectWinLose.showThang(MGEffectResultController.MINE_EFFECT_WINLOSE_POS),this._effectWinLose._spineThang.setScale(1.5,1.5),mg.audio.playEffect(ResourceManager.MGResourcesGameTaiXiu.WinSound,
MGGameInfo.gameVolume)):0>d.CoinWinLose?(this._txtCoin.setTextColor(MGEffectResultController.TEXT_LOSE_COLOR),this._effectTextAction(this._txtCoin),this._effectWinLose.showThua(MGEffectResultController.MINE_EFFECT_WINLOSE_POS),this._effectWinLose._spineThua.setScale(1.5,1.5)):0<d.ListBetWin&&(this._effectWinLose.showHoa(MGEffectResultController.MINE_EFFECT_WINLOSE_POS),this._effectWinLose._spineHoa.setScale(1.5,1.5));else{var e=UserController.findUserSlot(d.UserID,this.mainControl._listUser);e&&(e.setUserGold(d.CoinUser),
e.effectWinLoseTaiXiu||(e.effectWinLoseTaiXiu=new MGEffectThangThua(e)),0<d.CoinWinLose?e.effectWinLoseTaiXiu.showThang(cc.p(0,0)):0>d.CoinWinLose?e.effectWinLoseTaiXiu.showThua(cc.p(0,0)):0<d.ListBetWin.length&&e.effectWinLoseTaiXiu.showHoa(cc.p(0,0)))}}cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{})},_effectTextAction:function(a){a.setVisible(!0);a.setOpacity(255);a.runAction(cc.sequence(cc.spawn(cc.moveTo(3,MGEffectResultController.TEXT_WINLOSE_DESTINATION),
cc.fadeOut(3)),cc.callFunc(function(){a.setVisible(!1)})))}});MGEffectResultController.MINE_EFFECT_WINLOSE_POS=cc.p(640,350);MGEffectResultController.TEXT_WINLOSE_FONT="Roboto-Regular";MGEffectResultController.TEXT_WINLOSE_POS=cc.p(640,420);MGEffectResultController.TEXT_WINLOSE_DESTINATION=cc.p(640,520);MGEffectResultController.FONT_WINLOSE_SIZE=35;MGEffectResultController.TEXT_WIN_COLOR=cc.color(255,210,0,255);MGEffectResultController.TEXT_LOSE_COLOR=cc.color(253,67,131,255);var MGTaiXiu=MGBaseGame.extend({_timer:null,_effectTimer:null,_totalBet:null,_timeNotBet:3,_timeValue:0,_canBet:!1,_listUser:null,_layerXuBet:null,_layerPopupTaiXiu:null,_fileNameXu:"#xu100.png",_selectXuValue:100,_uiActionDices:null,_resultBtn:null,_minBet:0,_maxBet:0,_listBetCurrent:null,_currentMatchId:0,_totalBetValue:0,_effectControl:null,_toolTipBet:null,_toolTipManager:null,_xuController:null,_dealer:null,_gameInfoContain:null,_spriteGameStatus:null,_currentTYime:0,_lastTime:0,_deltaTime:0,
_totalBetCuoc:0,listButtonBet:null,_spriteErrorCard:null,layerDatCuoc:null,netSend:null,labelGoldUser:null,timeOutCallback:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameTaiXiu},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._listUser=[];this.timeOutCallback=[];this._listBetCurrent=[];this._initUI();this.netSend=new MGNetSendTaiXiu;this._initPopupTaiXiu();cc.sys.isNative&&this.setUIMobile()},setUIMobile:function(){this.setScale(1.5,1.5);this.setPosition(-(.5*
cc.winSize.width*(this.getScale()-1)),-200);this._resultBtn.setPosition(413,615);this._gameInfoContain.setPosition(220,560);this._layerXuBet.setPosition(410,180);this._layerXuBet.setScaleButton(1.2);this.layerDatCuoc.setPosition(980,180);this._dealer.setScale(2.5);this._dealer.setPositionY(550);this._spriteGameStatus.setPositionY(560);this._layerPopupTaiXiu.setUIMobile();for(var a=0;7>=a;a++)this._listUser[a].setScale(.6,.6),4>a?this._listUser[a].setPositionY(563):this._listUser[a].setPositionY(240);
MGGameInfo.MGMain.layerComponents.compoChat.btnChat.setPositionY(50);MGGameInfo.MGMain.layerComponents.compoChat.btnChat.setPositionX(-40);MGGameInfo.MGMain.layerComponents.compoChat.touchButtonPanel.setPosition(MGGameInfo.MGMain.layerComponents.compoChat.btnChat.getPosition());this.labelGoldUser.setPosition(250,505);this._mainLayer.getChildByName("IconCoin").setPosition(230,505)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameTaiXiu.UITaiXiuLayer,PreLoaderConfig.PathToResourceDefault);
this._initBtnBet();this._timeValue=0;this._dealer=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTaiXiu.Dealer_Json,ResourceManager.MGResourcesGameTaiXiu.Dealer_Atlas);this._dealer.setScale(4);this._dealer.setPosition(this._mainLayer.getChildByName("Dealer").getPosition());this._dealer.setPositionY(this._dealer.getPositionY()-15);this.addChild(this._dealer);this._spriteGameStatus=new cc.Sprite;this._spriteGameStatus.setSpriteFrame("MoiDatCuoc.png");this._spriteGameStatus.setPosition(cc.p(this._dealer.getPositionX(),
this._dealer.getPositionY()+10));this._spriteGameStatus.setScale(.6);this.addChild(this._spriteGameStatus);this._totalBet=this._mainLayer.getChildByName("Text_TongDat");this._totalBet.setTextColor(cc.color(132,255,0,255));this._resultBtn=this._mainLayer.getChildByName("ShowResultBtn");this._resultBtn.addClickEventListener(function(){this._layerPopupTaiXiu.showPopupResultTaiXiu()}.bind(this));this.labelGoldUser=this._mainLayer.getChildByName("Text_MyGold");for(var a=0;7>=a;a++){var b=this._mainLayer.getChildByName("Slot_"+
a.toString()).getPosition(),d=new MGCompUserInfoPlay;d.setPosition(b);4<=a&&d.setAlignInfo(MGCompUserInfoPlay.BottomAlign);this._listUser.push(d);this.addChild(d)}this.layerDatCuoc=new MGComboDatCuoc;this.layerDatCuoc.setPosition(980,90);this.addChild(this.layerDatCuoc);this._layerXuBet=new MGComboXuBet;this._layerXuBet.setPosition(400,80);this.addChild(this._layerXuBet);this._layerXuBet.reset();this._toolTipBet=new MGUIToolTip;this._toolTipBet.setPosition(300,100);this.addChild(this._toolTipBet,
ConstantsVariable.UIZONE_TAIXIU.TOOLTIP);this.listButtonBet=[];b=this._mainLayer.getChildren();d=b.length;for(a=0;a<d;a++)if(b[a]instanceof ccui.ImageView){var e=b[a].getTag();0<e&&53>e&&(b[a].addTouchEventListener(this._onclickBet.bind(this)),this.listButtonBet.push(b[a]))}this._initGameInfoContain();this._effectControl=new MGEffectResultController(this);this._xuController=new MGXuController(this);this._uiActionDices=new MGUIActionDices(this);this._timer=this._mainLayer.getChildByName("timer");this._timer.setFontSize(45);
this._timer.setFontName("arialbd");this._timer.setTextColor(cc.color(255,246,0));this._timer.ignoreContentAdaptWithSize(!0);this._timer.removeFromParent();this.addChild(this._timer);this._effectTimer=new sp.SkeletonAnimation(ResourceManager.MGResourcesCombo.UICircleSpineJson,ResourceManager.MGResourcesCombo.UICircleSpineAtlas);this._effectTimer.setPosition(this._timer.getPosition());this.addChild(this._effectTimer);this._effectTimer.setVisible(!1);this.stopTimerEffect();mg.audio.playMusic(ResourceManager.MGResourcesGameTaiXiu.BackgroundSound,
MGGameInfo.gameVolume,!0)},_initGameInfoContain:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(80,630);this._gameInfoContain.setVisible(!1);this.addChild(this._gameInfoContain)},_initBtnBet:function(){if(!cc.sys.isNative){this.listButtonBet=[];for(var a=1;52>=a;a++)if(this._mainLayer.getChildByTag(a)instanceof ccui.ImageView){var b=new MGBaseImageView;this.listButtonBet.push(b);b.setTag(this._mainLayer.getChildByTag(a).getTag());b.cloneImageView(this._mainLayer.getChildByTag(a));
b.initObj();b._initEventsGame();this._mainLayer.addChild(b);b.getTag();b.setTouchEnabled(!0);b.setMouseHoverEnabled(!0);b.addMouseHoverEventListener(this._onMouseHover.bind(this))}}},_onMouseHover:function(a,b){switch(b){case 0:this._toolTipBet.getTag()===a.getTag()&&this._toolTipBet.hide();break;case 1:if(!this._toolTipBet.isShow){this._toolTipBet.setTag(a.getTag());var d=this._getTotalGoldBet(a.getTag()),e=this._getXucXacInfoByTag(a.getTag()),f="1 : "+e.Rate.toString(),g=this._xuController.getTotalBetByBetID(a.getTag());
this._toolTipBet.updateToolTip(e.Name,d,g,e.MaxBet,f);d=a.getPosition();e=a.getContentSize();d.y-=e.height/2;d.y-=67;this._toolTipBet.setPosition(d);this._toolTipBet.show()}}},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);cc.sys.isNative&&(MGGameInfo.MGMain.layerComponents.compoChat.btnChat.setPositionY(-43),MGGameInfo.MGMain.layerComponents.compoChat.btnChat.setPositionX(43));this._uiActionDices&&(this._uiActionDices.setDispose(),this._uiActionDices=null);this.unschedule(this._countTime);
for(var a=0;a<this.timeOutCallback.length;a++)this.timeOutCallback[a]&&clearTimeout(this.timeOutCallback[a]);this.timeOutCallback=[];mg.audio.stopMusic(!0);mg.audio.stopAllEffects()},_onclickBet:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this._canBet&&a.setOpacity(255);break;case ccui.Widget.TOUCH_ENDED:var d=this._checkIsBet(a.getTag()),e=this._selectXuValue;this._canBet?(a.setOpacity(0),d&&this.timeOutCallback.push(setTimeout(function(){a.setOpacity(255)},200)),e<this._minBet&&(e=this._minBet*
ConstantsVariable.LIST_RATE_TAIXIU[0]),MGGameInfo.myInfo.Gold>this._minBet&&MGGameInfo.myInfo.Gold<e&&(e=MGGameInfo.myInfo.Gold),a.getTag(),this.netSend.sendBet(a.getTag(),e)):d||a.setOpacity(0);break;case ccui.Widget.TOUCH_CANCELED:this._checkIsBet(a.getTag())||a.setOpacity(0)}},_initPopupTaiXiu:function(){this._layerPopupTaiXiu=new MGLayerPopupTaiXiu;this.addChild(this._layerPopupTaiXiu,ConstantsVariable.UIZONE_TAIXIU.POPUP)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.StartGame.toString(),this._onGetGameStart.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.GameData.toString(),this._onGetGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.ResultHistory.toString(),this._onGetResultHistory.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.ListUser.toString(),
this._onGetListUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.AddUser.toString(),this._onGetGameAddUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.UserLeftDesk.toString(),this._onGetUserLeftDesk.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.AddBet.toString(),this._onGetGameAddBet.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.DoubleBet.toString(),
this._onGetGameDoubleBet.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.Result.toString(),this._onGetGameResult.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.EndMatch.toString(),this._onGetGameEndMatch.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.GetUserOnBoard.toString(),this._onGetUserOnBoard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGComboDatCuoc.ON_CLICK.toString(),
this._onGetChangeBet.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGComboXuBet.ON_CLICK.toString(),this._onChangeXu.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUpdateUserCoin.bind(this)))},_onGetGameData:function(a){this._resetGame();a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,TimeRemain:b.UInt16,MD5:b.StringDynamic,ListBet:b.Array8,ListBet_Type:b.Object8,
ListBet_Type_Struct:{UserID:b.UInt32,UserInfoBet:b.Array8,UserInfoBet_Type:b.Object8,UserInfoBet_Type_Struct:{BetID:b.UInt8,CoinBet:b.UInt64}},MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);b=a.Status;this._timeValue=a.TimeRemain;this._timer.setString(this._timeValue);this.runTimerEffect(this._timeValue);this._minBet=a.MinCoin;this._maxBet=a.MaxCoin;this._updateCurrentMatchId(a.MatchID);this._gameInfoContain.setInfo("TÀI XỈU",a.DeskID,a.MinCoin,a.MatchID);
this._layerXuBet.setMinBet(a.MinCoin);if(0<a.MatchID){for(var d=0;d<a.ListBet.length;d++)for(var e=a.ListBet[d],f=0;f<e.UserInfoBet.length;f++){var g=e.UserInfoBet[f],h=g.BetID,k=this._getButtonByTag(h);if(k){var l={BetID:h,UserID:e.UserID,BetCoin:g.CoinBet};e.UserID==MGGameInfo.myInfo.UserID&&this._updateMyBetInfo(h,g.CoinBet,e.UserID);this._xuController.createXu(MGTaiXiu.MY_POS,k,l,g.CoinBet,!0)}}this._layerPopupTaiXiu.popupHistory.updateHistoryBet(this._currentMatchId,this._listBetCurrent)}0===
b?(this._canBet=!0,this._timer.setVisible(!0),this._spriteGameStatus.setVisible(!0)):(this._canBet=!1,this._dealer.setAnimation(0,"Idle",!0),this.stopTimerEffect(),this._spriteGameStatus.setSpriteFrame("NgungNhanCuoc.png"),this._spriteGameStatus.setVisible(!1));this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},_onGetListUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,Nickname:b.StringDynamic,
avatar:b.StringDynamic}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.ListUser.length;b++)UserController.setSlotUser(a.ListUser[b],!1,this._listUser)},_updateUserGold:function(a,b){var d=UserController.findUserSlot(a,this._listUser);d&&d.setUserGold(b)},_onGetResultHistory:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultHistory:b.Array8,ResultHistory_Type:b.Object8,ResultHistory_Type_Struct:{StatisticCommon:b.Array8,StatisticCommon_Type:b.Object8,StatisticCommon_Type_Struct:{numTai:b.UInt16,
numXiu:b.UInt16,numBao:b.UInt16,percentOne:b.UInt16,percentTwo:b.UInt16,percentThree:b.UInt16,percentFour:b.UInt16,percentFive:b.UInt16,percentSix:b.UInt16},SixMatch:b.Array8,SixMatch_Type:b.Object8,SixMatch_Type_Struct:{matchID:b.UInt32,result:b.Array8,result_Type:b.UInt8}}};a=(new BinaryParser).initObj(b,a.content);this._updateResultGetData(a)},_onGetUserOnBoard:function(a){},_onGetGameStart:function(a){this._resetGame();a=a.getUserData();var b=BinaryConstants.DataTypeID,b={timeBet:b.UInt16,md5:b.StringDynamic,
rules:b.StringDynamic,timeShake:b.UInt16,MinCoin:b.UInt64,MaxCoin:b.UInt64,matchID:b.UInt32,timeNotBet:b.UInt16};a=(new BinaryParser).initObj(b,a.content);this._timeValue=a.timeBet;this._minBet=a.MinCoin;this._maxBet=a.MaxCoin;this._timeNotBet=a.timeNotBet;this._timer.setString(this._timeValue);this.runTimerEffect(this._timeValue);this._updateCurrentMatchId(a.matchID);this._gameInfoContain.setMinBetInfo(a.MinCoin);this._xuController.resetXu()},_onGetGameAddUser:function(a){a=a.getUserData();var b=
BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,avatar:b.StringDynamic};a=(new BinaryParser).initObj(b,a.content);UserController.setSlotUser(a,!0,this._listUser)},_onGetUserLeftDesk:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);if(a.ListUser&&void 0!==a.ListUser)for(b=0;b<a.ListUser.length;b++)UserController.removeSlotUser(a.ListUser[b],this._listUser)},_onErrorDownCard:function(a){},
_onGetGameAddBet:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,ListCuoc:b.Array8,ListCuoc_Type:b.Object8,ListCuoc_Type_Struct:{BetID:b.UInt8,BetCoin:b.UInt64},Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._processBetData(a);cc.audioEngine.playEffect(ResourceManager.MGResourcesGameTaiXiu.BetSound,!1)},_processBetData:function(a){for(var b=0;b<a.ListCuoc.length;b++){var d={UserID:a.UserID,BetID:a.ListCuoc[b].BetID,BetCoin:a.ListCuoc[b].BetCoin},e=
this._getButtonByTag(d.BetID);if(e){if(UserController.isMine(d.UserID))this._updateMyBetInfo(d.BetID,d.BetCoin,d.UserID),this._layerPopupTaiXiu.popupHistory.updateHistoryBet(this._currentMatchId,this._listBetCurrent),this._xuController.createXu(this._layerXuBet.getSelectXuPosition(),e,d,d.BetCoin,!0),MGGameInfo.myInfo.Gold=a.Coin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{});else{var f=UserController.findUserSlot(d.UserID,this._listUser),f=null!==f?f.getPosition():
MGTaiXiu.EMPTY_POS_BET[this.randomIntFromInterval(0,MGTaiXiu.EMPTY_POS_BET.length-1)];this._xuController.createXu(f,e,d,d.BetCoin,!0);this._updateUserGold(d.UserID,a.Coin)}if(d.BetID==this._toolTipBet.getTag()){var e=this._getTotalGoldBet(d.BetID),f=this._getXucXacInfoByTag(d.BetID),g="1 : "+f.Rate.toString(),d=this._xuController.getTotalBetByBetID(d.BetID);this._toolTipBet.updateToolTip(f.Name,e,d,f.MaxBet,g)}}else Utilities.showLog("Can not found button from ID "+d.BetID.toString())}this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},
_onGetGameDoubleBet:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,TotalCoinBet:b.UInt64,ListBet:b.Array8,ListBet_Type:b.Object8,ListBet_Type_Struct:{BetID:b.UInt8,BetCoin:b.UInt64},UserCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);b=a.ListBet;if(UserController.isMine(a.UserID))for(var d=0;d<b.length;d++)b[d].UserID=a.UserID;this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},_onGetGameResult:function(a){this._canBet=!1;a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={result:b.StringDynamic,md5:b.StringDynamic,key:b.StringDynamic};a=(new BinaryParser).initObj(b,a.content).result.split(",");for(var d=[],b=0;b<a.length;b++){var e=Number(a[b]);Number.isNaN(e)||d.push(e)}this.stopTimerEffect();this._uiActionDices.reset();this._uiActionDices.run(d[0],d[1],d[2]);this._dealer.setAnimation(0,"DealCard",!1);this._dealer.setTimeScale(.7);this.timeOutCallback.push(setTimeout(function(){this._layerPopupTaiXiu.popupResult.initSixMatchInfo(d)}.bind(this),5E3))},_onGetGameEndMatch:function(a){this._canBet=
!1;a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListResultId:b.Array8,ListResultId_Type:b.Int8,ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,CoinWinLose:b.Int64,CoinUser:b.UInt64,ListBetWin:b.Array8,ListBetWin_Type:b.Int8},MatchID:b.UInt32,StatisticResult:b.StringDynamic};this._dealer.setAnimation(0,"Idle",!0);a=(new BinaryParser).initObj(b,a.content);b=JSON.parse(a.StatisticResult);this._layerPopupTaiXiu.popupResult.setNormalInfoResult(b);this._layerPopupTaiXiu.popupHistory.setHistoryInfo(a,
this._listBetCurrent);this._showResultEffect(a);this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},onExit:function(){MGBaseGame.prototype.onExit.call(this)},_getButtonByTag:function(a){return this._mainLayer.getChildByTag(a)},_countTime:function(a){this._timeValue<=this._timeNotBet&&(this._canBet=!1);3>=this._timeValue&&this._spriteGameStatus.setSpriteFrame("NgungNhanCuoc.png");17>this._timeValue&&5<this._timeValue?this._timer.setTextColor(cc.color(255,246,0)):5>=this._timeValue&&(this._timer.setTextColor(cc.color.RED),
1<this._timeValue&&mg.audio.playEffect(ResourceManager.MGResourcesGameTaiXiu.TimeOutSound,MGGameInfo.gameVolume));0<this._timeValue?(this._timeValue--,this._currentTYime=Date.now(),this._deltaTime+=this._currentTYime-this._lastTime-1E3,this._timeValue-=parseInt(this._deltaTime/1E3),this._deltaTime%=1E3,this._lastTime=this._currentTYime,this._timer.setString(this._timeValue)):(this._timeValue=0,this._timer.setString(this._timeValue),this.unschedule(this._countTime),this._spriteGameStatus.setVisible(!1))},
_onGetChangeBet:function(a){a=a.getUserData();switch(a.value){case 0:this.netSend.sendReBet();break;case 1:this.netSend.sendBetDouble()}var b=a.sender;b&&(b.stopAllActions(),b.runAction(cc.sequence(cc.callFunc(function(){b.setEnabled(!1)}),cc.delayTime(1.3),cc.callFunc(function(){b.setEnabled(!0)}))))},_onChangeXu:function(a){a=a.getUserData();this._selectXuValue=this._minBet*ConstantsVariable.LIST_RATE_TAIXIU[a.value];this._fileNameXu="#"+ConstantsVariable.LIST_IMG_XU_TAIXIU[a.value]},_resetGame:function(){this.stopResultEffect();
this._canBet=!0;this._timeValue=0;this._listBetCurrent=[];this._deltaTime=0;this._currentTYime=this._lastTime=Date.now();this.unschedule(this._countTime);this.schedule(this._countTime,1);this._timer.setVisible(!0);this._setOpacityBetBtn();this._uiActionDices.reset();this._spriteGameStatus.setVisible(!0);this._spriteGameStatus.setSpriteFrame("MoiDatCuoc.png");this._dealer.setAnimation(0,"Idle",!0);this._totalBetValue=0;this._totalBet.setString(Utilities.Coin(this._totalBetValue));this._timer.setTextColor(cc.color(102,
255,0))},stopResultEffect:function(){var a=0,b=this.listButtonBet.length;for(a;a<b;a++)this.listButtonBet[a].stopAllActions()},_showResultEffect:function(a){var b=a.ListResultId;b.forEach(function(a,b){var f=this._getButtonByTag(a);f&&void 0!==f&&(f.stopAllActions(),f.runAction(cc.sequence(cc.fadeIn(.4),cc.fadeOut(.3)).repeat(3)))}.bind(this));this.timeOutCallback.push(setTimeout(this._xuController.cloneXuWin.bind(this._xuController,b),1E3));this.timeOutCallback.push(setTimeout(this._effectControl.showEffectWinLose.bind(this._effectControl,
a),1700));this.timeOutCallback.push(setTimeout(this._setOpacityBetBtn.bind(this),2E3));this.timeOutCallback.push(setTimeout(this._xuController.backXuMove.bind(this._xuController,b),1900));!0===this._layerPopupTaiXiu.popupResult._stickAutoShow.isSelected()&&this._layerPopupTaiXiu.showPopupResultTaiXiu()},_updateResultGetData:function(a){this._layerPopupTaiXiu.popupResult.setNormalInfoResult(a.ResultHistory[0].StatisticCommon[0]);a=a.ResultHistory[0].SixMatch;for(var b=[],d=0;d<a.length;d++)b.push(a[d].result);
this._layerPopupTaiXiu.popupResult.setSixMatchInfo(b)},randomIntFromInterval:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},_setOpacityBetBtn:function(){for(var a=this._mainLayer.getChildren(),b=a.length,d=0;d<b;d++)if(a[d]instanceof ccui.ImageView){var e=a[d].getTag();0<e&&53>e&&a[d].setOpacity(0)}},_updateCurrentMatchId:function(a){this._currentMatchId=a;this._layerPopupTaiXiu.popupResult.setMatchId(this._currentMatchId);this._gameInfoContain.setMatchIdInfo(a)},_updateMyBetInfo:function(a,
b,d){d==MGGameInfo.myInfo.UserID&&(this._totalBetValue+=b);this._totalBet.setString(Utilities.Coin(this._totalBetValue));d=!1;for(var e=0;e<this._listBetCurrent.length;e++)this._listBetCurrent[e].BetID===a&&(d=!0,this._listBetCurrent[e].BetCoin+=b);d||this._listBetCurrent.push({BetID:a,BetCoin:b})},_getTotalGoldBet:function(a){for(var b=0;b<this._listBetCurrent.length;b++)if(this._listBetCurrent[b].BetID===a)return this._listBetCurrent[b].BetCoin;return 0},_checkIsBet:function(a){for(var b=0;b<this._listBetCurrent.length;b++)if(this._listBetCurrent[b].BetID===
a)return!0;return!1},runTimerEffect:function(a){a&&void 0!==a&&0<a&&this._effectTimer.setTimeScale(1.6667/a);this._effectTimer.setVisible(!0);this._effectTimer.setAnimation(0,"animation",!1)},stopTimerEffect:function(){this._timer.setVisible(!1);this._effectTimer.setVisible(!1)},_getXucXacInfoByTag:function(a){return 1>a||52<a?0:MGTaiXiu.MAX_BET[a]},updateHUDGoldUser:function(a){this.labelGoldUser.setString(Utilities.Coin(a))},ngUpdateUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};
a=(new BinaryParser).initObj(b,a.content);this.updateHUDGoldUser(a.Gold)}});MGTaiXiu.TIME_FLY=.5;MGTaiXiu.TAG_XU_FLY=3910;MGTaiXiu.EMPTY_POS_BET=[cc.p(1140,440)];MGTaiXiu.MY_POS=cc.p(716,117);MGTaiXiu.DEALER_POS=cc.p(640,610);MGTaiXiu.XU_Y=2.5;
MGTaiXiu.MAX_BET={1:{Id:1,Rate:1,MaxBet:2E6,Name:"Đơn 1"},2:{Id:2,Rate:1,MaxBet:2E6,Name:"Đơn 2"},3:{Id:3,Rate:1,MaxBet:2E6,Name:"Đơn 3"},4:{Id:4,Rate:1,MaxBet:2E6,Name:"Đơn 4"},5:{Id:5,Rate:1,MaxBet:2E6,Name:"Đơn 5"},6:{Id:6,Rate:1,MaxBet:2E6,Name:"Đơn 6"},7:{Id:7,Rate:6,MaxBet:15E5,Name:"Đôi 1:2"},8:{Id:8,Rate:6,MaxBet:15E5,Name:"Đôi 1:3"},9:{Id:9,Rate:6,MaxBet:15E5,Name:"Đôi 1:4"},10:{Id:10,Rate:6,MaxBet:15E5,Name:"Đôi 1:5"},11:{Id:11,Rate:6,MaxBet:15E5,Name:"Đôi 1:6"},12:{Id:12,Rate:6,MaxBet:15E5,
Name:"Đôi 2:3"},13:{Id:13,Rate:6,MaxBet:15E5,Name:"Đôi 2:4"},14:{Id:14,Rate:6,MaxBet:15E5,Name:"Đôi 2:5"},15:{Id:15,Rate:6,MaxBet:15E5,Name:"Đôi 2:6"},16:{Id:16,Rate:6,MaxBet:15E5,Name:"Đôi 3:4"},17:{Id:17,Rate:6,MaxBet:15E5,Name:"Đôi 3:5"},18:{Id:18,Rate:6,MaxBet:15E5,Name:"Đôi 3:6"},19:{Id:19,Rate:6,MaxBet:15E5,Name:"Đôi 4:5"},20:{Id:20,Rate:6,MaxBet:15E5,Name:"Đôi 4:6"},21:{Id:21,Rate:6,MaxBet:15E5,Name:"Đôi 5:6"},22:{Id:22,Rate:62,MaxBet:1E5,Name:"4 Điểm"},23:{Id:23,Rate:31,MaxBet:2E5,Name:"5 Điểm"},
24:{Id:24,Rate:18,MaxBet:4E5,Name:"6 Điểm"},25:{Id:25,Rate:12,MaxBet:5E5,Name:"7 Điểm"},26:{Id:26,Rate:8,MaxBet:6E5,Name:"8 Điểm"},27:{Id:27,Rate:7,MaxBet:75E4,Name:"9 Điểm"},28:{Id:28,Rate:6,MaxBet:75E4,Name:"10 Điểm"},29:{Id:29,Rate:6,MaxBet:75E4,Name:"11 Điểm"},30:{Id:30,Rate:7,MaxBet:75E4,Name:"12 Điểm"},31:{Id:31,Rate:8,MaxBet:6E5,Name:"13 Điểm"},32:{Id:32,Rate:12,MaxBet:5E5,Name:"14 Điểm"},33:{Id:33,Rate:18,MaxBet:4E5,Name:"15 Điểm"},34:{Id:34,Rate:31,MaxBet:2E5,Name:"16 Điểm"},35:{Id:35,Rate:62,
MaxBet:1E5,Name:"17 Điểm"},36:{Id:36,Rate:11,MaxBet:5E5,Name:"Cặp 1:1"},37:{Id:37,Rate:11,MaxBet:5E5,Name:"Cặp 2:2"},38:{Id:38,Rate:11,MaxBet:5E5,Name:"Cặp 3:3"},39:{Id:39,Rate:11,MaxBet:5E5,Name:"Cặp 4:4"},40:{Id:40,Rate:11,MaxBet:5E5,Name:"Cặp 5:5"},41:{Id:41,Rate:11,MaxBet:5E5,Name:"Cặp 6:6"},42:{Id:42,Rate:180,MaxBet:5E4,Name:"Bảo nhất"},43:{Id:43,Rate:180,MaxBet:5E4,Name:"Bảo nhị"},44:{Id:44,Rate:180,MaxBet:5E4,Name:"Bảo tam"},45:{Id:45,Rate:180,MaxBet:5E4,Name:"Bảo tứ"},46:{Id:46,Rate:180,MaxBet:5E4,
Name:"Bảo ngũ"},47:{Id:47,Rate:180,MaxBet:5E4,Name:"Bảo lục"},48:{Id:48,Rate:1,MaxBet:2E6,Name:"Xỉu"},49:{Id:49,Rate:1,MaxBet:2E6,Name:"Tài"},50:{Id:50,Rate:31,MaxBet:2E5,Name:"Bảo bất kỳ"},51:{Id:51,Rate:1,MaxBet:2E6,Name:"Lẻ"},52:{Id:52,Rate:1,MaxBet:2E6,Name:"Chẵn"}};ResourceManager.MGResourcesGameTienLen={Card52:"res/game/Cards/mat-sau.png",Dealer_Atlas:"res/game/taixiu/Effect/dealer_Blue.atlas",Dealer_PNG:"res/game/taixiu/Effect/dealer_Blue.png",Dealer_Json:"res/game/taixiu/Effect/dealer_Blue.json",AtlasCards:"res/game/Cards/AtlasCards.png",AtlasCardsPlist:"res/game/Cards/AtlasCards.plist",FXBaDoiThong_Atlas:"res/game/tienlen/Effect/3dt.atlas",FXBaDoiThong_Json:"res/game/tienlen/Effect/3dt.json",FXBaDoiThong_png:"res/game/tienlen/Effect/3dt.png",FXBonDoiThong_Atlas:"res/game/tienlen/Effect/4dt.atlas",
FXBonDoiThong_Json:"res/game/tienlen/Effect/4dt.json",FXBonDoiThong_png:"res/game/tienlen/Effect/4dt.png",FXToiTrang_Atlas:"res/game/tienlen/Effect/toitrang.atlas",FXToiTrang_Json:"res/game/tienlen/Effect/toitrang.json",FXToiTrang_png:"res/game/tienlen/Effect/toitrang.png",FXTuQuy_Atlas:"res/game/tienlen/Effect/tuquy.atlas",FXTuQuy_Json:"res/game/tienlen/Effect/tuquy.json",FXTuQuy_png:"res/game/tienlen/Effect/tuquy.png",FXVanMoi_Atlas:"res/game/tienlen/Effect/vanmoi.atlas",FXVanMoi_Json:"res/game/tienlen/Effect/vanmoi.json",
FXVanMoi_png:"res/game/tienlen/Effect/vanmoi.png",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",AtlasTienLen:"res/game/tienlen/AtlasTienLen/AtlasTienLen.png",PlistTienLen:"res/game/tienlen/AtlasTienLen/AtlasTienLen.plist",
UIMGUITienLenLayer:"res/game/tienlen/UITienLenLayer.json",UIMGUITienLenButton:"res/game/tienlen/UITienLenButton.json",CHAT:"res/game/tienlen/Sounds/Chat.mp3",CHIA_BAI:"res/game/tienlen/Sounds/ChiaBai.mp3",DANH:"res/game/tienlen/Sounds/Danh.mp3",THANG:"res/game/tienlen/Sounds/Thang.mp3",TOI_LUOT:"res/game/tienlen/Sounds/ToiLuot.mp3",TOI_TRANG:"res/game/tienlen/Sounds/ToiTrang.mp3"};var resourcesGameTienLen=[];
for(i in ResourceManager.MGResourcesGameTienLen)ResourceManager.MGResourcesGameTienLen[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameTienLen[i],resourcesGameTienLen.push(ResourceManager.MGResourcesGameTienLen[i]);ConstantsVariable.NETWORK_TIEN_LEN={AutoWin:1200,AutoMove:1201,DownCard:1202,PassPlay:1203,NextPlayer:1204,RandCard:1205,UserLeave:1206,UserFinish:1207,GameData:1208,ListUser:1209,CutRoundResult:1210,ActiveTakeTurn:1211,TakeTurn:1212,AddUser:1213,ResultMoney:1214,Tool:1216,UpdateCoin:1218,ErrorDownCard:1217};ConstantsVariable.STATE_TIEN_LEN={NOT_START:0,START_GAME:1,DEAL:2,WAIT_SEND_AUTO_WIN:3,WAIT_DOWN_CARD:4,WAIT_DOWN_OR_PASS:5,CALCULATE_FINISH:6,FINISH:7};
ConstantsVariable.TypeDownCard={INVALID:0,Single:1,SingleOfCardTwo:2,Pair:3,PairOfCardTwo:4,ThreeOfAKind:5,ThreeOfAKindCardTwo:6,FourOfAKind:7,FourOfAKindCardTwo:8,Straight:11,ThreeStraightPair:12,FourStraightPair:13,FiveStraightPair:14};ConstantsVariable.FINISH_TYPE={FinishFull:10,FinishFinal:-1,FinishWin13Card:13,FinishDied13Card:-2,FinishLostSpades3:-3,FinishCompensationFull:-4,FinishWinSpades3:14,FinishCaptureSpades3:15,FinishCompensationSpades3:-5,FinishFinalAndDied2AndStraightPair:-6};var MGNetSendTienLen=cc.Class.extend({gameModuleID:null,ctor:function(){},sendDownCard:function(a){Utilities.showLog("sendDownCard "+JSON.stringify(a));var b={};b.ListCards=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TIEN_LEN.DownCard,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendPass:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TIEN_LEN.PassPlay,
null,null);MGNetCore.MGSocket.sendMsg(a)},toolTenLen:function(a){var b={};b.ListCards=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TIEN_LEN.Tool,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendTakeTurn:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_TIEN_LEN.TakeTurn,null,null);MGNetCore.MGSocket.sendMsg(a)}});var MGTLMNButtons=MGBaseNode.extend({_listButton:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);cc.sys.isNative?this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameTienLen.UIMGUITienLenButton,"res/").node):this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameTienLen.UIMGUITienLenButton).node);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this.hideAll()},_initEventBtnFromNode:function(){for(var a=
this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]))},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTLMNButtons.BUTTON_NAME.BO_LUOT:this.mainGame.netSend.sendPass();
break;case MGTLMNButtons.BUTTON_NAME.BO_CHON:0<MGGameBoardTienLen.listSelectedCards.length&&this.mainGame.boxCardContainer.boxCardOwner.unselectListCard();this.updateButton();break;case MGTLMNButtons.BUTTON_NAME.XEP_BAI:this.mainGame.boxCardContainer.boxCardOwner.shortAccending();this.updateButton();mg.audio.playEffect(ResourceManager.MGResourcesGameTienLen.DANH,MGGameInfo.gameVolume);break;case MGTLMNButtons.BUTTON_NAME.DANH:0<MGGameBoardTienLen.listSelectedCards.length&&this.mainGame.netSend.sendDownCard(MGGameBoardTienLen.listSelectedCards);
this.mainGame.boxCardContainer.boxCardOwner.unselectListCard();this.updateButton();break;case MGTLMNButtons.BUTTON_NAME.LAY_LUOT:this.mainGame.netSend.sendTakeTurn()}},hideAll:function(){for(var a=0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)},updateButton:function(){0<MGGameBoardTienLen.GameStatus&&6>MGGameBoardTienLen.GameStatus?MGGameBoardTienLen.UserActive==MGGameInfo.myInfo.UserID?(0<MGGameBoardTienLen.listSelectedCards.length?
(this.showButton(MGTLMNButtons.BUTTON_NAME.DANH),this.showButton(MGTLMNButtons.BUTTON_NAME.BO_CHON)):(this.hideButton(MGTLMNButtons.BUTTON_NAME.BO_CHON),this.hideButton(MGTLMNButtons.BUTTON_NAME.DANH)),this.showButton(MGTLMNButtons.BUTTON_NAME.XEP_BAI),1==MGGameBoardTienLen.isEndRound?this.hideButton(MGTLMNButtons.BUTTON_NAME.BO_LUOT):this.showButton(MGTLMNButtons.BUTTON_NAME.BO_LUOT)):(0<this.mainGame.boxCardContainer.boxCardOwner._listMyCard.length?this.showButton(MGTLMNButtons.BUTTON_NAME.XEP_BAI):
this.hideButton(MGTLMNButtons.BUTTON_NAME.XEP_BAI),0<MGGameBoardTienLen.listSelectedCards.length?this.showButton(MGTLMNButtons.BUTTON_NAME.BO_CHON):this.hideButton(MGTLMNButtons.BUTTON_NAME.BO_CHON),this.hideButton(MGTLMNButtons.BUTTON_NAME.DANH),this.hideButton(MGTLMNButtons.BUTTON_NAME.BO_LUOT)):this.hideAll()},activeTakeTurn:function(a){a.UserID==MGGameInfo.myInfo.UserID&&(1==a.IsActiveButton?(this.getChildByName(MGTLMNButtons.BUTTON_NAME.LAY_LUOT).setVisible(!0),this.showButton(MGTLMNButtons.BUTTON_NAME.LAY_LUOT)):
(this.getChildByName(MGTLMNButtons.BUTTON_NAME.LAY_LUOT).setVisible(!1),this.hideButton(MGTLMNButtons.BUTTON_NAME.LAY_LUOT)))}});MGTLMNButtons.BUTTON_NAME={BO_LUOT:"MGButtonBoLuot",BO_CHON:"MGButtonBoChon",XEP_BAI:"MGButtonXepBai",DANH:"MGButtonDanh",LAY_LUOT:"MGButtonLayLuot"};MGTLMNButtons.ON_CLICK="ON_CLICK_TLMN_BTN";var MGBoxCardContainer=MGBaseNode.extend({containCardDown:null,compoChiaBai:null,boxCardOwner:null,mainGame:null,listCardsRounds:null,listBoxCard:null,listCardUp:null,dealer:null,boBai:null,clearUITimeOut:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initEventBtnFromNode();this._initUI();this.initDealer();this.initCompoChiaBai();this.initEvents();this.initBoxcarOwner();this.initCards()},_initUI:function(){this.listCardsRounds=
[];this.listBoxCard=[];this.listCardUp=[];var a;a=new cc.Sprite;a.setSpriteFrame("card52.png");this.getChildByName("MGBoxCard_2").addChild(a);a.setName("BoxCard2");a.setVisible(!1);this.listBoxCard[2]=a;a=new cc.Sprite;a.setSpriteFrame("card52.png");this.getChildByName("MGBoxCard_3").addChild(a);a.setName("BoxCard3");a.setVisible(!1);this.listBoxCard[3]=a;a=new cc.Sprite;a.setSpriteFrame("card52.png");this.getChildByName("MGBoxCard_4").addChild(a);a.setName("BoxCard4");a.setVisible(!1);this.listBoxCard[4]=
a;this.containCardDown=new cc.Sprite;this.addChild(this.containCardDown);this.boBai=this.mainGame._mainLayer.getChildByName("MGBobai")},initCards:function(){MGGameBoardTienLen.Cards=[];var a;for(a=8;52>a;a++){var b=new MGCardTL;b.initObj(a,MGGameBoardTienLen.Cards.length,MGGameBoardTienLen.listSelectedCards);MGGameBoardTienLen.Cards.push(b);b.retain()}for(a=0;8>a;a++)b=new MGCardTL,b.initObj(a,MGGameBoardTienLen.Cards.length,MGGameBoardTienLen.listSelectedCards),MGGameBoardTienLen.Cards.push(b),b.retain();
b=new MGCardTL;b.retain();b.initObj(a,MGGameBoardTienLen.Cards.length,MGGameBoardTienLen.listSelectedCards);MGGameBoardTienLen.Cards.push(b)},initDealer:function(){this.dealer=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.Dealer_Json,ResourceManager.MGResourcesGameTienLen.Dealer_Atlas);this.dealer.setScale(4);var a=this.getChildByName("MGDealer").getPosition();this.dealer.setPosition(cc.p(a.x,a.y-15));this.addChild(this.dealer);this.dealer.setAnimation(0,"Idle",!0)},initCompoChiaBai:function(){this.compoChiaBai=
new CompoChiaBai;var a=this.getChildByName("MGDealer").getPosition();this.compoChiaBai.initObj(MGGameBoardTienLen.CARD_WIDTH,MGGameBoardTienLen.CARD_HEIGHT,cc.p(a.x,a.y-50),.05);this.addChild(this.compoChiaBai)},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.DownCard.toString(),this.ngDownCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.FINISH,this.ngFinishRand.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.AutoWin.toString(),this.ngAutoWin.bind(this)))},initBoxcarOwner:function(){this.boxCardOwner=new MGBoxcardOwner;this.boxCardOwner.initObj(this.mainGame);this.addChild(this.boxCardOwner);this.boxCardOwner.setPosition(this.getChildByName("MGBoxCard_1").getPosition())},randCard:function(a){null!=this.clearUITimeOut&&clearTimeout(this.clearUITimeOut);MGGameBoardTienLen.listUserBefore={};this.clearUI();var b=[];
b.push(this.boxCardOwner.getPosition());for(var d in MGGameBoardTienLen.listUser)1!=MGGameBoardTienLen.listUser[d].Index&&(b.push(this.getChildByName("MGBoxCard_"+[MGGameBoardTienLen.listUser[d].Index]).getPosition()),MGGameBoardTienLen.listUserBefore[d]=MGGameBoardTienLen.listUser[d]);d=[];for(var e=0;e<b.length;e++)d.push([52,52,52,52,52,52,52,52,52,52,52,52,52]);this.boxCardOwner.addListCard(a.ListCard);this.boxCardOwner.setVisible(!1);this.compoChiaBai.playEffect(b,d,.5);this.dealer.setAnimation(0,
"DealCard",!0);this.boBai.setVisible(!0);mg.audio.playEffect(ResourceManager.MGResourcesGameTienLen.CHIA_BAI,MGGameInfo.gameVolume)},ngDownCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCards:b.Array8,ListCards_Type:b.UInt8,UserID:b.UInt32,Type:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardTienLen.listCardsDown=a.ListCards;Utilities.showLog("ngDownCard"+JSON.stringify(a));for(var d=a.ListCards.length,e,f=[],b=0;b<d;b++)e=MGGameBoardTienLen.getCardByID(a.ListCards[b]),
f.push(e),this.listCardsRounds.push(e);a.UserID==MGGameInfo.myInfo.UserID&&(this.boxCardOwner.removeListCard(f),MGGameBoardTienLen.clearListSelect());mg.audio.playEffect(ResourceManager.MGResourcesGameTienLen.DANH,MGGameInfo.gameVolume);this.addDownCards(f,a.UserID);this.updateNumcardRemain(a.UserID);switch(a.Type){case ConstantsVariable.TypeDownCard.FourOfAKind:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BaseEffectAutoHide,MGCompoTienLenEffect.EFFECT.FX_TU_QUY);break;case ConstantsVariable.TypeDownCard.ThreeStraightPair:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BaseEffectAutoHide,
MGCompoTienLenEffect.EFFECT.FX_3Doi_THONG);break;case ConstantsVariable.TypeDownCard.FourStraightPair:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BaseEffectAutoHide,MGCompoTienLenEffect.EFFECT.FX_4DOI_THONG)}},hideBoxcard:function(a){if(a=MGGameBoardTienLen.listUser[a])this.listBoxCard[a.Index].setVisible(!1),this.getChildByName("MGCardRemain"+a.Index).setVisible(!1)},updateNumcardRemain:function(a){a!=MGGameInfo.myInfo.UserID&&(a=MGGameBoardTienLen.listUser[a])&&(0<a.NumCardsRemain?
(this.getChildByName("MGCardRemain"+a.Index).setString(a.NumCardsRemain),this.getChildByName("MGCardRemain"+a.Index).setVisible(!0),this.listBoxCard[a.Index].setVisible(!0)):(this.getChildByName("MGCardRemain"+a.Index).setVisible(!1),this.listBoxCard[a.Index].setVisible(!1)))},addDownCards:function(a,b){var d=MGGameBoardTienLen.listUser[b];if(d){d.NumCardsRemain-=a.length;for(var d=this.getChildByName("MGBoxCard_"+d.Index).getPosition(),e=this.getEndPos(),f=-45+90*Math.random(),g=0,h=a.length;g<h;g++)a[g].setPosition(d),
a[g].setRotation(f),this.containCardDown.addChild(a[g]),a[g].runAction(cc.spawn(cc.moveTo(.3,cc.p(e.x+30*g,e.y)),cc.scaleTo(.3,.8)))}},getEndPos:function(){return cc.p(500+200*Math.random(),350+100*Math.random())},endRound:function(){for(var a=0,b=this.listCardsRounds.length,d;a<b;a++)d=new cc.Sprite,d.setScale(.8,.8),d.setSpriteFrame("card52.png"),this.containCardDown.addChild(d),d.setPosition(this.listCardsRounds[a].getPosition()),d.setRotation(this.listCardsRounds[a].getRotation()),MGGameBoardTienLen.returnCard(this.listCardsRounds[a]),
this.listCardUp.push(d);this.listCardsRounds.length=0},onGetGameData:function(a){var b=a.ListUserInfo,d=0,e=b.length;for(d;d<e;d++)if(b[d].UserID==MGGameInfo.myInfo.UserID)this.boxCardOwner.addListCard(b[d].ListCards);else{var f=MGGameBoardTienLen.listUser[b[d].UserID];f&&(f.NumCardsRemain=b[d].NumCardRemain,this.updateNumcardRemain(b[d].UserID))}a=a.LastCardDown;for(var f=this.getEndPos(),d=0,e=a.length,g=-45+90*Math.random();d<e;d++)b=MGGameBoardTienLen.getCardByID(a[d]),b.setScale(.8,.8),this.containCardDown.addChild(b),
this.listCardsRounds.push(b),b.setPosition(cc.p(f.x+30*d,f.y)),b.setRotation(g)},clearUI:function(){this.boxCardOwner.resetListCard();for(var a=0,b=this.listCardUp.length;a<b;a++)this.listCardUp[a].removeFromParent();this.listCardUp.length=0;b=this.listCardsRounds.length;for(a=0;a<b;a++)MGGameBoardTienLen.returnCard(this.listCardsRounds[a]);this.listCardsRounds.length=0;this.hideAllBoxCard()},ngFinishRand:function(){this.boBai.setVisible(!1);for(var a in MGGameBoardTienLen.listUserBefore){var b=MGGameBoardTienLen.listUserBefore[a];
b&&b.UserID!=MGGameInfo.myInfo.UserID&&(b.NumCardsRemain=13,this.updateNumcardRemain(b.UserID))}this.boxCardOwner.setVisible(!0);this.dealer.setAnimation(0,"Idle",!0)},showWin12:function(a,b){var d={};b--;d.UserID=a;d.FinishRank=b;cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_RANK,d)},showLost13Card:function(a){var b={};b.UserID=a;cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_CONG,b)},resultMoney:function(a){if(!MGGameBoardTienLen.IsAutoWin){var b=!1,d;for(d in a){var e=
a[d].ListCard,f=e.length,g=MGGameBoardTienLen.listUser[a[d].UserID];switch(a[d].Type){case ConstantsVariable.FINISH_TYPE.FinishLostSpades3:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_THUA3BICH,a[d]);b=!0;break;case ConstantsVariable.FINISH_TYPE.FinishCompensationFull:case ConstantsVariable.FINISH_TYPE.FinishCompensationSpades3:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_DEN,a[d]);b=!0;break;case ConstantsVariable.FINISH_TYPE.FinishWinSpades3:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_THANG3BICH,
a[d]),b=!0}}if(!b)for(d in a){e=a[d].ListCard;f=e.length;g=MGGameBoardTienLen.listUser[a[d].UserID];switch(a[d].Type){case ConstantsVariable.FINISH_TYPE.FinishFinalAndDied2AndStraightPair:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_UNG,a[d]);break;case ConstantsVariable.FINISH_TYPE.FinishDied13Card:cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_CONG,a[d])}cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_RANK,a[d]);0!=a[d].CoinWinLose&&(0<a[d].CoinWinLose?
cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_THANG,a[d]):cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_THUA,a[d]));if(0<f){var b=0,h=this.getChildByName("MGBoxCard_"+g.Index).getPosition(),k;for(b;b<f;b++)a[d].UserID!=MGGameInfo.myInfo.UserID&&(k=MGGameBoardTienLen.getCardByID(e[b]),k.setScale(.8),k.setColor(cc.color(66,66,66,180)),this.listCardsRounds.push(k),this.addChild(k),4==g.Index?k.setPosition(cc.p(h.x+25*b,h.y)):(k.setPosition(cc.p(h.x-25*b,h.y)),
k.setLocalZOrder(f-b)))}}this.hideAllBoxCard()}this.clearUITimeOut=setTimeout(function(){this.clearUI();cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_HideAll,{});cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BaseEffect,{name:MGCompoTienLenEffect.EFFECT.FX_VAN_MOI,isShow:!0})}.bind(this),4E3)},hideAllBoxCard:function(){this.listBoxCard[2].setVisible(!1);this.listBoxCard[3].setVisible(!1);this.listBoxCard[4].setVisible(!1);this.getChildByName("MGCardRemain2").setVisible(!1);
this.getChildByName("MGCardRemain3").setVisible(!1);this.getChildByName("MGCardRemain4").setVisible(!1)},ngAutoWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,AutoWinKind:b.Int8,ListCard:b.Array8,ListCard_Type:b.UInt8}},b=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngAutoWin "+JSON.stringify(b));a=0;var b=b.ListUser,d=b.length;for(a;a<d;a++)b[a].UserID!=MGGameInfo.myInfo.UserID&&(this.hideBoxcard(b[a].UserID),
this.addCardsAutoWin(b[a])),cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_THANG,{UserID:b[a].UserID});cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BaseEffectAutoHide,MGCompoTienLenEffect.EFFECT.FX_TOI_TRANG);MGGameBoardTienLen.IsAutoWin=!0;this.mainGame.compoButtons.updateButton()},addCardsAutoWin:function(a){var b=MGGameBoardTienLen.listUser[a.UserID];if(b){var d=0,e=this.getChildByName("MGBoxCard_"+b.Index).getPosition(),f=a.ListCard,g=f.length;for(d;d<g;d++)a=
MGGameBoardTienLen.getCardByID(f[d]),a.setScale(.8),this.listCardsRounds.push(a),this.addChild(a),4==b.Index?a.setPosition(cc.p(e.x+25*d,e.y)):(a.setPosition(cc.p(e.x-25*d,e.y)),a.setLocalZOrder(g-d))}}});var MGCompoContainUsers=MGBaseNode.extend({listCompoUser:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.initListCompoUser();this._initEventsGame();this.initEvents();this.mainGame=a},initListCompoUser:function(){this.listCompoUser=[];for(var a=1,b;5>a;a++)b=new MGCompUserInfoPlay,b.setPosition(this.getChildByName("MGPosition_"+a).getPosition()),b.setAlignInfo(MGCompUserInfoPlay.BottomAlign),this.listCompoUser.push(b),
this.addChild(b)},initEvents:function(){this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.ListUser.toString(),this.ngListUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.UserLeave.toString(),this.ngUserLeave.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.AddUser.toString(),this.ngAddUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.CutRoundResult.toString(),
this.ngCutRoundResult.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.UpdateCoin.toString(),this.ngUpdateCoinUser.bind(this)))},ngListUsers:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngListUsers "+JSON.stringify(a));
this.updateMyPosition(a.ListUser);this.addListUser(a.ListUser)},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this.userLeave(a.ListUser);Utilities.showLog("ngUserLeave "+JSON.stringify(a))},ngAddUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8};a=(new BinaryParser).initObj(b,
a.content);a.Index=this.getIndexByPosition(a.Position);this.addUser(a);Utilities.showLog("ngAddUser "+JSON.stringify(a))},addUser:function(a){var b=this.getCompoUserByIndex(a.Index);b?(b.setUserInfoData(a.UserID,a.NickName,a.Coin,a.Avatar),b=new MGUserTienLen,b.initObj(a),MGGameBoardTienLen.listUser[a.UserID]=b):Utilities.showLog("addUser "+a.Index)},addListUser:function(a){for(var b in a)a[b].Index=this.getIndexByPosition(a[b].Position),this.addUser(a[b])},userLeave:function(a){var b=0,d=a.length;
for(b;b<d;b++)this.removeUser(a[b])},removeUser:function(a){this.mainGame.effectContainer.hideEffectX(a);var b=this.getCompoUserByUserID(a);b?b.removeUserInfoData():Utilities.showLog("removeUser Error"+a);delete MGGameBoardTienLen.listUser[a];1>=this.listCompoUser.length&&this.mainGame.boxCardContainer.clearUI()},getCompoUserByIndex:function(a){return this.listCompoUser[a-1]},getCompoUserByUserID:function(a){var b=0,d=this.listCompoUser.length;for(b;b<d;b++)if(this.listCompoUser[b].getUserPlayId()==
a)return this.listCompoUser[b];return null},getIndexByPosition:function(a){return(a-MGGameBoardTienLen.my.position+4)%4+1},updateMyPosition:function(a){for(var b in a)a[b].UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardTienLen.my.position=a[b].Position)},nextPlayer:function(a){this.stopAllClock();(a=this.getCompoUserByUserID(a.UserID))&&a.runActionEffect(MGGameBoardTienLen.timeOut)},stopAllClock:function(){var a=0,b=this.listCompoUser.length;for(a;a<b;a++)this.listCompoUser[a].stopActionEffect()},
onGetGameData:function(a){this.stopAllClock();if(0<a.ActiveUser){var b=this.getCompoUserByUserID(a.ActiveUser);b&&b.runActionEffect(a.TimeRemain)}},resultMoney:function(a){for(var b in a){var d=this.getCompoUserByUserID(a[b].UserID);d&&(d.showEffectGoldWinLose(a[b].CoinWinLose),d.setUserGold(a[b].Coin))}},ngCutRoundResult:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CutID:b.UInt32,BeCutID:b.UInt32,CoinLose:b.Int64,CoinWin:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngCutRoundResult "+
JSON.stringify(a));if((b=this.getCompoUserByUserID(a.BeCutID))&&MGGameInfo.myInfo.UserID===a.BeCutID){var d=MGGameInfo.myInfo.Gold;b.setUserGold(d+a.CoinLose);b.showEffectGoldWinLose(a.CoinLose);MGGameInfo.myInfo.Gold=d+a.CoinLose;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{})}(b=this.getCompoUserByUserID(a.CutID))&&MGGameInfo.myInfo.UserID===a.CutID&&(d=MGGameInfo.myInfo.Gold,b.setUserGold(d+a.CoinWin),b.showEffectGoldWinLose(a.CoinWin),MGGameInfo.myInfo.Gold=
d+a.CoinWin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{}))},ngUpdateCoinUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---update Coin: "+JSON.stringify(a));if(b=this.getCompoUserByUserID(a.UserID))b.setUserGold(a.Coin),MGGameInfo.myInfo.UserID===a.UserID&&(MGGameInfo.myInfo.Gold=a.Coin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,
{}))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.listCompoUser.length;a++)this.listCompoUser[a].setDispose()}});var MGBoxcardOwner=MGBaseNode.extend({_listMyCard:[],mainGame:null,_cardFirstPlay:-1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a},setCardFirstPlay:function(a){this._cardFirstPlay=a},addListCard:function(a){MGGameBoardTienLen.clearListSelect();this.removeAllChildren(!0);var b=0,d=a.length,e;for(b;b<d;b++)if(e=MGGameBoardTienLen.getCardByID(a[b]))this.addChild(e),e.setPosition(cc.p(b*MGBoxcardOwner.CARD_SIZE,0)),e.setLocalZOrder(100+
b),e.callBackOnClick||(e.callBackOnClick=this._onCardClick.bind(this),e.addTouchEventListener(e.callBackOnClick),e.setTouchEnabled(!0)),cc.sys.isNative||e.setTouchEnabled(!0),e.setEventEnable(!0),this._listMyCard.push(e),a[b]===this._cardFirstPlay&&e.setLock()},resetListCard:function(){for(var a=this._listMyCard.length,b=0;b<a;b++)MGGameBoardTienLen.returnCard(this._listMyCard[b]);this._listMyCard.length=0},shortListCard:function(){for(var a=0;a<this._listMyCard.length;a++)this._listMyCard[a].runAction(cc.moveTo(.1,
cc.p(a*MGBoxcardOwner.CARD_SIZE,0))),this._listMyCard[a]._isSelected=!1,this._listMyCard[a]._isMove=!1},unselectListCard:function(){for(var a=0;a<MGGameBoardTienLen.listSelectedCards.length;a++){var b=this.getCardByID(MGGameBoardTienLen.listSelectedCards[a]);b&&(b._isSelected=!1,b._isMove=!1,b.setPositionY(0))}MGGameBoardTienLen.clearListSelect()},shortAccending:function(){0<this._listMyCard.length&&this._listMyCard.sort(function(a,d){return a._idCard-d._idCard});for(var a=0;a<this._listMyCard.length;a++)this._listMyCard[a]._isSelected=
!1,this._listMyCard[a]._isMove=!1,this._listMyCard[a].stopAllActions(),this._listMyCard[a].setLocalZOrder(100+a),this._listMyCard[a].runAction(cc.moveTo(.1,cc.p(a*MGBoxcardOwner.CARD_SIZE,0)));MGGameBoardTienLen.clearListSelect()},getCardByID:function(a){for(var b=0;b<this._listMyCard.length;b++)if(this._listMyCard[b]._idCard==a)return this._listMyCard[b];return null},removeListCard:function(a){for(var b=0;b<a.length;b++){var d=this._listMyCard.indexOf(a[b]);0<=d&&(this._listMyCard.splice(d,1),MGGameBoardTienLen.returnCard(a[b]))}this.shortListCard()},
_onCardClick:function(a,b){switch(b){case ccui.Widget.TOUCH_ENDED:a&&a.moveUpDown(),this.mainGame.compoButtons.updateButton()}}});MGBoxcardOwner.CARD_SIZE=50;var MGCardTL=MGBaseCard.extend({ctor:function(){MGBaseCard.prototype.ctor.call(this)}});var MGUserTienLen=cc.Class.extend({NumCardsRemain:0,Index:0,Position:0,UserID:0,ctor:function(){},initObj:function(a){this.Index=a.Index;this.Position=a.Position;this.UserID=a.UserID}});var MGCompoTienLenEffect=MGBaseNode.extend({ListEffect:null,fxToiTrang:null,fxTuQui:null,fxVanMoi:null,fx3DoiThong:null,fx4DoiThong:null,timeOutHideEffect:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.ListEffect=[];this.ListEffect[1]={};this.ListEffect[2]={};this.ListEffect[3]={};this.ListEffect[4]={};this.timeOutHideEffect=[];this.initEffect();var a=1,b,d;for(a;5>a;a++)d=this.getChildByName("EffectPos"+a).getPosition(),b=new cc.Sprite,b.setSpriteFrame("fxBoluot.png"),
this.addChild(b),b.setPosition(cc.p(d.x,d.y-20)),b.setVisible(!1),this.ListEffect[a].fxBoQua=b,b=new cc.Sprite,b.setSpriteFrame("fxCong.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxCong=b,b=new cc.Sprite,b.setSpriteFrame("fxUng.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxUng=b,b=new cc.Sprite,b.setSpriteFrame("fxThua3Bich.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-20)),b.setVisible(!1),this.ListEffect[a].fxThua3Bich=
b,b=new cc.Sprite,b.setSpriteFrame("fxDen.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-20)),b.setVisible(!1),this.ListEffect[a].fxDen=b,b=new cc.Sprite,b.setSpriteFrame("Toi3Bich.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-20)),b.setVisible(!1),this.ListEffect[a].fxThang3Bich=b,b=new cc.Sprite,b.setSpriteFrame("Nhat.png"),this.addChild(b),b.setPosition(d),b.setVisible(!1),b.setScale(.8),this.ListEffect[a].fxNhat=b,b=new cc.Sprite,b.setSpriteFrame("Nhi.png"),this.addChild(b),b.setPosition(d),
b.setVisible(!1),b.setScale(.8),this.ListEffect[a].fxNhi=b,b=new cc.Sprite,b.setSpriteFrame("Ba.png"),this.addChild(b),b.setPosition(d),b.setVisible(!1),b.setScale(.8),this.ListEffect[a].fxBa=b,b=new cc.Sprite,b.setSpriteFrame("Bet.png"),this.addChild(b),b.setPosition(d),b.setVisible(!1),b.setScale(.8),this.ListEffect[a].fxBet=b,b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.Thang_Json,ResourceManager.MGResourcesGameTienLen.Thang_Atlas),this.addChild(b),b.setPosition(d),this.ListEffect[a].fxThang=
b,b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.Thua_Json,ResourceManager.MGResourcesGameTienLen.Thua_Atlas),this.addChild(b),b.setPosition(d),b.setVisible(!1),this.ListEffect[a].fxThua=b;this.hideAllEffect();this._initEventsGame()},initEffect:function(){var a=this.getChildByName("BaseEffectPos").getPosition();this.fx3DoiThong=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.FXBaDoiThong_Json,ResourceManager.MGResourcesGameTienLen.FXBaDoiThong_Atlas);this.fx3DoiThong.setPosition(a);
this.addChild(this.fx3DoiThong);this.fx4DoiThong=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.FXBonDoiThong_Json,ResourceManager.MGResourcesGameTienLen.FXBonDoiThong_Atlas);this.fx4DoiThong.setPosition(a);this.addChild(this.fx4DoiThong);this.fxToiTrang=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.FXToiTrang_Json,ResourceManager.MGResourcesGameTienLen.FXToiTrang_Atlas);this.fxToiTrang.setPosition(a);this.addChild(this.fxToiTrang);this.fxVanMoi=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.FXVanMoi_Json,
ResourceManager.MGResourcesGameTienLen.FXVanMoi_Atlas);this.fxVanMoi.setPosition(a);this.addChild(this.fxVanMoi);this.fxTuQui=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTienLen.FXTuQuy_Json,ResourceManager.MGResourcesGameTienLen.FXTuQuy_Atlas);this.fxTuQui.setPosition(a);this.addChild(this.fxTuQui)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_THANG,this.playEffectThang.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_THUA,this.playEffectThua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_BO_QUA,this.playEffectBoQua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_CONG,this.playEffectCong.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_THUA3BICH,this.playEffectThua3Bich.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_THANG3BICH,this.playEffectThang3Bich.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_DEN,this.playEffectDen.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_UNG,this.playEffectUng.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_BaseEffectAutoHide,this.playEffectAutoHide.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_BaseEffect,this.playEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_HideAll,this.hideAllEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoTienLenEffect.EVENT.FX_RANK,this.playEffectRank.bind(this)))},playEffect:function(a){a=a.getUserData();var b=this[a.name];a.isShow?(b.setVisible(!0),b.setAnimation(0,"animation",!1)):b.setVisible(!1)},
playEffectAutoHide:function(a){a=this[a.getUserData()];a.setVisible(!0);a.setAnimation(0,"animation",!1);this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,a),3E3))},playEffectThang:function(a){a=a.getUserData();if(a=MGGameBoardTienLen.listUser[a.UserID])mg.audio.playEffect(ResourceManager.MGResourcesGameTienLen.THANG,MGGameInfo.gameVolume),this.ListEffect[a.Index].fxThang.setAnimation(0,"thang",!1),this.ListEffect[a.Index].fxThang.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[a.Index].fxThang),3E3))},playEffectThua:function(a){a=a.getUserData();if(a=MGGameBoardTienLen.listUser[a.UserID])this.ListEffect[a.Index].fxThua.setAnimation(0,"thua",!1),this.ListEffect[a.Index].fxThua.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxThua),3E3))},playEffectBoQua:function(a){a=a.getUserData();if(a=MGGameBoardTienLen.listUser[a.UserID])mg.audio.playEffect(ResourceManager.MGResourcesGameTienLen.TOI_LUOT,MGGameInfo.gameVolume),
this.ListEffect[a.Index].fxBoQua.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxBoQua),1E3))},playEffectCong:function(a){a=a.getUserData();(a=MGGameBoardTienLen.listUser[a.UserID])&&this.ListEffect[a.Index].fxCong.setVisible(!0)},playEffectThua3Bich:function(a){a=a.getUserData();(a=MGGameBoardTienLen.listUser[a.UserID])&&this.ListEffect[a.Index].fxThua3Bich.setVisible(!0)},playEffectThang3Bich:function(a){a=a.getUserData();(a=MGGameBoardTienLen.listUser[a.UserID])&&
this.ListEffect[a.Index].fxThang3Bich.setVisible(!0)},playEffectDen:function(a){a=a.getUserData();(a=MGGameBoardTienLen.listUser[a.UserID])&&this.ListEffect[a.Index].fxDen.setVisible(!0)},playEffectUng:function(a){a=a.getUserData();(a=MGGameBoardTienLen.listUser[a.UserID])&&this.ListEffect[a.Index].fxUng.setVisible(!0)},hideEffectX:function(a){if(a=MGGameBoardTienLen.listUser[a])a=a.Index,this.ListEffect[a].fxThang.setVisible(!1),this.ListEffect[a].fxThua.setVisible(!1),this.ListEffect[a].fxBoQua.setVisible(!1),
this.ListEffect[a].fxCong.setVisible(!1),this.ListEffect[a].fxUng.setVisible(!1),this.ListEffect[a].fxThua3Bich.setVisible(!1),this.ListEffect[a].fxDen.setVisible(!1),this.ListEffect[a].fxThang3Bich.setVisible(!1),this.ListEffect[a].fxNhat.setVisible(!1),this.ListEffect[a].fxNhi.setVisible(!1),this.ListEffect[a].fxBa.setVisible(!1),this.ListEffect[a].fxBet.setVisible(!1)},playEffectRank:function(a){a=a.getUserData();var b=MGGameBoardTienLen.listUser[a.UserID];if(b)switch(a.FinishRank){case 0:this.ListEffect[b.Index].fxNhat.setVisible(!0);
break;case 1:this.ListEffect[b.Index].fxNhi.setVisible(!0);break;case 2:this.ListEffect[b.Index].fxBa.setVisible(!0);break;case 3:this.ListEffect[b.Index].fxBet.setVisible(!0)}},hideEffect:function(a){a.setVisible(!1)},hideAllEffect:function(a){this.fx3DoiThong.setVisible(!1);this.fx4DoiThong.setVisible(!1);this.fxToiTrang.setVisible(!1);this.fxVanMoi.setVisible(!1);this.fxTuQui.setVisible(!1);for(a=1;5>a;a++)this.ListEffect[a].fxThang.setVisible(!1),this.ListEffect[a].fxThua.setVisible(!1),this.ListEffect[a].fxBoQua.setVisible(!1),
this.ListEffect[a].fxCong.setVisible(!1),this.ListEffect[a].fxUng.setVisible(!1),this.ListEffect[a].fxThua3Bich.setVisible(!1),this.ListEffect[a].fxDen.setVisible(!1),this.ListEffect[a].fxThang3Bich.setVisible(!1),this.ListEffect[a].fxNhat.setVisible(!1),this.ListEffect[a].fxNhi.setVisible(!1),this.ListEffect[a].fxBa.setVisible(!1),this.ListEffect[a].fxBet.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.timeOutHideEffect.length;a++)this.timeOutHideEffect[a]&&
clearTimeout(this.timeOutHideEffect[a])}});MGCompoTienLenEffect.EFFECT={FX_TOI_TRANG:"fxToiTrang",FX_TU_QUY:"fxTuQui",FX_VAN_MOI:"fxVanMoi",FX_3Doi_THONG:"fx3DoiThong",FX_4DOI_THONG:"fx4DoiThong"};MGCompoTienLenEffect.EVENT={FX_BaseEffect:"fxBaseEffect",FX_BaseEffectAutoHide:"fxBaseEffectAutoHide",FX_THANG:"fxThang",FX_THUA:"fxThua",FX_BO_QUA:"fxBoQua",FX_CONG:"fxCong",FX_UNG:"fxUng",FX_THUA3BICH:"fxThua3Bich",FX_THANG3BICH:"Toi3Bich",FX_DEN:"fxDen",FX_HideAll:"fxHideAll",FX_RANK:"fxRANK"};var MGGameBoardTienLen=cc.Class.extend({_listEvents:null,ctor:function(){}});MGGameBoardTienLen.my={betCoin:0,position:0};MGGameBoardTienLen.listUser={};MGGameBoardTienLen.listUserBefore={};MGGameBoardTienLen.timeOut=0;MGGameBoardTienLen.Cards=null;MGGameBoardTienLen.listSelectedCards=[];MGGameBoardTienLen.clearListSelect=function(){for(;0<MGGameBoardTienLen.listSelectedCards.length;)MGGameBoardTienLen.listSelectedCards.pop();MGGameBoardTienLen.listSelectedCards.length=0};
MGGameBoardTienLen.listCardsDown=[];MGGameBoardTienLen.getCardByID=function(a){return MGGameBoardTienLen.Cards[a]};MGGameBoardTienLen.returnCard=function(a){cc.sys.isNative||a.setTouchEnabled(!1);a.parent&&(a.resetCard(),a.removeFromParent(!0),a.retain())};MGGameBoardTienLen.clearCards=function(){for(;0<MGGameBoardTienLen.Cards.length;){var a=MGGameBoardTienLen.Cards.pop();a&&a.removeFromParent(!0)}MGGameBoardTienLen.Cards=null};MGGameBoardTienLen.UserActive=0;MGGameBoardTienLen.isEndRound=0;
MGGameBoardTienLen.GameStatus=0;MGGameBoardTienLen.CARD_WIDTH=80;MGGameBoardTienLen.CARD_HEIGHT=80;MGGameBoardTienLen.IsAutoWin=!1;var MGTienLen=MGBaseGame.extend({compoUsersContain:null,compoButtons:null,boxCardContainer:null,effectContainer:null,_gameInfoContain:null,_spriteErrorCard:null,_posError:cc.p(0,0),ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameTienLen},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendTienLen;this.initCompoUser();this.initCompoButtons();this.initBoxCardContainer();this.initEffectContainer();this._initGameInfoContain()},
_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameTienLen.UIMGUITienLenLayer,PreLoaderConfig.PathToResourceDefault)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.RandCard.toString(),this.ngRandCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.NextPlayer.toString(),
this.ngNextPlayer.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.PassPlay.toString(),this.ngPassPlay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.UserFinish.toString(),this.ngUserFinish.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.ErrorDownCard.toString(),this.ngErrorDownCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.ResultMoney.toString(),
this.ngResultMoney.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TIEN_LEN.ActiveTakeTurn.toString(),this.ngActiveTakeTurn.bind(this)))},initBoxCardContainer:function(){this.boxCardContainer=new MGBoxCardContainer;this.boxCardContainer.cloneFromNode(this._mainLayer.getChildByName("MGBoxCardNode"));this.boxCardContainer.initObj(this);this.addChild(this.boxCardContainer)},initCompoButtons:function(){this.compoButtons=new MGTLMNButtons;this.compoButtons.initObj(this);
this.compoButtons.setPosition(cc.p(946.78,69));this.addChild(this.compoButtons)},initCompoUser:function(){this.compoUsersContain=new MGCompoContainUsers;this.compoUsersContain.cloneFromNode(this._mainLayer.getChildByName("MGContainUser"));this.compoUsersContain.initObj(this);this.addChild(this.compoUsersContain)},initEffectContainer:function(){this.effectContainer=new MGCompoTienLenEffect;this.effectContainer.cloneFromNode(this._mainLayer.getChildByName("MGEffectTienLen"));this.effectContainer.initObj();
this.addChild(this.effectContainer)},_initGameInfoContain:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(35,670);this._gameInfoContain.setVisible(!1);this.addChild(this._gameInfoContain);this._spriteErrorCard=this.effectContainer.getChildByName("MGMessageCardownErr");this._spriteErrorCard.setLocalZOrder(99999);this._posError=this._spriteErrorCard.getPosition()},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,
TimeRemain:b.UInt16,TimeOut:b.UInt16,MinCoin:b.UInt64,MatchID:b.UInt32,ActiveUser:b.UInt32,ListUserInfo:b.Array8,ListUserInfo_Type:b.Object8,ListUserInfo_Type_Struct:{UserID:b.UInt32,NumCardRemain:b.UInt8,ListCards:b.Array8,ListCards_Type:b.UInt8},LastCardDown:b.Array8,LastCardDown_Type:b.UInt8,IsEndRound:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardTienLen.UserActive=a.ActiveUser;MGGameBoardTienLen.timeOut=a.TimeOut;MGGameBoardTienLen.GameStatus=a.Status;MGGameBoardTienLen.isEndRound=
a.IsEndRound;MGGameBoardTienLen.GameStatus!=ConstantsVariable.STATE_TIEN_LEN.NOT_START&&MGGameBoardTienLen.GameStatus!=ConstantsVariable.STATE_TIEN_LEN.FINISH||cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BaseEffect,{name:MGCompoTienLenEffect.EFFECT.FX_VAN_MOI,isShow:!0});this.boxCardContainer.onGetGameData(a);this.compoUsersContain.onGetGameData(a);this.compoButtons.updateButton();this._gameInfoContain.setInfo("TLMN",a.DeskID,a.MinCoin,a.MatchID)},ngRandCard:function(a){a=a.getUserData();
var b=BinaryConstants.DataTypeID,b={ListCard:b.Array8,ListCard_Type:b.UInt8,PlayerGoFirst:b.UInt32,CardFirstPlay:b.Int8,MatchID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);MGGameBoardTienLen.IsAutoWin=!1;MGGameBoardTienLen.UserActive=a.PlayerGoFirst;MGGameBoardTienLen.GameStatus=ConstantsVariable.STATE_TIEN_LEN.START_GAME;this.effectContainer.hideAllEffect();MGGameInfo.myInfo.UserID===a.PlayerGoFirst?this.boxCardContainer.boxCardOwner.setCardFirstPlay(a.CardFirstPlay):this.boxCardContainer.boxCardOwner.setCardFirstPlay(-1);
this.boxCardContainer.randCard(a);this.compoButtons.updateButton();cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_HideAll,{});this._gameInfoContain.setMatchIdInfo(a.MatchID);this._spriteErrorCard.setVisible(!1);Utilities.showLog("--rand Card: "+JSON.stringify(a))},ngNextPlayer:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,IsEndRound:b.UInt8,InheritanceUserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);MGGameBoardTienLen.isEndRound=a.IsEndRound;
MGGameBoardTienLen.UserActive=a.UserID;this.compoUsersContain.nextPlayer(a);this.compoButtons.updateButton()},ngErrorDownCard:function(a){this._spriteErrorCard.setOpacity(255);this._spriteErrorCard.setVisible(!0);this._spriteErrorCard.setPosition(this._posError);this._spriteErrorCard.stopAllActions();this._spriteErrorCard.runAction(cc.moveBy(.3,cc.p(0,30)));this._spriteErrorCard.runAction(cc.sequence(cc.delayTime(1.2),cc.fadeOut(.5)))},ngPassPlay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={UserID:b.UInt32,IsEndRound:b.UInt8};a=(new BinaryParser).initObj(b,a.content);1==a.IsEndRound&&this.boxCardContainer.endRound();cc.eventManager.dispatchCustomEvent(MGCompoTienLenEffect.EVENT.FX_BO_QUA,a)},ngUserFinish:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserId:b.UInt32,WinRank:b.Int8,TypeFinish:b.Int8,UserIdCompensation:b.Int8,ListUserIdFinishDied13Card:b.Array8,ListUserIdFinishDied13Card_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngUserFinish"+
JSON.stringify(a));this.boxCardContainer.showWin12(a.UserId,a.WinRank);0<a.ListUserIdFinishDied13Card[0]&&this.boxCardContainer.showLost13Card(a.ListUserIdFinishDied13Card[0])},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};(new BinaryParser).initObj(b,a.content)},ngResultMoney:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListResult:b.Array8,ListResult_Type:b.Object8,ListResult_Type_Struct:{UserID:b.UInt32,
CoinWinLose:b.Int64,ListCard:b.Array8,ListCard_Type:b.UInt8,Type:b.Int8,FinishRank:b.Int8,Coin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultMoney "+JSON.stringify(a));this.compoUsersContain.stopAllClock();this.compoUsersContain.resultMoney(a.ListResult);this.boxCardContainer.resultMoney(a.ListResult)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardTienLen.listUser={};MGGameBoardTienLen.clearListSelect();MGGameBoardTienLen.listCardsDown.length=
0;MGGameBoardTienLen.clearCards();this.compoUsersContain&&this.compoUsersContain.setDispose();this.boxCardContainer&&this.boxCardContainer.setDispose();this.effectContainer&&this.effectContainer.setDispose();this.compoButtons&&this.compoButtons.setDispose();Utilities.showLog("OUT GAME : "+this._listEvents.length)},ngActiveTakeTurn:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,IsActiveButton:b.Int8};a=(new BinaryParser).initObj(b,a.content);this.compoButtons.activeTakeTurn(a)}});var MGXocDiaConfig={Message:{SHAKE:"Xóc dĩa",BET:"Đặt cửa",STOP_BET:"Ngừng nhận cược",OPEN_RESULT:"Mở bát",SHOW_RESULT:"Kết quả"}};ConstantsVariable.NETWORK_XOC_DIA={GameData:1301,AddBet:1302,StartGame:1303,Result:1304,ResultMoney:1305,GetUserOnBoard:1306,UserLeftDesk:1307,AddUser:1308,ResultHistory:1309,DoubleBet:1310,ReBet:1311,ListUser:1312,ToolResult:1313};ConstantsVariable.STATE_XOCDIA={WAITING_BET_TIME_OUT:0,CALCULATE_RESULT:1,FINISH_GAME:2,NOT_PLAYING:3,NOT_BET:4};ConstantsVariable.RESULT_XOCDIA={FOUR_WHITE_EVENT:0,ONE_RED_ODD:1,EVENT:2,ONE_WHITE_ODD:3,FOUR_RED_EVENT:4};ConstantsVariable.LIST_RATE_XOCDIA=[1,5,10,50,100];
ConstantsVariable.LIST_IMG_XU_XOCDIA={1:"xu100.png",5:"xu500.png",10:"xu1000.png",50:"xu5000.png",100:"xu10000.png"};ConstantsVariable.UIZONE_XOCDIA={COMPORESULT:1E3,CHIP:10};ResourceManager.MGResourcesGameXocDia={AtlasXocDia:"res/game/xocdia/AtlasXocDia/AtlasXocDia.png",AtlasXocDia_plist:"res/game/xocdia/AtlasXocDia/AtlasXocDia.plist",FXDiskShake_atlas:"res/game/xocdia/FX/Disk_Shaking.atlas",FXDiskShake_json:"res/game/xocdia/FX/Disk_Shaking.json",FXDiskShake_png:"res/game/xocdia/FX/Disk_Shaking.png",FXWin_atlas:"res/game/Components/EffectThangThua/thang.atlas",FXWin_json:"res/game/Components/EffectThangThua/thang.json",FXWin_png:"res/game/Components/EffectThangThua/thang.png",
FXHoa_atlas:"res/game/Components/EffectThangThua/hoa.atlas",FXHoa_json:"res/game/Components/EffectThangThua/hoa.json",FXHoa_png:"res/game/Components/EffectThangThua/hoa.png",FXLose_atlas:"res/game/Components/EffectThangThua/thua.atlas",FXLose_json:"res/game/Components/EffectThangThua/thua.json",FXLose_png:"res/game/Components/EffectThangThua/thua.png",FXDealer_atlas:"res/game/Components/Spines/DealerSpine/dealer_Blue.atlas",FXDealer_json:"res/game/Components/Spines/DealerSpine/dealer_Blue.json",FXDealer_png:"res/game/Components/Spines/DealerSpine/dealer_Blue.png",
FXDisk_Shaking_atlas:"res/game/xocdia/FX/Disk_Shaking.atlas",FXDisk_Shaking_json:"res/game/xocdia/FX/Disk_Shaking.json",FXDisk_Shaking_png:"res/game/xocdia/FX/Disk_Shaking.png",FXTimeLoading_atlas:"res/game/Components/Spines/CircleSpine/loading.atlas",FXTimeLoading_json:"res/game/Components/Spines/CircleSpine/loading.json",FXTimeLoading_png:"res/game/Components/Spines/CircleSpine/loading.png",FontTohomabd:"res/Fonts/tahomabd.ttf",UIMGLayerXocDiaPlayGround:"res/game/xocdia/MGLayerXocDiaPlayGround.json",
UIMGMGNodeDotResult:"res/game/xocdia/MGNodeDotResult.json",CLICK_CUOC:"res/game/xocdia/Sounds/CuocPhinh.mp3",HET_GIO:"res/game/xocdia/Sounds/GanHetGio.mp3",WIN:"res/game/xocdia/Sounds/Thang.mp3",XOC_DIA:"res/game/xocdia/Sounds/XocDia.mp3"};var resourcesGameXocDia=[];for(i in ResourceManager.MGResourcesGameXocDia)ResourceManager.MGResourcesGameXocDia[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXocDia[i],resourcesGameXocDia.push(ResourceManager.MGResourcesGameXocDia[i]);var MGNetSendXocDia=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBetXocDia:function(a,b){var d={};d.BetID=a;d.CoinBet=b;d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XOC_DIA.AddBet,{BetID:BinaryConstants.DataTypeID.UInt8,CoinBet:BinaryConstants.DataTypeID.UInt64},d);MGNetCore.MGSocket.sendMsg(d)},sendDoubleBetXocDia:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XOC_DIA.DoubleBet);MGNetCore.MGSocket.sendMsg(a)},sendReBetXocDia:function(){var a=
Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XOC_DIA.ReBet);MGNetCore.MGSocket.sendMsg(a)},sendToolXocDia:function(a){var b={};b.result=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XOC_DIA.ToolResult,{result:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGNodeContainerResultXocDia=MGBaseNode.extend({_txtTimer:null,_diskHead:null,_diskBody:null,_timeShake:null,_timeBet:null,_timeMoveShake:null,_scheduleTimerTick:null,_mainLayer:null,_fxDiskShake:null,_fxTimeLoading:null,_currentTime:0,_lastTime:0,_deltaTime:0,lastTimeScale:0,timeOutShake:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this._mainLayer=a},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._timeMoveShake=.05;this._txtTimer=this.getChildByName("TxTTimer");
this._txtTimer.ignoreContentAdaptWithSize(!0);this._diskHead=this.getChildByName("DiaHead");this._diskBody=this.getChildByName("DiaBody");this._fxDiskShake=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXocDia.FXDisk_Shaking_json,ResourceManager.MGResourcesGameXocDia.FXDisk_Shaking_atlas);this.addChild(this._fxDiskShake);this._fxTimeLoading=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXocDia.FXTimeLoading_json,ResourceManager.MGResourcesGameXocDia.FXTimeLoading_atlas);this.addChild(this._fxTimeLoading);
this._fxDiskShake.setVisible(!1);this.hideLock();this._scheduleTimerTick=this._timerTick.bind(this)},setDataTime:function(a,b){this._timeShake=a||2;this._timeBet=b;this.setTimerTick(""+b);this.unschedule(this._scheduleTimerTick);this.runAnimationShake()},runAnimationShake:function(){this.hideLock();this._diskBody.setVisible(!1);this._diskHead.setVisible(!1);this._fxDiskShake.setVisible(!0);this._fxDiskShake.setAnimation(0,"animation",!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXocDia.XOC_DIA,
MGGameInfo.gameVolume);this.timeOutShake=setTimeout(this._onCompleteSpineAnimation.bind(this),1300)},_onCompleteSpineAnimation:function(){this._fxDiskShake.setVisible(!1);this._diskBody.setVisible(!0);this._diskHead.setVisible(!0);this.runAnimationTimeTick()},runAnimationTimeTick:function(){this.schedule(this._scheduleTimerTick,1);this.showLock();this.resetDisk();this.lastTimeScale=1.6667/this._timeBet;this._fxTimeLoading.setTimeScale(this.lastTimeScale);this._fxTimeLoading.setAnimation(0,"animation",
!1);this._currentTime=this._lastTime=Date.now()},_timerTick:function(){if(0<=this._timeBet){this._timeBet--;this._currentTime=Date.now();this._deltaTime+=this._currentTime-this._lastTime-1E3;var a=parseInt(this._deltaTime/1E3);this._timeBet-=a;this._deltaTime%=1E3;this._lastTime=this._currentTime}31>=this._timeBet&&16<=this._timeBet?this._txtTimer.setTextColor(cc.color(102,255,0)):15>=this._timeBet&&3<this._timeBet?(6>this._timeBet&&mg.audio.playEffect(ResourceManager.MGResourcesGameXocDia.HET_GIO,
MGGameInfo.gameVolume),this._txtTimer.setTextColor(cc.color(255,246,0))):3>=this._timeBet&&0<=this._timeBet?(this._txtTimer.setTextColor(cc.color.RED),this._mainLayer._gameState=ConstantsVariable.STATE_XOCDIA.CALCULATE_RESULT,mg.audio.playEffect(ResourceManager.MGResourcesGameXocDia.HET_GIO,MGGameInfo.gameVolume),this._mainLayer._gameState=ConstantsVariable.STATE_XOCDIA.NOT_BET,this._mainLayer.updateGameState()):(this.unschedule(this._scheduleTimerTick),this._timeBet=0,this.hideLock(),this._txtTimer.setTextColor(cc.color(102,
255,0)));this.setTimerTick(this._timeBet)},setTimerTick:function(a){this._txtTimer.setString(""+a)},addResult:function(a){var b=[];switch(a){case MGNodeContainerResultXocDia.RESULT.FOUR_WHITE_EVENT:b[0]="WhitePointL.png";b[1]="WhitePointL.png";b[2]="WhitePointL.png";b[3]="WhitePointL.png";break;case MGNodeContainerResultXocDia.RESULT.ONE_RED_ODD:b[0]="RedPointL.png";b[1]="WhitePointL.png";b[2]="WhitePointL.png";b[3]="WhitePointL.png";break;case MGNodeContainerResultXocDia.RESULT.EVENT:b[0]="RedPointL.png";
b[1]="RedPointL.png";b[2]="WhitePointL.png";b[3]="WhitePointL.png";break;case MGNodeContainerResultXocDia.RESULT.ONE_WHITE_ODD:b[0]="WhitePointL.png";b[1]="RedPointL.png";b[2]="RedPointL.png";b[3]="RedPointL.png";break;case MGNodeContainerResultXocDia.RESULT.FOUR_RED_EVENT:b[0]="RedPointL.png",b[1]="RedPointL.png",b[2]="RedPointL.png",b[3]="RedPointL.png"}4<=b.length&&this.setResult(b)},setResult:function(a){for(var b=0;b<a.length;b++)this.getChildByName("Result"+b).setSpriteFrame(a[b])},showResult:function(){this.hideLock();
this._diskBody.setVisible(!0);this._diskHead.setVisible(!0);this._diskHead.stopAllActions();this._diskHead.runAction(cc.moveBy(.5,cc.p(0,100)))},resetStartGame:function(){this.hideLock();this._fxDiskShake.setVisible(!1);this._diskHead.stopAllActions();this._diskHead.runAction(cc.moveTo(.5,cc.p(0,0)))},resetDisk:function(){this._diskHead.stopAllActions();this._diskHead.setPosition(cc.p(0,0));this._fxDiskShake.setVisible(!1);this._fxDiskShake.stopAllActions();this._diskBody.setVisible(!0);this._diskHead.setVisible(!0)},
hideLock:function(){this._txtTimer.setVisible(!1);this.getChildByName("MGBackGroundTime").setVisible(!1);this._fxTimeLoading.setVisible(!1)},showLock:function(){this._txtTimer.setVisible(!0);this.getChildByName("MGBackGroundTime").setVisible(!0);this._fxTimeLoading.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.timeOutShake&&clearTimeout(this.timeOutShake);this.unschedule(this._scheduleTimerTick)}});
MGNodeContainerResultXocDia.RESULT={FOUR_WHITE_EVENT:0,ONE_RED_ODD:1,EVENT:2,ONE_WHITE_ODD:3,FOUR_RED_EVENT:4};var MGBtnBet=MGBaseImageView.extend({_totalGold:null,ctor:function(){MGBaseImageView.prototype.ctor.call(this)},initObj:function(){this.setAnchorPoint(cc.p(.5,.5));this._totalGold=0;this._initEventsGame()},_initEventsGame:function(){MGBaseImageView.prototype._initEventsGame.call(this)}});var MGChipXocDia=cc.Sprite.extend({goldValue:null,userID:null,betID:null,ownerPosition:null,targetPosition:null,hostPosition:null,imgFileName:null,rate:null,ctor:function(a){cc.Sprite.prototype.ctor.call(this);this._imgFileName=a||"xu100.png"},initObj:function(){this.setSpriteFrame(this._imgFileName);this._isRemove=!1},setCallBackFunction:function(a){this._callBackFunc=a},setImage:function(a){this._imgFileName=a||"xu100.png";this.setSpriteFrame(this._imgFileName)}});var MGLayerContainerFX=cc.Class.extend({_layerMain:null,_listChip:null,_listBet:null,_textWinLose:null,_textWin:cc.color(255,210,0,255),_textLose:cc.color(253,67,131,255),_textBegin:cc.p(640,456),timeOutCallback:null,ctor:function(a){this._layerMain=a;this._listChip=[];this.timeOutCallback=[]},animationMoveChipToHost:function(a){for(var b=0;b<this._listChip.length;b++){var d=this._listChip[b];d.betID===parseInt(a)&&(this._listChip.splice(b,1),d.runAction(cc.sequence(cc.moveTo(.3,d.hostPosition).clone().easing(cc.easeOut(2)),
cc.removeSelf())),b--)}},createChipUserToBet:function(a,b,d,e,f){f=d/this._layerMain._minBet;var g=null,g=ConstantsVariable.LIST_IMG_XU_XOCDIA[f];if(!g)for(var h=0;h<ConstantsVariable.LIST_RATE_XOCDIA.length;h++)if(f>=ConstantsVariable.LIST_RATE_XOCDIA[ConstantsVariable.LIST_RATE_XOCDIA.length-1-h]){f=ConstantsVariable.LIST_RATE_XOCDIA[ConstantsVariable.LIST_RATE_XOCDIA.length-1-h];g=ConstantsVariable.LIST_IMG_XU_XOCDIA[f];break}g&&(g=new MGChipXocDia(g),g.initObj(),this._layerMain.addChild(g,ConstantsVariable.UIZONE_XOCDIA.CHIP),
g.setPosition(a),g.goldValue=d,g.rate=f,g.userID=e,g.ownerPosition=a,g.betID=parseInt(b.getName()),g.targetPosition=this.getRandomPointByPoint(b.getPosition()),g.hostPosition=cc.p(640,720),this._listChip.push(g),g.runAction(cc.sequence(cc.moveTo(.3,g.targetPosition).clone().easing(cc.easeOut(2)))),mg.audio.playEffect(ResourceManager.MGResourcesGameXocDia.CLICK_CUOC,MGGameInfo.gameVolume))},animationMoveChipToUser:function(a){for(a=0;a<this._listChip.length;a++){var b=this._listChip[a];this._listChip.splice(a,
1);b.runAction(cc.sequence(cc.moveTo(.3,b.ownerPosition),cc.removeSelf()));a--}},runAnimationEndGame:function(a){this.timeOutCallback.push(setTimeout(this.runFXMoveChipToHost.bind(this,a.ListIDResult),500));this.timeOutCallback.push(setTimeout(this.createChipHostToBet.bind(this,a.ListIDResult),1E3));this.timeOutCallback.push(setTimeout(this.runFXMoveChipToUser.bind(this,a.ListIDResult),1500));this.timeOutCallback.push(setTimeout(this.runFXWinLose.bind(this,a.ListUser),2E3))},runFXWinLose:function(a){a.forEach(function(a,
d){var e=null,f="";Utilities.showLog("userInfo.CoinWinLose :"+a.CoinWinLose);var g=!0,h;0<a.CoinWinLose?(e=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXocDia.FXWin_json,ResourceManager.MGResourcesGameXocDia.FXWin_atlas),f="thang",h=this._textWin,cc.eventManager.dispatchCustomEvent(MGLayerContainerFX.EVENT.SET_SOUNDWIN,{target:a.userID})):0===a.CoinWinLose?(e=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXocDia.FXHoa_json,ResourceManager.MGResourcesGameXocDia.FXHoa_atlas),f="hoa",
g=!1):(e=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXocDia.FXLose_json,ResourceManager.MGResourcesGameXocDia.FXLose_atlas),f="thua",h=this._textLose);a.UserID!=MGGameInfo.myInfo.UserID?(h=this._layerMain._getCompoUserInfoPlayByID(a.UserID),e&&this._initFXSpine(e,f),h?h.addChild(e):e=null):(e?(e.setScale(1.5),this._initFXSpine(e,f),this._layerMain._containerResult.addChild(e)):e=null,g&&(e=0<a.CoinWinLose?"+"+Utilities.Coin(a.CoinWinLose):Utilities.Coin(a.CoinWinLose),this._textWinLose=
new cc.LabelTTF("","Roboto-Bold",20,cc.p(200,30),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER),this._textWinLose.setString(e),this._textWinLose.setPosition(this._textBegin),this._textWinLose.setColor(h),this._textWinLose.setOpacity(255),null==this._textWinLose.getParent()&&this._layerMain.addChild(this._textWinLose,99999),e=cc.p(this._textBegin.x,this._textBegin.y+50),this._textWinLose.runAction(cc.sequence(cc.moveTo(1,e),cc.fadeOut(1),cc.delayTime(1),cc.callFunc(function(){this._textWinLose.removeFromParent(!0);
this._textWinLose=null},this)))))}.bind(this))},_initFXSpine:function(a,b,d){a.setTimeScale(d||1);a.setAnimation(0,b,!1);a.setCompleteListener(this._removeFXSpine.bind(this,a))},_removeFXSpine:function(a){a.scheduleUpdate();a.schedule(function(a){a.unscheduleUpdate();a.removeFromParent()}.bind(this,a),.1)},runFXMoveChipToHost:function(a){a=this._getListBetIDLose(a);for(var b=0;b<a.length;b++)this.animationMoveChipToHost(a[b])},runFXMoveChipToUser:function(a){for(var b=0;b<a.length;b++)this.animationMoveChipToUser(a[b])},
createChipHostToBet:function(a){for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<this._listChip.length;e++)if(this._listChip[e].betID===d){var f=new MGChipXocDia(this._listChip[e].imgFileName);f.initObj();this._layerMain.addChild(f,ConstantsVariable.UIZONE_XOCDIA.CHIP);f.setPosition(cc.p(640,720));f.targetPosition=this._listChip[e].getPosition();f.ownerPosition=this._listChip[e].ownerPosition;f.hostPosition=this._listChip[e].hostPosition;f.userID=this._listChip[e].userID;f.betID=0;f.runAction(cc.sequence(cc.moveTo(.3,
f.targetPosition).clone().easing(cc.easeOut(2))));this._listChip.push(f)}},_getListBetIDLose:function(a){for(var b=[1,2,3,4,5,6],d=0;d<a.length;d++){var e=b.indexOf(a[d]);-1<e&&b.splice(e,1)}return b},getRandomPointByPoint:function(a){var b=cc.p(0,0);b.x=a.x+this.getRandomInt(-40,40);b.y=a.y+this.getRandomInt(-30,30);return b},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.timeOutCallback.length;a++)this.timeOutCallback[a]&&
clearTimeout(this.timeOutCallback[a]);this.timeOutCallback=[]}});MGLayerContainerFX.EVENT={SET_SOUNDWIN:"SOUND_WIN"};var ContainerUser=MGBaseNode.extend({ctor:function(){},star:function(){}});var MGNodeContainerTableResult=MGMoveablePopup.extend({_dotsResult:null,_count:0,_numRow:6,_numCol:12,_size:17,_isEven:null,_latestDot:null,_firstDot:null,_totalNodes:0,_listNodeResult:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.setMoveInfo(this.getChildByName("BGTableResult"));this._totalNodes=this._numRow*this._numCol;this._listNodeResult=[];this._dotsResult=new cc.Node;this._dotsResult.setPosition(-54,52);this.addChild(this._dotsResult)},
update:function(a){try{this.updateSumData(a.ResultHistory[0].StatisticCommon[0]);var b=a.ResultHistory[0].SixMatch,d;for(d in b)if(this._isEven!=(0===b[d].resultFinal%2))this.addDot(b[d].resultFinal);else{var e=this._latestDot.getChildByName("Num");null!==e&&e.setString(parseInt(e.getString())+1)}}catch(f){}},updateSumData:function(a){for(var b in a){var d=this.getChildByName(b);null!==d&&(d.setString(a[b].toString()),d.retain(),d.removeFromParent(),this.addChild(d))}},addDot:function(a){this._isEven=
0===a%2;dot=ccs.load(ResourceManager.MGResourcesGameXocDia.UIMGMGNodeDotResult,PreLoaderConfig.PathToResourceDefault).node;this._latestDot&&this._latestDot.stopAllActions();0==this._count&&(this._firstDot=dot,dot.x=this._count%this._numCol*this._size+this._size/2,dot.y=-this._size/2);this._latestDot=dot;this._isEven||dot.getChildByName("ImgDot").loadTexture("WhitePoint.png",ccui.Widget.PLIST_TEXTURE);this._listNodeResult.unshift(dot);this._dotsResult.addChild(dot);this._count++;this.updateResultIcon()},
alignDot:function(){for(var a=this._dotsResult.getChildren(),b=a.length,d=a[0].getPosition(),e=0;e<b-1;e++){var f=a[e+1].getPosition();a[e+1].setPosition(d);d=f}this._dotsResult.removeChild(a[0])},addResult:function(a){this._isEven!=(0===a%2)?this.addDot(a):(a=this._latestDot.getChildByName("Num"),null!==a&&a.setString(parseInt(a.getString())+1))},addSumChanLe:function(a){0===a%2?(this.getChildByName("NumEven").setString(parseInt(this.getChildByName("NumEven").getString())+1),0===a&&this.getChildByName("NumFourWhite").setString(parseInt(this.getChildByName("NumFourWhite").getString())+
1),4===a&&this.getChildByName("NumFourRed").setString(parseInt(this.getChildByName("NumFourRed").getString())+1)):(this.getChildByName("NumOdd").setString(parseInt(this.getChildByName("NumOdd").getString())+1),1===a&&this.getChildByName("NumOneRedThreeWhite").setString(parseInt(this.getChildByName("NumOneRedThreeWhite").getString())+1),3===a&&this.getChildByName("NumThreeRedOneWhite").setString(parseInt(this.getChildByName("NumThreeRedOneWhite").getString())+1))},updateResultIcon:function(){var a=
this._listNodeResult;a.length>this._totalNodes&&(a[this._totalNodes-1].removeFromParent(!0),a.splice(this._totalNodes,1));for(var b=0;b<a.length;b++){var d=b%this._numCol,e=Math.floor(b/this._numCol);a[b].stopAllActions();a[b].setPosition(new cc.p(this._size/2+d*this._size,-(this._size/2)-e*this._size));0===b&&a[b].runAction(cc.repeatForever(cc.sequence(cc.moveTo(.3,cc.p(a[b].getPosition().x,a[b].getPosition().y+2)),cc.moveTo(.3,cc.p(a[b].getPosition().x,a[b].getPosition().y-2)))))}},setDispose:function(){for(MGMoveablePopup.prototype.setDispose.call(this);0<
this._listNodeResult.length;)this._listNodeResult.pop()}});var MGXocDia=MGBaseGame.extend({_tableResult:null,_containerUser:null,_compoBetKind:null,_compoBtnBetOption:null,_containerResult:null,_betCoin:null,_minBet:null,_maxBet:null,_fxController:null,_tittleGame:null,_gameState:null,_girl:null,_gameInfoContain:null,_totalBet:0,_totalBetCuoc:0,labelGoldUser:null,timeOutCallback:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameXocDia;this._gameState=3;this._totalBet=MGGameInfo.myInfo.Gold},initObj:function(){this._initUI();
this.netSend=new MGNetSendXocDia;this._betCoin=0;MGBaseGame.prototype.initObj.call(this)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXocDia.UIMGLayerXocDiaPlayGround,PreLoaderConfig.PathToResourceDefault);this._containerUser=this._mainLayer.getChildByName("MGNodeUserContainer");this._compoBetKind=this._mainLayer.getChildByName("MGCompoBetKind");this._compoBtnBetOption=this._mainLayer.getChildByName("MGCompoBtnBetOption");this._tittleGame=this._mainLayer.getChildByName("MGTittleXD");
this._tittleGame.ignoreContentAdaptWithSize(!0);this._mainLayer.getChildByName("MGBorderTittleXD").setAnchorPoint(cc.p(.5,.5));this.labelGoldUser=this._mainLayer.getChildByName("Text_MyGold");this._initBtnBet();this._initContainerUser();this._initContainerResult();this._initCompoBetBtn();this._initDealer();this._initLayerFX();this._initGameInfoContain();this._initTableResult();this._resetBet();cc.sys.isNative&&this.setUIMobile()},setUIMobile:function(){this._compoBetKind.setScaleButton(1.4)},_initBtnBet:function(){if(!cc.sys.isNative)for(var a=
1;7>a;a++){var b=new MGBtnBet;b.cloneImageView(this._mainLayer.getChildByName(""+a));b.initObj();this._mainLayer.addChild(b)}},_initLayerFX:function(){this._fxController=new MGLayerContainerFX(this)},_initDealer:function(){cc.director.getWinSize();this._girl=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXocDia.FXDealer_json,ResourceManager.MGResourcesGameXocDia.FXDealer_atlas);this._girl.setPosition(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight-130);this._girl.setAnimation(0,"Idle",
!0);this._girl.setScale(4);this._mainLayer.addChild(this._girl)},_initCompoBetBtn:function(){var a=this._mainLayer.getChildByName("MGCompoBetKind");this._compoBetKind=new MGComboXuBet;this._compoBetKind.setName(a.getName());this._compoBetKind.setPosition(a.getPosition());this._compoBetKind.reset();this._mainLayer.addChild(this._compoBetKind);a.removeFromParent();a=this._mainLayer.getChildByName("MGCompoBtnBetOption");this._compoBtnBetOption=new MGComboDatCuoc;this._compoBtnBetOption.setName(a.getName());
this._compoBtnBetOption.setPosition(a.getPosition());this._mainLayer.addChild(this._compoBtnBetOption);a.removeFromParent()},_initContainerResult:function(){this._containerResult=new MGNodeContainerResultXocDia(this);this._containerResult.cloneFromNode(this._mainLayer.getChildByName("MGNodeContainerResult"));this._containerResult.initObj();this.addChild(this._containerResult,ConstantsVariable.UIZONE_XOCDIA.COMPORESULT)},_resetBet:function(){for(var a=1;6>=a;a++){var b="gold_"+a+"_user";this._mainLayer.getChildByName(b).setString("0");
this._mainLayer.getChildByName(b).setVisible(!1);b="gold_"+a+"_total";this._mainLayer.getChildByName(b).setString("0");this._mainLayer.getChildByName(b).setVisible(!1)}},_initContainerUser:function(){for(var a=this._containerUser.getChildrenCount(),b=0;b<a;b++)if(this._containerUser.getChildren()[0]instanceof cc.Node){var d=this._containerUser.getChildren()[0],e=new MGCompUserInfoPlay;this._containerUser.addChild(e);e.setName(d.getName());e.setPosition(d.getPosition());d.removeFromParent()}},_initGameInfoContain:function(){this._gameInfoContain=
new MGCompoGameInfo;this._gameInfoContain.setPosition(35,630);this._gameInfoContain.setVisible(!1);this.addChild(this._gameInfoContain)},_initTableResult:function(){var a=this._mainLayer.getChildByName("TableResult");a.removeFromParent();this._tableResult=new MGNodeContainerTableResult;this._tableResult.cloneFromNode(a);this._tableResult.initObj();this.addChild(this._tableResult,ConstantsVariable.UIZONE_XOCDIA.COMPORESULT)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);
this._initEventClickImages();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.GameData.toString(),this._onGetGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.StartGame.toString(),this._onGetStartGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.AddUser.toString(),this._onGetAddUserData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.Result.toString(),
this._onGetResultData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.ResultMoney.toString(),this._onGetResultEndGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.UserLeftDesk.toString(),this._onGetUserLeftDeskData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.ListUser.toString(),this._onGetListUserOnDeskData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.AddBet.toString(),
this._onGetUserAddBetData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XOC_DIA.ResultHistory.toString(),this._onGetHistoryResultData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGComboXuBet.ON_CLICK.toString(),this._onClickCompoBetKind.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGComboDatCuoc.ON_CLICK.toString(),this._onClickCompoBetOption.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGLayerContainerFX.EVENT.SET_SOUNDWIN.toString(),
this._showSoundWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUpdateUserCoin.bind(this)))},_initEventClickImages:function(){this._mainLayer.getChildByName("1").setTouchEnabled(!0);this._mainLayer.getChildByName("1").addTouchEventListener(this.onTouchBtnFromCocostudio.bind(this));this._mainLayer.getChildByName("2").addTouchEventListener(this.onTouchBtnFromCocostudio.bind(this));this._mainLayer.getChildByName("3").addTouchEventListener(this.onTouchBtnFromCocostudio.bind(this));
this._mainLayer.getChildByName("4").addTouchEventListener(this.onTouchBtnFromCocostudio.bind(this));this._mainLayer.getChildByName("5").addTouchEventListener(this.onTouchBtnFromCocostudio.bind(this));this._mainLayer.getChildByName("6").addTouchEventListener(this.onTouchBtnFromCocostudio.bind(this))},_onClickCompoBetOption:function(a){switch(a.getUserData().value){case 0:this.netSend.sendReBetXocDia();break;case 1:this.netSend.sendDoubleBetXocDia()}},_onClickCompoBetKind:function(a){a=a.getUserData();
this._betCoin=this._minBet*ConstantsVariable.LIST_RATE_XOCDIA[a.value]},_onGetHistoryResultData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultHistory:b.Array8,ResultHistory_Type:b.Object8,ResultHistory_Type_Struct:{StatisticCommon:b.Array8,StatisticCommon_Type:b.Object8,StatisticCommon_Type_Struct:{NumEven:b.UInt16,NumOdd:b.UInt16,NumFourRed:b.UInt16,NumFourWhite:b.UInt16,NumOneRedThreeWhite:b.UInt16,NumThreeRedOneWhite:b.UInt16},SixMatch:b.Array8,SixMatch_Type:b.Object8,
SixMatch_Type_Struct:{matchID:b.UInt32,resultFinal:b.UInt16}}};a=(new BinaryParser).initObj(b,a.content);this._tableResult.update(a)},_onGetListUserOnDeskData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.ListUser.length;b++)this._addUserIntoUserContainer(a.ListUser[b])},_onGetUserAddBetData:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,ListCuoc:b.Array8,ListCuoc_Type:b.Object8,ListCuoc_Type_Struct:{CuocID:b.UInt8,CoinBet:b.UInt64},Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);var d=this._getCompoUserInfoPlayByID(a.UserID);a.UserID==MGGameInfo.myInfo.UserID?(MGGameInfo.myInfo.Gold=a.Coin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{})):d.setUserGold(a.Coin);b=null;b=d?d.getPosition():a.UserID===MGGameInfo.myInfo.UserID?
this._compoBetKind.getPosition():c.p(0,0);cc.p(0,0);for(d=0;d<a.ListCuoc.length;d++){var e=a.ListCuoc[d],f=this._getBtnBetByID(e.CuocID);f&&f.getPosition();this._updateBet(a.ListCuoc[d].CuocID,a.UserID,a.ListCuoc[d].CoinBet,f);this._fxController.createChipUserToBet(b,f,e.CoinBet,a.UserID,e.CuocID);cc.eventManager.dispatchCustomEvent("SEND_BUTTON_BET",{target:f.getName()})}this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},_updateBet:function(a,b,d,e){var f="gold_"+a+"_user";b==MGGameInfo.myInfo.UserID&&
(b=this._mainLayer.getChildByName(f),this._mainLayer.getChildByName(f).setVisible(!0),f=this._stringChangeValue(b.getString()),f=parseInt(f)+d,b.setString(Utilities.Coin(f)),e.setOpacity(255));e="gold_"+a+"_total";a=this._mainLayer.getChildByName(e);this._mainLayer.getChildByName(e).setVisible(!0);e=this._stringChangeValue(a.getString());d=parseInt(e)+d;a.setString(Utilities.Coin(d))},_stringChangeValue:function(a){for(var b="",d=0;d<a.length;d++)"."!==a[d]&&(b+=a[d]);return parseInt(b)},_getCompoUserInfoPlayByID:function(a){for(var b=
0;b<this._containerUser.getChildrenCount();b++)if(this._containerUser.getChildren()[b]&&this._containerUser.getChildren()[b].getStateUser()&&this._containerUser.getChildren()[b].getUserPlayId()===a)return this._containerUser.getChildren()[b];return null},_getBtnBetByID:function(a){return this._mainLayer.getChildByName(""+a)instanceof ccui.ImageView?this._mainLayer.getChildByName(""+a):null},_onGetUserLeftDeskData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,
ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.ListUser.length;b++)this.removeUserByUserID(a.ListUser[b])},removeUserByUserID:function(a){(a=this._getCompoUserInfoPlayByID(a))&&a.removeUserInfoData()},_onGetAddUserData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic};a=(new BinaryParser).initObj(b,a.content);this._addUserIntoUserContainer(a)},_addUserIntoUserContainer:function(a){if(a.UserID!==
MGGameInfo.myInfo.UserID){var b=this._getCompoUserInfoPlayByID(a.UserID);if(b)b.setUserInfoData(a.UserID,a.NickName,a.Coin,a.Avatar),b.setAlignInfo(MGCompUserInfoPlay.BottomAlign);else for(b=0;b<this._containerUser.getChildrenCount();b++)if(!this._containerUser.getChildren()[b].getStateUser()){this._containerUser.getChildren()[b].setUserInfoData(a.UserID,a.NickName,a.Coin,a.Avatar);this._containerUser.getChildren()[b].setAlignInfo(MGCompUserInfoPlay.BottomAlign);break}}},_onGetStartGameData:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={TimeRemain:b.UInt16,md5:b.StringDynamic,rules:b.StringDynamic,TimeShake:b.UInt16,MinCoin:b.UInt64,MaxCoin:b.UInt64,matchID:b.UInt32,TimeNotBet:b.UInt16,Status:b.UInt8,Config:b.Array8,Config_Type:b.Object8,Config_Type_Struct:{Chan:b.UInt8,Le:b.UInt8,OneRed:b.UInt8,ThreeRed:b.UInt8,FourRed:b.UInt8,FourWhite:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---On Get Start Game: "+JSON.stringify(a));this._gameState=a.Status;this._minBet=
a.MinCoin;this._maxBet=a.MaxCoin;this._compoBetKind.setMinBet(this._minBet);this.showStateGame(a);this._resetBet();this._gameInfoContain.setMinBetInfo(a.MinCoin);this._gameInfoContain.setMatchIdInfo(a.matchID);this.setOffButton()},setOffButton:function(){for(var a=0;a<this._mainLayer.getChildrenCount();a++)this._mainLayer.getChildren()[a]instanceof ccui.ImageView&&(this._mainLayer.getChildren()[a].stopAllActions(),this._mainLayer.getChildren()[a].setOpacity(0));this._mainLayer.getChildByName("MGBorderTittleXD").setOpacity(255)},
_onGetResultData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={result:b.UInt8,md5:b.StringDynamic,key:b.StringDynamic},d=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---On Get Result Data: "+JSON.stringify(d));this._containerResult.addResult(d.result);this.scheduleOnce(function(a){this._tableResult.addResult(a);this._tableResult.addSumChanLe(d.result)}.bind(this,d.result),5)},_onGetResultEndGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b=
{ListIDResult:b.Array8,ListIDResult_Type:b.Int16,MatchID:b.UInt32,ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,CoinWinLose:b.Int64,CoinUser:b.UInt64,ListBetWin:b.Array8,ListBetWin_Type:b.Int8},StatisticResult:b.Array8,StatisticResult_Type:b.Object8,StatisticResult_Type_Struct:{NumEven:b.UInt16,NumOdd:b.UInt16,NumFourRed:b.UInt16,NumFourWhite:b.UInt16,NumOneRedThreeWhite:b.UInt16,NumThreeRedOneWhite:b.UInt16}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---On Get End Game: "+
JSON.stringify(a));this._gameState=ConstantsVariable.STATE_XOCDIA.FINISH_GAME;this.showStateGame(a);this._containerResult.showResult();for(b=0;b<a.ListUser.length;b++)MGGameInfo.myInfo.UserID===a.ListUser[b].UserID&&this.showEffectWinButton(a.ListUser[b].ListBetWin);this.timeOutCallback=setTimeout(this._runFXEndGame.bind(this,a),300);a.StatisticResult&&a.StatisticResult[0]&&this._tableResult.updateSumData(a.StatisticResult[0]);this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},_runFXEndGame:function(a){this._fxController.runAnimationEndGame(a)},
_onGetGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,TimeRemain:b.UInt16,MD5:b.StringDynamic,ListBet:b.Array8,ListBet_Type:b.Object8,ListBet_Type_Struct:{UserID:b.UInt32,UserInfoBet:b.Array8,UserInfoBet_Type:b.Object8,UserInfoBet_Type_Struct:{BetID:b.UInt8,CoinBet:b.UInt64}},MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32,TimeNotBet:b.UInt16,TimeShake:b.UInt16,Result:b.UInt8},d=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---On Get Game Data: "+
JSON.stringify(d));this._minBet=d.MinCoin;this._maxBet=d.MaxCoin;this._betCoin<=this._minBet&&(this._betCoin=this._minBet);this._compoBetKind.setMinBet(this._minBet);this.showStateGame(d);-1!==d.Result&&(this._containerResult.addResult(d.Result),this.scheduleOnce(function(a){this._tableResult.addResult(a);this._tableResult.addSumChanLe(d.Result)}.bind(this,d.Result),5));this._gameInfoContain.setInfo("XỐC DĨA",d.DeskID,d.MinCoin,d.MatchID);for(a=0;a<d.ListBet.length;a++){var e=this._getCompoUserInfoPlayByID(d.ListBet[a].UserID),
b=cc.p(0,0),b=e?e.getPosition():d.ListBet[a].UserID===MGGameInfo.myInfo.UserID?this._compoBetKind.getPosition():cc.p(0,0);cc.p(0,0);for(e=0;e<d.ListBet[a].UserInfoBet.length;e++){var f=null;if(f=this._getBtnBetByID(d.ListBet[a].UserInfoBet[e].BetID))f.getPosition(),this._fxController.createChipUserToBet(b,f,d.ListBet[a].UserInfoBet[e].CoinBet,d.ListBet[a].UserID,d.ListBet[a].UserInfoBet[e].BetID),this._updateBet(d.ListBet[a].UserInfoBet[e].BetID,d.ListBet[a].UserID,d.ListBet[a].UserInfoBet[e].CoinBet,
f)}}this.updateHUDGoldUser(MGGameInfo.myInfo.Gold)},showStateGame:function(a){switch(a.Status){case ConstantsVariable.STATE_XOCDIA.WAITING_BET_TIME_OUT:this._containerResult.resetStartGame();this._containerResult.setDataTime(a.timeShake,a.TimeRemain);break;case ConstantsVariable.STATE_XOCDIA.CALCULATE_RESULT:case ConstantsVariable.STATE_XOCDIA.FINISH_GAME:case ConstantsVariable.STATE_XOCDIA.NOT_PLAYING:this._containerResult.resetStartGame()}this.updateGameState()},updateGameState:function(){switch(this._gameState){case ConstantsVariable.STATE_XOCDIA.WAITING_BET_TIME_OUT:this._mainLayer.getChildByName("MGBorderTittleXD").setScaleX(1);
this._tittleGame.setString(MGXocDiaConfig.Message.BET);break;case ConstantsVariable.STATE_XOCDIA.CALCULATE_RESULT:case ConstantsVariable.STATE_XOCDIA.NOT_PLAYING:case ConstantsVariable.STATE_XOCDIA.NOT_BET:this._tittleGame.setString(MGXocDiaConfig.Message.STOP_BET);this._mainLayer.getChildByName("MGBorderTittleXD").setScaleX(1.5);break;case ConstantsVariable.STATE_XOCDIA.FINISH_GAME:this._mainLayer.getChildByName("MGBorderTittleXD").setScaleX(1),this._tittleGame.setString(MGXocDiaConfig.Message.SHOW_RESULT)}},
onTouchBtnFromCocostudio:function(a,b){Utilities.showLog("onTouchBtnFromCocostudio");switch(b){case ccui.Widget.TOUCH_ENDED:var d=this._betCoin;MGGameInfo.myInfo.Gold<d&&(d=MGGameInfo.myInfo.Gold);this.netSend.sendBetXocDia(parseInt(a.getName()),parseInt(d))}},hideAllBtnBetActive:function(){for(var a=1;7>a;a++)this._mainLayer.getChildByName(""+a).setOpacity(0)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);this._containerResult&&(this._containerResult.setDispose(),this._containerResult=
null);this._fxController&&(this._fxController.setDispose(),this._fxController=null);this.timeOutCallback&&clearTimeout(this.timeOutCallback);this._tableResult&&this._tableResult.setDispose()},_showSoundWin:function(a){a=a.getUserData();MGGameInfo.myInfo.userID===a.target&&mg.audio.playEffect(ResourceManager.MGResourcesGameXocDia.WIN,MGGameInfo.gameVolume)},showEffectWinButton:function(a){for(var b=0;b<a.length;b++){var d=this._mainLayer.getChildByName(a[b].toString());d&&void 0!==d&&d.runAction(cc.sequence(cc.fadeIn(.4),
cc.fadeOut(.3)).repeat(14))}},updateHUDGoldUser:function(a){this.labelGoldUser.setString(Utilities.Coin(a))},ngUpdateUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.updateHUDGoldUser(a.Gold)}});ResourceManager.MGResourcesGameSam={Card52:"res/game/Cards/mat-sau.png",Dealer_Atlas:"res/game/taixiu/Effect/dealer_Blue.atlas",Dealer_PNG:"res/game/taixiu/Effect/dealer_Blue.png",Dealer_Json:"res/game/taixiu/Effect/dealer_Blue.json",UIMGUISamPNG:"res/game/sam/AtlasSam/AtlasSam.png",UIMGUISamPLIST:"res/game/sam/AtlasSam/AtlasSam.plist",UIMGUISamLayerJSON:"res/game/sam/UISamLayer.json",UIMGUISamButtonJSON:"res/game/sam/UISamButton.json",UIMGUISamPopupJSON:"res/game/sam/UIPopUpBaoSam.json",AtlasCards:"res/game/Cards/AtlasCards.png",
AtlasCardsPlist:"res/game/Cards/AtlasCards.plist",FXToiTrang_Atlas:"res/game/sam/Effect/toitrang.atlas",FXToiTrang_Json:"res/game/sam/Effect/toitrang.json",FXToiTrang_png:"res/game/sam/Effect/toitrang.png",FXTuQuy_Atlas:"res/game/sam/Effect/tuquy.atlas",FXTuQuy_Json:"res/game/sam/Effect/tuquy.json",FXTuQuy_png:"res/game/sam/Effect/tuquy.png",FXVanMoi_Atlas:"res/game/sam/Effect/vanmoi.atlas",FXVanMoi_Json:"res/game/sam/Effect/vanmoi.json",FXVanMoi_png:"res/game/sam/Effect/vanmoi.png",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",
Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",CHAT:"res/game/sam/Sounds/Chat.mp3",CHIA_BAI:"res/game/sam/Sounds/ChiaBai.mp3",DANH:"res/game/sam/Sounds/Danh.mp3",THANG:"res/game/sam/Sounds/Thang.mp3",TOI_LUOT:"res/game/sam/Sounds/ToiLuot.mp3",TOI_TRANG:"res/game/sam/Sounds/ToiTrang.mp3"};
var resourcesGameSam=[];for(i in ResourceManager.MGResourcesGameSam)ResourceManager.MGResourcesGameSam[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameSam[i],resourcesGameSam.push(ResourceManager.MGResourcesGameSam[i]);ConstantsVariable.NETWORK_SAM={AutoWin:1501,AutoMove:1502,DownCard:1503,PassPlay:1504,NextPlayer:1505,RandCard:1506,UserLeave:1507,GameData:1508,ListUser:1509,AddUser:1510,CutRoundResult:1511,CongHeo:1512,Sam:1513,ResultMoney:1514,Tool:1517};ConstantsVariable.STATE_SAM_LOC={NOT_START:0,START_GAME:1,DEAL:2,SAM:3,WAIT_SEND_AUTO_WIN:4,WAIT_DOWN_CARD:5,WAIT_DOWN_OR_PASS:6,CALCULATE_FINISH:7,FINISH:8};
ConstantsVariable.TypeDownCard_SAM={INVALID:0,Single:1,SingleOfCardTwo:2,Pair:3,PairOfCardTwo:4,ThreeOfAKind:5,ThreeOfAKindCardTwo:6,FourOfAKind:7,FourOfAKindCardTwo:8,Straight:11,ThreeStraightPair:12,FourStraightPair:13,FiveStraightPair:14,DoubleFourOfAKind:15};ConstantsVariable.FINISH_TYPE_SAM={FinishFull:10,FinishFinal:-1,FinishWin13Card:13,FinishDied13Card:-2,FinishLostSpades3:-3,FinishCompensationFull:-4,FinishWinSpades3:14,FinishCaptureSpades3:15,FinishCompensationSpades3:-5};
ConstantsVariable.FINISH_WIN_TYPE_SAM={FinishNormal:0,FinishDen:1,FinishCong:2,FinishUng:3};var MGGameBoardSamLoc=cc.Class.extend({ctor:function(){}});MGGameBoardSamLoc.my={betCoin:0,position:0};MGGameBoardSamLoc.CARD_WIDTH=80;MGGameBoardSamLoc.CARD_HEIGHT=80;MGGameBoardSamLoc.UserActive=0;MGGameBoardSamLoc.isEndRound=1;MGGameBoardSamLoc.GameStatus=0;MGGameBoardSamLoc.timeOut=0;MGGameBoardSamLoc.listUser={};MGGameBoardSamLoc.Cards=[];MGGameBoardSamLoc.IsAutoWin=!1;MGGameBoardSamLoc.getCardByID=function(a){return MGGameBoardSamLoc.Cards[a]};
MGGameBoardSamLoc.returnCard=function(a){cc.sys.isNative||a.setTouchEnabled(!1);a.parent&&(a.resetCard(),a.removeFromParent(!0),a.retain())};MGGameBoardSamLoc.clearCards=function(){for(var a=MGGameBoardSamLoc.Cards.length,b=0;b<a;b++)MGGameBoardSamLoc.Cards[b].removeFromParent(!0),MGGameBoardSamLoc.Cards[b].release();MGGameBoardSamLoc.Cards=null};MGGameBoardSamLoc.listSelectedCards=[];
MGGameBoardSamLoc.clearListSelect=function(){for(;0<MGGameBoardSamLoc.listSelectedCards.length;)MGGameBoardSamLoc.listSelectedCards.pop();MGGameBoardSamLoc.listSelectedCards.length=0};var MGSamLocEffect=MGBaseNode.extend({ListEffect:null,fxToiTrang:null,fxTuQui:null,fxVanMoi:null,fx4DoiThong:null,timeOutHideEffect:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.ListEffect=[];this.ListEffect[1]={};this.ListEffect[2]={};this.ListEffect[3]={};this.ListEffect[4]={};this.timeOutHideEffect=[];this.initEffect();var a=1,b,d;for(a;5>a;a++)d=this.getChildByName("EffectPos"+a).getPosition(),b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSam.Thang_Json,
ResourceManager.MGResourcesGameSam.Thang_Atlas),this.addChild(b),b.setPosition(d),this.ListEffect[a].fxThang=b,b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSam.Thua_Json,ResourceManager.MGResourcesGameSam.Thua_Atlas),this.addChild(b),b.setPosition(d),b.setVisible(!1),this.ListEffect[a].fxThua=b,b=new cc.Sprite,b.setSpriteFrame("fxBoluot.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-20)),b.setVisible(!1),this.ListEffect[a].fxBoQua=b,b=new cc.Sprite,b.setSpriteFrame("fxCong.png"),this.addChild(b),
b.setPosition(d.x,d.y-40),b.setVisible(!1),this.ListEffect[a].fxCong=b,b=new cc.Sprite,b.setSpriteFrame("fxUng.png"),this.addChild(b),b.setPosition(d.x,d.y-40),b.setVisible(!1),this.ListEffect[a].fxUng=b,b=new cc.Sprite,b.setSpriteFrame("fxDen.png"),this.addChild(b),b.setPosition(d.x,d.y-40),b.setVisible(!1),this.ListEffect[a].fxDen=b,b=new cc.Sprite,b.setSpriteFrame("Bao.png"),this.addChild(b),b.setPosition(d.x,d.y-40),b.setVisible(!1),this.ListEffect[a].fxBao=b,b=new cc.Sprite,b.setSpriteFrame("BaoSam.png"),
this.addChild(b),b.setPosition(d.x,d.y-40),b.setVisible(!1),this.ListEffect[a].fxSam=b;this.hideAllEffect();this._initEventsGame()},initEffect:function(){var a=this.getChildByName("BaseEffectPos").getPosition();this.fxToiTrang=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSam.FXToiTrang_Json,ResourceManager.MGResourcesGameSam.FXToiTrang_Atlas);this.fxToiTrang.setPosition(a);this.addChild(this.fxToiTrang);this.fxVanMoi=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSam.FXVanMoi_Json,
ResourceManager.MGResourcesGameSam.FXVanMoi_Atlas);this.fxVanMoi.setPosition(a);this.addChild(this.fxVanMoi);this.fxTuQui=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSam.FXTuQuy_Json,ResourceManager.MGResourcesGameSam.FXTuQuy_Atlas);this.fxTuQui.setPosition(a);this.addChild(this.fxTuQui)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_THANG,this.playEffectThang.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_THUA,
this.playEffectThua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_BAO,this.playEffectBao.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_SAM,this.playEffectSam.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_BO_QUA,this.playEffectBoQua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_CONG,this.playEffectCong.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_DEN,this.playEffectDen.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_UNG,this.playEffectUng.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_BaseEffectAutoHide,this.playEffectAutoHide.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_BaseEffect,this.playEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGSamLocEffect.EVENT.FX_HideAll,
this.hideAllEffect.bind(this)))},hideEffect:function(a){a.setVisible(!1)},playEffect:function(a){a=a.getUserData();var b=this[a.name];a.isShow?(b.setVisible(!0),b.setAnimation(0,"animation",!1)):b.setVisible(!1)},playEffectAutoHide:function(a){a=this[a.getUserData()];a.setVisible(!0);a.setAnimation(0,"animation",!1);this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,a),3E3))},playEffectThang:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])mg.audio.playEffect(ResourceManager.MGResourcesGameSam.THANG,
MGGameInfo.gameVolume),this.ListEffect[a.Index].fxThang.setAnimation(0,"thang",!1),this.ListEffect[a.Index].fxThang.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxThang),3E3))},playEffectThua:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])this.ListEffect[a.Index].fxThua.setAnimation(0,"thua",!1),this.ListEffect[a.Index].fxThua.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxThua),
3E3))},playEffectBoQua:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])mg.audio.playEffect(ResourceManager.MGResourcesGameSam.TOI_LUOT,MGGameInfo.gameVolume),this.ListEffect[a.Index].fxBoQua.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxBoQua),1E3))},playEffectCong:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])this.ListEffect[a.Index].fxCong.setVisible(!0),this.ListEffect[a.Index].fxBao.setVisible(!1),
this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxCong),3E3))},playEffectBao:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])this.ListEffect[a.Index].fxBao.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxBao),7E3))},playEffectSam:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])this.ListEffect[a.Index].fxSam.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[a.Index].fxSam),3E3))},playEffectDen:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])this.ListEffect[a.Index].fxDen.setVisible(!0),this.ListEffect[a.Index].fxBao.setVisible(!1),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxDen),3E3))},playEffectUng:function(a){a=a.getUserData();if(a=MGGameBoardSamLoc.listUser[a.UserID])this.ListEffect[a.Index].fxUng.setVisible(!0),this.ListEffect[a.Index].fxBao.setVisible(!1),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[a.Index].fxUng),3E3))},hideAllEffect:function(a){this.fxToiTrang.setVisible(!1);this.fxVanMoi.setVisible(!1);this.fxTuQui.setVisible(!1);for(a=1;5>a;a++)this.ListEffect[a].fxThang.setVisible(!1),this.ListEffect[a].fxThua.setVisible(!1),this.ListEffect[a].fxBoQua.setVisible(!1),this.ListEffect[a].fxCong.setVisible(!1),this.ListEffect[a].fxUng.setVisible(!1),this.ListEffect[a].fxDen.setVisible(!1),this.ListEffect[a].fxSam.setVisible(!1),this.ListEffect[a].fxBao.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);
this.fxToiTrang.setVisible(!1);this.fxVanMoi.setVisible(!1);this.fxTuQui.setVisible(!1);for(var a=0;a<this.timeOutHideEffect.length;a++)this.timeOutHideEffect[a]&&clearTimeout(this.timeOutHideEffect[a]);for(a=1;5>a;a++)this.ListEffect[a].fxThang.setVisible(!1),this.ListEffect[a].fxThua.setVisible(!1),this.ListEffect[a].fxBoQua.setVisible(!1),this.ListEffect[a].fxCong.setVisible(!1),this.ListEffect[a].fxUng.setVisible(!1),this.ListEffect[a].fxDen.setVisible(!1),this.ListEffect[a].fxSam.setVisible(!1),
this.ListEffect[a].fxBao.setVisible(!1)}});MGSamLocEffect.EFFECT={FX_TOI_TRANG:"fxToiTrang",FX_TU_QUY:"fxTuQui",FX_VAN_MOI:"fxVanMoi"};MGSamLocEffect.EVENT={FX_BaseEffect:"fxBaseEffect",FX_BaseEffectAutoHide:"fxBaseEffectAutoHide",FX_THANG:"fxThang",FX_THUA:"fxThua",FX_BO_QUA:"fxBoQua",FX_BAO:"fxBao",FX_SAM:"fxSam",FX_CONG:"fxCong",FX_UNG:"fxUng",FX_DEN:"fxDen",FX_HideAll:"fxHideAll"};var MGUserSamLoc=cc.Class.extend({NumCardsRemain:0,Index:0,Position:0,UserID:0,ctor:function(){},initObj:function(a){this.Index=a.Index;this.Position=a.Position;this.UserID=a.UserID}});var MGCardSL=MGBaseCard.extend({_idCard:0,_listener:null,_isSelected:!1,_isMove:!1,_eventEnable:!1,callBackOnClick:null,ctor:function(){MGBaseCard.prototype.ctor.call(this)},moveDown:function(){if(this._eventEnable&&this._isSelected&&!this._isMove){this._isMove=!0;var a=cc.sequence(cc.moveTo(.1,cc.p(this.getPositionX(),0)),cc.callFunc(function(){this._isMove=this._isSelected=!1}.bind(this)));this.runAction(a)}}});var MGSamLocButtons=MGBaseNode.extend({_listButton:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]))},hideAll:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setBright(!1),
this._listButton[a].setEnabled(!1)},hideButton:function(a){this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGSamLocButtons.BUTTON_NAME.BO_LUOT:this.mainGame.netSend.sendPass();break;case MGSamLocButtons.BUTTON_NAME.BO_CHON:this.mainGame.samLocController.myBoxCard.unselectListCard();this.updateButton();break;case MGSamLocButtons.BUTTON_NAME.XEP_BAI:this.mainGame.samLocController.myBoxCard.shortAccending();
break;case MGSamLocButtons.BUTTON_NAME.DANH:0<MGGameBoardSamLoc.listSelectedCards.length&&(this.mainGame.netSend.sendDownCard(MGGameBoardSamLoc.listSelectedCards),this.mainGame.samLocController.myBoxCard.unselectListCard())}},updateButton:function(){switch(MGGameBoardSamLoc.GameStatus){case ConstantsVariable.STATE_SAM_LOC.NOT_START:case ConstantsVariable.STATE_SAM_LOC.START_GAME:case ConstantsVariable.STATE_SAM_LOC.DEAL:case ConstantsVariable.STATE_SAM_LOC.FINISH:this.hideAll();break;default:MGGameBoardSamLoc.UserActive==
MGGameInfo.myInfo.UserID?(MGGameBoardSamLoc.isEndRound?this.hideButton(MGSamLocButtons.BUTTON_NAME.BO_LUOT):this.showButton(MGSamLocButtons.BUTTON_NAME.BO_LUOT),0<MGGameBoardSamLoc.listSelectedCards.length?this.showButton(MGSamLocButtons.BUTTON_NAME.DANH):this.hideButton(MGSamLocButtons.BUTTON_NAME.DANH)):(this.hideButton(MGSamLocButtons.BUTTON_NAME.BO_LUOT),this.hideButton(MGSamLocButtons.BUTTON_NAME.DANH)),0<MGGameBoardSamLoc.listSelectedCards.length?this.showButton(MGSamLocButtons.BUTTON_NAME.BO_CHON):
this.hideButton(MGSamLocButtons.BUTTON_NAME.BO_CHON),0<this.mainGame.samLocController.myBoxCard._listMyCard.length?this.showButton(MGSamLocButtons.BUTTON_NAME.XEP_BAI):this.hideButton(MGSamLocButtons.BUTTON_NAME.XEP_BAI)}},onGameData:function(){}});MGSamLocButtons.BUTTON_NAME={BO_LUOT:"MGButtonBoLuot",BO_CHON:"MGButtonBoChon",XEP_BAI:"MGButtonXepBai",DANH:"MGButtonDanh"};var MGSamLocUsers=MGBaseNode.extend({_listUser:[],ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initListUser();this._initEventsGame();this.initEvents()},_initListUser:function(){this._listUser=[];for(var a=1;5>a;a++){var b=new MGCompUserInfoPlay;b.setPosition(this.getChildByName("MGPosition_"+a).getPosition());b.setAlignInfo(MGCompUserInfoPlay.BottomAlign);this._listUser.push(b);this.addChild(b)}},initEvents:function(){this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.ListUser.toString(),
this.ngListUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.UserLeave.toString(),this.ngUserLeave.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.AddUser.toString(),this.ngAddUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.CutRoundResult.toString(),this.ngCutRoundResult.bind(this)))},ngListUsers:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngListUsers "+JSON.stringify(a));this.updateMyPosition(a.ListUser);this.addListUser(a.ListUser)},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this.userLeave(a.ListUser)},
ngAddUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8};a=(new BinaryParser).initObj(b,a.content);a.Index=this.getIndexByPosition(a.Position);this.addUser(a);Utilities.showLog("ngAddUser "+JSON.stringify(a))},addUser:function(a){var b=this.getCompoUserByIndex(a.Index);b?(b.setUserInfoData(a.UserID,a.NickName,a.Coin,a.Avatar),b=new MGUserSamLoc,b.initObj(a),MGGameBoardSamLoc.listUser[a.UserID]=
b):Utilities.showLog("addUser "+a.Index)},addListUser:function(a){for(var b in a)a[b].Index=this.getIndexByPosition(a[b].Position),this.addUser(a[b])},userLeave:function(a){var b=0,d=a.length;for(b;b<d;b++)this.removeUser(a[b])},removeUser:function(a){var b=this.getCompoUserByUserID(a);b?b.removeUserInfoData():Utilities.showLog("removeUser Error"+a);delete MGGameBoardSamLoc.listUser[a]},getCompoUserByIndex:function(a){return this._listUser[a-1]},getCompoUserByUserID:function(a){var b=0,d=this._listUser.length;
for(b;b<d;b++)if(this._listUser[b].getUserPlayId()==a)return this._listUser[b];return null},getIndexByPosition:function(a){return(a-MGGameBoardSamLoc.my.position+4)%4+1},updateMyPosition:function(a){for(var b in a)a[b].UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardSamLoc.my.position=a[b].Position)},nextPlayer:function(a){this.stopAllClock();(a=this.getCompoUserByUserID(a.UserID))&&a.runActionEffect(MGGameBoardSamLoc.timeOut)},stopAllClock:function(){var a=0,b=this._listUser.length;for(a;a<b;a++)this._listUser[a].stopActionEffect()},
onGetGameData:function(a){this.stopAllClock();if(0<a.ActiveUser){var b=this.getCompoUserByUserID(a.ActiveUser);b&&b.runActionEffect(a.TimeRemain)}},resultMoney:function(a){for(var b in a){var d=this.getCompoUserByUserID(a[b].UserID);d&&(d.showEffectGoldWinLose(a[b].CoinWinLose),d.setUserGold(a[b].Coin),d.stopActionEffect())}},ngCutRoundResult:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CutID:b.UInt32,BeCutID:b.UInt32,CoinLose:b.Int64,CoinWin:b.Int64};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("ngCutRoundResult "+JSON.stringify(a));if((b=this.getCompoUserByUserID(a.BeCutID))&&MGGameInfo.myInfo.UserID===a.BeCutID){var d=MGGameInfo.myInfo.Gold;b.setUserGold(d+a.CoinLose);b.showEffectGoldWinLose(a.CoinLose);MGGameInfo.myInfo.Gold=d+a.CoinLose;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{})}(b=this.getCompoUserByUserID(a.CutID))&&MGGameInfo.myInfo.UserID===a.CutID&&(d=MGGameInfo.myInfo.Gold,b.setUserGold(d+a.CoinWin),b.showEffectGoldWinLose(a.CoinWin),
MGGameInfo.myInfo.Gold=d+a.CoinWin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{}))}});var MGSamLocMyBoxCard=MGBaseNode.extend({_listMyCard:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._listMyCard=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a},addListCard:function(a){MGGameBoardSamLoc.clearListSelect();this.removeAllChildren(!0);var b=0,d=a.length,e;for(b;b<d;b++)if(e=MGGameBoardSamLoc.getCardByID(a[b]))e.resetCard(),this.addChild(e),e.setPosition(cc.p(b*MGSamLocMyBoxCard.CARD_SIZE,0)),e.setLocalZOrder(b),e.callBackOnClick||
(e.callBackOnClick=this._onCardClick.bind(this),e.addTouchEventListener(e.callBackOnClick),e.setTouchEnabled(!0)),cc.sys.isNative||e.setTouchEnabled(!0),e.setEventEnable(!0),this._listMyCard.push(e)},resetListCard:function(){for(var a=this._listMyCard.length,b=0;b<a;b++)MGGameBoardSamLoc.returnCard(this._listMyCard[b]);this._listMyCard.length=0},shortListCard:function(){for(var a=0;a<this._listMyCard.length;a++)this._listMyCard[a].runAction(cc.moveTo(.1,cc.p(a*MGSamLocMyBoxCard.CARD_SIZE,0)))},unselectListCard:function(){for(var a=
0;a<MGGameBoardSamLoc.listSelectedCards.length;a++){var b=this.getCardByID(MGGameBoardSamLoc.listSelectedCards[a]);b&&b.moveDown()}MGGameBoardSamLoc.clearListSelect()},shortAccending:function(){0<this._listMyCard.length&&this._listMyCard.sort(function(a,d){return a._idCard-d._idCard});for(var a=0;a<this._listMyCard.length;a++)this._listMyCard[a]._isSelected=!1,this._listMyCard[a]._isMove=!1,this._listMyCard[a].stopAllActions(),this._listMyCard[a].setLocalZOrder(100+a),this._listMyCard[a].runAction(cc.moveTo(.1,
cc.p(a*MGSamLocMyBoxCard.CARD_SIZE,0)));MGGameBoardSamLoc.clearListSelect()},getCardByID:function(a){for(var b=0;b<this._listMyCard.length;b++)if(this._listMyCard[b]._idCard==a)return this._listMyCard[b];return null},removeListCard:function(a){for(var b=0;b<a.length;b++){var d=this._listMyCard.indexOf(a[b]);0<=d&&(MGGameBoardSamLoc.returnCard(a[b]),this._listMyCard.splice(d,1))}this.shortListCard()},_onCardClick:function(a,b){switch(b){case ccui.Widget.TOUCH_ENDED:a&&(a.moveUpDown(),this.mainGame.compoButtons.updateButton())}}});
MGSamLocMyBoxCard.CARD_SIZE=50;var MGPopupBaoSam=MGBaseNode.extend({_timer:null,_timeValue:0,mainGame:null,isShow:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initUI();this._initEventBtnFromNode()},_initUI:function(){this._timer=this.getChildByName("MGTimer");this._timer.setString("8");this.setVisible(!1);this.setScale(0);this.isShow=!1},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof
ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case "MGButtonOK":this.mainGame.netSend.sendSam(1);this.hide();break;case "MGButtonX":case "MGButtonHuy":this.mainGame.netSend.sendSam(0),this.hide()}},show:function(a){this.setScale(0);this.stopAllActions();this.setVisible(!0);this.runAction(cc.scaleTo(.1,1));this.unschedule(this._countTime);this.schedule(this._countTime,1);this._timeValue=a;this._timer.setString(this._timeValue);
this.isShow=!0},hide:function(){this.unschedule(this._countTime);this.stopAllActions();this.runAction(cc.sequence(cc.scaleTo(.1,0),cc.callFunc(function(){this.setVisible(!1);this.isShow=!1}.bind(this))))},_countTime:function(a){this._timeValue--;this._timer.setString(this._timeValue);0>this._timeValue&&(this._timer.setString(0),this.hide())}});var MGNetSendSam=cc.Class.extend({gameModuleID:null,ctor:function(){},sendDownCard:function(a){Utilities.showLog("sendDownCard "+JSON.stringify(a));var b={};b.ListCards=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SAM.DownCard,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendPass:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SAM.PassPlay,null,null);
MGNetCore.MGSocket.sendMsg(a)},sendSam:function(a){Utilities.showLog("Bao Sam ");var b={};b.IsSam=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SAM.Sam,{IsSam:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},toolSam:function(a){var b={};b.ListCards=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SAM.Tool,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGSamLocController=MGBaseNode.extend({containCardDown:null,mainGame:null,listCardsRounds:null,listBoxCard:null,listCardUp:null,dealer:null,compoChiaBai:null,myBoxCard:null,timeSan:10,popupBaoSam:null,clearUITimeOut:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initUI();this.initCompoChiaBai();this.initMyBoxCard();this.initCards();this.initEvents();this.initDealer()},_initUI:function(){this.listCardsRounds=
[];this.listBoxCard=[];this.listCardUp=[];var a;a=new cc.Sprite;a.setSpriteFrame("card52.png");this.getChildByName("MGBoxCard_2").addChild(a);a.setName("BoxCard2");a.setVisible(!1);this.listBoxCard[2]=a;a=new cc.Sprite;a.setSpriteFrame("card52.png");this.getChildByName("MGBoxCard_3").addChild(a);a.setName("BoxCard3");a.setVisible(!1);this.listBoxCard[3]=a;a=new cc.Sprite;a.setSpriteFrame("card52.png");this.getChildByName("MGBoxCard_4").addChild(a);a.setName("BoxCard4");a.setVisible(!1);this.listBoxCard[4]=
a;this.containCardDown=new cc.Sprite;this.addChild(this.containCardDown)},initCards:function(){MGGameBoardSamLoc.Cards=[];var a;for(a=8;52>a;a++){var b=new MGCardSL;b.initObj(a,MGGameBoardSamLoc.Cards.length,MGGameBoardSamLoc.listSelectedCards);MGGameBoardSamLoc.Cards.push(b);b.retain()}for(a=0;8>a;a++)b=new MGCardSL,b.initObj(a,MGGameBoardSamLoc.Cards.length,MGGameBoardSamLoc.listSelectedCards),MGGameBoardSamLoc.Cards.push(b),b.retain();b=new MGCardSL;b.initObj(a,MGGameBoardSamLoc.Cards.length,MGGameBoardSamLoc.listSelectedCards);
b.retain();MGGameBoardSamLoc.Cards.push(b)},initCompoChiaBai:function(){this.compoChiaBai=new CompoChiaBai;var a=this.getChildByName("MGDealer").getPosition();this.compoChiaBai.initObj(MGGameBoardSamLoc.CARD_WIDTH,MGGameBoardSamLoc.CARD_HEIGHT,cc.p(a.x,a.y-50),.05);this.addChild(this.compoChiaBai)},initMyBoxCard:function(){this.myBoxCard=new MGSamLocMyBoxCard;this.myBoxCard.initObj(this.mainGame);this.addChild(this.myBoxCard);this.myBoxCard.setPosition(this.getChildByName("MGBoxCard_1").getPosition())},
initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.DownCard.toString(),this.ngDownCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.FINISH,this.ngFinishRand.bind(this)))},setPopUp:function(a){this.popupBaoSam=a},initDealer:function(){this.dealer=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSam.Dealer_Json,ResourceManager.MGResourcesGameSam.Dealer_Atlas);this.dealer.setScale(4);
var a=this.getChildByName("MGDealer").getPosition();this.dealer.setPosition(cc.p(a.x,a.y-15));this.addChild(this.dealer);this.dealer.setAnimation(0,"Idle",!0)},randCard:function(a){null!=this.clearUITimeOut&&clearTimeout(this.clearUITimeOut);this.clearUI();var b=[];b.push(this.myBoxCard.getPosition());for(var d in MGGameBoardSamLoc.listUser)1!=MGGameBoardSamLoc.listUser[d].Index&&b.push(this.getChildByName("MGBoxCard_"+[MGGameBoardSamLoc.listUser[d].Index]).getPosition());d=[];for(var e=0;e<b.length;e++)d.push([52,
52,52,52,52,52,52,52,52,52]);this.myBoxCard.addListCard(a.ListCard);this.myBoxCard.setVisible(!1);this.compoChiaBai.playEffect(b,d,.5);this.timeSan=a.TimeSam;this.dealer.setAnimation(0,"DealCard",!0);mg.audio.playEffect(ResourceManager.MGResourcesGameSam.CHIA_BAI,MGGameInfo.gameVolume)},onGetGameData:function(a){var b=a.ListUserInfo,d=0,e=b.length;for(d;d<e;d++)if(b[d].UserID==MGGameInfo.myInfo.UserID)this.myBoxCard.addListCard(b[d].ListCards);else{var f=MGGameBoardSamLoc.listUser[b[d].UserID];f&&
(f.NumCardsRemain=b[d].NumCardRemain,this.updateNumcardRemain(b[d].UserID))}a=a.LastCardDown;for(var f=this.getEndPos(),d=0,e=a.length,g=-45+90*Math.random();d<e;d++)b=MGGameBoardSamLoc.getCardByID(a[d]),b.setScale(.8,.8),this.containCardDown.addChild(b),this.listCardsRounds.push(b),b.setPosition(cc.p(f.x+30*d,f.y)),b.setRotation(g)},clearUI:function(){this.myBoxCard.resetListCard();for(var a=0,b=this.listCardUp.length;a<b;a++)this.listCardUp[a].removeFromParent();this.listCardUp.length=0;b=this.listCardsRounds.length;
for(a=0;a<b;a++)MGGameBoardSamLoc.returnCard(this.listCardsRounds[a]);this.listCardsRounds.length=0;this.hideAllBoxCard()},ngDownCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCards:b.Array8,ListCards_Type:b.UInt8,UserID:b.UInt32,IsBao:b.UInt8,HaveUserFinished:b.UInt8,TypeCard:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardSamLoc.listCardsDown=a.ListCards;for(var d=a.ListCards.length,e,f=[],b=0;b<d;b++)e=MGGameBoardSamLoc.getCardByID(a.ListCards[b]),f.push(e),
this.listCardsRounds.push(e);a.UserID==MGGameInfo.myInfo.UserID&&(this.myBoxCard.removeListCard(f),MGGameBoardSamLoc.clearListSelect(),this.mainGame.compoButtons.updateButton());mg.audio.playEffect(ResourceManager.MGResourcesGameSam.DANH,MGGameInfo.gameVolume);this.addDownCards(f,a.UserID);this.updateNumcardRemain(a.UserID);1==a.IsBao&&cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BAO,a);switch(a.TypeCard){case ConstantsVariable.TypeDownCard_SAM.FourOfAKind:cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BaseEffectAutoHide,
MGSamLocEffect.EFFECT.FX_TU_QUY);break;case ConstantsVariable.TypeDownCard_SAM.DoubleFourOfAKind:cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BaseEffectAutoHide,MGSamLocEffect.EFFECT.FX_TU_QUY)}Utilities.showLog("---typeChat: "+JSON.stringify(a))},addDownCards:function(a,b){var d=MGGameBoardSamLoc.listUser[b];if(d){d.NumCardsRemain-=a.length;for(var d=this.getChildByName("MGBoxCard_"+d.Index).getPosition(),e=this.getEndPos(),f=-45+90*Math.random(),g=0,h=a.length;g<h;g++)a[g].setPosition(d),
a[g].setRotation(f),this.containCardDown.addChild(a[g]),a[g].runAction(cc.spawn(cc.moveTo(.3,cc.p(e.x+30*g,e.y))))}},getEndPos:function(){return cc.p(500+200*Math.random(),350+100*Math.random())},ngFinishRand:function(a){for(var b in MGGameBoardSamLoc.listUser)(a=MGGameBoardSamLoc.listUser[b])&&a.UserID!=MGGameInfo.myInfo.UserID&&(a.NumCardsRemain=10,this.updateNumcardRemain(a.UserID));0<this.myBoxCard._listMyCard.length&&(this.myBoxCard.setVisible(!0),this.popupBaoSam.show(this.timeSan));this.dealer.setAnimation(0,
"Idle",!0)},updateNumcardRemain:function(a){if(a!=MGGameInfo.myInfo.UserID&&(a=MGGameBoardSamLoc.listUser[a]))if(0<a.NumCardsRemain){var b=this.getChildByName("MGCardRemain"+a.Index);b.setString(a.NumCardsRemain);b.setVisible(!0);this.listBoxCard[a.Index].setVisible(!0)}else this.getChildByName("MGCardRemain"+a.Index).setVisible(!1),this.listBoxCard[a.Index].setVisible(!1)},endRound:function(){Utilities.showLog("endRound");for(var a=0,b=this.listCardsRounds.length,d;a<b;a++)d=new cc.Sprite,d.setScale(.8,
.8),d.setSpriteFrame("card52.png"),this.containCardDown.addChild(d),d.setPosition(this.listCardsRounds[a].getPosition()),d.setRotation(this.listCardsRounds[a].getRotation()),MGGameBoardSamLoc.returnCard(this.listCardsRounds[a]),this.listCardUp.push(d);this.listCardsRounds.length=0},resultMoney:function(a){if(!MGGameBoardSamLoc.IsAutoWin){cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_HideAll,{});for(var b in a){var d=a[b].ListCard,e=d.length,f=!1,g=MGGameBoardSamLoc.listUser[a[b].UserID];
switch(a[b].WinType){case ConstantsVariable.FINISH_WIN_TYPE_SAM.FinishNormal:f=!0;break;case ConstantsVariable.FINISH_WIN_TYPE_SAM.FinishCong:cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_CONG,a[b]);f=!0;break;case ConstantsVariable.FINISH_WIN_TYPE_SAM.FinishDen:cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_DEN,a[b]);f=!0;break;case ConstantsVariable.FINISH_WIN_TYPE_SAM.FinishUng:cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_UNG,a[b]),f=!0}if(0<e){var h=0,
k=this.getChildByName("MGBoxCard_"+g.Index).getPosition(),l;for(h;h<e;h++)a[b].UserID!=MGGameInfo.myInfo.UserID&&(l=MGGameBoardSamLoc.getCardByID(d[h]),l.setScale(.8),l.setColor(cc.color(66,66,66,180)),this.listCardsRounds.push(l),this.addChild(l),4==g.Index?l.setPosition(cc.p(k.x+25*h,k.y)):(l.setPosition(cc.p(k.x-25*h,k.y)),l.setLocalZOrder(e-h)))}f&&(0<a[b].CoinWinLose&&cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_THANG,a[b]),0>a[b].CoinWinLose&&cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_THUA,
a[b]))}this.hideAllBoxCard()}this.clearUITimeOut=setTimeout(function(){this.clearUI();cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_HideAll,{});cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BaseEffect,{name:MGSamLocEffect.EFFECT.FX_VAN_MOI,isShow:!0})}.bind(this),5E3)},addCardsAutoWin:function(a){var b=MGGameBoardSamLoc.listUser[a.UserID];if(b){var d=0,e=this.getChildByName("MGBoxCard_"+b.Index).getPosition(),f=a.ListCard,g=f.length;for(d;d<g;d++)a=MGGameBoardSamLoc.getCardByID(f[d]),
a.setScale(.8),this.listCardsRounds.push(a),this.addChild(a),4==b.Index?a.setPosition(cc.p(e.x+25*d,e.y)):(a.setPosition(cc.p(e.x-25*d,e.y)),a.setLocalZOrder(g-d))}},hideAllBoxCard:function(){this.listBoxCard[2].setVisible(!1);this.listBoxCard[3].setVisible(!1);this.listBoxCard[4].setVisible(!1);this.getChildByName("MGCardRemain2").setVisible(!1);this.getChildByName("MGCardRemain3").setVisible(!1);this.getChildByName("MGCardRemain4").setVisible(!1)},hideBoxcard:function(a){if(a=MGGameBoardSamLoc.listUser[a])this.listBoxCard[a.Index].setVisible(!1),
this.getChildByName("MGCardRemain"+a.Index).setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoChiaBai&&(this.compoChiaBai.removeFromParent(!0),this.compoChiaBai=null)}});var MGSamLoc=MGBaseGame.extend({netSend:null,compoButtons:null,samLocUsers:null,samLocController:null,popupBaoSam:null,effectContainer:null,_gameInfoContain:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameSam},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendSam;this._initCompoButtons();this._initListUser();this._initController();this.initEffectContainer();this._initGameInfoContain();this.initPopupSam()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameSam.UIMGUISamLayerJSON,
PreLoaderConfig.PathToResourceDefault)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.RandCard.toString(),this.ngRandCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.NextPlayer.toString(),this.ngNextPlayer.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.PassPlay.toString(),this.ngPassPlay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.AutoWin.toString(),this.ngAutoWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.Sam.toString(),this.ngSam.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SAM.ResultMoney.toString(),
this.ngResultMoney.bind(this)))},_initCompoButtons:function(){this.compoButtons=new MGSamLocButtons;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGButtonCombo"));this.compoButtons.initObj(this);this.addChild(this.compoButtons)},_initListUser:function(){this.samLocUsers=new MGSamLocUsers;this.samLocUsers.cloneFromNode(this._mainLayer.getChildByName("MGContainUser"));this.samLocUsers.initObj();this.addChild(this.samLocUsers)},_initController:function(){this.samLocController=new MGSamLocController;
this.samLocController.cloneFromNode(this._mainLayer.getChildByName("MGBoxCardNode"));this.samLocController.initObj(this);this.addChild(this.samLocController)},initEffectContainer:function(){this.effectContainer=new MGSamLocEffect;this.effectContainer.cloneFromNode(this._mainLayer.getChildByName("MGEffectSam"));this.effectContainer.initObj();this.addChild(this.effectContainer)},_initGameInfoContain:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(80,630);this._gameInfoContain.setVisible(!1);
this.addChild(this._gameInfoContain)},initPopupSam:function(){this.popupBaoSam=new MGPopupBaoSam;this.popupBaoSam.cloneFromNode(this._mainLayer.getChildByName("MGPopupSam"));this.popupBaoSam.initObj(this);this.addChild(this.popupBaoSam);this.samLocController.setPopUp(this.popupBaoSam)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,TimeRemain:b.UInt16,TimeOut:b.UInt16,MinCoin:b.UInt64,MatchID:b.UInt32,ActiveUser:b.UInt32,ListUserInfo:b.Array8,
ListUserInfo_Type:b.Object8,ListUserInfo_Type_Struct:{UserID:b.UInt32,NumCardRemain:b.UInt8,ListCards:b.Array8,ListCards_Type:b.UInt8},LastCardDown:b.Array8,LastCardDown_Type:b.UInt8,IsEndRound:b.UInt8,UserIDSam:b.UInt32};a=(new BinaryParser).initObj(b,a.content);MGGameBoardSamLoc.UserActive=a.ActiveUser;MGGameBoardSamLoc.timeOut=a.TimeOut;MGGameBoardSamLoc.GameStatus=a.Status;MGGameBoardSamLoc.isEndRound=a.IsEndRound;if(MGGameBoardSamLoc.GameStatus==ConstantsVariable.STATE_SAM_LOC.NOT_START||MGGameBoardSamLoc.GameStatus==
ConstantsVariable.STATE_SAM_LOC.FINISH)cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BaseEffect,{name:MGSamLocEffect.EFFECT.FX_VAN_MOI,isShow:!0});else if(MGGameBoardSamLoc.GameStatus==ConstantsVariable.STATE_SAM_LOC.SAM)for(var b=a.ListUserInfo,d=b.length,e=0;e<d;e++)b[e].UserID==MGGameInfo.myInfo.UserID&&0<b[e].ListCards.length&&this.popupBaoSam.show(a.TimeRemain);this.samLocController.onGetGameData(a);this.samLocUsers.onGetGameData(a);this.compoButtons.updateButton();this._gameInfoContain.setInfo("SẨM LỐC",
a.DeskID,a.MinCoin,a.MatchID)},ngSam:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngSam "+JSON.stringify(a));1==this.popupBaoSam.isShow&&this.popupBaoSam.hide();cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_SAM,a)},ngRandCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCard:b.Array8,ListCard_Type:b.UInt8,PlayerGoFirst:b.UInt32,CardFirstPlay:b.Int8,MatchID:b.UInt32,
TimeSam:b.Int8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngRandCard "+JSON.stringify(a));MGGameBoardSamLoc.UserActive=a.PlayerGoFirst;MGGameBoardSamLoc.GameStatus=ConstantsVariable.STATE_SAM_LOC.START_GAME;MGGameBoardSamLoc.IsAutoWin=!1;this.effectContainer.hideAllEffect();this.samLocController.randCard(a);this.compoButtons.updateButton();this.samLocUsers.stopAllClock();cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_HideAll,{});this._gameInfoContain.setMatchIdInfo(a.MatchID)},
ngResultMoney:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListResult:b.Array8,ListResult_Type:b.Object8,ListResult_Type_Struct:{UserID:b.UInt32,CoinWinLose:b.Int64,ListCard:b.Array8,ListCard_Type:b.UInt8,FinishRank:b.Int8,Coin:b.UInt64,WinType:b.Int8}};a=(new BinaryParser).initObj(b,a.content);this.samLocUsers.resultMoney(a.ListResult);this.samLocController.resultMoney(a.ListResult);ConstantsVariable.GameStatus=ConstantsVariable.STATE_SAM_LOC.FINISH;Utilities.showLog("--Result Money: "+
JSON.stringify(a))},ngNextPlayer:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,IsEndRound:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardSamLoc.isEndRound=a.IsEndRound;MGGameBoardSamLoc.UserActive=a.UserID;MGGameBoardSamLoc.GameStatus=a.UserID!=MGGameInfo.myInfo.UserID?ConstantsVariable.STATE_SAM_LOC.WAIT_DOWN_OR_PASS:ConstantsVariable.STATE_SAM_LOC.WAIT_DOWN_CARD;this.samLocUsers.nextPlayer(a);this.compoButtons.updateButton()},ngAutoWin:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,AutoWinKind:b.Int8,ListCard:b.Array8,ListCard_Type:b.UInt8}},b=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngAutoWin"+JSON.stringify(b));a=0;var b=b.ListUser,d=b.length;for(a;a<d;a++)b[a].UserID!=MGGameInfo.myInfo.UserID&&(this.samLocController.hideBoxcard(b[a].UserID),this.samLocController.addCardsAutoWin(b[a])),cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_THANG,
{UserID:b[a].UserID});cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BaseEffectAutoHide,MGSamLocEffect.EFFECT.FX_TOI_TRANG);MGGameBoardSamLoc.IsAutoWin=!0;1==this.popupBaoSam.isShow&&this.popupBaoSam.hide();this.compoButtons.updateButton()},ngPassPlay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt8,IsEndRound:b.UInt8};a=(new BinaryParser).initObj(b,a.content);1==a.IsEndRound&&this.samLocController.endRound();cc.eventManager.dispatchCustomEvent(MGSamLocEffect.EVENT.FX_BO_QUA,
a);Utilities.showLog("ngPassPlay"+JSON.stringify(a))},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardSamLoc.listUser={};MGGameBoardSamLoc.clearCards();this.samLocUsers&&(this.samLocUsers.setDispose(),this.samLocUsers.removeFromParent(!0),this.samLocUsers=null);this.samLocController&&(this.samLocController.setDispose(),this.samLocController.removeFromParent(!0),this.samLocController=null);this.effectContainer&&(this.effectContainer.setDispose(),this.effectContainer.removeFromParent(!0),
this.effectContainer=null)}});ResourceManager.MGResourcesGameBinh={Card52:"res/game/Cards/mat-sau.png",AtlasCards:"res/game/Cards/AtlasCards.png",AtlasCardsPlist:"res/game/Cards/AtlasCards.plist",AtlasBinh:"res/game/maubinh/AtlasBinh/atlasBinh.png",AtlasBinhPlist:"res/game/maubinh/AtlasBinh/atlasBinh.plist",Dealer_Atlas:"res/game/taixiu/Effect/dealer_Blue.atlas",Dealer_PNG:"res/game/taixiu/Effect/dealer_Blue.png",Dealer_Json:"res/game/taixiu/Effect/dealer_Blue.json",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",
Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",UILayerBinh:"res/game/maubinh/UILayerBinh.json",UIMGButtonBinh:"res/game/maubinh/UIButtonBinh.json",MGBinhBoxCardOwner:"res/game/maubinh/MGBinhBoxCard.json",MGStateInfo:"res/game/maubinh/MGStateInfo.json",CHANGE_CARD:"res/game/maubinh/Sounds/Swap.mp3",
CHIA_BAI:"res/game/maubinh/Sounds/ChiaBai.wav",WIN:"res/game/maubinh/Sounds/Thang.mp3"};var resourcesGameBinh=[];for(i in ResourceManager.MGResourcesGameBinh)ResourceManager.MGResourcesGameBinh[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameBinh[i],resourcesGameBinh.push(ResourceManager.MGResourcesGameBinh[i]);ConstantsVariable.NETWORK_BINH={ListUser:1600,GameData:1601,AddUser:1602,UserLeave:1603,CompareChi:1604,RandCard:1605,BinhXong:1606,MauBinh:1607,ResetBinh:1608,ChangeCard:1609,EndMatch:1610,SetTool:1611};ConstantsVariable.CARD_DOWN_IMG="card52.png";ConstantsVariable.BINH_CARD_SIZE=cc.size(100,132);ConstantsVariable.STATE_BINH={NOT_START:0,START_GAME:1,DEAL:2,WAIT_BINH:3,CALCULATE_FINISH:4,FINISH:5};ConstantsVariable.USER_STATE_BINH={CHUA_BINH:0,BINH_XONG:1,THOAT:2};
ConstantsVariable.IS_BINH_LUNG={FALSE:0,TRUE:1};ConstantsVariable.TYPECARD={BICH:1,CHUON:2,RO:3,CO:4};ConstantsVariable.TYPE_BINH={0:{Name:"Chưa Binh"},1:{Name:"Mậu Thầu"},2:{Name:"Dách"},3:{Name:"Thú"},4:{Name:"Xám"},5:{Name:"Sảnh"},6:{Name:"Thùng"},7:{Name:"Cù Lũ"},8:{Name:"Tứ Quý"},9:{Name:"Thùng Phá Sảnh"},10:{Name:"Ba Chi Sảnh"},11:{Name:"Mười Hai Đen"},12:{Name:"Mười Hai Đỏ"},13:{Name:"Ba Chi Thùng"},14:{Name:"Mười Ba Đen"},15:{Name:"Mười Ba Đỏ"},16:{Name:"Sáu Đôi"},17:{Name:"Sảnh 13 Lá"},18:{Name:"Sảnh Rồng"}};
ConstantsVariable.UI_ZONE_BINH={DEALER:0,STATE_INFO:1,MY_BOX_CARD:2,COMPO_CHIA_BAI:3};var MGNetSendBinh=cc.Class.extend({gameModuleID:null,ctor:function(){},sendChangeCard:function(a){var b={};b.ListCard=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BINH.ChangeCard,{ListCard:BinaryConstants.DataTypeID.Array8,ListCard_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendResetBinh:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BINH.ResetBinh,null,null);MGNetCore.MGSocket.sendMsg(a)},sendBinhXong:function(a){var b=
{};b.ListCard=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BINH.BinhXong,{ListCard:BinaryConstants.DataTypeID.Array8,ListCard_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendMauBinh:function(a){var b={};b.ListCard=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BINH.MauBinh,{ListCard:BinaryConstants.DataTypeID.Array8,ListCard_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendToolChiaBai:function(a){var b=
{};b.ListCard=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BINH.SetTool,{ListCard:BinaryConstants.DataTypeID.Array8,ListCard_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGUserBinh=cc.Class.extend({Index:0,Position:0,UserID:0,ctor:function(){},initObj:function(a){this.Index=a.Index;this.Position=a.Position;this.UserID=a.UserID}});var MGBinhContainUsers=MGBaseNode.extend({listCompoUser:null,timeOut:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);MGGameBoardBinh.listUser={};this.timeOut=0},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initListCompoUser();this._initEventsGame()},initListCompoUser:function(){this.listCompoUser=[];for(var a=1,b;5>a;a++)b=new MGCompUserInfoPlay,b.setPosition(this.getChildByName("MGPosition_"+a).getPosition()),b.setAlignInfo(MGCompUserInfoPlay.BottomAlign),this.listCompoUser.push(b),
this.addChild(b)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.ListUser.toString(),this.ngListUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.UserLeave.toString(),this.ngUserLeave.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.AddUser.toString(),this.ngAddUser.bind(this)))},
ngListUsers:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,Nickname:b.StringDynamic,avatar:b.StringDynamic,Position:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);this.updateMyPosition(a.ListUser);this.addListUser(a.ListUser)},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);
this.userLeave(a.ListUser)},ngAddUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,Nickname:b.StringDynamic,avatar:b.StringDynamic,Position:b.UInt8};a=(new BinaryParser).initObj(b,a.content);a.Index=this.getIndexByPosition(a.Position);this.addUser(a)},addUser:function(a){var b=this.getCompoUserByIndex(a.Index);b&&(b.setUserInfoData(a.UserID,a.Nickname,a.Coin,a.avatar),b=new MGUserBinh,b.initObj(a),MGGameBoardBinh.listUser[a.UserID]=b)},addListUser:function(a){for(var b in a)a[b].Index=
this.getIndexByPosition(a[b].Position),this.addUser(a[b])},userLeave:function(a){var b=0,d=a.length;for(b;b<d;b++)this.removeUser(a[b])},removeUser:function(a){var b=this.getCompoUserByUserID(a);b&&b.removeUserInfoData();delete MGGameBoardBinh.listUser[a]},getCompoUserByIndex:function(a){return this.listCompoUser[a-1]},getCompoUserByUserID:function(a){var b=0,d=this.listCompoUser.length;for(b;b<d;b++)if(this.listCompoUser[b].getUserPlayId()===a)return this.listCompoUser[b];return null},getIndexByPosition:function(a){return(a-
MGGameBoardBinh.my.position+4)%4+1},updateMyPosition:function(a){for(var b in a)a[b].UserID===MGGameInfo.myInfo.UserID&&(MGGameBoardBinh.my.position=a[b].Position)},onGetGameData:function(a){this.stopAllClock();this.timeOut=a.TimeOut;if(MGGameBoardBinh.isXepBaiTime())for(var b=0;b<a.ListUserInfo.length;b++){var d=this.getCompoUserByUserID(a.ListUserInfo[b].UserID);d&&d.runActionEffect(a.TimeRemain)}},onRandCard:function(){this.stopAllClock();for(var a=0;a<this.listCompoUser.length;a++)0<this.listCompoUser[a].getUserPlayId()&&
this.listCompoUser[a].runActionEffect(this.timeOut)},stopAllClock:function(){var a=0,b=this.listCompoUser.length;for(a;a<b;a++)this.listCompoUser[a].stopActionEffect()},updateCoinUser:function(a){var b=this.getCompoUserByUserID(a.userId);b&&b.setUserGold(a.coin)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGBinhCompoEffect=MGBaseNode.extend({ListEffect:null,timeOutHideEffect:null,fxChoVanMoi:null,fxXepBai:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.timeOutHideEffect=[];this.initEffect();this._initEventsGame()},initEffect:function(){this.ListEffect=[];for(var a,b,d=1;5>d;d++)this.ListEffect[d]={},b=this.getChildByName("MGEffectPos_"+d).getPosition(),a=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameBinh.Thang_Json,
ResourceManager.MGResourcesGameBinh.Thang_Atlas),this.addChild(a),a.setPosition(b),this.ListEffect[d].fxThang=a,a=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameBinh.Thua_Json,ResourceManager.MGResourcesGameBinh.Thua_Atlas),this.addChild(a),a.setPosition(b),this.ListEffect[d].fxThua=a,a=new cc.Sprite,a.setSpriteFrame("binhXongEffect.png"),this.addChild(a),a.setPosition(b.x,b.y-15),a.setVisible(!1),this.ListEffect[d].binhXongTxt=a;b=this.getChildByName("MGBaseEffect").getPosition();this.fxChoVanMoi=
new cc.Sprite;this.fxChoVanMoi.setSpriteFrame("BinhChoVanMoi.png");this.fxChoVanMoi.setPosition(b);this.fxChoVanMoi.setVisible(!1);this.addChild(this.fxChoVanMoi);this.fxXepBai=new cc.Sprite;this.fxXepBai.setSpriteFrame("XepChi.png");this.fxXepBai.setPosition(b);this.fxXepBai.setVisible(!1);this.addChild(this.fxXepBai);this.hideAllBinhEffect()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_FX_THANG,
this._playEffectThang.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_FX_THUA,this._playEffectThua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_FX_HideAll,this.hideAllBinhEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_XONG_SHOW,this._showEffectBinhXong.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_XONG_HIDE,
this._hideEffectBinhXong.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_BASE_EFFECT,this._playBinhBaseEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGBinhCompoEffect.EVENT.BINH_BASE_XEPCHI,this._playBinhXepChi.bind(this)))},_playEffectThang:function(a){a=a.getUserData();var b=MGGameBoardBinh.listUser[a.userId];b&&(MGGameBoardBinh.isMine(a.userId)&&mg.audio.playEffect(ResourceManager.MGResourcesGameBinh.WIN,MGGameInfo.gameVolume),
this.ListEffect[b.Index].fxThang.setAnimation(0,"thang",!1),this.ListEffect[b.Index].fxThang.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this._hideEffect.bind(this,this.ListEffect[b.Index].fxThang),3E3)))},_playEffectThua:function(a){a=a.getUserData();if(a=MGGameBoardBinh.listUser[a.userId])this.ListEffect[a.Index].fxThua.setAnimation(0,"thua",!1),this.ListEffect[a.Index].fxThua.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this._hideEffect.bind(this,this.ListEffect[a.Index].fxThua),
3E3))},_showEffectBinhXong:function(a){a=a.getUserData();(a=MGGameBoardBinh.listUser[a.UserID])&&this.ListEffect[a.Index].binhXongTxt.setVisible(!0)},_hideEffectBinhXong:function(a){a=a.getUserData();(a=MGGameBoardBinh.listUser[a.UserID])&&this._hideEffect(this.ListEffect[a.Index].binhXongTxt)},_playBinhBaseEffect:function(a){a=a.getUserData();var b=this[a.name];a.isShow?b.setVisible(!0):b.setVisible(!1)},_playBinhXepChi:function(a){a=a.getUserData();var b=this[a.name];a.isShow?b.setVisible(!0):b.setVisible(!1)},
_hideEffect:function(a){a.setVisible(!1)},hideAllBinhEffect:function(){for(var a=1;5>a;a++)this.ListEffect[a].fxThang.setVisible(!1),this.ListEffect[a].fxThua.setVisible(!1),this.ListEffect[a].binhXongTxt.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.timeOutHideEffect.length;a++)this.timeOutHideEffect[a]&&clearTimeout(this.timeOutHideEffect[a])}});var MGCardBinh=MGBaseImageView.extend({_idCard:0,_listener:null,_chiCard:null,blackCard:null,cardUpImg:null,indexCard:0,currentPos:null,callBackOnClick:null,eventEnable:!1,ctor:function(){MGBaseImageView.prototype.ctor.call(this);this._initEventsGame()},initObj:function(a,b){this.loadTexture("card"+a+".png",ccui.Widget.PLIST_TEXTURE);this.setName("MGCard"+a+".png");this._idCard=b;this.setContentSize(ConstantsVariable.BINH_CARD_SIZE)},resetCard:function(){this._chiCard=0;this.cardUpImg=null;this.indexCard=
0;this.currentPos=null;this.eventEnable=!1},setAndSavePos:function(a){this.currentPos=a;this.setPosition(a)},getSavePos:function(){return this.currentPos},setChiCard:function(a){this._chiCard=a},getChiCard:function(){return this._chiCard},getIndexCard:function(){return this.indexCard},setIndexCard:function(a){this.indexCard=a},showBlackCard:function(a){this.blackCard&&void 0!==this.blackCard?this.blackCard.setVisible(a):a&&(this.blackCard=new MGBaseImageView,this.blackCard.setContentSize(ConstantsVariable.BINH_CARD_SIZE),
this.blackCard.setPosition(ConstantsVariable.BINH_CARD_SIZE.width/2,ConstantsVariable.BINH_CARD_SIZE.height/2),this.blackCard.setOpacity(70),this.blackCard.initObj(),this.blackCard._initEventsGame(),this.blackCard.loadTexture("CardInvisible.png",ccui.Widget.PLIST_TEXTURE),this.blackCard.setScale(1.25),this.addChild(this.blackCard))},setEventEnable:function(a){this.eventEnable=a}});var MGBinhBoxCardOwner=MGBaseNode.extend({_scaleControl:null,_listCard:null,_txtChi_1:null,_txtChi_2:null,_txtChi_3:null,_txtBinhType:null,_txtSoChi_1:null,_txtSoChi_2:null,_txtSoChi_3:null,_txtSoTongChi:null,_tongChiTitle:null,_achTitle:null,_txtAch:null,mauBinhType:null,mainGame:null,timeOutChi:null,timeOutFinishChi:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameBinh.MGBinhBoxCardOwner,
PreLoaderConfig.PathToResourceDefault).node);this.mainGame=a;this._listCard=[];this.mauBinhType=0;this.timeOutChi=[];this._initUI();this._initEventsGame()},_initUI:function(){this._scaleControl=this.getChildByName("MGMainPanel");this._txtChi_1=this._scaleControl.getChildByName("MGTxtChi1");this._txtChi_1.ignoreContentAdaptWithSize(!0);this._txtChi_2=this._scaleControl.getChildByName("MGTxtChi2");this._txtChi_2.ignoreContentAdaptWithSize(!0);this._txtChi_3=this._scaleControl.getChildByName("MGTxtChi3");
this._txtChi_3.ignoreContentAdaptWithSize(!0);this._txtBinhType=this._scaleControl.getChildByName("MGTxtMauBinh");this._txtBinhType.ignoreContentAdaptWithSize(!0);this._txtSoChi_1=this._scaleControl.getChildByName("MGTxtSoChi_1");this._txtSoChi_1.ignoreContentAdaptWithSize(!0);this._txtSoChi_2=this._scaleControl.getChildByName("MGTxtSoChi_2");this._txtSoChi_2.ignoreContentAdaptWithSize(!0);this._txtSoChi_3=this._scaleControl.getChildByName("MGTxtSoChi_3");this._txtSoChi_3.ignoreContentAdaptWithSize(!0);
this._tongChiTitle=this._scaleControl.getChildByName("MGTongChiTitle");this._txtSoTongChi=this._scaleControl.getChildByName("MGTxtSoTongChi");this._txtSoTongChi.ignoreContentAdaptWithSize(!0);this._achTitle=this._scaleControl.getChildByName("MGAchTitle");this._txtAch=this._scaleControl.getChildByName("MGTxtAch");this._txtAch.ignoreContentAdaptWithSize(!0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.ChangeCard.toString(),
this.ngChangeCard.bind(this)))},ngChangeCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCard:b.Array8,ListCard_Type:b.UInt8,TypeChi:b.Array8,TypeChi_Type:b.UInt8,IsBinhLung:b.Int8};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.TypeChi.length;b++)this._setTxtTypeCard(b+1,a.TypeChi[b]);this._checkLung(a.IsBinhLung)},addListCard:function(a,b){0<this._listCard.length&&this.resetListCard();for(var d=0;d<a.length;d++){var e=null;if((e=MGGameBoardBinh.getCardByID(a[d]))&&
d<MGBinhBoxCardOwner.CHI_POS_DETAIL.length){var f=MGBinhBoxCardOwner.CHI_POS_DETAIL[d],g=this._scaleControl.getChildByName("MGPos_"+d);g&&(e.setChiCard(f.CHI),e.setIndexCard(d),e.setAndSavePos(g.getPosition()),e.setLocalZOrder(d),e.callBackOnClick||(e.callBackOnClick=this.onCardMove.bind(this),e.addTouchEventListener(e.callBackOnClick),e.setTouchEnabled(!0)),e.setEventEnable(!0),this._scaleControl.addChild(e),this._listCard.push(e))}}},resetListCard:function(){for(var a=0;a<this._listCard.length;a++)MGGameBoardBinh.returnCard(this._listCard[a]);
this._listCard.length=0},binhXongAction:function(a){this._listCard&&0<this._listCard.length&&(a?this.mainGame.netSend.sendMauBinh(this._getListIdCard()):this.mainGame.netSend.sendBinhXong(this._getListIdCard()))},onCardMove:function(a,b){if(a.eventEnable)switch(b){case ccui.Widget.TOUCH_MOVED:a.setLocalZOrder(999);a.setPosition(this._scaleControl.convertToNodeSpace(a.getTouchMovePosition()));break;case ccui.Widget.TOUCH_ENDED:a.setLocalZOrder(0);this._switchCard(a,this._scaleControl.convertToNodeSpace(a.getTouchEndPosition()));
break;case ccui.Widget.TOUCH_CANCELED:a.setLocalZOrder(0),this._switchCard(a,this._scaleControl.convertToNodeSpace(a.getTouchEndPosition()))}},_switchCard:function(a,b){var d=this._findCardContain(a,b);if(d){var e=a.getSavePos(),f=a.getChiCard(),g=a.getIndexCard();a.setAndSavePos(d.getSavePos());a.setChiCard(d.getChiCard());a.setIndexCard(d.getIndexCard());d.setAndSavePos(e);d.setChiCard(f);d.setIndexCard(g)}else a.setAndSavePos(a.getSavePos());mg.audio.playEffect(ResourceManager.MGResourcesGameBinh.CHANGE_CARD,
MGGameInfo.gameVolume);this._listCard&&0<this._listCard.length&&this.mainGame.netSend.sendChangeCard(this._getListIdCard())},_findCardContain:function(a,b){for(var d=0;d<this._listCard.length;d++)if(a._idCard!==this._listCard[d]._idCard){var e=this._listCard[d].getSavePos();if(b.x>=e.x-ConstantsVariable.BINH_CARD_SIZE.width/2&&b.x<=e.x+ConstantsVariable.BINH_CARD_SIZE.width/2&&b.y>=e.y-ConstantsVariable.BINH_CARD_SIZE.height/2&&b.y<=e.y+ConstantsVariable.BINH_CARD_SIZE.height/2)return this._listCard[d]}return null},
_setTxtTypeCard:function(a,b,d){if(ConstantsVariable.TYPE_BINH[b]){b=ConstantsVariable.TYPE_BINH[b].Name;var e=MGBinhCompoEffect.BINH_WHITE_COLOR;d&&void 0!==d&&(e=d);a=this._getTxtTarget(a);a.setString(b);a.setTextColor(e)}},setTxtBinhType:function(a,b){var d=MGBinhCompoEffect.BINH_WHITE_COLOR;b&&void 0!==b&&(d=b);this._txtBinhType.setString(a);this._txtBinhType.setTextColor(d);this._txtBinhType.setVisible(!0)},_getTxtTarget:function(a){switch(a){case 1:return this._txtChi_1;case 2:return this._txtChi_2;
default:return this._txtChi_3}},_getTxtSoChiBinh:function(a){switch(a){case 1:return this._txtSoChi_1;case 2:return this._txtSoChi_2;default:return this._txtSoChi_3}},_sortListCard:function(){0<this._listCard.length&&this._listCard.sort(function(a,b){return a.getIndexCard()-b.getIndexCard()})},_getListIdCard:function(){this._sortListCard();for(var a=[],b=0;b<this._listCard.length;b++)a.push(this._listCard[b]._idCard);return a},setStateBoxCard:function(a){this.mainGame.darkLayer.setVisible(a);this._txtChi_3.setVisible(a);
this._txtChi_1.setVisible(a);this._txtChi_2.setVisible(a);this._txtBinhType.setVisible(a);for(var b=a?MGBinhBoxCardContainer.SCALE_INFO.STATE_BINH:MGBinhBoxCardContainer.SCALE_INFO.STATE_SHOW,d=0;d<this._listCard.length;d++){var e=this._listCard[d]._chiCard;1===e?this._listCard[d].setAndSavePos(cc.p(this._listCard[d].getPositionX(),b.Chi1PosY)):2===e&&this._listCard[d].setAndSavePos(cc.p(this._listCard[d].getPositionX(),b.Chi2PosY));this._listCard[d].setTouchEnabled(a)}Utilities.showLog("this._scaleControl.setScale "+
b.ScaleX+" "+b.ScaleY);this._scaleControl.setScaleX(b.ScaleX);this._scaleControl.setScaleY(b.ScaleY)},_setStateBtn:function(a,b){a?(this.mainGame.compoButtons.hideButton(MGCompoButtonBinh.BUTTON_NAME.BINH_XONG),this.mainGame.compoButtons.hideButton(MGCompoButtonBinh.BUTTON_NAME.MAU_BINH),this.mainGame.compoButtons.showButton(MGCompoButtonBinh.BUTTON_NAME.BINH_LAI)):(this._checkLung(b),this.mainGame.compoButtons.hideButton(MGCompoButtonBinh.BUTTON_NAME.BINH_LAI))},_checkLung:function(a){a&&void 0!==
a&&a===ConstantsVariable.IS_BINH_LUNG.TRUE?this.mainGame.compoButtons.hideButton(MGCompoButtonBinh.BUTTON_NAME.BINH_XONG):this.mainGame.compoButtons.showButton(MGCompoButtonBinh.BUTTON_NAME.BINH_XONG)},soChiAction:function(a){for(var b=1;3>=b;b++)this.timeOutChi[b]=setTimeout(this._showChi.bind(this,b,a),b*MGBinhBoxCardContainer.TIME_SO_PER_CHI)},_showChi:function(a,b){for(var d=0;d<this._listCard.length;d++){var e=this._listCard[d];e.showBlackCard(e.getChiCard()!==a)}a-1<b.TypeChi.length&&this.setTxtBinhType(ConstantsVariable.TYPE_BINH[b.TypeChi[a-
1]].Name);this.setPointChiData(b,a);3===a&&(this.timeOutFinishChi=setTimeout(this._showChiFinish.bind(this,b),MGBinhBoxCardContainer.TIME_SO_PER_CHI))},_showChiFinish:function(a){for(var b=0;b<this._listCard.length;b++)this._listCard[b].showBlackCard(!1);this.setPointAch(a);MGGameBoardBinh.GameStatus!==ConstantsVariable.STATE_BINH.FINISH&&(0<a.PointSampHam?(a=MGBinhBoxCardContainer.BINH_RESULT_INFO.WIN_SUP_HAM_TXT,this.setTxtBinhType(a.Text,a.ColorTxt)):0>a.PointSampHam?(a=MGBinhBoxCardContainer.BINH_RESULT_INFO.LOSE_SUP_HAM_TXT,
this.setTxtBinhType(a.Text,a.ColorTxt)):this.setTxtBinhType(""))},setPointAch:function(a){this._achTitle.setVisible(!0);this._setColorAndValueChi(this._txtAch,a.PointAch);this.setPointTongChi(a)},setPointTongChi:function(a){this._tongChiTitle.setVisible(!0);this._setColorAndValueChi(this._txtSoTongChi,a.TotalPoint)},setPointChiData:function(a,b){var d=this._getTxtSoChiBinh(b);d.setVisible(!0);1===b?this._setColorAndValueChi(d,a.PointChiDau):2===b?this._setColorAndValueChi(d,a.PointChiGiua):3===b&&
this._setColorAndValueChi(d,a.PointChiCuoi)},_setColorAndValueChi:function(a,b){a.setString(b);0<b?a.setTextColor(MGBinhCompoEffect.BINH_RED_COLOR):0>b?a.setTextColor(MGBinhCompoEffect.BINH_YELLOW_COLOR):a.setTextColor(MGBinhCompoEffect.BINH_WHITE_COLOR)},clearOwnTxt:function(){this.mauBinhType=0;this._txtChi_1.setString("");this._txtChi_2.setString("");this._txtChi_3.setString("");this._txtBinhType.setString("");this._txtSoChi_1.setString("");this._txtSoChi_2.setString("");this._txtSoChi_3.setString("");
this._tongChiTitle.setVisible(!1);this._txtSoTongChi.setString("");this._achTitle.setVisible(!1);this._txtAch.setString("")},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=1;3>=a;a++)this.timeOutChi[a]&&clearTimeout(this.timeOutChi[a]);this.timeOutFinishChi&&clearTimeout(this.timeOutFinishChi)}});var MGBinhBoxCardOtherUser=MGBaseNode.extend({_scaleControl:null,_listCard:null,_txtInfo:null,timeOutShowChi:null,timeOutFinishChi:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameBinh.MGBinhBoxCardOwner,PreLoaderConfig.PathToResourceDefault).node);this.mainGame=a;this._listCard=[];this.timeOutShowChi=[];this._initUI()},_initUI:function(){this._scaleControl=
this.getChildByName("MGMainPanel");this._scaleControl.getChildByName("MGTxtChi1").setVisible(!1);this._scaleControl.getChildByName("MGTxtChi2").setVisible(!1);this._scaleControl.getChildByName("MGTxtChi3").setVisible(!1);this._scaleControl.getChildByName("MGTxtSoChi_1").setVisible(!1);this._scaleControl.getChildByName("MGTxtSoChi_2").setVisible(!1);this._scaleControl.getChildByName("MGTxtSoChi_3").setVisible(!1);this._txtInfo=this._scaleControl.getChildByName("MGTxtMauBinh");this._txtInfo.ignoreContentAdaptWithSize(!0);
this._txtInfo.setVisible(!1)},addOtherListCard:function(a){0<this._listCard.length&&this.resetOtherListCard();for(var b=0;b<a.length;b++){var d=null;if((d=MGGameBoardBinh.getCardByID(a[b]))&&b<MGBinhBoxCardOwner.CHI_POS_DETAIL.length){var e=MGBinhBoxCardOwner.CHI_POS_DETAIL[b],f=this._scaleControl.getChildByName("MGPos_"+b);f&&(d.setChiCard(e.CHI),d.setIndexCard(b),d.setAndSavePos(f.getPosition()),d.setLocalZOrder(b),this._scaleControl.addChild(d),this._listCard.push(d))}}this.setStateOtherBoxCard()},
resetOtherListCard:function(){for(var a=0;a<this._listCard.length;a++)MGGameBoardBinh.returnCard(this._listCard[a]);this._listCard.length=0},setStateOtherBoxCard:function(){for(var a=MGBinhBoxCardContainer.SCALE_INFO.STATE_SHOW,b=0;b<this._listCard.length;b++){var d=this._listCard[b]._chiCard;1===d?this._listCard[b].setAndSavePos(cc.p(this._listCard[b].getPositionX(),a.Chi1PosY)):2===d&&this._listCard[b].setAndSavePos(cc.p(this._listCard[b].getPositionX(),a.Chi2PosY))}this._scaleControl.setScaleX(a.ScaleX);
this._scaleControl.setScaleY(a.ScaleY)},soChiOtherAction:function(a){for(var b=1;3>=b;b++)this.timeOutShowChi[b]=setTimeout(this._showChi.bind(this,b,a),b*MGBinhBoxCardContainer.TIME_SO_PER_CHI)},_showChi:function(a,b){for(var d=0;d<this._listCard.length;d++){var e=this._listCard[d];e.getChiCard()===a?(e.setVisible(!0),e.setPositionY(MGBinhBoxCardOtherUser.CHI_3_POS_Y)):e.setVisible(!1)}a-1<b.TypeChi.length&&this.setTxtOtherBinhType(ConstantsVariable.TYPE_BINH[b.TypeChi[a-1]].Name);3===a&&(this.timeOutFinishChi=
setTimeout(this._showChiFinish.bind(this,b),MGBinhBoxCardContainer.TIME_SO_PER_CHI))},_showChiFinish:function(a){for(var b=0;b<this._listCard.length;b++)this._listCard[b].setVisible(!0);this.setStateOtherBoxCard();MGGameBoardBinh.GameStatus!==ConstantsVariable.STATE_BINH.FINISH&&(0<a.PointSampHam?(a=MGBinhBoxCardContainer.BINH_RESULT_INFO.WIN_SUP_HAM_TXT,this.setTxtOtherBinhType(a.Text,a.ColorTxt)):0>a.PointSampHam?(a=MGBinhBoxCardContainer.BINH_RESULT_INFO.LOSE_SUP_HAM_TXT,this.setTxtOtherBinhType(a.Text,
a.ColorTxt)):this.setTxtOtherBinhType(""))},setTxtOtherBinhType:function(a,b){var d=MGBinhCompoEffect.BINH_WHITE_COLOR;b&&void 0!==b&&(d=b);this._txtInfo.setString(a);this._txtInfo.setTextColor(d);this._txtInfo.setVisible(!0)},clearOtherTxt:function(){this._txtInfo.setString("")},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=1;3>=a;a++)this.timeOutShowChi[a]&&clearTimeout(this.timeOutShowChi[a]);this.timeOutFinishChi&&clearTimeout(this.timeOutFinishChi)}});var MGBinhBoxCardContainer=MGBaseNode.extend({compoChiaBai:null,boxCardOwner:null,listBoxCard:null,listCardDown:null,mainGame:null,dealer:null,stateInfoContain:null,_randCardData:null,timeOutClearUI:null,timeOutCompareChi:null,timeOutBoxCardOtherUser:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.timeOutCompareChi=[];this._initEventBtnFromNode();this._initUI();this._initBoxCardOwner();this._initCompoChiaBai();
this._initEventsGame();this._initDealer();this._initCards();this._initStateInfo()},_initUI:function(){this.listCardDown=[];this.listBoxCard=[];var a=new cc.Sprite;a.setSpriteFrame(ConstantsVariable.CARD_DOWN_IMG);this.getChildByName("MGBoxCardRemain_1").addChild(a);a.setScale(.63,.6);a.setName("CardDown1");a.setVisible(!1);this.listCardDown[1]=a;for(var b=2;4>=b;b++)a=new cc.Sprite,a.setSpriteFrame(ConstantsVariable.CARD_DOWN_IMG),this.getChildByName("MGBoxCardRemain_"+b).addChild(a),a.setScale(.63,
.6),a.setName("CardDown"+b),a.setVisible(!1),this.listCardDown[b]=a,a=new MGBinhBoxCardOtherUser,a.initObj(this.mainGame),this.addChild(a,ConstantsVariable.UI_ZONE_BINH.MY_BOX_CARD),a.setPosition(this.getChildByName("MGBoxCard_"+b).getPosition()),a.setVisible(!1),this.listBoxCard[b]=a},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.FINISH,this._finishRand.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.ResetBinh.toString(),
this.ngResetBinh.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.BinhXong.toString(),this.ngBinhXong.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.MauBinh.toString(),this.ngMauBinh.bind(this)))},_initCards:function(){MGGameBoardBinh.Cards=[];for(var a=4;52>a;a++){var b=new MGCardBinh;b.initObj(a,MGGameBoardBinh.Cards.length);MGGameBoardBinh.Cards.push(b);b.retain()}for(a=0;4>a;a++)b=new MGCardBinh,
b.initObj(a,MGGameBoardBinh.Cards.length),MGGameBoardBinh.Cards.push(b),b.retain();b=new MGCardBinh;b.initObj(a,MGGameBoardBinh.Cards.length);MGGameBoardBinh.Cards.push(b);b.retain()},_initBoxCardOwner:function(){this.boxCardOwner=new MGBinhBoxCardOwner;this.boxCardOwner.initObj(this.mainGame);this.mainGame.addChild(this.boxCardOwner,ConstantsVariable.UI_ZONE_BINH.MY_BOX_CARD);this.boxCardOwner.setPosition(this.getChildByName("MGBoxCard_1").getPosition())},_initCompoChiaBai:function(){this.compoChiaBai=
new CompoChiaBai;var a=this.getChildByName("MGDealer").getPosition();this.compoChiaBai.initObj(MGGameBoardBinh.CARD_WIDTH,MGGameBoardBinh.CARD_HEIGHT,cc.p(a.x,a.y-50),.1);this.addChild(this.compoChiaBai,ConstantsVariable.UI_ZONE_BINH.COMPO_CHIA_BAI)},_initDealer:function(){this.dealer=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameBinh.Dealer_Json,ResourceManager.MGResourcesGameBinh.Dealer_Atlas);this.dealer.setScale(4);var a=this.getChildByName("MGDealer").getPosition();this.dealer.setPosition(cc.p(a.x,
a.y-15));this.addChild(this.dealer,ConstantsVariable.UI_ZONE_BINH.DEALER);this.dealer.setAnimation(0,"Idle",!0)},_initStateInfo:function(){this.stateInfoContain=new MGStateInfo;this.stateInfoContain.initObj();this.addChild(this.stateInfoContain,ConstantsVariable.UI_ZONE_BINH.STATE_INFO);this.stateInfoContain.setPosition(this.getChildByName("MGStatePos").getPosition())},randCardBinh:function(a){null!=this.timeOutClearUI&&clearTimeout(this.timeOutClearUI);this.clearUI();this.stateInfoContain._checkAndSetState();
this._randCardData=a;var b=[];b.push(this.boxCardOwner.getPosition());for(var d in MGGameBoardBinh.listUser)1!==MGGameBoardBinh.listUser[d].Index&&b.push(this.getChildByName("MGBoxCardRemain_"+[MGGameBoardBinh.listUser[d].Index]).getPosition());for(var e=[],f=0;f<b.length;f++)e.push([52,52,52,52,52,52,52,52,52,52,52,52,52]);this.boxCardOwner.addListCard(a.ListCard,!0);for(f=0;f<a.TypeChi.length;f++)this.boxCardOwner._setTxtTypeCard(f+1,a.TypeChi[f]);this.boxCardOwner.setVisible(!1);this.compoChiaBai.playEffect(b,
e,.5);mg.audio.playEffect(ResourceManager.MGResourcesGameBinh.CHIA_BAI,MGGameInfo.gameVolume);this.dealer.setAnimation(0,"DealCard",!0);for(d in MGGameBoardBinh.listUser)(a=MGGameBoardBinh.listUser[d])&&(MGGameBoardBinh.isMine(a.UserID)?this.listCardDown[1].setVisible(!0):this.updateStateCardOtherUser(a));cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_BASE_EFFECT,{name:MGBinhCompoEffect.EFFECT.FX_CHO_VANMOI,isShow:!1})},_finishRand:function(a){mg.audio.stopAllEffects();a=this._randCardData;
this.boxCardOwner._setStateBtn(!1,a.IsBinhLung);this._checkAndSetMauBinh(a.MauBinhType);this.listCardDown[1].setVisible(!1);this.boxCardOwner.setVisible(!0);this.boxCardOwner.setStateBoxCard(!0);this.dealer.setAnimation(0,"Idle",!0)},ngBinhXong:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32};a=(new BinaryParser).initObj(b,a.content);cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_SHOW,a);MGGameBoardBinh.isMine(a.UserID)&&(this.boxCardOwner.setStateBoxCard(!1),
this.boxCardOwner._setStateBtn(!0))},ngResetBinh:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32};a=(new BinaryParser).initObj(b,a.content);cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_HIDE,a);MGGameBoardBinh.isMine(a.UserID)&&(this.boxCardOwner.setStateBoxCard(!0),this.boxCardOwner._setStateBtn(!1),this._checkAndSetMauBinh(this.boxCardOwner.mauBinhType))},ngMauBinh:function(a){a=a.getUserData();var b={UserID:BinaryConstants.DataTypeID.UInt32};
a=(new BinaryParser).initObj(b,a.content);cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_SHOW,a);MGGameBoardBinh.isMine(a.UserID)&&(this.boxCardOwner.setStateBoxCard(!1),this.boxCardOwner._setStateBtn(!0))},onGetGameData:function(a){this.stateInfoContain._checkAndSetState();a=a.ListUserInfo;var b=0,d=a.length;for(b;b<d;b++){var e=a[b];if(MGGameBoardBinh.isMine(e.UserID))if(this.boxCardOwner.addListCard(e.ListCard,!0),MGGameBoardBinh.isXepBaiTime()){this._checkAndSetMauBinh(e.MauBinhType);
for(var f=0;f<e.TypeChi.length;f++)this.boxCardOwner._setTxtTypeCard(f+1,e.TypeChi[f]);e.Status===ConstantsVariable.USER_STATE_BINH.BINH_XONG?(this.boxCardOwner.setStateBoxCard(!1),this.boxCardOwner._setStateBtn(!0),cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_SHOW,e)):(this.boxCardOwner.setStateBoxCard(!0),this.boxCardOwner._setStateBtn(!1,e.IsBinhLung),cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_HIDE,e))}else MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.CALCULATE_FINISH&&
this.boxCardOwner.setStateBoxCard(!1);else if(f=MGGameBoardBinh.listUser[e.UserID])this.listBoxCard[f.Index].addOtherListCard(e.ListCard),this.updateStateCardOtherUser(e)}},onCampareChi:function(a){this.stateInfoContain._showHideStateInfo(!1);for(var b=0,d=!0,e=0;e<a.ResultInfo.length;e++)a.ResultInfo[e].IsBinhLung===ConstantsVariable.IS_BINH_LUNG.FALSE&&!1===MGGameBoardBinh.isMauBinh(a.ResultInfo[e].MauBinhType)&&(b+=1),a.ResultInfo[e].IsBinhLung===ConstantsVariable.IS_BINH_LUNG.FALSE&&(d=!1);for(e=
0;e<a.ResultInfo.length;e++)MGGameBoardBinh.isMine(a.ResultInfo[e].UserID)?this._ownerCompare(a.ResultInfo[e],2<=b,d):this._otherCompare(a.ResultInfo[e],2<=b);if(2>b)this.stateInfoContain._checkAndSetState();else for(a=1;3>=a;a++)this.timeOutCompareChi[a]=setTimeout(this.stateInfoContain._compareChiState.bind(this.stateInfoContain,a),a*MGBinhBoxCardContainer.TIME_SO_PER_CHI)},onEndMatch:function(a){this.stateInfoContain._showHideStateInfo(!1);for(var b=0;b<a.ResultInfo.length;b++){var d=a.ResultInfo[b],
e=MGBinhCompoEffect.BINH_WHITE_COLOR,f=0,g=d.resultCoin;0<g?(f="+"+Utilities.Coin(g),e=MGBinhCompoEffect.BINH_WIN_COLOR,cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_FX_THANG,d)):(f=Utilities.Coin(g),0>g&&cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_FX_THUA,d));MGGameBoardBinh.isMine(d.userId)?this.boxCardOwner.setTxtBinhType(f,e):(d=MGGameBoardBinh.listUser[d.userId])&&this.listBoxCard[d.Index].setTxtOtherBinhType(f,e)}this.timeOutClearUI=setTimeout(this.clearUI.bind(this),
5E3)},_ownerCompare:function(a,b,d){this.mainGame.compoButtons.hideAll();this.boxCardOwner.addListCard(a.ListCard);this.boxCardOwner.setStateBoxCard(!1);if(a.IsBinhLung===ConstantsVariable.IS_BINH_LUNG.TRUE){if(b=MGBinhBoxCardContainer.BINH_RESULT_INFO.BINH_LUNG_TXT,this.boxCardOwner.setTxtBinhType(b.Text,b.ColorTxt),!d)for(this.boxCardOwner.setPointAch(a),d=1;3>=d;d++)this.boxCardOwner.setPointChiData(a,d)}else if(MGGameBoardBinh.isMauBinh(a.MauBinhType))this.boxCardOwner.setTxtBinhType(ConstantsVariable.TYPE_BINH[a.MauBinhType].Name,
MGBinhCompoEffect.BINH_YELLOW_COLOR),this.boxCardOwner.setPointAch(a);else if(b)this.boxCardOwner.soChiAction(a);else for(this.boxCardOwner.setPointAch(a),d=1;3>=d;d++)this.boxCardOwner.setPointChiData(a,d)},_otherCompare:function(a,b){var d=MGGameBoardBinh.listUser[a.UserID];if(d){var e=this.listBoxCard[d.Index];e.addOtherListCard(a.ListCard);if(a.IsBinhLung===ConstantsVariable.IS_BINH_LUNG.TRUE){var f=MGBinhBoxCardContainer.BINH_RESULT_INFO.BINH_LUNG_TXT;e.setTxtOtherBinhType(f.Text,f.ColorTxt);
this.showBoxCardOtherUser(d.Index,!0)}else MGGameBoardBinh.isMauBinh(a.MauBinhType)?(e.setTxtOtherBinhType(ConstantsVariable.TYPE_BINH[a.MauBinhType].Name,MGBinhCompoEffect.BINH_YELLOW_COLOR),this.showBoxCardOtherUser(d.Index,!0)):b?(this.timeOutBoxCardOtherUser=setTimeout(this.showBoxCardOtherUser.bind(this,d.Index,!0),MGBinhBoxCardContainer.TIME_SO_PER_CHI),e.soChiOtherAction(a)):this.showBoxCardOtherUser(d.Index,!0)}},updateStateCardOtherUser:function(a){var b=MGGameBoardBinh.listUser[a.UserID];
b&&(a.Status===ConstantsVariable.USER_STATE_BINH.THOAT?(this.listBoxCard[b.Index].setVisible(!1),this.listCardDown[b.Index].setVisible(!1)):(a.Status===ConstantsVariable.USER_STATE_BINH.BINH_XONG?cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_SHOW,a):cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_XONG_HIDE,a),MGGameBoardBinh.isXepBaiTime()?this.showBoxCardOtherUser(b.Index,!1):this.showBoxCardOtherUser(b.Index,!0)))},showBoxCardOtherUser:function(a,b){!a||
2>a||4<a||(b?(this.listBoxCard[a].setVisible(!0),this.listCardDown[a].setVisible(!1)):(this.listBoxCard[a].setVisible(!1),this.listCardDown[a].setVisible(!0)))},clearUI:function(){cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_BASE_EFFECT,{name:MGBinhCompoEffect.EFFECT.FX_CHO_VANMOI,isShow:!0});this.boxCardOwner.resetListCard();this.boxCardOwner.clearOwnTxt();for(var a=2;4>=a;a++)this.listBoxCard[a].clearOtherTxt(),this.listBoxCard[a].resetOtherListCard();this.hideAllBoxCard()},
hideAllBoxCard:function(){this.boxCardOwner.setVisible(!1);this.listBoxCard[2].setVisible(!1);this.listBoxCard[3].setVisible(!1);this.listBoxCard[4].setVisible(!1);this.listCardDown[2].setVisible(!1);this.listCardDown[3].setVisible(!1);this.listCardDown[4].setVisible(!1)},_checkAndSetMauBinh:function(a){this.boxCardOwner.mauBinhType=a;MGGameBoardBinh.isMauBinh(a)?this.mainGame.compoButtons.showButton(MGCompoButtonBinh.BUTTON_NAME.MAU_BINH):this.mainGame.compoButtons.hideButton(MGCompoButtonBinh.BUTTON_NAME.MAU_BINH)},
setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.timeOutClearUI&&clearTimeout(this.timeOutClearUI);for(var a=1;3>=a;a++)this.timeOutCompareChi[a]&&clearTimeout(this.timeOutCompareChi[a]);this.timeOutBoxCardOtherUser&&clearTimeout(this.timeOutBoxCardOtherUser);this.boxCardOwner&&(this.boxCardOwner.setDispose(),this.boxCardOwner.removeFromParent(!0),this.boxCardOwner=null);for(a=2;4>=a;a++)this.listBoxCard[a]&&this.listBoxCard[a].setDispose();this.removeAllChildren(!0)}}),MGStateInfo=
MGBaseNode.extend({_stateTxt:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesGameBinh.MGStateInfo,PreLoaderConfig.PathToResourceDefault);this._initUI()},_initUI:function(){this._stateTxt=this._mainLayer.getChildByName("MGStateInfo").getChildByName("MGTxtState");this._stateTxt.ignoreContentAdaptWithSize(!0);this.setVisible(!1)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this)},
_showHideStateInfo:function(a){this.setVisible(a)},_checkAndSetState:function(){MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.START_GAME||MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.WAIT_BINH||MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.DEAL?(this._showHideStateInfo(!1),cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_BASE_XEPCHI,{name:MGBinhCompoEffect.EFFECT.FX_XEP_CHI,isShow:!0})):MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.CALCULATE_FINISH?
(this._showHideStateInfo(!0),cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_BASE_XEPCHI,{name:MGBinhCompoEffect.EFFECT.FX_XEP_CHI,isShow:!1}),this._stateTxt.setString("So chi")):(this._showHideStateInfo(!1),cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_BASE_EFFECT,{name:MGBinhCompoEffect.EFFECT.FX_CHO_VANMOI,isShow:!0}))},_compareChiState:function(a){this._showHideStateInfo(!0);this._stateTxt.setString("Chi "+a);cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_BASE_XEPCHI,
{name:MGBinhCompoEffect.EFFECT.FX_XEP_CHI,isShow:!1})}});var MGCompoButtonBinh=MGBaseNode.extend({_listButton:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this.hideAll()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]))},hideButton:function(a){this.getChildByName(a).setBright(!1);
this.getChildByName(a).setEnabled(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGCompoButtonBinh.BUTTON_NAME.BINH_XONG:this.mainGame.boxCardContainer.boxCardOwner.binhXongAction(!1);break;case MGCompoButtonBinh.BUTTON_NAME.BINH_LAI:this.mainGame.netSend.sendResetBinh();break;case MGCompoButtonBinh.BUTTON_NAME.MAU_BINH:this.mainGame.boxCardContainer.boxCardOwner.binhXongAction(!0)}},
hideAll:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)}});MGCompoButtonBinh.BUTTON_NAME={BINH_XONG:"MGBtnBinhXong",BINH_LAI:"MGBtnBinhLai",MAU_BINH:"MGBtnMauBinh"};MGCompoButtonBinh.ON_CLICK="ON_CLICK_BINH_BUTTON";var MGGameBoardBinh=cc.Class.extend({_listEvents:null,ctor:function(){}});MGGameBoardBinh.my={betCoin:0,position:0};MGGameBoardBinh.listUser={};MGGameBoardBinh.timeOut=0;MGGameBoardBinh.Cards=null;MGGameBoardBinh.listCardsDown=[];MGGameBoardBinh.getCardByID=function(a){return MGGameBoardBinh.Cards[a]};MGGameBoardBinh.returnCard=function(a){cc.sys.isNative||a.setTouchEnabled(!1);a.parent&&(a.resetCard(),a.retain(),a.removeFromParent(!0))};
MGGameBoardBinh.clearCards=function(){for(;0<MGGameBoardBinh.Cards.length;)MGGameBoardBinh.Cards.pop().removeFromParent(!0);MGGameBoardBinh.Cards=null};MGGameBoardBinh.isEndRound=0;MGGameBoardBinh.GameStatus=0;MGGameBoardBinh.CARD_WIDTH=80;MGGameBoardBinh.CARD_HEIGHT=105;MGGameBoardBinh.isMine=function(a){return a===MGGameInfo.myInfo.UserID};MGGameBoardBinh.isMauBinh=function(a){return 10<=a};
MGGameBoardBinh.isXepBaiTime=function(){return MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.START_GAME||MGGameBoardBinh.GameStatus===ConstantsVariable.STATE_BINH.WAIT_BINH?!0:!1};MGBinhBoxCardOwner.CHI_POS_DETAIL=[{CHI:1},{CHI:1},{CHI:1},{CHI:2},{CHI:2},{CHI:2},{CHI:2},{CHI:2},{CHI:3},{CHI:3},{CHI:3},{CHI:3},{CHI:3}];MGBinhBoxCardOtherUser.CHI_3_POS_Y=51;MGBinhBoxCardContainer.SCALE_INFO={STATE_BINH:{ScaleX:1,ScaleY:1,Chi2PosY:230,Chi1PosY:410},STATE_SHOW:{ScaleX:.53,ScaleY:.5,Chi2PosY:190,Chi1PosY:330}};MGBinhBoxCardContainer.TIME_SO_PER_CHI=2E3;
MGBinhBoxCardContainer.BINH_RESULT_INFO={BINH_LUNG_TXT:{Text:"Binh Lủng",ColorTxt:cc.color(36,220,227)},WIN_SUP_HAM_TXT:{Text:"Thắng Sập Hầm",ColorTxt:cc.color(255,255,255)},LOSE_SUP_HAM_TXT:{Text:"Thua Sập Hầm",ColorTxt:cc.color(255,255,255)}};MGBinhCompoEffect.EVENT={BINH_FX_THANG:"Binh_fxThang",BINH_FX_THUA:"Binh_fxThua",BINH_FX_HideAll:"Binh_fxHideAll",BINH_XONG_SHOW:"Binh_XongShow",BINH_XONG_HIDE:"Binh_XongHide",BINH_BASE_EFFECT:"Binh_BaseEffect",BINH_BASE_XEPCHI:"Binh_XepChi"};
MGBinhCompoEffect.EFFECT={FX_CHO_VANMOI:"fxChoVanMoi",FX_XEP_CHI:"fxXepBai"};MGBinhCompoEffect.BINH_XONG_TXT_FONT="Roboto-Medium";MGBinhCompoEffect.BINH_XONG_TXT_SIZE=22;MGBinhCompoEffect.BINH_BLUE_COLOR=cc.color(36,220,227);MGBinhCompoEffect.BINH_YELLOW_COLOR=cc.color(240,224,50);MGBinhCompoEffect.BINH_WHITE_COLOR=cc.color(255,255,255);MGBinhCompoEffect.BINH_RED_COLOR=cc.color(255,0,0);MGBinhCompoEffect.BINH_WIN_COLOR=cc.color(253,67,131);var MGBinh=MGBaseGame.extend({compoUsersContain:null,compoButtons:null,boxCardContainer:null,effectContainer:null,_gameInfoContain:null,darkLayer:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameBinh},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendBinh;this._initCompoUser();this._initBoxCardContainer();this._initGameInfoContain();this._initEffectContainer();this._initDarkLayer();this.addChild(this.darkLayer);
this._initCompoButton()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameBinh.UILayerBinh,PreLoaderConfig.PathToResourceDefault);this.setPosition(0,-60)},_initGameInfoContain:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(100,730);this._gameInfoContain.setVisible(!1);this.addChild(this._gameInfoContain)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.GameData.toString(),
this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.RandCard.toString(),this.ngRandCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.CompareChi.toString(),this.ngCompareChi.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BINH.EndMatch.toString(),this.ngEndMatch.bind(this)))},_initBoxCardContainer:function(){this.boxCardContainer=new MGBinhBoxCardContainer;
this.boxCardContainer.cloneFromNode(this._mainLayer.getChildByName("MGBoxCardNode"));this.boxCardContainer.initObj(this);this.addChild(this.boxCardContainer)},_initCompoButton:function(){this.compoButtons=new MGCompoButtonBinh;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGUIButton"));this.compoButtons.initObj(this);this.addChild(this.compoButtons)},_initCompoUser:function(){this.compoUsersContain=new MGBinhContainUsers;this.compoUsersContain.cloneFromNode(this._mainLayer.getChildByName("MGContainUser"));
this.compoUsersContain.initObj();this.addChild(this.compoUsersContain)},_initEffectContainer:function(){this.effectContainer=new MGBinhCompoEffect;this.effectContainer.cloneFromNode(this._mainLayer.getChildByName("MGContainEffect"));this.effectContainer.initObj();this.addChild(this.effectContainer)},_initDarkLayer:function(){this.darkLayer=new ccui.ImageView("stateBG.png",ccui.Widget.PLIST_TEXTURE);this.darkLayer.setScale(2);this.darkLayer.setScale9Enabled(!0);this.darkLayer.setContentSize(cc.size(cc.winSize.width,
cc.winSize.height));this.darkLayer.setPosition(cc.p(cc.winSize.width/2,cc.winSize.height/2));this.darkLayer.setColor(cc.color("#000000"));this.darkLayer.setOpacity(210);this.darkLayer.setTouchEnabled(!0);this.darkLayer.setSwallowTouches(!0);this.darkLayer.setVisible(!1)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,TimeRemain:b.UInt16,TimeOut:b.UInt16,MinCoin:b.UInt64,MatchID:b.UInt32,ListUserInfo:b.Array8,ListUserInfo_Type:b.Object8,
ListUserInfo_Type_Struct:{UserID:b.UInt32,Status:b.UInt8,MauBinhType:b.UInt8,ListCard:b.Array8,ListCard_Type:b.UInt8,TypeChi:b.Array8,TypeChi_Type:b.UInt8,IsBinhLung:b.Int8}};a=(new BinaryParser).initObj(b,a.content);MGGameBoardBinh.timeOut=a.TimeOut;MGGameBoardBinh.GameStatus=a.Status;this.boxCardContainer.onGetGameData(a);this.compoUsersContain.onGetGameData(a);MGGameBoardBinh.isXepBaiTime()||cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_FX_HideAll,null);this._gameInfoContain.setInfo("BINH",
a.DeskID,a.MinCoin,a.MatchID)},ngRandCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCard:b.Array8,ListCard_Type:b.UInt8,TypeChi:b.Array8,TypeChi_Type:b.UInt8,MauBinhType:b.UInt8,IsBinhLung:b.Int8,MatchID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);MGGameBoardBinh.GameStatus=ConstantsVariable.STATE_BINH.START_GAME;cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_FX_HideAll,null);this.boxCardContainer.randCardBinh(a);this.compoUsersContain.onRandCard();
this._gameInfoContain.setMatchIdInfo(a.MatchID)},ngCompareChi:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultInfo:b.Array8,ResultInfo_Type:b.Object8,ResultInfo_Type_Struct:{UserID:b.UInt32,IsReady:b.Int8,IsBinhLung:b.Int8,MauBinhType:b.UInt8,ListCard:b.Array8,ListCard_Type:b.UInt8,TypeChi:b.Array8,TypeChi_Type:b.UInt8,TotalPoint:b.Int32,PointChiDau:b.Int32,PointChiGiua:b.Int32,PointChiCuoi:b.Int32,PointAch:b.Int32,PointSampHam:b.Int32}};a=(new BinaryParser).initObj(b,a.content);
MGGameBoardBinh.GameStatus=ConstantsVariable.STATE_BINH.CALCULATE_FINISH;cc.eventManager.dispatchCustomEvent(MGBinhCompoEffect.EVENT.BINH_FX_HideAll,null);this.compoUsersContain.stopAllClock();this.boxCardContainer.onCampareChi(a)},ngEndMatch:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultInfo:b.Array8,ResultInfo_Type:b.Object8,ResultInfo_Type_Struct:{userId:b.UInt32,winRank:b.UInt32,coin:b.Int64,resultCoin:b.Int64}};a=(new BinaryParser).initObj(b,a.content);MGGameBoardBinh.GameStatus=
ConstantsVariable.STATE_BINH.FINISH;this.boxCardContainer.onEndMatch(a);for(b=0;b<a.ResultInfo.length;b++)this.compoUsersContain.updateCoinUser(a.ResultInfo[b]),MGGameInfo.myInfo.UserID===a.ResultInfo[b].userId&&(MGGameInfo.myInfo.Gold=a.ResultInfo[b].coin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{}))},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardBinh.clearCards();this.boxCardContainer&&(this.boxCardContainer.setDispose(),
this.boxCardContainer.removeFromParent(!0),this.boxCardContainer=null);this.compoUsersContain&&(this.compoUsersContain.setDispose(),this.compoUsersContain.removeFromParent(!0),this.compoUsersContain=null);this.effectContainer&&(this.effectContainer.setDispose(),this.effectContainer.removeFromParent(!0),this.effectContainer=null);this._gameInfoContain&&(this._gameInfoContain.setDispose(),this._gameInfoContain.removeFromParent(!0),this._gameInfoContain=null);this.compoButtons&&(this.compoButtons.setDispose(),
this.compoButtons.removeFromParent(!0),this.compoButtons=null);this.removeAllChildren(!0)}});ResourceManager.MGResourcesGamePhom={Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",Dealer_Atlas:"res/game/taixiu/Effect/dealer_Blue.atlas",Dealer_PNG:"res/game/taixiu/Effect/dealer_Blue.png",Dealer_Json:"res/game/taixiu/Effect/dealer_Blue.json",
AnSound:"res/game/phom/Sounds/An.mp3",GuiBaiSound:"res/game/phom/Sounds/GuiBai.mp3",MomDenSound:"res/game/phom/Sounds/Mom_Den.mp3",USound:"res/game/phom/Sounds/U_UTron_UKhan.mp3",ChiaBaiSound:"res/game/phom/Sounds/ChiaBai.mp3",DanhSound:"res/game/phom/Sounds/Danh.mp3",Card52:"res/game/Cards/mat-sau.png",AtlasCards:"res/game/Cards/AtlasCards.png",AtlasCardsPlist:"res/game/Cards/AtlasCards.plist",AtlastPhomPNG:"res/game/phom/Atlas/AtlastPhom.png",AtlastPhomPLIST:"res/game/phom/Atlas/AtlastPhom.plist",
MGUIPhomLayerJSON:"res/game/phom/UIPhomLayer.json",FXVanMoi_Atlas:"res/game/phom/Effect/vanmoi.atlas",FXVanMoi_Json:"res/game/phom/Effect/vanmoi.json",FXVanMoi_png:"res/game/phom/Effect/vanmoi.png"};var resourcesGamePhom=[];for(i in ResourceManager.MGResourcesGamePhom)ResourceManager.MGResourcesGamePhom[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGamePhom[i],resourcesGamePhom.push(ResourceManager.MGResourcesGamePhom[i]);Array.ASC=function(a,b){return a-b};Array.DESC=function(a,b){return b-a};Array.spliceArray=function(a,b){var d=0,e=b.length,f=a.slice(0);for(d;d<e;d++)f.splice(f.indexOf(b[d]),1);return f};Array.trimArray=function(a){var b=0;if(2>a.length)return a;for(;b<a.length-1;)a[b]==a[b+1]?a.splice(b,1):b++;return a};var GameRule=cc.Class.extend({});GameRule._BICH=1;GameRule._CHUON=2;GameRule._RO=3;GameRule._CO=4;GameRule._BA=1;GameRule._DAY=2;GameRule.RESULT_U=1;GameRule.RESULT_BI_U=2;GameRule.RESULT_BI_U_DEN=3;GameRule.RESULT_THOAT=4;GameRule.RESULT_MOM=5;GameRule.RESULT_TINHDIEM=6;
GameRule.CARDS=[[1,1],[1,2],[1,3],[1,4],[2,1],[2,2],[2,3],[2,4],[3,1],[3,2],[3,3],[3,4],[4,1],[4,2],[4,3],[4,4],[5,1],[5,2],[5,3],[5,4],[6,1],[6,2],[6,3],[6,4],[7,1],[7,2],[7,3],[7,4],[8,1],[8,2],[8,3],[8,4],[9,1],[9,2],[9,3],[9,4],[10,1],[10,2],[10,3],[10,4],[11,1],[11,2],[11,3],[11,4],[12,1],[12,2],[12,3],[12,4],[13,1],[13,2],[13,3],[13,4]];GameRule.getStyle=function(a){return GameRule.CARDS[a][1]};
GameRule.TachBai=function(a,b){for(var d=[],e=0;e<a.length;e++)GameRule.getStyle(a[e])==b&&d.push(a[e]);d.sort(Array.DESC);return d};GameRule.GetCard=function(a){return GameRule.CARDS[a][0]};GameRule.GetTuQuys=function(a){a.sort(Array.DESC);var b=[];if(4<=a.length)for(var d=a.length-3,e=0;e<d;e++){for(var f=[0,0,0,0],g=0;4>g;g++)f[g]=a[e+g];GameRule.IsTUQUI(f)&&b.push(f)}return b};
GameRule.GetBas=function(a){a.sort(Array.DESC);var b=[];if(3<=a.length)for(var d=a.length-2,e=0;e<d;e++){for(var f=[0,0,0],g=0;3>g;g++)f[g]=a[e+g];GameRule.IsBA(f)&&b.push(f)}return b};GameRule.GetDAYs=function(a){var b=[];if(3<=a.length)for(var d=a.length-2,e=0;e<d;e++){var f=[];f.push(a[e]);for(var g=e+1;g<a.length;g++)if(a[e]-4==a[g])f.push(a[g]),e=g;else{e=g-1;break}3<=f.length&&b.push(f)}return b};
GameRule.IsTUQUI=function(a){return 4!=a.length?!1:GameRule.GetCard(a[0])==GameRule.GetCard(a[1])&&GameRule.GetCard(a[1])==GameRule.GetCard(a[2])&&GameRule.GetCard(a[2])==GameRule.GetCard(a[3])};GameRule.IsBA=function(a){return GameRule.GetCard(a[0])==GameRule.GetCard(a[1])&&GameRule.GetCard(a[1])==GameRule.GetCard(a[2])};var MGUserPhom=MGBaseNode.extend({mainGame:null,Index:0,Position:0,UserID:0,Mom:!1,compoUserInfo:null,boxCard:null,boxCardDown:null,boxPhomDown:null,boxCardOwner:null,ListCardsDown:null,isPlaying:!1,nodeEffectCard:null,txtScore:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a,b){MGBaseNode.prototype.initObj.call(this);this.mainGame=b;this.ListCardsDown=[];this.Index=a;this.boxCardDown=new MGPhomBoxCardDown;this.boxCardDown.initObj(this);this.mainGame.addChild(this.boxCardDown);
this.boxCard=new MGPhomBoxCard;this.boxCard.initObj(this);this.mainGame.addChild(this.boxCard);this.nodeEffectCard=new cc.Node;this.mainGame.addChild(this.nodeEffectCard);this.boxPhomDown=new MGBoxPhomDown;this.boxPhomDown.cloneFromNode(this.getChildByName("MGBoxPhomDown"));this.boxPhomDown.initObj();this.addChild(this.boxPhomDown);this.compoUserInfo=new MGCompUserInfoPlay;this.compoUserInfo.setAlignInfo(MGCompUserInfoPlay.BottomAlign);this.addChild(this.compoUserInfo);this.txtScore=this.getChildByName("MGTxtScore");
1==a&&(this.boxCardOwner=new MGPhomMyBoxCard,this.boxCardOwner.initObj(),this.mainGame.addChild(this.boxCardOwner));this.hideCardBack()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoUserInfo.setDispose()},updateInfoUser:function(a){this.Position=a.Position;this.UserID=a.UserID;this.compoUserInfo.setUserInfoData(a.UserID,a.NickName,a.Coin,a.Avatar)},updateUserLeave:function(){this.UserID=this.Position=0;this.isPlaying=!1;this.compoUserInfo.removeUserInfoData()},addDownCard:function(a,
b){b==MGGameInfo.myInfo.UserID&&(MGGameBoardPhom.clearListSelect(),this.boxCardOwner.removeCard(a));this.boxCardDown.addDownCard(a,b)},pickCard:function(a,b){if(b==MGGameInfo.myInfo.UserID)this.boxCardOwner.pickCard(a);else{var d=new cc.Sprite;d.setSpriteFrame("card52.png");this.nodeEffectCard.addChild(d);d.setScale(.8);d.setPosition(ConstantsVariable.BAI_TY_POS);var e=MGGameBoardPhom.listUser[b].getPositionDearCard();d.setLocalZOrder(ConstantsVariable.Z_FLY_CARD);d.runAction(cc.sequence(cc.spawn(cc.moveTo(.3,
cc.p(e.x,e.y)),cc.scaleTo(.3,1)),cc.callFunc(function(){d.removeFromParent(!0)}.bind(this))))}},getPositionDearCard:function(){return cc.p(this.getPositionX()+this.boxCard.getPositionX(),this.getPositionY()+this.boxCard.getPositionY())},updateGameData:function(a,b){this.boxCardDown.addListCard(a.ListCardsDown);a.UserID==MGGameInfo.myInfo.UserID?this.boxCardOwner.updateGameData(a.ListCards,a.EatCard,b):(this.boxCard.showCardBack(),this.boxPhomDown.updateGameDataCardEat(a.EatCard));0<a.ListPhomDown.length&&
this.boxPhomDown.haPhom(a.ListPhomDown)},eatCard:function(a){a.UserIDEat==MGGameInfo.myInfo.UserID?(this.boxCardOwner.eatCard(a.CardEat),mg.audio.playEffect(ResourceManager.MGResourcesGamePhom.AnSound,MGGameInfo.gameVolume)):this.boxPhomDown.eatCard(a.CardEat)},haPhom:function(a,b){b==MGGameInfo.myInfo.UserID&&this.boxCardOwner.haPhom(a);this.boxPhomDown.haPhom(a)},removeDownCard:function(a){this.boxCardDown.removeCard(a)},addCardDownWhenEat:function(a){this.boxCardDown.addCardDownWhenEat(a)},showScore:function(a){this.txtScore.setVisible(!0);
this.txtScore.setString(a+" điểm");setTimeout(this.hideScore.bind(this),3E3)},hideScore:function(){this.txtScore.setVisible(!1);this.txtScore.setString("")},openAllCardFinish:function(a,b){a!=MGGameInfo.myInfo.UserID&&this.boxCard.openAllCardFinish(b)},showCardBack:function(){this.UserID!=MGGameInfo.myInfo.UserID&&this.boxCard.showCardBack()},hideCardBack:function(){this.boxCard.hideCardBack()},updateListPhomSend:function(a){this.boxPhomDown.addPhomSend(a)},resetForNewMatch:function(){this.hideScore();
this.boxCardDown.resetForNewMatch();this.boxCardOwner&&this.boxCardOwner.resetForNewMatch();this.boxPhomDown.resetForNewMatch();this.isPlaying=!1;this.boxCard.resetForNewMatch()}});var MGGameBoardPhom=cc.Class.extend({ctor:function(){}});MGGameBoardPhom.my={betCoin:0,position:0};MGGameBoardPhom.CARD_WIDTH=80;MGGameBoardPhom.CARD_HEIGHT=80;MGGameBoardPhom.UserActive=0;MGGameBoardPhom.isEndRound=0;MGGameBoardPhom.GameStatus=0;MGGameBoardPhom.timeOut=0;MGGameBoardPhom.listUser={};MGGameBoardPhom.myUser=null;MGGameBoardPhom.Cards=[];MGGameBoardPhom.Card=-1;MGGameBoardPhom.getCardByID=function(a){return MGGameBoardPhom.Cards[a]};
MGGameBoardPhom.returnCard=function(a){cc.sys.isNative||a.setTouchEnabled(!1);a.parent&&(a.resetCard(),a.removeFromParent(!0),a.retain())};MGGameBoardPhom.haveU=!1;MGGameBoardPhom.listSelectedCards=[];MGGameBoardPhom.clearListSelect=function(){for(;0<MGGameBoardPhom.listSelectedCards.length;)MGGameBoardPhom.listSelectedCards.pop();MGGameBoardPhom.listSelectedCards.length=0};ConstantsVariable.NETWORK_PHOM={ListUser:1701,GameData:1702,AddUser:1703,RandCard:1704,AutoWin:1705,DownCard:1706,GetCard:1707,EatCard:1708,ShowCardSend:1709,SendCard:1710,UserReqU:1711,UserU:1712,DownPhom:1713,NextPlayer:1714,UserLeave:1715,ShowCardsEndMatch:1716,ResultMoney:1717,UserHaveU:1718,ShowCanEat:1719,UserReqAutoDownPhom:1720,Tool:1721,ErrorResponse:1724};ConstantsVariable.STATE_PHOM={NOT_START:0,START_GAME:1,DEAL:2,PLAYING:3,WAIT_SEND_AUTO_WIN:4,CALCULATE_FINISH:5,FINISH:6};
ConstantsVariable.ACTION={DOWN_CARD:1,EATORGET_CARD:2,DOWN_PHOM:3,AUTOWIN:4,DOWNORSEND_CARD:5};ConstantsVariable.Type_U={DEN:-1,KO_U:0,U_TRON:1,U_THUONG:2};ConstantsVariable.BAI_TY_POS={x:624,y:400.05};ConstantsVariable.Z_FLY_CARD=999;var MGPhomBoxCard=MGBaseNode.extend({localPositionX:null,localPositionY:null,cardUp:null,containCard:null,user:null,listCards:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.listCards=[];var b=a.getChildByName("MGBoxCard").getPosition();this.localPositionX=a.getPositionX()+b.x;this.localPositionY=a.getPositionY()+b.y;this.containCard=new cc.Node;this.containCard.setPosition(cc.p(this.localPositionX,this.localPositionY));this.addChild(this.containCard);
this.user=a;this.cardUp=new cc.Sprite;this.cardUp.setPosition(cc.p(this.localPositionX,this.localPositionY));this.cardUp.setSpriteFrame("card52.png");this.addChild(this.cardUp);this.cardUp.setScale(.8)},openAllCardFinish:function(a){this.hideCardBack();if(1==this.user.Index||2==this.user.Index){var b=a.length,d=b-1;for(d;0<=d;d--){var e=MGGameBoardPhom.getCardByID(a[d]);e.setPosition(cc.p(-15*d,0));e.setLocalZOrder(b-d);e.setScale(.7);this.containCard.addChild(e);this.listCards.push(e)}}else for(d=
0;d<a.length;d++)e=MGGameBoardPhom.getCardByID(a[d]),e.setPosition(cc.p(15*d,0)),e.setLocalZOrder(1+d),e.setScale(.7),this.containCard.addChild(e),this.listCards.push(e)},showCardBack:function(){this.cardUp.setVisible(!0)},hideCardBack:function(){this.cardUp.setVisible(!1)},resetForNewMatch:function(){this.hideCardBack();for(var a=this.listCards.length,b=0;b<a;b++)MGGameBoardPhom.returnCard(this.listCards[b]);this.containCard.removeAllChildren(!0)}});var MGPhomBoxCardDown=MGBaseNode.extend({ListCardsDown:null,localPositionX:null,localPositionY:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.ListCardsDown=[];var b=a.getChildByName("MGBoxCarDown").getPosition();this.localPositionX=a.getPositionX()+b.x;this.localPositionY=a.getPositionY()+b.y},addDownCard:function(a,b){var d=MGGameBoardPhom.getCardByID(a),e=MGGameBoardPhom.listUser[b].getPositionDearCard();d.setPosition(e);
this.addChild(d);d.isBet=!0;d.setLocalZOrder(this.ListCardsDown.length+1);d.runAction(cc.spawn(cc.moveTo(.3,cc.p(this.localPositionX+30*this.ListCardsDown.length,this.localPositionY)),cc.scaleTo(.3,.8)));this.ListCardsDown.push(d)},addListCard:function(a){for(var b=0;b<a.length;b++){var d=MGGameBoardPhom.getCardByID(a[b]);d.setLocalZOrder(b+1);d.isBet=!0;d.setScale(.8);d.setPosition(cc.p(this.localPositionX+30*b,this.localPositionY));this.addChild(d);this.ListCardsDown.push(d)}},removeCard:function(a){var b=
MGGameBoardPhom.getCardByID(a),d=this.ListCardsDown.indexOf(b);Utilities.showLog("MGPhomBoxCardDown removeCard cardID "+a+" index "+d);0<=d&&(MGGameBoardPhom.returnCard(b),this.ListCardsDown.splice(d,1))},addCardDownWhenEat:function(a){a=MGGameBoardPhom.getCardByID(a);a.stopAllActions();a.setPosition(cc.p(this.localPositionX+30*this.ListCardsDown.length,this.localPositionY));this.addChild(a);a.setScale(.8);a.isBet=!0;this.ListCardsDown.push(a)},resetForNewMatch:function(){for(var a=this.ListCardsDown.length,
b=0;b<a;b++)MGGameBoardPhom.returnCard(this.ListCardsDown[b]);this.removeAllChildren(!0);this.ListCardsDown.length=0}});var MGBoxPhomDown=MGBaseNode.extend({listContainPhom:null,listCardEat:null,localPositionX:null,localPositionY:null,listPhomHa:null,listcard:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listcard=[];this.listContainPhom=[];var a=new cc.Node;a.setPosition(cc.p(0,50));this.addChild(a);this.listContainPhom[2]=a;a=new cc.Node;a.setPosition(cc.p(0,25));this.addChild(a);this.listContainPhom[1]=a;a=new cc.Node;this.addChild(a);this.listContainPhom[0]=
a;this.listCardEat=[];this.listPhomHa=[]},updateGameDataCardEat:function(a){var b=0,d=a.length;for(b;b<d;b++){var e=MGGameBoardPhom.getCardByID(a[b]);e.isBet=!0;e.setScale(.8);this.listcard.push(e);var f=new cc.Sprite;f.setSpriteFrame("card52.png");f.setScale(.8);f.setPosition(40,0);this.listContainPhom[b].addChild(f);f=new cc.Sprite;f.setSpriteFrame("card52.png");f.setScale(.8);f.setPosition(20,0);this.listContainPhom[b].addChild(f);e.setPosition(cc.p(0,0));this.listContainPhom[b].addChild(e);this.listCardEat.push(a[b])}},
haPhom:function(a,b){b||(this.listContainPhom[0].removeAllChildren(!0),this.listContainPhom[1].removeAllChildren(!0),this.listContainPhom[2].removeAllChildren(!0),this._returnCard());for(var d=0;d<a.length;d++){for(var e=a[d],f=0;f<e.length;f++){var g=MGGameBoardPhom.getCardByID(e[f]);g.stopAllActions();g.setScale(.8);g.setPosition(cc.p(f*MGPhomMyBoxCard.CARD_SIZE,0));this.listContainPhom[d].addChild(g);g.setLocalZOrder(f+1);this.listcard.push(g)}this.listPhomHa[d]=a[d]}},eatCard:function(a){var b=
new cc.Sprite;b.setSpriteFrame("card52.png");b.setScale(.8);b.setPosition(40,0);this.listContainPhom[this.listCardEat.length].addChild(b);b=new cc.Sprite;b.setSpriteFrame("card52.png");b.setScale(.8);b.setPosition(20,0);this.listContainPhom[this.listCardEat.length].addChild(b);b=MGGameBoardPhom.getCardByID(a);b.stopAllActions();b.setScale(.8);b.setPosition(cc.p(0,0));b.setLocalZOrder(3);this.listContainPhom[this.listCardEat.length].addChild(b);this.listcard.push(b);this.listCardEat.push(a)},addPhomSend:function(a){for(var b=
0;b<a.length;b++){var d=a[b];a[b].sort(function(a,b){return a-b});if(0<=d.indexOf(this.listPhomHa[0][0])){this.listPhomHa[0]=d;this.listContainPhom[0].removeAllChildren(!0);for(var e=0;e<d.length;e++){var f=MGGameBoardPhom.getCardByID(d[e]);f.stopAllActions();f.setScale(.8);f.setPosition(cc.p(e*MGPhomMyBoxCard.CARD_SIZE,0));this.listContainPhom[0].addChild(f);f.setLocalZOrder(e+1);this.listcard.push(f)}}if(this.listPhomHa[1]&&0<=d.indexOf(this.listPhomHa[1][0]))for(this.listPhomHa[1]=d,this.listContainPhom[1].removeAllChildren(!0),
e=0;e<d.length;e++)f=MGGameBoardPhom.getCardByID(d[e]),f.stopAllActions(),f.setScale(.8),f.setPosition(cc.p(e*MGPhomMyBoxCard.CARD_SIZE,0)),this.listContainPhom[1].addChild(f),f.setLocalZOrder(e+1),this.listcard.push(f)}},resetForNewMatch:function(){this._returnCard();this.listContainPhom[0].removeAllChildren(!0);this.listContainPhom[1].removeAllChildren(!0);this.listContainPhom[2].removeAllChildren(!0);this.listCardEat.length=0;this.listPhomHa.length=0},_returnCard:function(){for(var a=this.listcard.length,
b=0;b<a;b++)MGGameBoardPhom.returnCard(this.listcard[b]);this.listcard.length=0}});var MGPhomButtons=MGBaseNode.extend({_listButton:[],mainGame:null,xepBaiPos:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]));this.xepBaiPos=this.getChildByName(MGPhomButtons.BUTTON_NAME.XEP_BAI).getPosition()},
hideAll:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setVisible(!1)},hideButton:function(a){this.getChildByName(a).setVisible(!1)},showButton:function(a){this.getChildByName(a).setVisible(!0)},updateButtonCanEate:function(){this.showButton(MGPhomButtons.BUTTON_NAME.AN)},updateButtonHaveU:function(){this.showButton(MGPhomButtons.BUTTON_NAME.U)},resetButtonXepBai:function(){this.getChildByName(MGPhomButtons.BUTTON_NAME.XEP_BAI).setPosition(this.xepBaiPos)},moveButtonXepBai:function(){var a=
this.getChildByName(MGPhomButtons.BUTTON_NAME.BOC).getPosition();this.getChildByName(MGPhomButtons.BUTTON_NAME.XEP_BAI).setPosition(a)},updateButtonOnGameData:function(a,b,d,e,f){this.resetButtonXepBai();for(var g=!1,h=0;h<d.length;h++)d[h].UserID==MGGameInfo.myInfo.UserID&&(g=!0);switch(b){case ConstantsVariable.ACTION.EATORGET_CARD:this.hideAll();a==MGGameInfo.myInfo.UserID&&this.showButton(MGPhomButtons.BUTTON_NAME.BOC);this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);break;case ConstantsVariable.ACTION.DOWN_CARD:this.hideAll();
a==MGGameInfo.myInfo.UserID&&this.showButton(MGPhomButtons.BUTTON_NAME.DANH);this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);break;case ConstantsVariable.ACTION.DOWN_PHOM:this.hideAll();this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);a==MGGameInfo.myInfo.UserID&&(this.showButton(MGPhomButtons.BUTTON_NAME.HA),this.showButton(MGPhomButtons.BUTTON_NAME.HA_TUDONG),this.moveButtonXepBai());break;case ConstantsVariable.ACTION.DOWNORSEND_CARD:this.hideAll();a==MGGameInfo.myInfo.UserID&&(1===e&&this.showButton(MGPhomButtons.BUTTON_NAME.GUI),
this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI),this.showButton(MGPhomButtons.BUTTON_NAME.DANH));break;default:this.hideAll()}a==MGGameInfo.myInfo.UserID&&1==f&&this.showButton(MGPhomButtons.BUTTON_NAME.U);0==g&&this.hideAll()},updateButtonByNextPlay:function(a){var b=a.UserID;a=a.NextAction;this.resetButtonXepBai();switch(a){case ConstantsVariable.ACTION.EATORGET_CARD:this.hideAll();b==MGGameInfo.myInfo.UserID&&this.showButton(MGPhomButtons.BUTTON_NAME.BOC);this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);
break;case ConstantsVariable.ACTION.DOWN_CARD:this.hideAll();b==MGGameInfo.myInfo.UserID&&this.showButton(MGPhomButtons.BUTTON_NAME.DANH);this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);break;case ConstantsVariable.ACTION.DOWN_PHOM:this.hideAll();this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);b==MGGameInfo.myInfo.UserID&&(this.showButton(MGPhomButtons.BUTTON_NAME.HA),this.showButton(MGPhomButtons.BUTTON_NAME.HA_TUDONG),this.moveButtonXepBai());break;case ConstantsVariable.ACTION.DOWNORSEND_CARD:this.hideAll();
this.showButton(MGPhomButtons.BUTTON_NAME.XEP_BAI);b==MGGameInfo.myInfo.UserID&&this.showButton(MGPhomButtons.BUTTON_NAME.DANH);break;default:this.hideAll()}this.mainGame.phomController.haveU&&(this.mainGame.phomController.haveU=!1,this.showButton(MGPhomButtons.BUTTON_NAME.U));0>=MGGameBoardPhom.myUser.boxCardOwner._listMyCard.length&&this.hideAll()},showSendCard:function(){this.showButton(MGPhomButtons.BUTTON_NAME.GUI)},hideU:function(){this.hideButton(MGPhomButtons.BUTTON_NAME.U)},onClickBtnFromCocostudio:function(a,
b){mg.audio.playEffect(ResourceManager.MGResourcesGamePhom.DanhSound,MGGameInfo.gameVolume);switch(a.getName()){case MGPhomButtons.BUTTON_NAME.BOC:this.mainGame.netSend.sendPicCard();break;case MGPhomButtons.BUTTON_NAME.DANH:1==MGGameBoardPhom.listSelectedCards.length&&this.mainGame.netSend.sendDownCard();break;case MGPhomButtons.BUTTON_NAME.AN:this.mainGame.netSend.sendEatCard();break;case MGPhomButtons.BUTTON_NAME.XEP_BAI:MGGameBoardPhom.myUser.boxCardOwner.shortListCard(!0);break;case MGPhomButtons.BUTTON_NAME.HA:this.mainGame.netSend.sendCardDownPhom();
break;case MGPhomButtons.BUTTON_NAME.GUI:this.mainGame.netSend.sendCad();break;case MGPhomButtons.BUTTON_NAME.HA_TUDONG:this.mainGame.netSend.sendAutoDownPhom();break;case MGPhomButtons.BUTTON_NAME.U:this.mainGame.netSend.sendRequestU()}}});MGPhomButtons.BUTTON_NAME={U:"MGButton_U",AN:"MGButton_An",XEP_BAI:"MGButton_XepBai",DANH:"MGButton_Danh",GUI:"MGButton_Gui",HA_TUDONG:"MGButton_HaTuDong",HA:"MGButton_Ha",BOC:"MGButton_Boc"};var MGPhomCompoEffect=MGBaseNode.extend({ListEffect:null,timeOutHideEffect:null,fxChonBaiHa:null,fxChonBaiGui:null,fxVanMoi:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.ListEffect=[];this.timeOutHideEffect=[];for(var a,b,d=1;5>d;d++)this.ListEffect[d]={},b=this.getChildByName("EffectPos"+d).getPosition(),a=new sp.SkeletonAnimation(ResourceManager.MGResourcesGamePhom.Thang_Json,ResourceManager.MGResourcesGamePhom.Thang_Atlas),
this.addChild(a),a.setPosition(b),this.ListEffect[d].fxThang=a,a=new sp.SkeletonAnimation(ResourceManager.MGResourcesGamePhom.Thua_Json,ResourceManager.MGResourcesGamePhom.Thua_Atlas),this.addChild(a),a.setPosition(b),this.ListEffect[d].fxThua=a,a=new cc.Sprite,a.setSpriteFrame("DongHoa.png"),this.addChild(a),a.setPosition(b.x,b.y-40),a.setVisible(!1),this.ListEffect[d].fxDongHoa=a,a=new cc.Sprite,a.setSpriteFrame("DongHoaTrang.png"),this.addChild(a),a.setPosition(b.x,b.y-40),a.setVisible(!1),this.ListEffect[d].fxDongHoaTrang=
a,a=new cc.Sprite,a.setSpriteFrame("Den.png"),this.addChild(a),a.setPosition(b.x,b.y-40),a.setVisible(!1),this.ListEffect[d].fxDen=a,a=new cc.Sprite,a.setSpriteFrame("U.png"),this.addChild(a),a.setPosition(b.x,b.y-40),a.setVisible(!1),this.ListEffect[d].fxU=a,a=new cc.Sprite,a.setSpriteFrame("UK.png"),this.addChild(a),a.setPosition(b.x,b.y-40),a.setVisible(!1),this.ListEffect[d].fxUK=a,a=new cc.Sprite,a.setSpriteFrame("UTron.png"),this.addChild(a),a.setPosition(b.x,b.y-40),a.setVisible(!1),this.ListEffect[d].fxUTron=
a,a=new cc.Sprite,a.setSpriteFrame("AnChot.png"),this.addChild(a),a.setPosition(b.x+35,b.y+25),a.setVisible(!1),this.ListEffect[d].fxAnChot=a,a=new cc.Sprite,a.setSpriteFrame("HaDau.png"),this.addChild(a),a.setPosition(b.x-35,b.y+25),a.setVisible(!1),a.setScale(.7),this.ListEffect[d].fxHaDau=a,a=new cc.Sprite,a.setSpriteFrame("Nhat.png"),this.addChild(a),a.setPosition(b),a.setVisible(!1),this.ListEffect[d].fxNhat=a,a=new cc.Sprite,a.setSpriteFrame("Mom.png"),this.addChild(a),a.setPosition(b.x,b.y-
40),a.setVisible(!1),this.ListEffect[d].fxMom=a,a=new cc.Sprite,a.setSpriteFrame("Nhi.png"),this.addChild(a),a.setPosition(b),a.setVisible(!1),this.ListEffect[d].fxNhi=a,a=new cc.Sprite,a.setSpriteFrame("Ba.png"),this.addChild(a),a.setPosition(b),a.setVisible(!1),this.ListEffect[d].fxBa=a,a=new cc.Sprite,a.setSpriteFrame("Bet.png"),this.addChild(a),a.setPosition(b),a.setVisible(!1),this.ListEffect[d].fxBet=a;this.initEffect();this.hideAllPhomEffect();this._initEventsGame()},initEffect:function(){var a=
this.getChildByName("BaseEffectPos").getPosition();this.fxChonBaiHa=new cc.Sprite;this.fxChonBaiHa.setSpriteFrame("KhongChonBaiHa.png");this.fxChonBaiHa.setPosition(a);this.fxChonBaiHa.setVisible(!1);this.addChild(this.fxChonBaiHa);this.fxChonBaiGui=new cc.Sprite;this.fxChonBaiGui.setSpriteFrame("KhongGuiDuocBai.png");this.fxChonBaiGui.setPosition(a);this.fxChonBaiGui.setVisible(!1);this.addChild(this.fxChonBaiGui);this.fxVanMoi=new sp.SkeletonAnimation(ResourceManager.MGResourcesGamePhom.FXVanMoi_Json,
ResourceManager.MGResourcesGamePhom.FXVanMoi_Atlas);this.fxVanMoi.setPosition(a);this.fxVanMoi.setVisible(!1);this.addChild(this.fxVanMoi)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_THANG,this._playEffectThang.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_THUA,this._playEffectThua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_BaseEffectAutoHide,
this._playEffectAutoHide.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_HIDEALL,this.hideAllPhomEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_DONGHOA,this._playEffectDongHoa.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_DONGHOATRANG,this._playEffectDongHoaTrang.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_DEN,
this._playEffectDen.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_U,this._playEffectU.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_UK,this._playEffectUK.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_UTRON,this._playEffectUTron.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_ANCHOT,
this._playEffectAnChot.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_HADAU,this._playEffectHaDau.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_FX_RANKING,this._playEffectUserRanking.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_VAN_MOI,this._playEffectVanMoi.bind(this)))},_playEffectThang:function(a){a=a.getUserData();if(a=MGGameBoardPhom.listUser[a.UserID])this.ListEffect[a.Index].fxThang.setAnimation(0,
"thang",!1),this.ListEffect[a.Index].fxThang.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this._hideEffect.bind(this,this.ListEffect[a.Index].fxThang),4E3))},_playEffectThua:function(a){a=a.getUserData();var b=MGGameBoardPhom.listUser[a.UserID];b&&(this.ListEffect[b.Index].fxThua.setAnimation(0,"thua",!0),this.ListEffect[b.Index].fxThua.setVisible(!0),-1===a.typeU&&this.ListEffect[b.Index].fxDen.setVisible(!0))},_playEffectDongHoa:function(a){a=a.getUserData();if(a=MGGameBoardPhom.listUser[a.UserID])this.ListEffect[a.Index].fxDongHoa.setVisible(!0),
this.timeOutHideEffect.push(setTimeout(this._hideEffect.bind(this,this.ListEffect[a.Index].fxDongHoa),4E3))},_playEffectDongHoaTrang:function(a){a=a.getUserData();(a=MGGameBoardPhom.listUser[a.UserID])&&this.ListEffect[a.Index].fxDongHoaTrang.setVisible(!0)},_playEffectU:function(a){a=a.getUserData();(a=MGGameBoardPhom.listUser[a.UserID])&&this.ListEffect[a.Index].fxU.setVisible(!0)},_playEffectUK:function(a){a=a.getUserData();(a=MGGameBoardPhom.listUser[a.UserID])&&this.ListEffect[a.Index].fxUK.setVisible(!0)},
_playEffectUTron:function(a){a=a.getUserData();(a=MGGameBoardPhom.listUser[a.UserID])&&this.ListEffect[a.Index].fxUTron.setVisible(!0)},_playEffectDen:function(a){a=a.getUserData();(a=MGGameBoardPhom.listUser[a.UserID])&&this.ListEffect[a.Index].fxDen.setVisible(!0)},_playEffectAnChot:function(a){a=a.getUserData();if(a=MGGameBoardPhom.listUser[a.UserID])this.ListEffect[a.Index].fxAnChot.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this._hideEffect.bind(this,this.ListEffect[a.Index].fxAnChot),
4E3))},_playEffectHaDau:function(a){a=a.getUserData();a=MGGameBoardPhom.listUser[a.UserID];for(var b=1;5>b;b++)this.ListEffect[b].fxHaDau.setVisible(!1);a&&this.ListEffect[a.Index].fxHaDau.setVisible(!0)},_playEffectUserRanking:function(a){a=a.getUserData();var b=MGGameBoardPhom.listUser[a.UserID];if(b){var d=this.ListEffect[b.Index].fxBet;switch(a.FinishRank){case 1:d=this.ListEffect[b.Index].fxNhat;break;case 2:d=this.ListEffect[b.Index].fxNhi;break;case 3:d=this.ListEffect[b.Index].fxBa}d.setVisible(!0);
3<=a.UK?(this.ListEffect[b.Index].fxUK.setVisible(!0),d.setVisible(!1)):1==a.DongHoa?(this.ListEffect[b.Index].fxDongHoa.setVisible(!0),d.setVisible(!1)):2==a.DongHoa?(this.ListEffect[b.Index].fxDongHoaTrang.setVisible(!0),d.setVisible(!1)):0<a.Mom?(d.setVisible(!1),b.Mom=!0,this.ListEffect[b.Index].fxMom.setVisible(!0),cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_HIDE_SOCCER_MOM,{UserID:b.UserID})):b.Mom=!1}},_playEffectVanMoi:function(a){this.fxVanMoi.setVisible(!0);this.fxVanMoi.setAnimation(0,
"animation",!1)},_playEffectAutoHide:function(a){a=this[a.getUserData()];a.setVisible(!0);this.timeOutHideEffect.push(setTimeout(this._hideEffect.bind(this,a),1E3))},_hideEffect:function(a){a.setVisible(!1)},hideAllPhomEffect:function(){this.fxChonBaiHa.setVisible(!1);this.fxChonBaiGui.setVisible(!1);this.fxVanMoi.setVisible(!1);for(var a=1;5>a;a++)this.ListEffect[a].fxThang.setVisible(!1),this.ListEffect[a].fxThua.setVisible(!1),this.ListEffect[a].fxBet.setVisible(!1),this.ListEffect[a].fxAnChot.setVisible(!1),
this.ListEffect[a].fxNhat.setVisible(!1),this.ListEffect[a].fxNhi.setVisible(!1),this.ListEffect[a].fxBa.setVisible(!1),this.ListEffect[a].fxUTron.setVisible(!1),this.ListEffect[a].fxU.setVisible(!1),this.ListEffect[a].fxUK.setVisible(!1),this.ListEffect[a].fxDongHoa.setVisible(!1),this.ListEffect[a].fxDongHoaTrang.setVisible(!1),this.ListEffect[a].fxHaDau.setVisible(!1),this.ListEffect[a].fxDen.setVisible(!1),this.ListEffect[a].fxMom.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);
for(var a=0;a<this.timeOutHideEffect.length;a++)this.timeOutHideEffect[a]&&clearTimeout(this.timeOutHideEffect[a])}});
MGPhomCompoEffect.EVENT={PHOM_FX_THANG:"PHOM_FX_THANG",PHOM_FX_THUA:"PHOM_FX_THUA",PHOM_FX_HIDEALL:"PHOM_FX_HIDEALL",PHOM_FX_BaseEffectAutoHide:"PHOM_FX_BaseEffectAutoHide",PHOM_FX_DONGHOA:"PHOM_FX_DONGHOA",PHOM_FX_DONGHOATRANG:"PHOM_FX_DONGHOATRANG",PHOM_FX_DEN:"PHOM_FX_DEN",PHOM_FX_U:"PHOM_FX_U",PHOM_FX_UK:"PHOM_FX_UK",PHOM_FX_UTRON:"PHOM_FX_UTRON",PHOM_FX_ANCHOT:"PHOM_FX_ANCHOT",PHOM_FX_HADAU:"PHOM_FX_HADAU",PHOM_FX_RANKING:"PHOM_FX_RANKING",PHOM_HIDE_SOCCER_MOM:"PHOM_HIDE_SOCCER_MOM",PHOM_VAN_MOI:"PHOM_VAN_MOI"};
MGPhomCompoEffect.EFFECT={PHOM_FX_HABAI:"fxChonBaiHa",PHOM_FX_GUIBAI:"fxChonBaiGui"};var MGPhomContainUsers=MGBaseNode.extend({_listUser:[],mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initListUser();this._initEventsGame();this.initEvents()},_initListUser:function(){this._listUser=[];for(var a,b=1;5>b;b++)a=new MGUserPhom,a.cloneFromNode(this.getChildByName("MGPosition_"+b)),a.initObj(b,this.mainGame),this.addChild(a),this._listUser.push(a)},initEvents:function(){this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.ListUser.toString(),
this.ngListUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.UserLeave.toString(),this.ngUserLeave.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.AddUser.toString(),this.ngAddUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("UPDATE_USER_COIN",this.ngUpdateCoin.bind(this)))},resetUsers:function(){for(var a=0;a<this._listUser.length;a++)this._listUser[a].resetForNewMatch()},
ngListUsers:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);this.updateMyPosition(a.ListUser);this.addListUser(a.ListUser)},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);
this.userLeave(a.ListUser)},ngAddUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8};a=(new BinaryParser).initObj(b,a.content);a.Index=this.getIndexByPosition(a.Position);this.addUser(a)},addUser:function(a){var b=this.getCompoUserByIndex(a.Index);b&&(b.updateInfoUser(a),MGGameBoardPhom.listUser[a.UserID]=b,a.UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardPhom.myUser=b))},addListUser:function(a){for(var b in a)a[b].Index=
this.getIndexByPosition(a[b].Position),this.addUser(a[b])},userLeave:function(a){var b=0,d=a.length;for(b;b<d;b++)this.removeUser(a[b])},removeUser:function(a){MGGameBoardPhom.listUser[a]&&(MGGameBoardPhom.listUser[a].updateUserLeave(),delete MGGameBoardPhom.listUser[a])},getCompoUserByIndex:function(a){return this._listUser[a-1]},getIndexByPosition:function(a){return(a-MGGameBoardPhom.my.position+4)%4+1},updateMyPosition:function(a){for(var b in a)a[b].UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardPhom.my.position=
a[b].Position)},nextPlayer:function(a){this.stopAllClock();MGGameBoardPhom.listUser[a.UserID]&&MGGameBoardPhom.listUser[a.UserID].compoUserInfo.runActionEffect(MGGameBoardPhom.timeOut)},updateUserActive:function(a,b){this.stopAllClock();MGGameBoardPhom.listUser[a]&&MGGameBoardPhom.listUser[a].compoUserInfo.runActionEffect(b)},stopAllClock:function(){var a=0,b=this._listUser.length;for(a;a<b;a++)this._listUser[a].compoUserInfo.stopActionEffect()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);
for(var a=0;a<this._listUser.length;a++)this._listUser[a].setDispose()},ngUpdateCoin:function(a){a=a.getUserData().target;for(var b=0;b<a.length;b++)MGGameBoardPhom.listUser[a[b].UserID]&&MGGameBoardPhom.listUser[a[b].UserID].compoUserInfo.setUserGold(a[b].Coin)}});var MGPhomMyBoxCard=MGBaseNode.extend({_listMyCard:null,_listMyCardID:null,listIdCardEat:null,posBoxCardOwnerX:369,posBoxCardOwnerY:193,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._listMyCard=[];this._listMyCardID=[];this.listIdCardEat=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this)},addListCard:function(a){this._listMyCardID=a;var b=0,d=a.length,e;for(b;b<d;b++)if(e=MGGameBoardPhom.getCardByID(a[b]))this.addChild(e),e.setLocalZOrder(b),e.setPosition(cc.p(b*MGPhomMyBoxCard.CARD_SIZE+
this.posBoxCardOwnerX,this.posBoxCardOwnerY)),e.pX=e.getPositionX(),e.pY=e.getPositionY(),e.setEventEnable(!0),cc.sys.isNative||e.setTouchEnabled(!0),this._listMyCard.push(e)},pickCard:function(a){var b=MGGameBoardPhom.getCardByID(a);b&&(b.setPosition(ConstantsVariable.BAI_TY_POS),b.setScale(.8),this.addChild(b),this._listMyCard.push(b),this._listMyCardID.push(a),b.pX=(this._listMyCard.length-1)*MGPhomMyBoxCard.CARD_SIZE+this.posBoxCardOwnerX,b.pY=this.posBoxCardOwnerY,b.runAction(cc.sequence(cc.moveTo(.3,
cc.p(b.pX,b.pY)),cc.delayTime(.1),cc.callFunc(function(){b.resetCard();b.setEventEnable(!0);cc.sys.isNative||b.setTouchEnabled(!0)}.bind(this)))),b.runAction(cc.scaleTo(.3,1)),b.setLocalZOrder(this._listMyCard.length+100))},haPhom:function(a){this.listIdCardEat.length=0;MGGameBoardPhom.clearListSelect();for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.length;e++)this.removeCardNoShot(d[e]);this.shortListCard(!1)},removeCardsSend:function(a){for(var b=0;b<a.length;b++){var d=this._listMyCardID.indexOf(a[b]);
0<=d&&(MGGameBoardPhom.returnCard(this._listMyCard[d]),this._listMyCard.splice(d,1),this._listMyCardID.splice(d,1))}this.shortListCard(!1)},eatCard:function(a){var b=MGGameBoardPhom.getCardByID(a);this.listIdCardEat.push(a);this._listMyCard.push(b);this._listMyCardID.push(a);b.isBet=!0;this.addChild(b);b.setLocalZOrder(this._listMyCard.length+100);b.runAction(cc.sequence(cc.moveTo(.3,cc.p((this._listMyCard.length-1)*MGPhomMyBoxCard.CARD_SIZE+this.posBoxCardOwnerX,this.posBoxCardOwnerY)),cc.delayTime(.1),
cc.callFunc(function(){b.resetCard();b.setLock();b.setEventEnable(!0);cc.sys.isNative||b.setTouchEnabled(!0);this.shortListCard(!1)}.bind(this))));b.runAction(cc.scaleTo(.3,1))},resetListCard:function(){this.listIdCardEat.length=0;this._listMyCardID.length=0;for(var a=this._listMyCard.length,b=0;b<a;b++)MGGameBoardPhom.returnCard(this._listMyCard[b]);this._listMyCard.length=0},showCardSend:function(a){this.unselectListCard();for(var b=0;b<a.length;b++){var d=MGGameBoardPhom.getCardByID(a[b]);MGGameBoardPhom.Card=
d._idCard;MGGameBoardPhom.listSelectedCards.push(d._idCard);d.setPosition(cc.p(d.pX,d.pY));d.stopAllActions();d._isSelected=!0;d.setPosition(cc.p(d.getPositionX(),d.pY+MGPhomCard.DISTANCE_UP))}},unselectListCard:function(){for(var a=0;a<MGGameBoardPhom.listSelectedCards.length;a++){var b=this.getCardByID(MGGameBoardPhom.listSelectedCards[a]);b&&(b._isSelected=!1,b._isMove=!1,b.setPosition(cc.p(b.getPositionX(),b.pY)))}MGGameBoardPhom.clearListSelect()},getCardByID:function(a){for(var b=0;b<this._listMyCard.length;b++)if(this._listMyCard[b]._idCard===
a)return this._listMyCard[b];return null},removeListCard:function(a){for(var b=0;b<a.length;b++){MGGameBoardPhom.returnCard(a[b]);var d=this._listMyCard.indexOf(a[b]);this._listMyCard.splice(d,1);this._listMyCardID.splice(d,1)}this.shortListCard(!1)},removeCard:function(a){a=this._listMyCardID.indexOf(a);0<=a&&(MGGameBoardPhom.returnCard(this._listMyCard[a]),this._listMyCard.splice(a,1),this._listMyCardID.splice(a,1),this.shortListCard(!1))},removeCardNoShot:function(a){a=this._listMyCardID.indexOf(a);
0<=a&&(MGGameBoardPhom.returnCard(this._listMyCard[a]),this._listMyCard.splice(a,1),this._listMyCardID.splice(a,1))},shortListCard:function(a){MGGameBoardPhom.clearListSelect();a=this.getListPhomEat();var b=this.getListPhom(Array.spliceArray(this._listMyCardID,a)),d=Array.spliceArray(this._listMyCardID,a.concat(b)).sort(Array.ASC);this._listMyCardID=a.concat(b.concat(this.sortCardSingle(d)));a=this._listMyCardID.length;for(var d=[],e=0;e<a;e++)b=this.getCardByID(this._listMyCardID[e]),b.stopAllActions(),
b.setScale(1),b._isSelected=!1,b._isMove=!1,b.setEventEnable(!0),cc.sys.isNative||b.setTouchEnabled(!0),b.pX=e*MGPhomMyBoxCard.CARD_SIZE+this.posBoxCardOwnerX,b.pY=this.posBoxCardOwnerY,b.runAction(cc.moveTo(.1,cc.p(e*MGPhomMyBoxCard.CARD_SIZE+this.posBoxCardOwnerX,this.posBoxCardOwnerY))),b.setLocalZOrder(100+e),d.push(b);this._listMyCard=d},getListPhomEat:function(){switch(this.listIdCardEat.length){case 0:case 2:return[];case 1:return this.getListPhomEatByCardID(this._listMyCardID,this.listIdCardEat[0])[0].sort(Array.ASC);
default:return[]}},getListPhomEatByCardID:function(a,b){a.sort(Array.ASC);var d=[],e=this.getPhomSanhByCardID(b,a).sort(Array.ASC);0<e.length&&d.push(e);e=this.getPhomXamCoByCardID(b,a);0<e.length&&d.push(e);return d},getPhomSanhByCardID:function(a,b){var d=[],e=1;for(d.push(a);0<=b.indexOf(a+4*e);)d.push(a+4*e),e++;for(e=1;0<=b.indexOf(a-4*e);)d.push(a-4*e),e++;return 2<d.length?d:[]},getPhomXamCoByCardID:function(a,b){var d=[],e=0;for(e;e<b.length;e++)GameRule.GetCard(b[e])==GameRule.GetCard(a)&&
d.push(b[e]);return 2<d.length?d:[]},getListPhom:function(a){var b=this.getPhomSanh(a);return b?(a=this.getPhomXamCo(Array.spliceArray(a,b)))?b.concat(a):b:(a=this.getPhomXamCo(a))?a:[]},getPhomSanh:function(a){if(3>a.length)return null;var b=GameRule.GetDAYs(GameRule.TachBai(a,GameRule._CO));if(0<b.length)return b[0].sort(Array.ASC);b=GameRule.GetDAYs(GameRule.TachBai(a,GameRule._RO));if(0<b.length)return b[0].sort(Array.ASC);b=GameRule.GetDAYs(GameRule.TachBai(a,GameRule._CHUON));if(0<b.length)return b[0].sort(Array.ASC);
b=GameRule.GetDAYs(GameRule.TachBai(a,GameRule._BICH));return 0<b.length?b[0].sort(Array.ASC):null},getPhomXamCo:function(a){if(3>a.length)return null;var b=GameRule.GetTuQuys(a);if(0<b.length)return b[0];a=GameRule.GetBas(a);return 0<a.length?a[0]:null},sortCardSingle:function(a){var b=[],d=a.length,e=a.slice(0);e.sort(Array.ASC);for(a=0;a<d-1;a++)GameRule.GetCard(e[a])==GameRule.GetCard(e[a+1])&&(b.push(e[a]),b.push(e[a+1])),0<=e.indexOf(e[a]+4)&&(b.push(e[a]),b.push(e[a]+4)),0<=e.indexOf(e[a]+
8)&&(b.push(e[a]),b.push(e[a]+8));b.sort(Array.ASC);b=Array.trimArray(b);return b=b.concat(Array.spliceArray(e,b))},updateGameData:function(a,b,d){this.addListCard(a);this.updateCardEate(b);0<d.length&&this.showCardSend(d)},updateCardEate:function(a){for(var b=0;b<a.length;b++)MGGameBoardPhom.getCardByID(a[b]).setLock()},resetForNewMatch:function(){for(var a=0;a<this._listMyCard.length;a++)MGGameBoardPhom.returnCard(this._listMyCard[a]);this.removeAllChildren(!0);this._listMyCard.length=0;this._listMyCardID.length=
0}});MGPhomMyBoxCard.CARD_SIZE=43;var MGPhomCard=MGBaseSprite.extend({_idCard:0,_isSelected:!1,_isMove:!1,lock:!1,isBet:!1,_spriteLock:null,pX:0,pY:0,_eventEnable:!1,ctor:function(){MGBaseSprite.prototype.ctor.call(this);this._initEventsGame()},initObj:function(a){this.setSpriteFrame("card"+a+".png");this.setName("MGCard"+a+".png");this.setTouchEnabled(!0);this.addClickEventListener(this._onCardClick.bind(this));this._idCard=MGGameBoardPhom.Cards.length},moveDown:function(){if(this._isSelected&&!this._isMove){this._isMove=!0;this._removeCards(this._idCard);
var a=cc.sequence(cc.moveTo(.1,cc.p(this.getPositionX(),this.pY)),cc.callFunc(function(){this._isMove=this._isSelected=!1}.bind(this)));this.runAction(a)}},moveUp:function(){if(0==this._isMove&&0==this._isSelected){this._isMove=!0;MGGameBoardPhom.Card=this._idCard;MGGameBoardPhom.listSelectedCards.push(this._idCard);this.setPositionY(this.pY);var a=cc.sequence(cc.moveTo(.1,cc.p(this.getPositionX(),this.pY+MGPhomCard.DISTANCE_UP)),cc.callFunc(function(){this._isSelected=!0;this._isMove=!1}.bind(this)));
this.runAction(a)}},setLock:function(){this.lock=!0;null==this._spriteLock&&(this._spriteLock=new cc.Sprite,this._spriteLock.setSpriteFrame("Stoke.png"),this._spriteLock.setPosition(cc.p(this._spriteLock.getContentSize().width/2-2,this._spriteLock.getContentSize().height/2-2)),this.addChild(this._spriteLock));this._spriteLock.setVisible(!0)},resetCard:function(){this._eventEnable=this.isBet=this._isMove=this.lock=this._isSelected=!1;null!=this._spriteLock&&this._spriteLock.setVisible(!1);this.setRotation(0);
this.setScale(1);this.setColor(cc.color(255,255,255,255))},moveUpDown:function(){this._eventEnable&&0==this._isMove&&(0==this._isSelected?this.moveUp():this.moveDown())},_removeCards:function(a){0<MGGameBoardPhom.listSelectedCards.length&&(a=MGGameBoardPhom.listSelectedCards.indexOf(a),MGGameBoardPhom.listSelectedCards.splice(a,1))},_onCardClick:function(a){this.moveUpDown()},setEventEnable:function(a){this._eventEnable=a}});MGPhomCard.DISTANCE_UP=40;var MGNetSendPhom=cc.Class.extend({gameModuleID:null,ctor:function(){},sendDownCard:function(){var a={};a.Card=MGGameBoardPhom.Card;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.DownCard,{Card:BinaryConstants.DataTypeID.UInt8},a);MGNetCore.MGSocket.sendMsg(a)},sendCardDownPhom:function(){var a={};a.ListCards=MGGameBoardPhom.listSelectedCards;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.DownPhom,{ListCards:BinaryConstants.DataTypeID.Array8,
ListCards_Type:BinaryConstants.DataTypeID.UInt8},a);MGNetCore.MGSocket.sendMsg(a)},sendAutoDownPhom:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.UserReqAutoDownPhom,null,null);MGNetCore.MGSocket.sendMsg(a)},sendCad:function(){var a={};a.ListCards=MGGameBoardPhom.listSelectedCards;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.SendCard,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8},
a);MGNetCore.MGSocket.sendMsg(a)},sendPicCard:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.GetCard,null,null);MGNetCore.MGSocket.sendMsg(a)},sendEatCard:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.EatCard,null,null);MGNetCore.MGSocket.sendMsg(a)},sendRequestU:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.UserReqU,null,null);MGNetCore.MGSocket.sendMsg(a)},
sendToolU:function(a,b){var d={};d.ListCards=a;d.Kind=b;d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_PHOM.Tool,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8,Kind:BinaryConstants.DataTypeID.UInt8},d);MGNetCore.MGSocket.sendMsg(d)}});var MGPhomController=MGBaseNode.extend({containCardDown:null,mainGame:null,cardGroundNode:null,listBoxCard:null,listCardUp:null,dealer:null,compoChiaBai:null,boxCardCenter:null,listScoreInfo:null,spriteError:null,textCardRoot:null,haveU:!1,nodeEffectCard:null,clearUITimeOut:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initUI();this.initEvents();this.initCompoChiaBai();this.initCards();this.intBoxCardCenter();
this._initDealer()},_initUI:function(){this.cardGroundNode=new cc.Node;this.addChild(this.cardGroundNode);this.listBoxCard=[];this.listCardUp=[];this.listScoreInfo=[];this.containCardDown=new cc.Sprite;this.addChild(this.containCardDown);this.spriteError=new cc.Sprite;this.spriteError.setSpriteFrame("BaiKoHopLe.png");this.spriteError.setPosition(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2);this.addChild(this.spriteError,100);this.spriteError.setVisible(!1);this.nodeEffectCard=new cc.Node;
this.addChild(this.nodeEffectCard)},intBoxCardCenter:function(){this.boxCardCenter=new cc.Sprite;this.boxCardCenter.setSpriteFrame("card52.png");this.boxCardCenter.setPosition(this.getChildByName("MGBoxCardRoot").getPosition());this.boxCardCenter.setScale(.8);this.boxCardCenter.setVisible(!1);this.addChild(this.boxCardCenter);this.textCardRoot=new cc.LabelTTF("00","Arial",30);this.textCardRoot.setPosition(this.getChildByName("MGBoxCardRoot").getPosition());this.textCardRoot.setVisible(!1);this.addChild(this.textCardRoot)},
initCards:function(){MGGameBoardPhom.Cards=[];var a;for(a=0;52>a;a++){var b=new MGPhomCard;b.initObj(a);MGGameBoardPhom.Cards.push(b);b.retain()}b=new MGPhomCard;b.initObj(52);MGGameBoardPhom.Cards.push(b);b.retain()},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.DownCard.toString(),this.ngDownCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.UserU.toString(),
this.ngUserU.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.GetCard.toString(),this.ngGetCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.EatCard.toString(),this.ngEatCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.ShowCardSend.toString(),this.ngShowCardSend.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.SendCard.toString(),
this.ngSendCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.ShowCanEat.toString(),this.ngShowCanEat.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.UserHaveU.toString(),this.ngUserHaveU.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.DownPhom.toString(),this.ngDownPhom.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.ShowCardsEndMatch.toString(),
this.ngShowCardsEndMatch.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.ResultMoney.toString(),this.ngResultMoney.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.ErrorResponse.toString(),this.ngErrorResponse.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.FINISH,this.ngFinishRand.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGPhomCompoEffect.EVENT.PHOM_HIDE_SOCCER_MOM,
this.hideSoccerMom.bind(this)))},_initDealer:function(){this.dealer=new sp.SkeletonAnimation(ResourceManager.MGResourcesGamePhom.Dealer_Json,ResourceManager.MGResourcesGamePhom.Dealer_Atlas);this.dealer.setScale(4);var a=this.getChildByName("MGDealer").getPosition();this.dealer.setPosition(cc.p(a.x,a.y-15));this.addChild(this.dealer,0);this.dealer.setAnimation(0,"Idle",!0)},pickCard:function(a,b){var d=MGGameBoardPhom.listUser[b];d&&d.pickCard(a,b)},randCard:function(a){null!=this.clearUITimeOut&&
clearTimeout(this.clearUITimeOut);this.clearUI();this.boxCardCenter.setVisible(!1);this.textCardRoot.setString(a.RemainCard);this.textCardRoot.setVisible(!1);var b=[],d=[],e;for(e in MGGameBoardPhom.listUser)MGGameBoardPhom.listUser[e].isPlaying=!0,b.push(MGGameBoardPhom.listUser[e].getPositionDearCard()),d.push([52,52,52,52,52,52,52,52,52,52,52,52,52]);MGGameBoardPhom.myUser.boxCardOwner.addListCard(a.ListCard);MGGameBoardPhom.myUser.boxCardOwner.setVisible(!1);this.compoChiaBai.playEffect(b,d,.5);
this.dealer.setAnimation(0,"DealCard",!0);mg.audio.playEffect(ResourceManager.MGResourcesGamePhom.ChiaBaiSound,MGGameInfo.gameVolume)},initCompoChiaBai:function(){this.compoChiaBai=new CompoChiaBai;var a=this.getChildByName("MGDealer").getPosition();this.compoChiaBai.initObj(MGGameBoardPhom.CARD_WIDTH,MGGameBoardPhom.CARD_HEIGHT,cc.p(a.x,a.y-50),.05);this.addChild(this.compoChiaBai)},ngResultMoney:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListResult:b.Array8,ListResult_Type:b.Object8,
ListResult_Type_Struct:{UserID:b.UInt32,CoinWinLose:b.Int64,FinishRank:b.Int8,UK:b.Int8,DongHoa:b.Int8,Coin:b.UInt64,Mom:b.Int8,typeU:b.Int8}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.ListResult.length;b++)0==MGGameBoardPhom.haveU?cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_RANKING,a.ListResult[b]):0>a.ListResult[b].CoinWinLose&&cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_THUA,a.ListResult[b]),MGGameBoardPhom.listUser[a.ListResult[b].UserID].compoUserInfo.showEffectGoldWinLose(a.ListResult[b].CoinWinLose);
this.mainGame.compoButtons.hideAll();this.mainGame.compoUsers.stopAllClock();cc.eventManager.dispatchCustomEvent("UPDATE_USER_COIN",{target:a.ListResult})},ngErrorResponse:function(a){a=a.getUserData();var b={Type:BinaryConstants.DataTypeID.UInt8};(new BinaryParser).initObj(b,a.content);this._showErrorCard()},_showErrorCard:function(){this.spriteError.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2));this.spriteError.setOpacity(255);this.spriteError.setVisible(!0);this.spriteError.stopAllActions();
this.spriteError.runAction(cc.moveBy(.5,cc.p(0,30)));this.spriteError.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){this.spriteError.runAction(cc.fadeOut(3))}.bind(this))))},ngShowCardsEndMatch:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListInfo:b.Array8,ListInfo_Type:b.Object8,ListInfo_Type_Struct:{UserID:b.UInt32,CardPoint:b.UInt8,ListPhoms:b.Array8,ListPhoms_Type:b.Array8,ListPhoms_Type_Type:b.UInt8,ListCards:b.Array8,ListCards_Type:b.UInt8}};a=(new BinaryParser).initObj(b,
a.content).ListInfo;for(var b=0,d,e=0;e<a.length;e++)d=MGGameBoardPhom.listUser[a[e].UserID],d.openAllCardFinish(a[e].UserID,a[e].ListCards),0==a[e].CardPoint&&(b=1);if(0===b)for(e=0;e<a.length;e++)d=MGGameBoardPhom.listUser[a[e].UserID],d.showScore(a[e].CardPoint);this.clearUITimeOut=setTimeout(function(){this.clearUI()}.bind(this),5E3)},ngUserHaveU:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Visible:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngUserHaveU "+
JSON.stringify(a));a.UserID==MGGameInfo.myInfo.UserID&&1==a.Visible&&(this.haveU=!0,this.mainGame.compoButtons.updateButtonHaveU())},ngShowCanEat:function(a){this.mainGame.compoButtons.updateButtonCanEate()},ngDownPhom:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserIDSend:b.UInt32,Info:b.Array8,Info_Type:b.Array8,Info_Type_Type:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardPhom.listUser[a.UserIDSend].haPhom(a.Info,a.UserIDSend)},ngShowCardSend:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCards:b.Array8,ListCards_Type:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardPhom.myUser.boxCardOwner.showCardSend(a.ListCards);this.mainGame.compoButtons.showSendCard()},ngSendCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserIDSend:b.UInt32,ListCardSend:b.Array8,ListCardSend_Type:b.UInt8,Info:b.Array8,Info_Type:b.Object8,Info_Type_Struct:{UserID:b.UInt32,ListPhom:b.Array8,ListPhom_Type:b.Array8,ListPhom_Type_Type:b.UInt8}};
a=(new BinaryParser).initObj(b,a.content);b=a.Info;a.UserIDSend==MGGameInfo.myInfo.UserID&&(MGGameBoardPhom.clearListSelect(),MGGameBoardPhom.myUser.boxCardOwner.removeCardsSend(a.ListCardSend));for(var d=0;d<b.length;d++)MGGameBoardPhom.listUser[b[d].UserID].updateListPhomSend(b[d].ListPhom);Utilities.showLog("----send card: "+JSON.stringify(a))},ngEatCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserIDEat:b.UInt32,CardEat:b.UInt8,UserIDBeEaten:b.UInt32,CardMove:b.Int8,LastUserKeepFlag:b.UInt32,
NextUserKeepFlag:b.UInt32};a=(new BinaryParser).initObj(b,a.content);b=MGGameBoardPhom.listUser[a.UserIDBeEaten];b.removeDownCard(a.CardEat);b=MGGameBoardPhom.listUser[a.UserIDEat];b.eatCard(a);this.moveNextCardInBoard(a.LastUserKeepFlag,a.UserIDBeEaten,a.CardMove);a.UserID=a.NextUserKeepFlag;cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_HADAU,a)},ngGetCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Card:b.UInt8,RemainCard:b.UInt8};a=(new BinaryParser).initObj(b,
a.content);this.pickCard(a.Card,a.UserID);this.textCardRoot.setString(a.RemainCard)},ngUserU:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,TypeU:b.UInt8,ListPhom:b.Array8,ListPhom_Type:b.Array8,ListPhom_Type_Type:b.UInt8};a=(new BinaryParser).initObj(b,a.content);b=a.TypeU;switch(b){case ConstantsVariable.Type_U.DEN:cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_DEN,a);break;case ConstantsVariable.Type_U.U_THUONG:cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_U,
a);break;case ConstantsVariable.Type_U.U_TRON:cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_UTRON,a)}if(a.userID==MGGameInfo.myInfo.UserID)switch(b){case ConstantsVariable.Type_U.DEN:mg.audio.playEffect(ResourceManager.MGResourcesGamePhom.MomDenSound,MGGameInfo.gameVolume);break;case ConstantsVariable.Type_U.U_THUONG:mg.audio.playEffect(ResourceManager.MGResourcesGamePhom.USound,MGGameInfo.gameVolume);break;case ConstantsVariable.Type_U.U_TRON:mg.audio.playEffect(ResourceManager.MGResourcesGamePhom.USound,
MGGameInfo.gameVolume)}MGGameBoardPhom.haveU=!0;this.mainGame.compoButtons.hideU();MGGameBoardPhom.listUser[a.UserID].haPhom(a.ListPhom,a.UserID)},ngDownCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Card:b.UInt8,IsDownPhomRound:b.UInt8,IsUserChotHaID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this.addDownCards(a.Card,a.UserID);this.haveU=!1;Utilities.showLog("----Down Card: "+JSON.stringify(a))},ngFinishRand:function(){this.boxCardCenter.setVisible(!0);
this.textCardRoot.setVisible(!0);MGGameBoardPhom.myUser.boxCardOwner.setVisible(!0);this.dealer.setAnimation(0,"Idle",!0);for(var a in MGGameBoardPhom.listUser)MGGameBoardPhom.listUser[a].isPlaying&&(MGGameBoardPhom.listUser[a].isPlaying=!1,MGGameBoardPhom.listUser[a].showCardBack())},clearUI:function(){MGGameBoardPhom.clearListSelect();this.mainGame.compoUsers.resetUsers();MGGameBoardPhom.myUser.boxCardOwner.resetListCard();this.nodeEffectCard.removeAllChildren(!0);this.boxCardCenter.setVisible(!1);
this.textCardRoot.setVisible(!1);cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_HIDEALL,0);cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_VAN_MOI)},addDownCards:function(a,b){var d=MGGameBoardPhom.listUser[b];d&&d.addDownCard(a,b)},updateGameData:function(a,b){this.boxCardCenter.setVisible(!0);this.textCardRoot.setVisible(!0);for(var d=0;d<a.length;d++)MGGameBoardPhom.listUser[a[d].UserID].updateGameData(a[d],b)},hideSoccerMom:function(a){a=a.getUserData();MGGameBoardPhom.listUser[a.UserID].hideScore()},
moveNextCardInBoard:function(a,b,d){0>d||(MGGameBoardPhom.listUser[a].removeDownCard(d),MGGameBoardPhom.listUser[b].addCardDownWhenEat(d))}});var MGPhom=MGBaseGame.extend({compoButtons:null,compoUsers:null,phomController:null,phomCompoEffect:null,netSend:null,_gameInfoContain:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGamePhom;Utilities.showLog("Phom ctor___________")},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.netSend=new MGNetSendPhom;this._initUI();this._initListUser();this._initController();this._initCompoButtons();this._initCompoEffect();this._initGameInfoContain()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGamePhom.MGUIPhomLayerJSON,
PreLoaderConfig.PathToResourceDefault)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.RandCard.toString(),this.ngRandCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_PHOM.NextPlayer.toString(),this.ngNextPlayer.bind(this)))},
_initListUser:function(){this.compoUsers=new MGPhomContainUsers;this.compoUsers.cloneFromNode(this._mainLayer.getChildByName("MGContainUser"));this.compoUsers.initObj(this);this.addChild(this.compoUsers)},_initController:function(){this.phomController=new MGPhomController;this.phomController.cloneFromNode(this._mainLayer.getChildByName("MGBoxCardNode"));this.phomController.initObj(this);this.addChild(this.phomController)},_initCompoButtons:function(){this.compoButtons=new MGPhomButtons;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGButtonCombo"));
this.compoButtons.initObj(this);this.compoButtons.hideAll();this.addChild(this.compoButtons)},_initCompoEffect:function(){this.phomCompoEffect=new MGPhomCompoEffect;this.phomCompoEffect.cloneFromNode(this._mainLayer.getChildByName("MGEffectPhom"));this.phomCompoEffect.initObj();this.addChild(this.phomCompoEffect)},_initGameInfoContain:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(35,670);this._gameInfoContain.setVisible(!1);this.addChild(this._gameInfoContain)},
ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,TimeRemain:b.UInt16,TimeOut:b.UInt16,MinCoin:b.UInt64,MatchID:b.UInt32,ActiveUser:b.UInt32,CurrentAction:b.UInt8,ListUserInfo:b.Array8,ListUserInfo_Type:b.Object8,ListUserInfo_Type_Struct:{UserID:b.UInt32,NumCardRemain:b.UInt8,ListCards:b.Array8,ListCards_Type:b.UInt8,EatCard:b.Array8,EatCard_Type:b.UInt8,ListCardsDown:b.Array8,ListCardsDown_Type:b.UInt8,ListPhomDown:b.Array8,ListPhomDown_Type:b.Array8,
ListPhomDown_Type_Type:b.UInt8},IsCanEatCard:b.UInt8,RemainCard:b.UInt8,CardsCanSend:b.Array8,CardsCanSend_Type:b.UInt8,ShowUButton:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardPhom.UserActive=a.ActiveUser;MGGameBoardPhom.timeOut=a.TimeOut;MGGameBoardPhom.GameStatus=a.Status;a.Status==ConstantsVariable.STATE_PHOM.PLAYING&&(this.compoUsers.updateUserActive(a.ActiveUser,a.TimeOut),this.phomController.updateGameData(a.ListUserInfo,a.CardsCanSend));cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_HIDEALL);
a.Status==ConstantsVariable.STATE_PHOM.NOT_START&&cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_VAN_MOI);this._gameInfoContain.setInfo("PHỎM",a.DeskID,a.MinCoin,a.MatchID);0<a.CardsCanSend.length?this.compoButtons.updateButtonOnGameData(a.ActiveUser,a.CurrentAction,a.ListUserInfo,1,a.ShowUButton):this.compoButtons.updateButtonOnGameData(a.ActiveUser,a.CurrentAction,a.ListUserInfo,0,a.ShowUButton);MGGameBoardPhom.isEndRound=a.IsEndRound;1===a.IsCanEatCard&&this.compoButtons.updateButtonCanEate();
a.UserID=a.ActiveUser;cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_HADAU,a);this.phomController.textCardRoot.setString(a.RemainCard);Utilities.showLog("---GameData: "+JSON.stringify(a))},ngRandCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCard:b.Array8,ListCard_Type:b.UInt8,PlayerGoFirstID:b.UInt32,MatchID:b.UInt32,RemainCard:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this.phomController.randCard(a);this._gameInfoContain.setMatchIdInfo(a.MatchID);
a.UserID=a.PlayerGoFirstID;cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_HIDEALL);cc.eventManager.dispatchCustomEvent(MGPhomCompoEffect.EVENT.PHOM_FX_HADAU,a);MGGameBoardPhom.haveU=!1;Utilities.showLog("---Rand card: "+JSON.stringify(a))},ngNextPlayer:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,NextAction:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameBoardPhom.UserActive=a.UserID;this.compoUsers.nextPlayer(a);this.compoButtons.updateButtonByNextPlay(a)},
setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardPhom.listUser={};MGGameBoardPhom.myUser=null;MGGameBoardPhom.clearListSelect();this.compoButtons&&(this.compoButtons.setDispose(),this.compoButtons.removeFromParent(!0),this.compoButtons=null);this.compoUsers&&(this.compoUsers.setDispose(),this.compoUsers.removeFromParent(!0),this.compoUsers=null);this.phomController&&(this.phomController.setDispose(),this.phomController.removeFromParent(!0),this.phomController=null);this.phomCompoEffect&&
(this.phomCompoEffect.setDispose(),this.phomCompoEffect.removeFromParent(!0),this.phomCompoEffect=null);this._gameInfoContain&&(this._gameInfoContain.setDispose(),this._gameInfoContain.removeFromParent(),this._gameInfoContain=null)}});ResourceManager.MGresourcesGameXiTo={Card52:"res/game/Cards/mat-sau.png",Dealer_Atlas:"res/game/taixiu/Effect/dealer_Blue.atlas",Dealer_PNG:"res/game/taixiu/Effect/dealer_Blue.png",Dealer_Json:"res/game/taixiu/Effect/dealer_Blue.json",AtlasCards:"res/game/Cards/AtlasCards.png",AtlasCardsPlist:"res/game/Cards/AtlasCards.plist",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",
Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",VanMoi_Atlas:"res/game/Components/EffectThangThua/vanmoi.atlas",VanMoi_PNG:"res/game/Components/EffectThangThua/vanmoi.png",VanMoi_Json:"res/game/Components/EffectThangThua/vanmoi.json",AtlasXiTo:"res/game/xito/AtlasXiTo/AtlasXiTo.png",PlistXiTo:"res/game/xito/AtlasXiTo/AtlasXiTo.plist",UIMGUIXiToLayer:"res/game/xito/UIXiToLayer.json",
UIMGUIXiToButtonsCombo:"res/game/xito/UIXiToButtonsCombo.json",UIMGUIXiToPositionCuoc:"res/game/xito/UITextPositionCuoc.json",MGUIPopupDonTay:"res/game/xito/UIXiToPopUpDonTay.json",FXVanMoi_Atlas:"res/game/tienlen/Effect/vanmoi.atlas",FXVanMoi_Json:"res/game/tienlen/Effect/vanmoi.json",FXVanMoi_png:"res/game/tienlen/Effect/vanmoi.png",CHIA_BAI:"res/game/xito/Sounds/ChiaBai.mp3",DANH:"res/game/xito/Sounds/Danh.mp3",THANG:"res/game/xito/Sounds/Thang.mp3",CUOC_PHINH:"res/game/xito/Sounds/CuocPhinh.mp3",
TOI_LUOT:"res/game/xito/Sounds/ToiLuot.mp3"};var resourcesGameXiTo=[];for(i in ResourceManager.MGresourcesGameXiTo)ResourceManager.MGresourcesGameXiTo[i]=""+cc.loader.resPath+ResourceManager.MGresourcesGameXiTo[i],resourcesGameXiTo.push(ResourceManager.MGresourcesGameXiTo[i]);ConstantsVariable.NETWORK_XI_TO={ListUser:1800,GameData:1801,AddUser:1802,UserLeave:1803,DonTay:1804,RandCard:1805,RandNextCard:1806,CompareCard:1807,EndMatch:1808,SetTool:1809,To:1810,KhongTo:1811,ToMax:1812,Theo:1813,UpBai:1814,ActivePlayer:1815,LatTay:1816,CalculateResult:1817,ResponseDonTay:1818};ConstantsVariable.LIST_RATE_XITO=[1,5,10,50,100];ConstantsVariable.LIST_IMG_XU_XITO=["xu100.png","xu500.png","xu1000.png","xu5000.png","xu10000.png"];ConstantsVariable.XU_Z_LOCAL_XITO=10;
ConstantsVariable.TypeCardsValue={MAU_THAU:1,ZACH:2,THU:3,XAM:4,SANH:5,THUNG:6,CU_LU:7,TU_QUI:8,THUNG_PHA_SANH:9};var MGCompoButtonsComboXiTo=MGBaseNode.extend({_listButton:null,mainGame:null,currentCoinTo:0,currentCoinTheo:0,btnXemTay:null,btnLatTay:null,btnDonTay:null,labelTo:null,labelTheo:null,_listEvents:null,btnResetTo:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listEvents=[];this._listButton=[];this._initEventBtnFromNode();this.labelTo=this.getChildByName(MGCompoButtonsComboXiTo.TEXT_BOTTOM.TEXT_TO);this.labelTo.setString(Utilities.Coin(this.currentCoinTo));
this.labelTo.setVisible(!1);this.labelTheo=this.getChildByName(MGCompoButtonsComboXiTo.TEXT_BOTTOM.TEXT_THEO);this.labelTheo.setString(Utilities.Coin(this.currentCoinTheo));this.labelTheo.setVisible(!1);this.btnXemTay=this.getChildByName(MGCompoButtonsComboXiTo.BUTTON_NAME_TOP.XEM_TAY);this.btnLatTay=this.getChildByName(MGCompoButtonsComboXiTo.BUTTON_NAME_TOP.LAT_TAY);this.btnDonTay=this.getChildByName(MGCompoButtonsComboXiTo.BUTTON_NAME_TOP.DON_TAY);this.btnResetTo=this.getChildByName(MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.RESET_TO);
this.setLatTayEnable(!1)},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=0;b<a.length;b++)a[b]instanceof ccui.Button&&(a[b].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[b]));this._listEvents.push(cc.eventManager.addCustomListener(MGComboXuBet.ON_CLICK.toString(),this._onSelectXu.bind(this)))},hideButton:function(a){this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);
this.getChildByName(a).setEnabled(!0)},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGresourcesGameXiTo.DANH,MGGameInfo.gameVolume);switch(a.getName()){case MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.TO:var d=MGGameBoardXiTo.listUser[MGGameInfo.myInfo.UserID];d&&(0===this.currentCoinTo?this.currentCoinTo=this.mainGame._minBet:this.currentCoinTo==MGGameBoardXiTo.MaxTay&&(this.currentCoinTo=0),this.mainGame.netSend.sendTo(this.currentCoinTo));break;case MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.UP_BO:this.mainGame.netSend.sendToUpBai();
break;case MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.KHONG_TO:this.updateButton();this.mainGame.netSend.sendKhongTo();break;case MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.THEO:if(d=MGGameBoardXiTo.listUser[MGGameInfo.myInfo.UserID])d.setStringCoinBet(this.currentCoinTo),this.mainGame.netSend.sendTheo(),this.mainGame._xuController.createXuFromUserID(d.UserID,parseInt(this.currentCoinTheo),!0);break;case MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.RESET_TO:this.currentCoinTo=0;this.setCoinTo(this.currentCoinTo);
this.labelTo.setString(Utilities.Coin(this.mainGame._minBet));break;case MGCompoButtonsComboXiTo.BUTTON_NAME_TOP.XEM_TAY:a.setVisible(!1);(d=MGGameBoardXiTo.listUser[MGGameInfo.myInfo.UserID])&&d.xemBaiTay();break;case MGCompoButtonsComboXiTo.BUTTON_NAME_TOP.DON_TAY:Utilities.showLog("MGGameBoardXiTo.my.betCoin "+MGGameBoardXiTo.my.betCoin);this.mainGame.popupDonTay.setMaxCuoc(MGGameBoardXiTo.my.betCoin);this.mainGame.popupDonTay.showPopup();break;case MGCompoButtonsComboXiTo.BUTTON_NAME_TOP.LAT_TAY:a.setVisible(!1),
this.mainGame.netSend.sendLatTay()}},hideAll:function(){for(var a=0;a<this._listButton.length-3;a++)this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1);this.labelTo.setVisible(!1);this.labelTheo.setVisible(!1);this.setResetToEnable(!1)},restartAllButton:function(){this.hideAll();this.btnLatTay.setVisible(!0);this.btnXemTay.setVisible(!0);this.setLatTayEnable(!1)},showAll:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setBright(!0),this._listButton[a].setEnabled(!0)},
setCoinTo:function(a){this.currentCoinTo+=a*this.mainGame._minBet;a=MGGameBoardXiTo.my.betCoin-this.currentCoinTheo;this.currentCoinTo=this.currentCoinTo>a?a:this.currentCoinTo;0<a&&(this.currentCoinTo>a?this.setMaxCoinTo():this.labelTo.setString(Utilities.Coin(this.currentCoinTo)))},setMaxCoinTo:function(){this.currentCoinTo=MGGameBoardXiTo.my.betCoin-this.currentCoinTheo;Utilities.showLog("this.currentCoinTo "+this.currentCoinTo+" MGGameBoardXiTo.my.betCoin"+MGGameBoardXiTo.my.betCoin+" theo "+
this.currentCoinTheo);this.labelTo.setString(Utilities.Coin(this.currentCoinTo))},setCoinTheo:function(a){this.currentCoinTheo+=a;this.labelTheo.setString(Utilities.Coin(this.currentCoinTheo));Utilities.showLog("this.currentCoinTheo "+this.currentCoinTheo)},setVisibleTopButton:function(a){this.btnLatTay.setVisible(a);this.btnXemTay.setVisible(a)},setLatTayEnable:function(a){this.btnLatTay.setEnabled(a);this.btnLatTay.setBright(a)},setXemTayVisible:function(a){this.btnXemTay.setVisible(a)},setDonTayEnable:function(a){this.btnDonTay.setEnabled(a);
this.btnDonTay.setBright(a)},setResetToEnable:function(a){this.btnResetTo.setEnabled(a);this.btnResetTo.setBright(a);this.btnResetTo.setVisible(a)},updateButton:function(a){Utilities.showLog("updateButton this.currentCoinTheo "+this.currentCoinTheo);this.currentCoinTheo=this.currentCoinTo=0;if(null==a)this.hideAll();else for(var b=0;b<a.ListAction.length;b++){var d=this.getChildByTag(parseInt(a.ListAction[b]));null!=d?(d.setBright(!0),d.setEnabled(!0),d.getName()==MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.TO&&
(this.labelTo.setVisible(!0),this.labelTo.setString(Utilities.Coin(this.mainGame._minBet)),this.setResetToEnable(!0)),d.getName()==MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM.THEO&&this.labelTheo.setVisible(!0)):Utilities.showLog("button is null")}},_onSelectXu:function(a){Utilities.showLog("_onSelectXu");a=a.getUserData();switch(a.value){case 0:this.setCoinTo(ConstantsVariable.LIST_RATE_XITO[a.value]);break;case 1:this.setCoinTo(ConstantsVariable.LIST_RATE_XITO[a.value]);break;case 2:this.setCoinTo(ConstantsVariable.LIST_RATE_XITO[a.value]);
break;case 3:this.setCoinTo(ConstantsVariable.LIST_RATE_XITO[a.value]);break;case 4:this.setMaxCoinTo()}}});MGCompoButtonsComboXiTo.BUTTON_NAME_BOTTOM={TO:"MGButtonTo",UP_BO:"MGButtonUpBo",KHONG_TO:"MGButtonKhongTo",THEO:"MGButtonTheo",RESET_TO:"MGBtnResetTo"};MGCompoButtonsComboXiTo.BUTTON_NAME_TOP={XEM_TAY:"MGButtonXemTay",LAT_TAY:"MGButtonLatTay",DON_TAY:"MGButtonDonTay"};MGCompoButtonsComboXiTo.TEXT_BOTTOM={TEXT_TO:"MGTextCoinTo",TEXT_THEO:"MGTextCoinTheo"};var MGCompoContainUsersXiTo=MGBaseNode.extend({listCompoUser:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.initListCompoUser();this._initEventsGame();this.initEvents();this.mainGame=a},initListCompoUser:function(){this.listCompoUser=[];for(var a=1,b;6>a;a++)b=new MGCompUserInfoPlay,b.setPosition(this.getChildByName("MGPosition_"+a).getPosition()),b.setAlignInfo(MGCompUserInfoPlay.BottomAlign),this.listCompoUser.push(b),
this.addChild(b)},initEvents:function(){this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.ListUser.toString(),this.ngListUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.AddUser.toString(),this.ngAddUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.UserLeave.toString(),this.ngUserLeave.bind(this)))},ngListUsers:function(a){a=a.getUserData();var b=
BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,Nickname:b.StringDynamic,avatar:b.StringDynamic,Position:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngListUsers "+JSON.stringify(a));this.updateMyPosition(a.ListUser);this.addListUser(a.ListUser)},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);
Utilities.showLog("ngUserLeave "+JSON.stringify(a));this.userLeave(a.ListUser)},ngAddUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,Nickname:b.StringDynamic,avatar:b.StringDynamic,Position:b.UInt8};a=(new BinaryParser).initObj(b,a.content);a.Index=this.getIndexByPosition(a.Position);Utilities.showLog("ngAddUser "+JSON.stringify(a));MGGameBoardXiTo.listUser[a.UserID]||this.addUser(a)},addUser:function(a){var b=this.getCompoUserByIndex(a.Index);
b&&(b.setUserInfoData(a.UserID,a.Nickname,a.Coin,a.avatar),b=new MGUserXiTo,b.initObj(a),MGGameBoardXiTo.listUser[a.UserID]=b);Utilities.showLog("addUser "+a.Index)},addListUser:function(a){for(var b in a)a[b].Index=this.getIndexByPosition(a[b].Position),this.addUser(a[b])},userLeave:function(a){var b=0,d=a.length;for(b;b<d;b++)this.removeUser(a[b])},removeUser:function(a){var b=this.getCompoUserByUserID(a);b?b.removeUserInfoData():Utilities.showLog("removeUser Error"+a);MGGameBoardXiTo.listUser[a].resetUser();
delete MGGameBoardXiTo.listUser[a]},getCompoUserByIndex:function(a){return this.listCompoUser[a-1]},getCompoUserByUserID:function(a){var b=0,d=this.listCompoUser.length;for(b;b<d;b++)if(this.listCompoUser[b].getUserPlayId()==a)return this.listCompoUser[b];return null},getIndexByPosition:function(a){return(a-MGGameBoardXiTo.my.position+5)%5+1},updateMyPosition:function(a){for(var b in a)a[b].UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardXiTo.my.position=a[b].Position)},stopAllClock:function(){var a=
0,b=this.listCompoUser.length;for(a;a<b;a++)this.listCompoUser[a].stopActionEffect()},resultMoneyXiTo:function(a){for(var b in a){var d=this.getCompoUserByUserID(a[b].userId);d&&(d.showEffectGoldWinLose(a[b].resultCoin),d.setUserGold(a[b].coinPot),a[b].userId==MGGameInfo.myInfo.UserID&&this.mainGame.setBetCoinForMyUser(a[b].coinPot))}},updateActiveUser:function(a){this.stopAllClock();if(0<a.ActivePlayer){var b=this.getCompoUserByUserID(a.ActivePlayer);b&&(b.runActionEffect(void 0===a.TimeRemain?a.TimeOut:
a.TimeRemain),void 0!==a.CoinPot&&b.setUserGold(a.CoinPot))}}});var MGBoxCardUserXiTo=MGBaseNode.extend({_listUserCards:null,mainGame:null,_isOwner:!1,isActive:!1,imageCancel:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listUserCards=[];this.initImageCanel();this.resetListCard()},initImageCanel:function(){this.imageCancel=new ccui.ImageView;this.imageCancel.loadTexture("imageX.png",ccui.Widget.PLIST_TEXTURE);this.imageCancel.setVisible(!1);this.imageCancel.setScale(.8,
.8);this.imageCancel.setPosition(30,0);this.addChild(this.imageCancel)},addListCard:function(a){var b=0,d=a.length;for(b;b<d;b++)this.addCardElementToList(a[b])},addCardToListCards:function(a){this.addCardElementToList(a);this.setNextCardVisisble(!1)},showCardIndex:function(a){a<this._listUserCards.length&&this._listUserCards[a].setVisible(!0)},addCardElementToList:function(a){52===a?(a=new MGCardXiTo,a.retain(),a.setName("MGCard52.png"),a.setSpriteFrame("card52.png"),a.setRealSpriteName("card52.png")):
(a=MGGameBoardXiTo.getCardByID(a),0==this._listUserCards.length&&this._isOwner&&a.setVisibleCard(!1));if(a){var b=this._listUserCards.length;a.resetCard();this.addChild(a);this.getPosition().x>MGGameBoardXiTo.CENTER_X?(a.setPosition(cc.p(-(b*MGBoxCardUserXiTo.CARD_SIZE),0)),a.setLocalZOrder(100-b)):(a.setPosition(cc.p(b*MGBoxCardUserXiTo.CARD_SIZE,0)),a.setLocalZOrder(100+b));a.setScale(this._isOwner?1:.8);this._listUserCards.push(a)}},resetListCard:function(){var a=this._listUserCards.length;this.imageCancel.setVisible(!1);
for(var b=0;b<a;b++)"MGCard52.png"==this._listUserCards[b].getName()?(this._listUserCards[b].removeFromParent(!0),this._listUserCards[b].release()):this._listUserCards[b].removeFromParent(!0);this._listUserCards.length=0},getCardByID:function(a){for(var b=0;b<this._listUserCards.length;b++)if(this._listUserCards[b]._idCard==a)return this._listUserCards[b];return null},xemTay:function(){this._listUserCards[0].setVisibleCard(!0)},latTay:function(a){a=MGGameBoardXiTo.getCardByID(a);a!=this._listUserCards[0]&&
(this._listUserCards[0]||Utilities.showLog("this._listUserCards[0] is null"),"MGCard52.png"==this._listUserCards[0].getName()&&(a.setPosition(this._listUserCards[0].getPosition()),a.setLocalZOrder(this._listUserCards[0].getLocalZOrder()),a.setScale(this._isOwner?1:.8),this.addChild(a),this._listUserCards[0].removeFromParent(!0),this._listUserCards[0].release(),this._listUserCards[0]=a));this.xemTay()},setNextCardVisisble:function(a){this._listUserCards[this._listUserCards.length-1].setVisible(a)},
setAllCardsVisible:function(a){for(var b=0;b<this._listUserCards.length;b++)this._listUserCards[b].setVisible(a)},setListCardBlack:function(a){var b={r:255,g:255,b:255};a&&(b={r:155,g:155,b:155});for(a=0;a<this._listUserCards.length;a++)this._listUserCards[a].setColor(b)},makeUpBoCards:function(a){this.imageCancel.setVisible(!0);this.imageCancel.setLocalZOrder(200);for(var b={r:100,g:100,b:100},d=0;d<this._listUserCards.length;d++)this._listUserCards[d].setVisibleCard(!a),this._listUserCards[d].setColor(b)}});
MGBoxCardUserXiTo.CARD_SIZE=45;var MGCardXiTo=MGBaseSprite.extend({realSpriteName:null,ctor:function(){MGBaseSprite.prototype.ctor.call(this)},initObj:function(){MGBaseSprite.prototype.initObj.call(this)},resetCard:function(){this.setRotation(0);this.setScale(1,1);this.setColor(cc.color(255,255,255,255));this.setLocalZOrder(0);this.setVisible(!1)},setVisibleCard:function(a){a?this.setSpriteFrame(this.realSpriteName):this.setSpriteFrame("card52.png")},setRealSpriteName:function(a){this.realSpriteName=a},getRealSpriteName:function(){return this.realSpriteName}});var MGUserXiTo=cc.Class.extend({Index:0,Position:0,UserID:0,listCards:null,coinBet:null,bIsPLaying:!1,ctor:function(){},initObj:function(a){this.Index=a.Index;this.Position=a.Position;this.UserID=a.UserID},setListCard:function(a){this.setIsPlaying(!0);this.listCards=a},setCoinBet:function(a){a=this.coinBet=a;setTimeout(function(){a.setVisible(!0)},1E3*MGGameBoardXiTo.DurationXuMove)},setStringCoinBet:function(a){this.coinBet.setTextForCoinLabel(a)},getCoinBetPostion:function(){return this.coinBet.getPosition()},
setVisibleListCards:function(a){this.isPlaying()&&this.listCards.setVisible(a)},showCardAtIndex:function(a){this.isPlaying()&&this.listCards.showCardIndex(a)},getCardBoxPosition:function(){return this.listCards.getPosition()},addCardtoList:function(a){this.listCards.addCardToListCards(a)},resetUser:function(){Utilities.showLog("resetUser");this.isPlaying()?(this.listCards.makeUpBoCards(!1),this.listCards.setListCardBlack(!1),this.setVisibleListCards(!1),this.listCards.resetListCard(),this.coinBet.setVisible(!1)):
Utilities.showLog("resetUser User is waiting ")},latBaiTay:function(a){this.listCards.latTay(a)},xemBaiTay:function(){this.listCards.xemTay()},processCaculateCards:function(a){if(1===parseInt(a.IsUpbai))Utilities.showLog("User Upbai"),this.listCards.makeUpBoCards(!0);else switch(Utilities.showLog("User Mo Bai"),this.latBaiTay(a.CardList[0]),a.ValueCard){case ConstantsVariable.TypeCardsValue.MAU_THAU:cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,
EffectName:MGCompoEffectsXiTo.EVENTS.FX_MAU_THAU});break;case ConstantsVariable.TypeCardsValue.ZACH:this.makeHightLightCards(a.CardHighLight);cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_DACH});break;case ConstantsVariable.TypeCardsValue.THU:this.makeHightLightCards(a.CardHighLight);cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_THU});
break;case ConstantsVariable.TypeCardsValue.XAM:this.makeHightLightCards(a.CardHighLight);cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_SAM_CO});break;case ConstantsVariable.TypeCardsValue.TU_QUI:this.makeHightLightCards(a.CardHighLight);cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_TU_QUY});break;case ConstantsVariable.TypeCardsValue.SANH:cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,
{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_SANH});break;case ConstantsVariable.TypeCardsValue.CU_LU:cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_CU_LU});break;case ConstantsVariable.TypeCardsValue.THUNG:cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_THUNG});break;case ConstantsVariable.TypeCardsValue.THUNG_PHA_SANH:cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,
{UserID:this.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_THUNG_PHA_SANH})}},isPlaying:function(){return this.bIsPLaying},setIsPlaying:function(a){this.bIsPLaying=a},makeUpBai:function(a){this.listCards.makeUpBoCards(a)},makeHightLightCards:function(a){this.listCards.setListCardBlack(!0);for(var b=0;b<a.length;b++)Utilities.showLog("makeHightLightCards "+a[b]),MGGameBoardXiTo.getCardByID(a[b]).setColor({r:255,g:255,b:255})},setNextCardVisible:function(a){this.isPlaying()&&this.listCards.setNextCardVisisble(a)},
setAllCardVisible:function(a){this.isPlaying()&&this.listCards.setAllCardsVisible(a)}});var MGCompoEffectsXiTo=MGBaseNode.extend({ListEffect:null,fxDonTay:null,fxVanMoi:null,timeOutHideEffect:null,timeOutVanMoi:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.ListEffect=[];this.ListEffect[1]={};this.ListEffect[2]={};this.ListEffect[3]={};this.ListEffect[4]={};this.ListEffect[5]={};this.timeOutHideEffect=[];this.initEffect();var a=1,b,d;for(a;6>a;a++)d=this.getChildByName("EffectPos"+a).getPosition(),b=new cc.Sprite,b.setSpriteFrame("fxUpBo.png"),this.addChild(b),
b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxUpBo=b,b=new cc.Sprite,b.setSpriteFrame("fxKhongTo.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxKhongTo=b,b=new cc.Sprite,b.setSpriteFrame("fxTheo.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxTheo=b,b=new cc.Sprite,b.setSpriteFrame("fxTo.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxTo=b,
b=new cc.Sprite,b.setSpriteFrame("fxTuquy.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxTuquy=b,b=new cc.Sprite,b.setSpriteFrame("fxThungphasanh.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxThungphasanh=b,b=new cc.Sprite,b.setSpriteFrame("fxMauThau.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxMauThau=b,b=new cc.Sprite,b.setSpriteFrame("fxDach.png"),this.addChild(b),
b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxDach=b,b=new cc.Sprite,b.setSpriteFrame("fxThu.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxThu=b,b=new cc.Sprite,b.setSpriteFrame("fxSamCo.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxSamCo=b,b=new cc.Sprite,b.setSpriteFrame("fxSanh.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxSanh=b,b=
new cc.Sprite,b.setSpriteFrame("fxCuLu.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxCuLu=b,b=new cc.Sprite,b.setSpriteFrame("fxThung.png"),this.addChild(b),b.setPosition(cc.p(d.x,d.y-35)),b.setVisible(!1),this.ListEffect[a].fxThung=b,b=new cc.Sprite,b.setSpriteFrame("fxToDau.png"),this.addChild(b),b.setPosition(cc.p(d.x-35,d.y+25)),b.setVisible(!1),this.ListEffect[a].fxToDau=b,b=new sp.SkeletonAnimation(ResourceManager.MGresourcesGameXiTo.Thang_Json,
ResourceManager.MGresourcesGameXiTo.Thang_Atlas),this.addChild(b),b.setPosition(d),b.setVisible(!1),this.ListEffect[a].fxThang=b,b=new sp.SkeletonAnimation(ResourceManager.MGresourcesGameXiTo.Thua_Json,ResourceManager.MGresourcesGameXiTo.Thua_Atlas),this.addChild(b),b.setPosition(d),b.setVisible(!1),this.ListEffect[a].fxThua=b;this._initEventsGame()},initEffect:function(){var a=this.getChildByName("BaseEffectPos").getPosition();this.fxDonTay=new cc.Sprite;this.fxDonTay.setSpriteFrame("fxDonTay.png");
this.fxDonTay.setPosition(a);this.fxDonTay.setVisible(!1);this.addChild(this.fxDonTay);a=this.getChildByName("EffectVanMoi").getPosition();this.fxVanMoi=new sp.SkeletonAnimation(ResourceManager.MGresourcesGameXiTo.VanMoi_Json,ResourceManager.MGresourcesGameXiTo.VanMoi_Atlas);this.fxVanMoi.setPosition(a);this.fxVanMoi.setVisible(!1);this.addChild(this.fxVanMoi)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_TO,
this.playEffectTo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_THEO,this.playEffectTheo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_UP_BO,this.playEffectUpBo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_KHONG_TO,this.playEffectKhongTo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_TU_QUY,this.playEffectTuQuy.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_THUNG_PHA_SANH,this.playEffectThungPhaSanh.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,this.playEffectInList.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoEffectsXiTo.EVENTS.FX_DON_TAY,this.playEffectDonTay.bind(this)))},playEffect:function(a){a=a.getUserData();var b=this[a.name];a.isShow?(b.setVisible(!0),b.setAnimation(0,
"animation",!1)):b.setVisible(!1)},playEffectThang:function(a){if(a=MGGameBoardXiTo.listUser[a])this.ListEffect[a.Index].fxThang.setAnimation(0,"thang",!1),this.ListEffect[a.Index].fxThang.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxThang),4E3))},playEffectThua:function(a){if(a=MGGameBoardXiTo.listUser[a])this.ListEffect[a.Index].fxThua.setAnimation(0,"thua",!1),this.ListEffect[a.Index].fxThua.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[a.Index].fxThua),4E3))},playEffectTo:function(a){this.clearTimeoutEffects();this.hideAllEffect();a=a.getUserData();if(a=MGGameBoardXiTo.listUser[a.UserID])this.ListEffect[a.Index].fxTo.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxTo),4E3))},playEffectTheo:function(a){this.clearTimeoutEffects();this.hideAllEffect();a=a.getUserData();if(a=MGGameBoardXiTo.listUser[a.UserID])this.ListEffect[a.Index].fxTheo.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[a.Index].fxTheo),4E3))},playEffectTuQuy:function(a){this.clearTimeoutEffects();a=a.getUserData();if(a=MGGameBoardXiTo.listUser[a.UserID])this.ListEffect[a.Index].fxTuquy.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxTuquy),4E3))},playEffectThungPhaSanh:function(a){this.clearTimeoutEffects();a=a.getUserData();if(a=MGGameBoardXiTo.listUser[a.UserID])this.ListEffect[a.Index].fxThungphasanh.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[a.Index].fxThungphasanh),4E3))},playEffectUpBo:function(a){this.clearTimeoutEffects();this.hideAllEffect();a=a.getUserData();(a=MGGameBoardXiTo.listUser[a.UserID])&&this.ListEffect[a.Index].fxUpBo.setVisible(!0)},playEffectKhongTo:function(a){this.clearTimeoutEffects();this.hideAllEffect();a=a.getUserData();if(a=MGGameBoardXiTo.listUser[a.UserID])this.ListEffect[a.Index].fxKhongTo.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[a.Index].fxKhongTo),
4E3))},playEffectDonTay:function(a){a=a.getUserData();MGGameBoardXiTo.listUser[a.UserID]&&(this.fxDonTay.setVisible(!0),this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.fxDonTay),2E3)))},playEffectVanMoi:function(){this.fxVanMoi.setVisible(!0);this.fxVanMoi.setAnimation(0,"animation",!1)},hideEffectVanMoi:function(){this.timeOutVanMoi&&clearTimeout(this.timeOutVanMoi);this.fxVanMoi.setVisible(!1)},playEffectToDau:function(a){this.hideEffectsToDau();(a=MGGameBoardXiTo.listUser[a])&&
this.ListEffect[a.Index].fxToDau.setVisible(!0)},hideEffectsToDau:function(){for(var a=1;6>a;a++)this.ListEffect[a].fxToDau.setVisible(!1)},playEffectInList:function(a){a=a.getUserData();var b=MGGameBoardXiTo.listUser[a.UserID],d=a.EffectName;if(b){this.clearTimeoutEffects();this.hideAllEffect();var e=this.ListEffect[b.Index][d];e?(this.hideEffectX(a.UserID),e.setVisible(!0),MGGameBoardXiTo.GameStatus==MGGameBoardXiTo.STATE.CALCULATE_FINISH?this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,
this.ListEffect[b.Index][d]),1E4)):this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.ListEffect[b.Index][d]),4E3))):Utilities.showLog("Cant find effect "+d)}},playEffectEndGame:function(a){this.clearTimeoutEffects();for(var b=0;b<a.length;b++)0<a[b].resultCoin?(this.playEffectThang(a[b].userId),a[b].userId===MGGameInfo.myInfo.UserID&&mg.audio.playEffect(ResourceManager.MGresourcesGameXiTo.THANG,MGGameInfo.gameVolume)):this.playEffectThua(a[b].userId);this.timeOutVanMoi=setTimeout(function(){this.hideAllEffect();
Utilities.showLog("reset user when play effects");for(var b=0;b<a.length;b++){var e=MGGameBoardXiTo.listUser[a[b].userId];e&&e.resetUser()}this.playEffectVanMoi()}.bind(this),4E3)},hideEffectX:function(a){if(a=MGGameBoardXiTo.listUser[a]){a=a.Index;for(var b in this.ListEffect[a])b!=MGCompoEffectsXiTo.EVENTS.FX_TO_DAU&&this.ListEffect[a][b].setVisible(!1)}},hideEffect:function(a){a.setVisible(!1)},hideAllEffect:function(){this.fxDonTay.setVisible(!1);for(var a=1;6>a;a++)for(var b in this.ListEffect[a])this.ListEffect[a][b].setVisible(!1)},
showAllEffect:function(){this.fxDonTay.setVisible(!0);for(var a=1;6>a;a++)for(var b in this.ListEffect[a])this.ListEffect[a][b].setVisible(!1)},clearTimeoutEffects:function(){for(var a=0;a<this.timeOutHideEffect.length;a++)this.timeOutHideEffect[a]&&clearTimeout(this.timeOutHideEffect[a]);this.timeOutHideEffect=[];null!=this.timeOutVanMoi&&clearTimeout(this.timeOutVanMoi)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.clearTimeoutEffects()}});
MGCompoEffectsXiTo.EFFECTS={FX_THEO:"fxTheo",FX_TO:"fxTo",FX_TU_QUY:"fxTuquy",FX_THUNG_PHA_SANH:"fxThungphasanh"};
MGCompoEffectsXiTo.EVENTS={FX_BaseEffect:"fxBaseEffect",FX_BaseEffectAutoHide:"fxBaseEffectAutoHide",FX_THEO:"fxTheo",FX_TO:"fxTo",FX_UP_BO:"fxUpBo",FX_MAU_THAU:"fxMauThau",FX_DACH:"fxDach",FX_THU:"fxThu",FX_SAM_CO:"fxSamCo",FX_SANH:"fxSanh",FX_THUNG:"fxThung",FX_CU_LU:"fxCuLu",FX_TU_QUY:"fxTuquy",FX_THUNG_PHA_SANH:"fxThungphasanh",FX_THANG:"fxThang",FX_THUA:"fxThua",FX_KHONG_TO:"fxKhongTo",FX_TO_DAU:"fxToDau",FX_HideAll:"fxHideAll",FX_EFFECTS_LIST:"playEffectInList",FX_DON_TAY:"fxDonTay",FX_VAN_MOI:"fxVanMoi"};var MGXuControllerXiTo=MGBaseNode.extend({listBet:null,mainGame:null,index:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.listXu=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initListXu()},initListXu:function(){for(var a=1;6>a;a++)this.listXu[a]=[]},createXuFromUserID:function(a,b,d){var e=MGGameBoardXiTo.listUser[a];if(e){this.index=e.Index;var f=new cc.Sprite;f.setVisible(!0);b=MGXuControllerXiTo.TYPE_BET[this.initImageBet(b)].NAME;f.setSpriteFrame(b);
this.addChild(f,ConstantsVariable.UIZONE_TAIXIU.XU_Z_LOCAL);a=this.mainGame.compoUsersContain.getCompoUserByUserID(a).getPosition();f.setPosition(a.x,a.y);this.listXu[this.index].push(f);e=e.getCoinBetPostion();d?(f.runAction(cc.sequence(cc.moveTo(.2,cc.p(e.x,e.y)),cc.callFunc(this.shortXuUser.bind(this)))),mg.audio.playEffect(ResourceManager.MGresourcesGameXiTo.CUOC_PHINH,MGGameInfo.gameVolume)):f.setPosition(e.x,e.y)}},initImageBet:function(a){for(var b in MGXuControllerXiTo.TYPE_BET)if(MGXuControllerXiTo.TYPE_BET[b].value>=
a)return b;return"BET_4"},updateXu:function(a,b){var d=0,e;for(e in MGXuControllerXiTo.TYPE_BET)MGXuControllerXiTo.TYPE_BET[e].value=b[d]*a,d++},resetXu:function(){for(var a=1;6>a;a++){for(var b=0;b<this.listXu[a].length;b++)this.listXu[a][b].setVisible(!1),this.listXu[a][b].removeFromParent(!0);this.listXu[a]=[]}},setBetXuAll:function(a,b){for(var d=0;d<a.length;d++)for(var e in MGGameBoardXiTo.listUser)MGGameBoardXiTo.listUser[e].UserID===a[d].UserID&&this.initXu(a[d].UserID,b)},shortXuUser:function(){for(var a=
null,b=1;b<this.listXu[this.index].length;b++)5==b?(a=this.listXu[this.index][0].getPosition(),this.listXu[this.index][b].setPosition(a.x+18,a.y)):10>b?(a=this.listXu[this.index][b-1].getPosition(),this.listXu[this.index][b].setPosition(a.x,a.y+3)):(a=this.listXu[this.index][9].getPosition(),this.listXu[this.index][b].setPosition(a.x,a.y))},effectXu:function(a){for(var b=[],d=[],e,f,g,h,k=1;6>k;k++)for(var l=0;l<this.listXu[k].length;l++)d.push(this.listXu[k][l]);for(k=0;k<a.length;k++)0<a[k].resultCoin&&
b.push(a[k].userId);a=Math.floor(d.length/b.length);for(var n=null,m=null,k=0;k<b.length;k++){for(var u in MGGameBoardXiTo.listUser)MGGameBoardXiTo.listUser[u].UserID===b[k]&&(l=this.mainGame.compoUsersContain.getCompoUserByUserID(b[k]))&&(n=l.getPosition());for(l=0;l<a;l++){e=parseInt(100*Math.random())+570;f=parseInt(100*Math.random())+350;m=a*k+l;if(m>=d.length)break;g=parseInt(30*Math.random())+n.x;h=parseInt(30*Math.random())+n.y;d[m].stopAllActions();d[m].runAction(cc.sequence(cc.moveTo(.3,
cc.p(e,f)),cc.delayTime(.5),cc.moveTo(.4,cc.p(g,h)),cc.delayTime(.5),cc.callFunc(this.resetXu.bind(this))))}}}});MGXuControllerXiTo.TYPE_BET={BET_0:{NAME:"xu100.png",value:"1"},BET_1:{NAME:"xu500.png",value:"5"},BET_2:{NAME:"xu1000.png",value:"10"},BET_3:{NAME:"xu5000.png",value:"50"},BET_4:{NAME:"xu10000.png",value:"0"}};var MGPopupDonTayXiTo=MGBaseNode.extend({mainGame:null,_minCuoc:null,_tienTay:null,_maxTay:null,_unit:null,slider:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this._initBackGroundDonTay();this.cloneFromNode(ccs.load(ResourceManager.MGresourcesGameXiTo.MGUIPopupDonTay,PreLoaderConfig.PathToResourceDefault).node);this.mainGame=a;this._tienTay=0;this._initEventsGame()},_initBackGroundDonTay:function(){var a=new ccui.Layout;a.setContentSize(2E3,
2E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.slider=this.getChildByName("MGSliderCuoc");this.slider.addEventListener(this._getDonTay.bind(this))},
onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGPopupDonTayXiTo.BUTTON_NAME.XAC_NHAN:this.mainGame.netSend.sendDonTay(this._tienTay);this.hidePopup();break;case MGPopupDonTayXiTo.BUTTON_NAME.CLOSE_POPUP:this.hidePopup()}},setMinCuoc:function(a,b){this._minCuoc=a;this._maxTay=b;this._unit=this._maxTay/10;this.slider.setPercent(100);this._setTienTay(this.makeRound(Math.floor(this._maxTay)))},setMaxCuoc:function(a){var b=MGGameBoardXiTo.MaxTay-a;this._minCuoc=0;this._maxTay=MGGameInfo.myInfo.Gold>
b?b:MGGameInfo.myInfo.Gold;b<this.mainGame._minBet&&(this._maxTay=0);MGGameInfo.myInfo.Gold<b&&(b=MGGameInfo.myInfo.Gold-a,this._maxTay=b>this.mainGame._minBet?b:0);this._unit=(this._maxTay-this._minCuoc)/10;this.slider.setPercent(100);this._setTienTay(this.makeRound(this._maxTay))},_setTienTay:function(a){this.getChildByName("MGTextTien").setString(Utilities.Coin(a));this._tienTay=a},_getDonTay:function(a){a=Math.ceil(a.getPercent()/10);a=Math.floor(this._minCuoc+this._unit*a);a=a>MGGameBoardXiTo.MaxTay?
MGGameBoardXiTo.MaxTay:a;this._setTienTay(this.makeRound(a))},showPopup:function(){this.setVisible(!0)},hidePopup:function(){this.setVisible(!1)},makeRound:function(a){1E3<a&&(a-=a%1E3);return a}});MGPopupDonTayXiTo.BUTTON_NAME={XAC_NHAN:"MGButtonXacNhan",CLOSE_POPUP:"MGButtonCloseDonTay"};var MGComboXuBetXiTo=MGComboXuBet.extend({ctor:function(a){MGComboXuBet.prototype.ctor.call(this);this._minBet=a;this._listRate=ConstantsVariable.LIST_RATE_XITO;this.initObj()},setMinBet:function(a){MGComboXuBet.prototype.setMinBet.call(this,a);this.getChildByName("Text_"+(this._listRate.length-1)).setString("MAX")},setSelectXu:function(a){MGComboXuBet.prototype.setSelectXu.call(this,a);this.getChildByTag(a).setEnabled(!0);this.getChildByTag(a).setBright(!0);this.getChildByTag(a).setScale(1);this.getChildByTag(a).stopAllActions();
this.getChildByName("Text_"+a).setColor(cc.color("#FFFFFF"))},onClickBtnFromCocostudio:function(a,b){MGComboXuBet.prototype.onClickBtnFromCocostudio.call(this,a,b);a.setEnabled(!0);a.setBright(!0);a.setScale(1)},setListRate:function(a){this._listRate=a}});var MGCoinsBetUserContainer=MGBaseNode.extend({mainGame:null,listCompoCoinBetUser:[],ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.initListCompo();this._initEventsGame();this.mainGame=a},initListCompo:function(){this.listCompoCoinBetUser=[];for(var a=1,b;6>a;a++){b=this.getChildByName("MGCoinTextPos"+a);var d=new CoinBetUserElement;d.cloneFromNode(b);d.initObj();d.setTextForCoinLabel("1000");d.setVisible(!1);this.addChild(d);
this.listCompoCoinBetUser.push(d)}}}),CoinBetUserElement=MGBaseNode.extend({labelTextCoin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.labelTextCoin=this.getChildByName(MGCoinsBetUserContainer.MGCoinText)},setTextForCoinLabel:function(a){this.labelTextCoin.setString(Utilities.Coin(a))}});MGCoinsBetUserContainer.MGCoinText="MGCoinText";var MGNetSendXiTo=cc.Class.extend({ctor:function(){},sendTo:function(a){Utilities.showLog("sendDonTay: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XI_TO.To.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendKhongTo:function(){Utilities.showLog("sendKhongTo: ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XI_TO.KhongTo.toString());MGNetCore.MGSocket.sendMsg(a)},sendToMax:function(){},
sendTheo:function(){Utilities.showLog("sendTheo: ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XI_TO.Theo.toString());MGNetCore.MGSocket.sendMsg(a)},sendToUpBai:function(){Utilities.showLog("sendToUpBai: ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XI_TO.UpBai.toString());MGNetCore.MGSocket.sendMsg(a)},sendToolXiTo:function(a){Utilities.showLog("--sendToolXiTo");var b={};b.ListCards=a;a=Message.buildMsgWithModule(this.gameModuleID,
ConstantsVariable.NETWORK_XI_TO.SetTool,{ListCards:BinaryConstants.DataTypeID.Array8,ListCards_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendDonTay:function(a){Utilities.showLog("sendDonTay: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XI_TO.DonTay.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendLatTay:function(){Utilities.showLog("sendLatTay: ");var a=Message.buildMsgWithModule(this.gameModuleID,
ConstantsVariable.NETWORK_XI_TO.LatTay.toString());MGNetCore.MGSocket.sendMsg(a)}});var MGXiTo=MGBaseGame.extend({compoUsersContain:null,compoButtons:null,compoButtonsBet:null,boxCardContainer:null,effectContainer:null,popupDonTay:null,_gameInfoContain:null,_xuController:null,_minBet:1,netSend:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameXiTo},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendXiTo;this.initCompoUser();this.initCompoButtonsBet();this.initCompoButtons();this.initBoxCardContainer();
this.initEffectContainer();this.initCoinBetUser();this._initGameInfoContain();this.initPopupDonTay()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGresourcesGameXiTo.UIMGUIXiToLayer,PreLoaderConfig.PathToResourceDefault);this._xuController=new MGXuControllerXiTo(this);this._xuController.initObj();this.addChild(this._xuController)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.GameData.toString(),
this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.DonTay.toString(),this.ngDonTay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.RandCard.toString(),this.ngRandCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.RandNextCard.toString(),this.ngRandNextCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.ActivePlayer.toString(),
this.ngActiveUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.KhongTo.toString(),this.ngKhongTo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.UpBai.toString(),this.ngUpBai.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.To.toString(),this.ngTo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.Theo.toString(),
this.ngTheo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.LatTay.toString(),this.ngLatTay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.CalculateResult.toString(),this.ngCalculateResult.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.ResponseDonTay.toString(),this.ngResponseDonTay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XI_TO.EndMatch.toString(),
this.ngEndMatch.bind(this)))},initBoxCardContainer:function(){this.boxCardContainer=new MGXiToController;this.boxCardContainer.cloneFromNode(this._mainLayer.getChildByName("MGBoxCardNode"));this.boxCardContainer.initObj(this);this.addChild(this.boxCardContainer)},initCompoButtons:function(){this.compoButtons=new MGCompoButtonsComboXiTo;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGButtonsCombo"));this.compoButtons.initObj(this);this.addChild(this.compoButtons)},initCompoButtonsBet:function(){this.compoButtonsBet=
new MGComboXuBetXiTo(this._minBet);this.compoButtonsBet.setPosition(this._mainLayer.getChildByName("MGButtonsCoinCombo").getPosition());this.compoButtonsBet.reset();this.addChild(this.compoButtonsBet)},initCompoUser:function(){this.compoUsersContain=new MGCompoContainUsersXiTo;this.compoUsersContain.cloneFromNode(this._mainLayer.getChildByName("MGContainUser"));this.compoUsersContain.initObj(this);this.addChild(this.compoUsersContain)},initEffectContainer:function(){this.effectContainer=new MGCompoEffectsXiTo;
this.effectContainer.cloneFromNode(this._mainLayer.getChildByName("MGEffectXiTo"));this.effectContainer.initObj();this.addChild(this.effectContainer)},initPopupDonTay:function(){this.popupDonTay=new MGPopupDonTayXiTo;this.popupDonTay.initObj(this);this.popupDonTay.setPosition(cc.p(640,360));this.addChild(this.popupDonTay);this.popupDonTay.hidePopup()},_initGameInfoContain:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(35,670);this._gameInfoContain.setVisible(!1);
this.addChild(this._gameInfoContain)},initCoinBetUser:function(){this.coinBetUserContainer=new MGCoinsBetUserContainer;this.coinBetUserContainer.cloneFromNode(this._mainLayer.getChildByName("MGCoinPosition"));this.coinBetUserContainer.initObj(this);this.addChild(this.coinBetUserContainer)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,MatchID:b.UInt32,MinCoin:b.UInt64,Status:b.UInt8,ListUserInfo:b.Array8,ListUserInfo_Type:b.Object8,ListUserInfo_Type_Struct:{userID:b.UInt32,
cardList:b.Array8,cardList_Type:b.UInt8,coinPot:b.Int64,coinPlay:b.Int64,isUpbai:b.UInt8,isLatTay:b.UInt8},ActivePlayer:b.UInt32,PlayerFirstInRound:b.UInt32,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeRemain:b.UInt16,TimeOut:b.UInt16,CoinRaiseInRound:b.Int64,RatioRaise:b.Array8,RatioRaise_Type:b.UInt16,RatioMinAnte:b.UInt16,RatioMaxnAnte:b.UInt16};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));MGGameBoardXiTo.GameStatus=a.Status;MGGameBoardXiTo.CoinRaiseInRound=
a.CoinRaiseInRound;this.effectContainer.clearTimeoutEffects();this._minBet=parseInt(a.MinCoin);MGGameBoardXiTo.MinTay=10*this._minBet;MGGameBoardXiTo.MaxTay=100*this._minBet;this.compoButtonsBet.setListRate(a.RatioRaise);this.compoButtonsBet.setMinBet(a.MinCoin);this._gameInfoContain.setInfo("XÌ TỐ",a.DeskID,a.MinCoin,a.MatchID);this._xuController.updateXu(this._minBet,a.RatioRaise);0<a.ListUserInfo.length&&(this.boxCardContainer.ngResumeMatch(a),this.effectContainer.playEffectToDau(a.PlayerFirstInRound),
MGGameBoardXiTo.listUser[MGGameInfo.myInfo.UserID].isPlaying()&&(this.compoButtons.setVisibleTopButton(!0),MGGameBoardXiTo.my.isUpbai?this.compoButtons.setVisibleTopButton(!1):(2<a.ListUserInfo[0].cardList.length&&!MGGameBoardXiTo.my.isLatTay&&this.compoButtons.setLatTayEnable(!0),MGGameBoardXiTo.my.isLatTay&&this.compoButtons.setXemTayVisible(!1))))},ngDonTay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,UserCoin:b.Int64,Min:b.Int64,Max:b.Int64};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("ngDonTay : "+JSON.stringify(a));MGGameBoardXiTo.MinTay=a.Min;MGGameBoardXiTo.MaxTay=a.Max;MGGameBoardXiTo.my.betCoin=0;this.popupDonTay.setMinCuoc(MGGameBoardXiTo.MinTay,a.UserCoin>MGGameBoardXiTo.MaxTay?MGGameBoardXiTo.MaxTay:a.UserCoin);this.popupDonTay.showPopup()},ngRandCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListCardInfo:b.Array8,ListCardInfo_Type:b.Object8,ListCardInfo_Type_Struct:{userID:b.UInt32,cardList:b.Array8,cardList_Type:b.UInt8,
coinPot:b.Int64,coinPlay:b.Int64},MatchID:b.UInt32,DealerID:b.UInt32,CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngRandCard : "+JSON.stringify(a));this._gameInfoContain.setMatchIdInfo(a.MatchID);this.compoButtons.restartAllButton();this.effectContainer.hideAllEffect();this.effectContainer.hideEffectVanMoi();this.boxCardContainer.randCardXiTo(a);MGGameBoardXiTo.CoinRaiseInRound=a.CoinRaiseInRound},ngActiveUser:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={ActivePlayer:b.UInt32,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32};a=(new BinaryParser).initObj(b,a.content);MGGameBoardXiTo.timeOut=a.TimeOut;this.updateActivePlayer(a);this.effectContainer.playEffectToDau(a.ActivePlayer);Utilities.showLog("ngActiveUser : "+JSON.stringify(a))},ngRandNextCard:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CardInfo:b.Array8,CardInfo_Type:b.Object8,CardInfo_Type_Struct:{userID:b.UInt32,cardID:b.UInt8},DealerID:b.UInt32,ActivePlayer:b.UInt32,
ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngRandNextCard : "+JSON.stringify(a));MGGameBoardXiTo.GameStatus=MGGameBoardXiTo.STATE.DEAL_CARD;this.effectContainer.playEffectToDau(a.ActivePlayer);this.boxCardContainer.randNextCardXiTo(a);MGGameBoardXiTo.my.isLatTay||this.compoButtons.setLatTayEnable(!0)},ngTo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,
CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTo : "+JSON.stringify(a));cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:a.ActionInfo.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_TO});MGGameBoardXiTo.CoinRaiseInRound=
a.CoinRaiseInRound;MGGameBoardXiTo.CoinAction=a.ActionInfo.CoinAction;this.processAction(a.ActionInfo);this.updateActivePlayer(a.ActiveInfo)},ngUpBai:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};
a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngUpBai : "+JSON.stringify(a));MGGameBoardXiTo.CoinRaiseInRound=a.CoinRaiseInRound;MGGameBoardXiTo.CoinAction=a.CoinAction;cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:a.ActionInfo.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_UP_BO});(b=MGGameBoardXiTo.listUser[a.ActionInfo.UserID])&&b.makeUpBai(!0);this.updateActivePlayer(a.ActiveInfo)},ngKhongTo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngKhongTo : "+JSON.stringify(a));MGGameBoardXiTo.CoinRaiseInRound=a.CoinRaiseInRound;MGGameBoardXiTo.CoinAction=a.CoinAction;cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,
{UserID:a.ActionInfo.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_KHONG_TO});this.updateActivePlayer(a.ActiveInfo)},ngTheo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("ngTheo : "+JSON.stringify(a));MGGameBoardXiTo.CoinRaiseInRound=a.CoinRaiseInRound;MGGameBoardXiTo.CoinAction=a.CoinAction;cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_EFFECTS_LIST,{UserID:a.ActionInfo.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.FX_THEO});this.processAction(a.ActionInfo);this.updateActivePlayer(a.ActiveInfo)},ngResponseDonTay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,AnteCoin:b.Int64};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("ngResponseDonTay : "+JSON.stringify(a));a.UserID==MGGameInfo.myInfo.UserID&&(cc.eventManager.dispatchCustomEvent(MGCompoEffectsXiTo.EVENTS.FX_DON_TAY,{UserID:a.UserID,EffectName:MGCompoEffectsXiTo.EVENTS.DON_TAY}),MGGameBoardXiTo.listUser[MGGameInfo.myInfo.UserID].isPlaying()||(MGGameBoardXiTo.my.betCoin=a.AnteCoin,this.compoUsersContain.getCompoUserByUserID(MGGameInfo.myInfo.UserID).setUserGold(MGGameBoardXiTo.my.betCoin),Utilities.showLog("MGGameBoardXiTo.my.betCoin "+
MGGameBoardXiTo.my.betCoin)))},ngLatTay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,CardInfo:b.Array8,ListCardInfo_Type:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngLatTay : "+JSON.stringify(a));(b=MGGameBoardXiTo.listUser[a.UserID])?(b.latBaiTay(a.CardInfo[0]),MGGameInfo.myInfo.UserID==a.UserID&&(MGGameBoardXiTo.my.isLatTay=!0)):Utilities.showLog("ngLatTay khong thanh cong")},updateActivePlayer:function(a){this.compoUsersContain.updateActiveUser(a);
if(a.ActivePlayer==MGGameInfo.myInfo.UserID){this.compoButtons.setCoinTo(0);this.compoButtons.updateButton(a);if(void 0!==a.CoinPlay){var b=0,b=MGGameBoardXiTo.CoinRaiseInRound-a.CoinPlay;this.compoButtons.setCoinTheo(a.CoinPot<b?a.CoinPot:b)}else b=MGGameBoardXiTo.CoinRaiseInRound-MGGameBoardXiTo.my.playCoin,0<b&&this.compoButtons.setCoinTheo(MGGameBoardXiTo.my.betCoin<b?MGGameBoardXiTo.my.betCoin:b),Utilities.showLog("MGGameBoardXiTo.my.playCoin "+MGGameBoardXiTo.my.playCoin+" MGGameBoardXiTo.CoinRaiseInRound "+
MGGameBoardXiTo.CoinRaiseInRound);mg.audio.playEffect(ResourceManager.MGresourcesGameXiTo.TOI_LUOT,MGGameInfo.gameVolume)}else this.compoButtons.updateButton()},ngCalculateResult:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultInfo:b.Array8,ResultInfo_Type:b.Object8,ResultInfo_Type_Struct:{UserID:b.UInt32,CardList:b.Array8,CardList_Type:b.UInt8,CardHighLight:b.Array8,CardHighLight_Type:b.UInt8,ValueCard:b.UInt8,IsUpbai:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngCalculateResult : "+
JSON.stringify(a));MGGameBoardXiTo.GameStatus=MGGameBoardXiTo.STATE.CALCULATE_FINISH;this.boxCardContainer.processCalculateResult(a);this.compoButtons.setVisibleTopButton(!1);this.effectContainer.hideEffectsToDau()},ngEndMatch:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultInfo:b.Array8,ResultInfo_Type:b.Object8,ResultInfo_Type_Struct:{userId:b.UInt32,playerNo:b.UInt8,winRank:b.UInt32,resultCoin:b.Int64,coin:b.Int64,fee:b.Int64,coinPot:b.Int64}};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("ngEndMatch : "+JSON.stringify(a));MGGameBoardXiTo.GameStatus=MGGameBoardXiTo.STATE.FINISH;this._xuController.effectXu(a.ResultInfo);this.effectContainer.playEffectEndGame(a.ResultInfo);this.compoUsersContain.resultMoneyXiTo(a.ResultInfo);MGGameBoardXiTo.my.isLatTay=0;MGGameBoardXiTo.my.isUpbai=0},processAction:function(a){this._xuController.createXuFromUserID(a.UserID,a.CoinAction,!0);var b=MGGameBoardXiTo.listUser[a.UserID];b&&(b.setStringCoinBet(a.CoinPlay),this.compoUsersContain.getCompoUserByUserID(a.UserID).setUserGold(a.CoinPot),
a.UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardXiTo.my.playCoin=a.CoinPlay,this.setBetCoinForMyUser(a.CoinPot)))},setBetCoinForMyUser:function(a){MGGameBoardXiTo.my.betCoin=a;MGGameBoardXiTo.my.betCoin>MGGameBoardXiTo.MaxTay?this.compoButtons.setDonTayEnable(!1):this.compoButtons.setDonTayEnable(!0)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardXiTo.listUser={};MGGameBoardXiTo.clearCards();this.compoUsersContain&&(this.compoUsersContain.setDispose(),this.compoUsersContain.removeFromParent(),
this.compoUsersContain=null,Utilities.showLog("setDispose compoUsersContain"));this.boxCardContainer&&(this.boxCardContainer.setDispose(),this.boxCardContainer.removeFromParent(),this.boxCardContainer=null,Utilities.showLog("setDispose boxCardContainer"));this.effectContainer&&(this.effectContainer.clearTimeoutEffects(),this.effectContainer.setDispose(),this.effectContainer.removeFromParent(),this.effectContainer=null,Utilities.showLog("setDispose effectContainer"));this.compoButtons&&(Utilities.showLog("setDispose compoButtons"),
this.compoButtons.setDispose(),this.compoButtons.removeFromParent(),this.compoButtons=null);this.compoButtonsBet&&(Utilities.showLog("setDispose compoButtonsBet"),this.compoButtonsBet.setDispose(),this.compoButtonsBet.removeFromParent(),this.compoButtonsBet=null);this.coinBetUserContainer&&(Utilities.showLog("setDispose coinBetUserContainer"),this.coinBetUserContainer.setDispose(),this.coinBetUserContainer.removeFromParent(),this.coinBetUserContainer=null);this._xuController&&(Utilities.showLog("setDispose _xuController"),
this._xuController.setDispose(),this._xuController.removeFromParent(),this._xuController=null);this.popupDonTay&&(Utilities.showLog("setDispose popupDonTay"),this.popupDonTay.setDispose(),this.popupDonTay.removeFromParent(),this.popupDonTay=null);Utilities.showLog("OUT GAME XITO : "+this._listEvents.length)}});var MGXiToController=MGBaseNode.extend({dealer:null,compoChiaBai:null,listCardsUsers:null,listCalcelCard:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initEventBtnFromNode();this._initUI();this.initDealer();this.initCompoChiaBai();this.initCards();this.initBoxcardUsers();this.initEvents()},initDealer:function(){this.dealer=new sp.SkeletonAnimation(ResourceManager.MGresourcesGameXiTo.Dealer_Json,ResourceManager.MGresourcesGameXiTo.Dealer_Atlas);
this.dealer.setScale(4);var a=this.getChildByName("MGDealer").getPosition();this.dealer.setPosition(cc.p(a.x,a.y-15));this.addChild(this.dealer);this.dealer.setAnimation(0,"Idle",!0)},initCompoChiaBai:function(){this.compoChiaBai=new CompoChiaBai;var a=this.getChildByName("MGDealer").getPosition();this.compoChiaBai.initObj(MGGameBoardXiTo.CARD_WIDTH,MGGameBoardXiTo.CARD_HEIGHT,cc.p(a.x,a.y-50),.05);this.addChild(this.compoChiaBai)},_initUI:function(){this.listCardsUsers=[];this.listCalcelCard=[];
this.boBai=this.mainGame._mainLayer.getChildByName("MGDealer")},initCards:function(){MGGameBoardXiTo.Cards=[];var a;for(a=4;52>a;a++){var b=new MGCardXiTo;b.setSpriteFrame("card"+a+".png");b.setName("MGCard"+a+".png");b._idCard=MGGameBoardXiTo.Cards.length;b.setRealSpriteName("card"+a+".png");MGGameBoardXiTo.Cards.push(b);b.retain()}for(a=0;5>a;a++)b=new MGCardXiTo,b.setName("MGCard"+a+".png"),b.setSpriteFrame("card"+a+".png"),b._idCard=MGGameBoardXiTo.Cards.length,b.setRealSpriteName("card"+a+".png"),
MGGameBoardXiTo.Cards.push(b),b.retain();b=new MGCardXiTo;b.retain();b.setName("MGCard52.png");b.setSpriteFrame("card52.png");b.setRealSpriteName("card52.png");b._idCard=52;MGGameBoardXiTo.Cards.push(b)},initBoxcardUsers:function(){for(var a=[],b=1;6>b;b++){var d=new MGBoxCardUserXiTo;d.initObj(this.mainGame);d.setPosition(this.getChildByName("MGBoxCard_"+b).getPosition());a.push(d.getPosition());this.addChild(d);d.setVisible(!1);this.listCardsUsers.push(d);1==b?d._isOwner=!0:d._isOwner=!1}},initEvents:function(){this._initEventsGame();
this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.FINISH,this.ngFinishRand.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.OPEN_CARD,this.ngOpenCard.bind(this)))},randCardXiTo:function(a){var b=[],d=[];a=a.ListCardInfo;for(var e=0;e<a.length;e++){var f=a[e].cardList,g=MGGameBoardXiTo.listUser[a[e].userID];g&&(Utilities.showLog("reset user when init it"),g.resetUser(),this.listCardsUsers[g.Index-1].addListCard(f),g.setListCard(this.listCardsUsers[g.Index-
1]),g.setCoinBet(this.mainGame.coinBetUserContainer.listCompoCoinBetUser[g.Index-1]),g.setStringCoinBet(a[e].coinPlay),this.mainGame._xuController.createXuFromUserID(a[e].userID,a[e].coinPlay,!0),this.mainGame.compoUsersContain.getCompoUserByUserID(a[e].userID).setUserGold(a[e].coinPot),a[e].userID==MGGameInfo.myInfo.UserID&&(MGGameBoardXiTo.my.playCoin=a[e].coinPlay,this.mainGame.setBetCoinForMyUser(a[e].coinPot)),d.push(f),b.push(this.listCardsUsers[g.Index-1].getPosition()))}this.compoChiaBai.delay=
.2;setTimeout(function(){this.dealer.setAnimation(0,"DealCard",!0);this.compoChiaBai.playEffectStepByStep(b,d,MGGameBoardXiTo.DurationChiaBai);mg.audio.playEffect(ResourceManager.MGresourcesGameXiTo.CHIA_BAI,MGGameInfo.gameVolume)}.bind(this),1E3)},randNextCardXiTo:function(a){for(var b=a.CardInfo,d=[],e=[],f=0;f<b.length;f++){var g=MGGameBoardXiTo.listUser[b[f].userID];g&&(g.addCardtoList(b[f].cardID),d.push(g.getCardBoxPosition()),e.push([b[f].cardID]))}this.dealer.setAnimation(0,"DealCard",!0);
this.compoChiaBai.playEffectStepByStep(d,e,MGGameBoardXiTo.DurationChiaBai);mg.audio.playEffect(ResourceManager.MGresourcesGameXiTo.CHIA_BAI,MGGameInfo.gameVolume);this.mainGame.updateActivePlayer(a)},processCalculateResult:function(a){a=a.ResultInfo;for(var b=0;b<a.length;b++){var d=MGGameBoardXiTo.listUser[a[b].UserID];d&&d.processCaculateCards(a[b])}},ngFinishRand:function(){mg.audio.stopAllEffects();this.dealer.setAnimation(0,"Idle",!0);Utilities.showLog("ngFinishRand")},ngOpenCard:function(a){a=
a.getUserData();Utilities.showLog("ngOpenCard: "+a);if(52!=a)MGGameBoardXiTo.getCardByID(a).setVisible(!0);else for(var b in MGGameBoardXiTo.listUser)a=MGGameBoardXiTo.listUser[b],a.setVisibleListCards(!0),a.showCardAtIndex(0);this.dealer.setAnimation(0,"Idle",!0)},ngResumeMatch:function(a){for(var b=a.ListUserInfo,d=0;d<b.length;d++){var e=MGGameBoardXiTo.listUser[b[d].userID];e&&(this.listCardsUsers[e.Index-1].addListCard(b[d].cardList),e.setListCard(this.listCardsUsers[e.Index-1]),e.setVisibleListCards(!0),
e.setAllCardVisible(!0),b[d].isUpbai&&e.makeUpBai(!0),e.setCoinBet(this.mainGame.coinBetUserContainer.listCompoCoinBetUser[e.Index-1]),e.setStringCoinBet(b[d].coinPlay),this.mainGame.compoUsersContain.getCompoUserByUserID(b[d].userID).setUserGold(b[d].coinPot),this.mainGame._xuController.createXuFromUserID(b[d].userID,b[d].coinPlay,!1),MGGameInfo.myInfo.UserID==b[d].userID&&(MGGameBoardXiTo.my.isLatTay=b[d].isLatTay,MGGameBoardXiTo.my.isUpbai=b[d].isUpbai,!MGGameBoardXiTo.my.isUpbai&&MGGameBoardXiTo.my.isLatTay&&
e.xemBaiTay(),MGGameBoardXiTo.my.playCoin=b[d].coinPlay,this.mainGame.setBetCoinForMyUser(b[d].coinPot),Utilities.showLog("MGGameBoardXiTo.my.betCoin "+MGGameBoardXiTo.my.betCoin)))}this.mainGame.updateActivePlayer(a)}});var MGGameBoardXiTo=cc.Class.extend({_listEvents:null,ctor:function(){}});MGGameBoardXiTo.my={betCoin:0,playCoin:0,position:0,isLatTay:0,isUpbai:0};MGGameBoardXiTo.listUser={};MGGameBoardXiTo.timeOut=0;MGGameBoardXiTo.Cards=null;MGGameBoardXiTo.getCardByID=function(a){return MGGameBoardXiTo.Cards[a]};MGGameBoardXiTo.clearCards=function(){for(;0<MGGameBoardXiTo.Cards.length;){var a=MGGameBoardXiTo.Cards.pop();a.removeFromParent(!0);a.release()}MGGameBoardXiTo.Cards=null};
MGGameBoardXiTo.CARD_WIDTH=80;MGGameBoardXiTo.CARD_HEIGHT=80;MGGameBoardXiTo.DurationXuMove=.3;MGGameBoardXiTo.DurationChiaBai=.5;MGGameBoardXiTo.STATE={NOT_START:0,START_GAME:1,DEAL_CARD:2,PLAYING:3,CALCULATE_FINISH:4,FINISH:5};MGGameBoardXiTo.MinTay=0;MGGameBoardXiTo.MaxTay=0;ResourceManager.MGREsourcesGameLieng={Card52:"res/game/Cards/mat-sau.png",AtlasCards:"res/game/Cards/AtlasCards.png",AtlasCardsPlist:"res/game/Cards/AtlasCards.plist",atlaslieng_plist:"res/game/lieng/atlaslieng/atlasLieng.plist",atlaslieng_png:"res/game/lieng/atlaslieng/atlasLieng.png",MGUIPopupDonTay:"res/game/lieng/UIItemDonTay.json",MGUILayerLieng:"res/game/lieng/UILayerLieng.json",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",
Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",VanMoi_Atlas:"res/game/Components/EffectThangThua/vanmoi.atlas",VanMoi_PNG:"res/game/Components/EffectThangThua/vanmoi.png",VanMoi_Json:"res/game/Components/EffectThangThua/vanmoi.json",CHIA_BAI:"res/game/lieng/Sounds/ChiaBai.mp3",DANH:"res/game/lieng/Sounds/Danh.mp3",
THANG:"res/game/lieng/Sounds/Thang.mp3",CUOC_PHINH:"res/game/lieng/Sounds/CuocPhinh.mp3"};var resourcesGameLieng=[];for(i in ResourceManager.MGREsourcesGameLieng)ResourceManager.MGREsourcesGameLieng[i]=""+cc.loader.resPath+ResourceManager.MGREsourcesGameLieng[i],resourcesGameLieng.push(ResourceManager.MGREsourcesGameLieng[i]);ConstantsVariable.NETWORK_LIENG={ListUser:2E3,GameData:2001,AddUser:2002,UserLeave:2003,RequireDonTay:2004,RandCard:2005,RandNextCard:2006,CompareCard:2007,EndMatch:2008,SetTool:2009,To:2010,KhongTo:2011,ToMax:2012,Theo:2013,UpBai:2014,ActivePlayer:2015,LatTay:2016,CalculateResult:2017,ResponseDonTay:2018};ConstantsVariable.STATE_LIENG={TO_OR_NOT:2020,FOLLOW_OR_NOT:2021};var MGNetSendLieng=cc.Class.extend({gameModuleID:null,ctor:function(){},sendDonTay:function(a){Utilities.showLog("--sendDonTay: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.RequireDonTay.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendTo:function(a){Utilities.showLog("--sendTo: "+a);var b={};b.raisingCoin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.To.toString(),
{raisingCoin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendUpBo:function(){Utilities.showLog("--sendUpBo");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.UpBai,null,null);MGNetCore.MGSocket.sendMsg(a)},sendKhongTo:function(){Utilities.showLog("--sendKhongTo");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.KhongTo,null,null);MGNetCore.MGSocket.sendMsg(a)},sendTheo:function(){Utilities.showLog("--sendTheo");
var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.Theo,null,null);MGNetCore.MGSocket.sendMsg(a)},sendLatTay:function(){Utilities.showLog("--sendLatTay");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.LatTay,null,null);MGNetCore.MGSocket.sendMsg(a)},sendToolLieng:function(a){Utilities.showLog("--sendToolLieng");var b={};b.ListCards=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_LIENG.SetTool,{ListCards:BinaryConstants.DataTypeID.Array8,
ListCards_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXuControllerLieng=MGBaseNode.extend({listBet:null,mainGame:null,index:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listXu=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.initListXu()},initListXu:function(){for(var a=1;7>a;a++)this.listXu[a]=[]},initXu:function(a,b){for(var d in MGGameBoardLieng.listUser)if(MGGameBoardLieng.listUser[d].UserID===a){this.index=MGGameBoardLieng.listUser[d].Index;var e=new cc.Sprite;e.setSpriteFrame(MGXuControllerLieng.TYPE_BET[this.initImageBet(b)].NAME);
e.setVisible(!0);this.addChild(e);var f=this.mainGame.comboUsers.getCompoUserByUserID(a).getPosition();1==this.index?e.setPosition(this.mainGame.comboBet.getPosition()):e.setPosition(f.x,f.y);this.listXu[this.index].push(e);f=this.getChildByName("MGBetCuoc_"+this.index).getPosition();1==MGGameInfo._paused?(e.setPosition(f.x,f.y),this.shortXuUser()):e.runAction(cc.sequence(cc.moveTo(.2,cc.p(f.x,f.y)),cc.callFunc(this.shortXuUser.bind(this))))}mg.audio.playEffect(ResourceManager.MGREsourcesGameLieng.CUOC_PHINH,
MGGameInfo.gameVolume)},initImageBet:function(a){for(var b in MGXuControllerLieng.TYPE_BET)if(MGXuControllerLieng.TYPE_BET[b].value>=a)return b;return"BET_4"},updateXu:function(a){var b=0,d;for(d in MGXuControllerLieng.TYPE_BET)MGXuControllerLieng.TYPE_BET[d].value=a[b]*this.mainGame.minBet,b++},resetXu:function(){for(var a=1;7>a;a++){for(var b=0;b<this.listXu[a].length;b++)this.listXu[a][b].setVisible(!1),this.listXu[a][b].removeFromParent(!0);this.listXu[a]=[]}},setBetXuAll:function(a){for(var b=
0;b<a.length;b++)for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID===a[b].UserID&&this.initXu(a[b].UserID,a[b].coinPlay)},shortXuUser:function(){for(var a=null,b=1;b<this.listXu[this.index].length;b++)5==b?(a=this.listXu[this.index][0].getPosition(),this.listXu[this.index][b].setPosition(a.x+18,a.y)):10>b?(a=this.listXu[this.index][b-1].getPosition(),this.listXu[this.index][b].setPosition(a.x,a.y+3)):(a=this.listXu[this.index][9].getPosition(),this.listXu[this.index][b].setPosition(a.x,
a.y))},setBetXuGameData:function(a){for(var b=0;b<a.length;b++)for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID===a[b].UserID&&this.initXu(a[b].UserID,a[b].CoinPlay)},effectXu:function(a){for(var b=[],d=[],e,f,g,h=1;7>h;h++)for(var k=0;k<this.listXu[h].length;k++)d.push(this.listXu[h][k]);for(h=0;h<a.length;h++)0<a[h].resultCoin&&b.push(a[h].UserID);for(var l=Math.floor(d.length/b.length),n=null,m=null,h=0;h<b.length;h++){for(var u in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[u].UserID===
b[h]&&(n=this.mainGame.comboUsers.getCompoUserByUserID(b[h]).getPosition());for(k=0;k<l;k++){a=parseInt(100*Math.random())+570;e=parseInt(100*Math.random())+350;m=l*h+k;if(m>=d.length)break;f=parseInt(30*Math.random())+n.x;g=parseInt(30*Math.random())+n.y;d[m].stopAllActions();1==MGGameInfo._paused?this.resetXu():d[m].runAction(cc.sequence(cc.moveTo(.3,cc.p(a,e)),cc.delayTime(.5),cc.moveTo(.4,cc.p(f,g)),cc.delayTime(.5),cc.callFunc(this.resetXu.bind(this))))}}}});
MGXuControllerLieng.TYPE_BET={BET_0:{NAME:"xu100.png",value:"1000"},BET_1:{NAME:"xu500.png",value:"5000"},BET_2:{NAME:"xu1000.png",value:"10000"},BET_3:{NAME:"xu5000.png",value:"50000"},BET_4:{NAME:"xu10000.png",value:"0"}};var MGComboTextLieng=MGBaseNode.extend({mainGame:null,textTo:null,textTheo:null,tienTheo:null,btnCloseTo:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.initText();this._initEventsGame()},initText:function(){this.textTo=this.getChildByName("MGTextTo");this.textTo.ignoreContentAdaptWithSize(!0);this.textTheo=this.getChildByName("MGTextTheo");this.textTheo.ignoreContentAdaptWithSize(!0);this.btnCloseTo=this.getChildByName("MGButtonResetTo")},
_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.btnCloseTo.addClickEventListener(this.resetTienTo.bind(this))},setTextTo:function(a){var b=this.mainGame.comboUsers.getCompoUserByUserID(MGGameInfo.myInfo.UserID),d=this.mainGame.comboUsers.getStringToBet(b.getUserGold());this.mainGame.comboUsers.getStringToBet(a)>d?this.textTo.setString(b.getUserGold()):this.textTo.setString(a)},setTextTheo:function(a,b){if(b==MGGameInfo.myInfo.UserID){var d=this.mainGame.comboUsers.getCompoUserByUserID(b);
if(d){var e=this.mainGame.comboUsers.getStringToBet(d.getUserGold());a>e?this.textTheo.setString(d.getUserGold()):this.textTheo.setString(Utilities.Coin(a));this.tienTheo=a}}},hideTextTo:function(){this.textTo.setVisible(!1);this.btnCloseTo.setVisible(!1)},hideAllText:function(){this.textTo.setVisible(!1);this.textTheo.setVisible(!1);this.btnCloseTo.setVisible(!1)},showTextTo:function(){this.textTo.setVisible(!0);this.btnCloseTo.setVisible(!0)},showTextTheo:function(){this.textTheo.setVisible(!0)},
showAllText:function(){this.textTo.setVisible(!0);this.textTheo.setVisible(!0);this.btnCloseTo.setVisible(!0)},setBetTheoGameData:function(a,b){for(var d=0;d<a.length;d++)a[d].UserID==MGGameInfo.myInfo.UserID&&0<b&&(this.mainGame.coinTheo=b-a[d].CoinPlay,this.setTextTheo(this.mainGame.coinTheo,a[d].UserID))},resetTienTo:function(){this.setTextTo(Utilities.Coin(this.mainGame.minBet));this.mainGame.countClickBet=0}});var MGComboBetCuoc=MGBaseNode.extend({mainGame:null,listBetCuoc:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listBetCuoc=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.initComboText()},initComboText:function(){for(var a=1;7>a;a++){var b=this.getChildByName("MGBetCuoc_"+a);this.listBetCuoc[a]=b}},resetBetCuoc:function(){this.hideAllBetCuoc();for(var a=1;7>a;a++)this.listBetCuoc[a].getChildByName("MGTextCuoc").setString(0)},setBetCuoc:function(a,
b){this.listBetCuoc[b.Index].setVisible(!0);this.listBetCuoc[b.Index].getChildByName("MGTextCuoc").setString(Utilities.Coin(a))},hideAllBetCuoc:function(){for(var a=1;7>a;a++)this.listBetCuoc[a].setVisible(!1)},setBetCuocAll:function(a){this.resetBetCuoc();for(var b=0;b<a.length;b++)for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID==a[b].UserID&&(this.setBetCuoc(a[b].coinPlay,MGGameBoardLieng.listUser[d]),MGGameBoardLieng.listUser[d].BetCuocUser=a[b].coinPlay)},setBetCuocGameData:function(a){this.resetBetCuoc();
for(var b=0;b<a.length;b++)for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID===a[b].UserID&&this.setBetCuoc(a[b].CoinPlay,MGGameBoardLieng.listUser[d])}});var MGComboXuBetLieng=MGComboXuBet.extend({listRate:null,ctor:function(){MGComboXuBet.prototype.ctor.call(this)},initObj:function(){MGComboXuBet.prototype.initObj.call(this)},setComboBetCuoc:function(a,b){this.listRate=[];for(var d=0;d<a.length;d++)this.listRate[d]=a[d]*b;this.getBetHienThi()},getBetHienThi:function(){for(var a=0;a<this.listRate.length-1;a++)this.getChildByName("Text_"+a).setString(Utilities.Coin(this.listRate[a]));this.getChildByName("Text_4").setString("MAX")},onClickBtnFromCocostudio:function(a,
b){MGComboXuBet.prototype.onClickBtnFromCocostudio.call(this,a,b);a.setEnabled(!0);a.setBright(!0);a.setScale(1)}});var MGLiengButtons=MGBaseNode.extend({_listButton:null,isLatTay:0,mainGame:null,listLatTay:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._listButton=[];this.listLatTay=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initEventBtnFromNode();this._initListLatTay()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=0;b<a.length;b++)a[b]instanceof ccui.Button&&(a[b].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[b]))},
_initListLatTay:function(){for(var a=1;7>a;a++)this.listLatTay[a]=0},hideButton:function(a){this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGLiengButtons.BUTTON_NAME.TO:this.mainGame.netSend.sendTo(this.mainGame.comboUsers.getStringToBet(this.mainGame.comboText.textTo.getString()));this.hideAllButton();break;
case MGLiengButtons.BUTTON_NAME.UP_BO:this.mainGame.netSend.sendUpBo();this.hideAllButton();break;case MGLiengButtons.BUTTON_NAME.KHONG_TO:this.mainGame.netSend.sendKhongTo();this.hideAllButton();break;case MGLiengButtons.BUTTON_NAME.THEO:this.mainGame.netSend.sendTheo();this.hideAllButton();break;case MGLiengButtons.BUTTON_NAME.LAT_TAY:this.hideButtonLieng(MGLiengButtons.BUTTON_NAME.LAT_TAY);this.mainGame.netSend.sendLatTay();break;case MGLiengButtons.BUTTON_NAME.DON_TAY:this.mainGame.popupDonTay.showPopup()}mg.audio.playEffect(ResourceManager.MGREsourcesGameLieng.DANH,
MGGameInfo.gameVolume)},updateButtonLieng:function(a){if(MGGameBoardLieng.UserActive==MGGameInfo.myInfo.UserID){this.hideAllButton();for(var b=0;b<a.length;b++)this.showButtonLieng(MGLiengButtons.ACTION_BUTTON[a[b]].BUTTON_NAME),2==a[b]&&this.mainGame.comboText.showTextTo(),4==a[b]&&this.mainGame.comboText.showAllText()}else this.hideAllButton();for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID==MGGameInfo.myInfo.UserID&&(1==this.listLatTay[MGGameBoardLieng.listUser[d].Index]?
this.hideButtonLieng(MGLiengButtons.BUTTON_NAME.LAT_TAY):this.showButtonLieng(MGLiengButtons.BUTTON_NAME.LAT_TAY))},hideButtonLieng:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButtonLieng:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},hideAllButton:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1);this.showButtonLieng(MGLiengButtons.BUTTON_NAME.DON_TAY);
this.mainGame.comboText.hideAllText()},updateButtonLatTay:function(a){for(var b in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[b].UserID==a&&(this.listLatTay[MGGameBoardLieng.listUser[b].Index]=1)},resetListLatTay:function(){for(var a=1;7>a;a++)this.listLatTay[a]=0},showAllLatTayUser:function(){this.resetListLatTay();var a=0,b;for(b in MGGameBoardLieng.listUserBefore)MGGameBoardLieng.listUserBefore[b].UserID==MGGameInfo.myInfo.UserID&&(a=1);0==a?this.updateButtonLatTay(MGGameInfo.myInfo.UserID):
this.showButtonLieng(MGLiengButtons.BUTTON_NAME.LAT_TAY)},updateButtonLatTayGameData:function(a){for(var b=0,d=0;d<a.length;d++)a[d].UserID==MGGameInfo.myInfo.UserID&&(1==a[d].isLatTay?this.updateButtonLatTay(a[d].UserID):this.showButtonLieng(MGLiengButtons.BUTTON_NAME.LAT_TAY),b=1);0==b&&this.updateButtonLatTay(MGGameInfo.myInfo.UserID)},getButtonTo:function(){if(MGGameBoardLieng.UserActive==MGGameInfo.myInfo.UserID){var a=this.mainGame.comboUsers.getCompoUserByUserID(MGGameInfo.myInfo.UserID),a=
this.mainGame.comboUsers.getStringToBet(a.getUserGold());this.mainGame.comboUsers.getStringToBet(this.mainGame.comboText.textTheo.getString())>=a&&(this.hideButtonLieng(MGLiengButtons.BUTTON_NAME.TO),this.mainGame.comboText.hideTextTo())}},updateButtonDonTay:function(){if(0==this.mainGame.popupDonTay.firstDonTay){var a=this.mainGame.comboUsers.getCompoUserByUserID(MGGameInfo.myInfo.UserID);this.mainGame.comboUsers.getStringToBet(a.getUserGold())>=this.mainGame.popupDonTay.maxCuoc?this.hideButtonLieng(MGLiengButtons.BUTTON_NAME.DON_TAY):
this.showButtonLieng(MGLiengButtons.BUTTON_NAME.DON_TAY)}}});MGLiengButtons.BUTTON_NAME={TO:"MGButtonTo",UP_BO:"MGButtonUpBo",KHONG_TO:"MGButtonKhongTo",THEO:"MGButtonTheo",LAT_TAY:"MGButtonLatTay",DON_TAY:"MGButtonDonTay"};MGLiengButtons.ACTION_BUTTON={1:{NAME_ACTION:"UP_BO",BUTTON_NAME:"MGButtonUpBo"},2:{NAME_ACTION:"TO",BUTTON_NAME:"MGButtonTo"},3:{NAME_ACTION:"KHONG_TO",BUTTON_NAME:"MGButtonKhongTo"},4:{NAME_ACTION:"THEO",BUTTON_NAME:"MGButtonTheo"}};var MGPopupDonTay=MGBaseNode.extend({mainGame:null,_minCuoc:null,maxCuoc:null,_tienTay:null,firstDonTay:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this._initBackGroundDonTay();this.cloneFromNode(ccs.load(ResourceManager.MGREsourcesGameLieng.MGUIPopupDonTay,PreLoaderConfig.PathToResourceDefault).node);this.mainGame=a;this._initEventsGame()},_initBackGroundDonTay:function(){var a=new ccui.Layout;a.setContentSize(2E3,2E3);a.setAnchorPoint(.5,
.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.getChildByName("MGSliderCuoc").addEventListener(this._setDonTay.bind(this))},onClickBtnFromCocostudio:function(a,
b){switch(a.getName()){case MGPopupDonTay.BUTTON_NAME.XAC_NHAN:this.mainGame.netSend.sendDonTay(this._tienTay);this.hidePopup();break;case MGPopupDonTay.BUTTON_NAME.CLOSE_POPUP:this.hidePopup()}mg.audio.playEffect(ResourceManager.MGREsourcesGameLieng.DANH,MGGameInfo.gameVolume)},setMinCuoc:function(a,b){this._minCuoc=a;this.maxCuoc=b;this._setTienTay(this.maxCuoc);this.getChildByName("MGSliderCuoc").setPercent(100)},_setTienTay:function(a){if(1==this.firstDonTay)this._tienTay=a;else{var b=this.mainGame.comboUsers.getCompoUserByUserID(MGGameInfo.myInfo.UserID),
b=this.mainGame.comboUsers.getStringToBet(b.getUserGold());this._tienTay=b+a>=this.maxCuoc?this.maxCuoc-b:a}this.getChildByName("MGTextTien").setString(Utilities.Coin(this._tienTay))},_setDonTay:function(a){var b=(this.maxCuoc-this._minCuoc)/10;a=Math.ceil(a.getPercent()/10);b=Math.floor(this._minCuoc+b*a);b=b>this.maxCuoc?this.maxCuoc:b;this._setTienTay(this.makeRound(b))},showPopup:function(){this._setDonTay(this.getChildByName("MGSliderCuoc"));this.setVisible(!0)},makeRound:function(a){1E3<a&&
(a-=a%1E3);return a},hidePopup:function(){this.setVisible(!1)}});MGPopupDonTay.BUTTON_NAME={XAC_NHAN:"MGButtonXacNhan",CLOSE_POPUP:"MGButtonCloseDonTay"};var MGBoxCardOtherUsersLieng=MGBaseNode.extend({_listCardOther:null,_listCardUser:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._listCardOther=[];this._listCardUser=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a},resetListCard:function(){for(var a=0;a<this._listCardOther.length;a++)MGGameBoardLieng.returnCardLieng(this._listCardOther[a]);this._listCardOther=[];for(a=0;a<this._listCardUser.length;a++)MGGameBoardLieng.returnCardLieng(this._listCardUser[a]);
this._listCardUser=[]},showCardEnds:function(a){this.resetListCard();for(var b=0;b<a.length;b++)if(0==a[b].IsUpbai)for(var d in MGGameBoardLieng.listUser){var e=MGGameBoardLieng.listUser[d];if(e&&e.UserID==a[b].UserID&&e.UserID!=MGGameInfo.myInfo.UserID)for(var f=0;3>f;f++)if(52!==a[b].CardList[f]){var g=MGGameBoardLieng.getCardByID(a[b].CardList[f]),h=this.mainGame.boxCardContainer.getChildByName("MGBoxCard_"+e.Index).getPosition();g.setPosition(h.x+30*f,h.y);MGGameBoardLieng.returnCardLieng(g);
this.mainGame.boxCardContainer.addChild(g);this._listCardOther.push(g)}}},showCard:function(a,b){for(var d in MGGameBoardLieng.listUser){var e=MGGameBoardLieng.listUser[d];if(e&&e.UserID==a&&e.UserID!=MGGameInfo.myInfo.UserID)for(var f=0;3>f;f++){var g=MGGameBoardLieng.getCardByID(b[f]),h=this.mainGame.boxCardContainer.getChildByName("MGBoxCard_"+e.Index).getPosition();g.setPosition(h.x+30*f,h.y);MGGameBoardLieng.returnCardLieng(g);this.mainGame.boxCardContainer.addChild(g);this._listCardUser.push(g)}}}});var MGBoxCardContainerLieng=MGBaseNode.extend({listBoxCard:null,boBaiLieng:null,comboChiaBai:null,boxCardOwner:null,_listCardShow:null,boxCardOther:null,timeOutDealCard:null,timeOutHideCard:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listBoxCard=[];this._listCardShow=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initUI();this._initEventsGame();this.initCards();this.initComboChiaBai();this.initBoxCardOwner();this.initBoxCardOther()},_initUI:function(){for(var a,
b=2;7>b;b++){this.listBoxCard[b]=[];for(var d=0;3>d;d++)a=new cc.Sprite,a.setSpriteFrame("card52.png"),a.removeFromParent(!0),a.setVisible(!1),this.getChildByName("MGBoxCard_"+b).addChild(a),a.setPosition(30*d,0),this.listBoxCard[b].push(a)}this.boBaiLieng=this.getChildByName("MGBobaiLieng");this.boBaiLieng.setVisible(!1)},initCards:function(){MGGameBoardLieng.Cards=[];var a;for(a=4;52>a;a++){var b=new MGCardLieng;b.setSpriteFrame("card"+a+".png");b.setName("MGCard"+a+".png");b.idCard=MGGameBoardLieng.Cards.length;
MGGameBoardLieng.Cards.push(b);b.retain()}for(a=0;4>a;a++)b=new MGCardLieng,b.setName("MGCard"+a+".png"),b.setSpriteFrame("card"+a+".png"),b.idCard=MGGameBoardLieng.Cards.length,MGGameBoardLieng.Cards.push(b),b.retain()},initComboChiaBai:function(){this.comboChiaBai=new CompoChiaBai;var a=this.getChildByName("MGBobaiLieng").getPosition();this.comboChiaBai.initObj(MGGameBoardLieng.CARD_WIDTH,MGGameBoardLieng.CARD_HEIGHT,cc.p(a.x,a.y-50),.05);this.addChild(this.comboChiaBai)},initBoxCardOwner:function(){this.boxCardOwner=
new MGBoxCardOwnerLieng;this.boxCardOwner.initObj(this.mainGame);this.addChild(this.boxCardOwner);this.boxCardOwner.setPosition(this.getChildByName("MGBoxCard_1").getPosition())},initBoxCardOther:function(){this.boxCardOther=new MGBoxCardOtherUsersLieng;this.boxCardOther.initObj(this.mainGame);this.addChild(this.boxCardOther)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(CompoChiaBai.EVENT.FINISH,this.ngFinishDealLieng.bind(this)))},
randCardLieng:function(a){var b=[],d;for(d in MGGameBoardLieng.listUserBefore)b.push(this.getChildByName("MGBoxCard_"+[MGGameBoardLieng.listUserBefore[d].Index]).getPosition());d=[];if(1<b.length){for(var e=0;e<b.length;e++)d.push([52,52,52]);for(e=0;e<a.ListCardInfo.length;e++)a.ListCardInfo[e].UserID==MGGameInfo.myInfo.UserID&&(this.boxCardOwner.addListCardLieng(a.ListCardInfo[e].cardList),this.boxCardOwner.setVisible(!1));this.timeOutDealCard=setTimeout(this.dealCardLieng.bind(this,b,d),1E3)}},
dealCardLieng:function(a,b){mg.audio.playEffect(ResourceManager.MGREsourcesGameLieng.CHIA_BAI,MGGameInfo.gameVolume);this.comboChiaBai.playEffect(a,b,.8);this.boBaiLieng.setVisible(!0)},ngFinishDealLieng:function(){this.timeOutHideCard=setTimeout(this.hideBoBai.bind(this),1E3);for(var a in MGGameBoardLieng.listUserBefore){var b=MGGameBoardLieng.listUserBefore[a];if(b&&b.UserID!=MGGameInfo.myInfo.UserID)for(var d=0;3>d;d++)this.listBoxCard[b.Index][d].setVisible(!0)}this.boxCardOwner.setVisible(!0);
this.mainGame.comboButtons.showAllLatTayUser()},hideBoBai:function(){this.boBaiLieng.setVisible(!1);mg.audio.stopAllEffects()},getGameData:function(a){for(var b=0;b<a.length;b++)if(0<a[b].CardList.length)if(a[b].UserID==MGGameInfo.myInfo.UserID)this.boxCardOwner.addListCardLieng(a[b].CardList);else for(var d in MGGameBoardLieng.listUser){var e=MGGameBoardLieng.listUser[d];if(e&&e.UserID==a[b].UserID)if(52!==a[b].CardList[0])this.showCardUser(e.UserID,a[b].CardList);else for(var f=0;3>f;f++)this.listBoxCard[e.Index][f].setVisible(!0)}},
showCardOtherUsers:function(a){this.boxCardOther.showCardEnds(a)},clearUILieng:function(){this.hideListBoxCard();this.boxCardOther.resetListCard();this.boxCardOwner.resetCardOwner()},hideListBoxCard:function(){for(var a=2;7>a;a++)for(var b=0;3>b;b++)this.listBoxCard[a][b].setVisible(!1)},showCardUser:function(a,b){this.boxCardOther.showCard(a,b)}});var MGComboUsersLieng=MGBaseNode.extend({listCompoUser:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.initListCompoUser();this._initEventsGame();this.mainGame=a},initListCompoUser:function(){this.listCompoUser=[];for(var a=1,b;7>a;a++)b=new MGCompUserInfoPlay,b.setPosition(this.getChildByName("MGPosition_"+a).getPosition()),b.setAlignInfo(MGCompUserInfoPlay.BottomAlign),this.listCompoUser.push(b),this.addChild(b)},
_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.ListUser.toString(),this.ngListUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.AddUser.toString(),this.ngAddUsers.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.UserLeave.toString(),this.ngUserLeave.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.ResponseDonTay.toString(),
this.ngResponseDonTay.bind(this)))},getCompoUserByIndex:function(a){return this.listCompoUser[a-1]},getCompoUserByUserID:function(a){for(var b=0;b<this.listCompoUser.length;b++)if(this.listCompoUser[b].getUserPlayId()==a)return this.listCompoUser[b];return null},ngListUsers:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,Avatar:b.StringDynamic,Position:b.UInt8}};
a=(new BinaryParser).initObj(b,a.content);this.updateMyPosition(a.ListUser);this.addListUserLieng(a.ListUser);Utilities.showLog("--ListUsers "+JSON.stringify(a))},addListUserLieng:function(a){for(var b in a)a[b].Index=this.getIndexByPosition(a[b].Position),this.addUserLieng(a[b])},getIndexByPosition:function(a){return(a-MGGameBoardLieng.my.position+6)%6+1},addUserLieng:function(a){var b=this.getCompoUserByIndex(a.Index);b&&(b.setUserInfoData(a.UserID,a.NickName,a.Coin,a.Avatar),b=new MGUserLieng,
b.initObj(a),MGGameBoardLieng.listUser[a.UserID]=b)},ngResponseDonTay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,AnteCoin:b.Int64};a=(new BinaryParser).initObj(b,a.content);if((b=this.getCompoUserByUserID(a.UserID))&&0==this.mainGame.isVan)if(1==this.mainGame.popupDonTay.firstDonTay)b.setUserGold(a.AnteCoin);else{var d=this.getStringToBet(b.getUserGold());b.setUserGold(a.AnteCoin+d)}a.UserID==MGGameInfo.myInfo.UserID&&0<a.AnteCoin&&(this.mainGame.comboEffect.showTextDonTay(),
this.mainGame.popupDonTay.firstDonTay=0,this.mainGame.comboButtons.updateButtonDonTay());Utilities.showLog("---ngResponseDonTay: "+JSON.stringify(a))},setGoldListUser:function(a){for(var b=0;b<a.length;b++){var d=this.getCompoUserByUserID(a[b].UserID);d&&d.setUserGold(a[b].CoinPot)}},setGoldUser:function(a){var b=this.getCompoUserByUserID(MGGameInfo.myInfo.UserID);b&&b.setUserGold(a)},ngAddUsers:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,Coin:b.UInt64,NickName:b.StringDynamic,
Avatar:b.StringDynamic,Position:b.UInt8};a=(new BinaryParser).initObj(b,a.content);a.Index=this.getIndexByPosition(a.Position);this.addUserLieng(a);Utilities.showLog("--AddUser: "+JSON.stringify(a))},ngUserLeave:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListUser:b.Array8,ListUser_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--UserLeave: "+JSON.stringify(a));this.userLeaveLieng(a.ListUser)},userLeaveLieng:function(a){for(var b=0;b<a.length;b++)this.removeUserLieng(a[b])},
removeUserLieng:function(a){var b=this.getCompoUserByUserID(a);b&&b.removeUserInfoData();delete MGGameBoardLieng.listUser[a]},updateMyPosition:function(a){for(var b in a)a[b].UserID==MGGameInfo.myInfo.UserID&&(MGGameBoardLieng.my.position=a[b].Position)},nextPlayer:function(a,b){this.stopAllClock();var d=this.getCompoUserByUserID(a);d&&d.runActionEffect(b)},nextPlayerGameData:function(a,b){this.stopAllClock();if(0<a){var d=this.getCompoUserByUserID(a);d&&d.runActionEffect(b)}},stopAllClock:function(){var a=
0,b=this.listCompoUser.length;for(a;a<b;a++)this.listCompoUser[a].stopActionEffect()},updateCoinUser:function(a){for(var b=0;b<a.length;b++){var d=this.getCompoUserByUserID(a[b].UserID);d&&d.setUserGold(a[b].coinPot)}},resultMoneyLieng:function(a){for(var b=0;b<a.length;b++){var d=this.getCompoUserByUserID(a[b].UserID);d&&d.setUserGold(a[b].coinPot)}},updateCoinCuoc:function(a,b){var d=this.getCompoUserByUserID(a);d&&d.setUserGold(b)},getStringToBet:function(a){a=a.replace(".","").replace(".","").replace(".",
"");return parseInt(a)},addListUserBefore:function(){MGGameBoardLieng.listUserBefore={};for(var a in MGGameBoardLieng.listUser)MGGameBoardLieng.listUserBefore[a]=MGGameBoardLieng.listUser[a]},addListUserBeforeGameData:function(a){MGGameBoardLieng.listUserBefore={};for(var b=0;b<a.length;b++)for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID==a[b].UserID&&(MGGameBoardLieng.listUserBefore[d]=MGGameBoardLieng.listUser[d])}});var MGBoxCardOwnerLieng=MGBaseNode.extend({mainGame:null,_listMyCard:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._listMyCard=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a},addListCardLieng:function(a){var b=0,d=a.length,e;for(b;b<d;b++)if(e=MGGameBoardLieng.getCardByID(a[b]))this.addChild(e),e.setPosition(cc.p(b*MGBoxCardOwnerLieng.CARD_SIZE,0)),this._listMyCard.push(e)},resetCardOwner:function(){for(var a=0;a<this._listMyCard.length;a++)MGGameBoardLieng.returnCardLieng(this._listMyCard[a]);
this._listMyCard=[]}});MGBoxCardOwnerLieng.CARD_SIZE=50;var MGCardLieng=MGBaseSprite.extend({idCard:0,ctor:function(){MGBaseSprite.prototype.ctor.call(this)},initObj:function(){MGBaseSprite.prototype.initObj.call(this)}});var MGUserLieng=cc.Class.extend({NumCardsRemain:0,Index:0,Position:0,UserID:0,BetCuocUser:0,ctor:function(){},initObj:function(a){this.Index=a.Index;this.Position=a.Position;this.UserID=a.UserID}});var MGComboEffectLieng=MGBaseNode.extend({listEffectLieng:null,fxVanMoi:null,fxUpBai:null,fxSap:null,fxLiengDongChat:null,fxLieng:null,fxAnh:null,fxKhongTo:null,fxTo:null,fxTheo:null,fx1diem:null,fx2diem:null,fx3diem:null,fx4diem:null,fx5diem:null,fx6diem:null,fx7diem:null,fx8diem:null,fx9diem:null,fxBu:null,textDonTay:null,mainGame:null,timeOutEffect:null,timeOutEffectKhongTo:null,timeOutEffectTo:null,timeOutEffectTheo:null,timeOutEffectUpBai:null,timeOutEffectDonTay:null,timeOutTextVanMoi:null,
ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listEffectLieng=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.initListEffect();this.initTextDonTay();this.initTextVanMoi()},initListEffect:function(){for(var a=1;7>a;a++)this.listEffectLieng[a]={};for(var b,d,a=1;7>a;a++)b=this.getChildByName("MGEffect_"+a).getPosition(),d=new cc.Sprite,d.setSpriteFrame("TextUpBo.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxUpBai=
d,d=new cc.Sprite,d.setSpriteFrame("TextSap.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxSap=d,d=new cc.Sprite,d.setSpriteFrame("LiengDongChat.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxLiengDongChat=d,d=new cc.Sprite,d.setSpriteFrame("TextLieng.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxLieng=d,d=new cc.Sprite,d.setSpriteFrame("TextAnh.png"),
this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxAnh=d,d=new cc.Sprite,d.setSpriteFrame("TextKhongTo.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxKhongTo=d,d=new cc.Sprite,d.setSpriteFrame("TextTo.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxTo=d,d=new cc.Sprite,d.setSpriteFrame("TextTheo.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),
this.listEffectLieng[a].fxTheo=d,d=new cc.Sprite,d.setSpriteFrame("TextBu.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fxBu=d,d=new cc.Sprite,d.setSpriteFrame("Text1Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx1diem=d,d=new cc.Sprite,d.setSpriteFrame("Text2Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx2diem=d,d=new cc.Sprite,d.setSpriteFrame("Text3Diem.png"),
this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx3diem=d,d=new cc.Sprite,d.setSpriteFrame("Text4Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx4diem=d,d=new cc.Sprite,d.setSpriteFrame("Text5Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx5diem=d,d=new cc.Sprite,d.setSpriteFrame("Text6Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),
this.listEffectLieng[a].fx6diem=d,d=new cc.Sprite,d.setSpriteFrame("Text7Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx7diem=d,d=new cc.Sprite,d.setSpriteFrame("Text8Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx8diem=d,d=new cc.Sprite,d.setSpriteFrame("Text9Diem.png"),this.addChild(d),d.setPosition(cc.p(b.x,b.y-35)),d.setVisible(!1),this.listEffectLieng[a].fx9diem=d,d=new sp.SkeletonAnimation(ResourceManager.MGREsourcesGameLieng.Thang_Json,
ResourceManager.MGREsourcesGameLieng.Thang_Atlas),this.addChild(d),d.setPosition(b),d.setVisible(!1),this.listEffectLieng[a].fxThang=d,d=new sp.SkeletonAnimation(ResourceManager.MGREsourcesGameLieng.Thua_Json,ResourceManager.MGREsourcesGameLieng.Thua_Atlas),this.addChild(d),d.setPosition(b),d.setVisible(!1),this.listEffectLieng[a].fxThua=d},initTextDonTay:function(){this.textDonTay=this.mainGame._mainLayer.getChildByName("MGTextDonTay");this.textDonTay.setVisible(!1)},initTextVanMoi:function(){this.fxVanMoi=
new sp.SkeletonAnimation(ResourceManager.MGREsourcesGameLieng.VanMoi_Json,ResourceManager.MGREsourcesGameLieng.VanMoi_Atlas);this.addChild(this.fxVanMoi);this.fxVanMoi.setPosition(this.mainGame._mainLayer.getChildByName("MGTextVanMoi").getPosition());this.fxVanMoi.setVisible(!1)},showTextVanMoi:function(){this.fxVanMoi.setVisible(!0);this.fxVanMoi.setAnimation(0,"animation",!1);this.hideAllEffectLieng();this.mainGame.boxCardContainer.clearUILieng();this.mainGame.comboTextBetCuoc.hideAllBetCuoc()},
hideTextVanMoi:function(){null!=this.timeOutTextVanMoi&&clearTimeout(this.timeOutTextVanMoi);this.fxVanMoi.setVisible(!1)},showTextDonTay:function(){this.textDonTay.setVisible(!0);this.timeOutEffectDonTay=setTimeout(this.hideTextDonTay.bind(this),2E3)},hideTextDonTay:function(){this.textDonTay.setVisible(!1)},playEffectEndGame:function(a){this.hideAllEffectAction();for(var b=0;b<a.length;b++)for(var d in MGGameBoardLieng.listUser)MGGameBoardLieng.listUser[d].UserID==a[b].UserID&&(0<a[b].resultCoin?
(mg.audio.playEffect(ResourceManager.MGREsourcesGameLieng.THANG,MGGameInfo.gameVolume),this.listEffectLieng[MGGameBoardLieng.listUser[d].Index].fxThang.setAnimation(0,"thang",!1),this.listEffectLieng[MGGameBoardLieng.listUser[d].Index].fxThang.setVisible(!0)):(this.listEffectLieng[MGGameBoardLieng.listUser[d].Index].fxThua.setAnimation(0,"thua",!1),this.listEffectLieng[MGGameBoardLieng.listUser[d].Index].fxThua.setVisible(!0)),this.mainGame.comboUsers.getCompoUserByUserID(a[b].UserID).showEffectGoldWinLose(a[b].resultCoin));
this.timeOutTextVanMoi=setTimeout(this.showTextVanMoi.bind(this),3E3)},hideAllEffectLieng:function(){for(var a=1;7>a;a++)for(var b in this.listEffectLieng[a])this.listEffectLieng[a][b].setVisible(!1)},hideEffect:function(a){a.setVisible(!1)},showTypeLieng:function(a){this.hideAllEffectAction();for(var b,d,e=0;e<a.length;e++)if(0==a[e].IsUpbai)for(var f in MGGameBoardLieng.listUser)d=MGGameBoardLieng.listUser[f].Index,b=a[e].ValueCard,MGGameBoardLieng.listUser[f].UserID==a[e].UserID&&(0==b&&this.listEffectLieng[d].fxBu.setVisible(!0),
1==b&&this.listEffectLieng[d].fx1diem.setVisible(!0),2==b&&this.listEffectLieng[d].fx2diem.setVisible(!0),3==b&&this.listEffectLieng[d].fx3diem.setVisible(!0),4==b&&this.listEffectLieng[d].fx4diem.setVisible(!0),5==b&&this.listEffectLieng[d].fx5diem.setVisible(!0),6==b&&this.listEffectLieng[d].fx6diem.setVisible(!0),7==b&&this.listEffectLieng[d].fx7diem.setVisible(!0),8==b&&this.listEffectLieng[d].fx8diem.setVisible(!0),9==b&&this.listEffectLieng[d].fx9diem.setVisible(!0),10==b&&this.listEffectLieng[d].fxAnh.setVisible(!0),
11==b&&this.listEffectLieng[d].fxLieng.setVisible(!0),12==b&&this.listEffectLieng[d].fxLiengDongChat.setVisible(!0),13==b&&this.listEffectLieng[d].fxSap.setVisible(!0))},showEffectKhongTo:function(a){this.hideAllEffectAction();(a=MGGameBoardLieng.listUser[a])&&this.listEffectLieng[a.Index].fxKhongTo.setVisible(!0);this.timeOutEffectKhongTo=setTimeout(this.hideEffect.bind(this,this.listEffectLieng[a.Index].fxKhongTo),4E3)},showEffectTo:function(a){this.hideAllEffectAction();(a=MGGameBoardLieng.listUser[a])&&
this.listEffectLieng[a.Index].fxTo.setVisible(!0);this.timeOutEffectTo=setTimeout(this.hideEffect.bind(this,this.listEffectLieng[a.Index].fxTo),4E3)},showEffectTheo:function(a){this.hideAllEffectAction();(a=MGGameBoardLieng.listUser[a])&&this.listEffectLieng[a.Index].fxTheo.setVisible(!0);this.timeOutEffectTheo=setTimeout(this.hideEffect.bind(this,this.listEffectLieng[a.Index].fxTheo),4E3)},showEffectUpBo:function(a){this.hideAllEffectAction();(a=MGGameBoardLieng.listUser[a])&&this.listEffectLieng[a.Index].fxUpBai.setVisible(!0)},
hideAllEffectAction:function(){this.clearTimeOut();for(var a=1;7>a;a++)this.listEffectLieng[a].fxKhongTo.setVisible(!1),this.listEffectLieng[a].fxTheo.setVisible(!1),this.listEffectLieng[a].fxTo.setVisible(!1)},clearTimeOut:function(){this.timeOutEffect&&clearTimeout(this.timeOutEffect);this.timeOutEffectKhongTo&&clearTimeout(this.timeOutEffectKhongTo);this.timeOutEffectTo&&clearTimeout(this.timeOutEffectTo);this.timeOutEffectTheo&&clearTimeout(this.timeOutEffectTheo);this.timeOutEffectUpBai&&clearTimeout(this.timeOutEffectUpBai);
this.timeOutTextVanMoi&&clearTimeout(this.timeOutTextVanMoi)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.clearTimeOut()}});MGComboEffectLieng.EFFECT={FX_UP_BAI:"fxUpBai",FX_SAP:"fxSap",FX_LIENG_DONG_CHAT:"fxLiengDongChat",FX_LIENG:"fxLieng",FX_ANH:"fxAnh",FX_THANG:"fxThang",FX_THUA:"fxThua",FX_KHONG_TO:"fxKhongTo",FX_THEO:"fxTheo",FX_TO:"fxTo",FX_VANMOI:"fxVanMoi"};MGComboEffectLieng.TYPE_LIENG={10:"ANH",11:"LIENG",12:"LIENG_DONG_CHAT",13:"SAP"};var MGGameBoardLieng=cc.Class.extend({_listEvents:null,ctor:function(){}});MGGameBoardLieng.my={betCoin:0,position:0};MGGameBoardLieng.getCardByID=function(a){return MGGameBoardLieng.Cards[a]};MGGameBoardLieng.UserActive=0;MGGameBoardLieng.isEndRound=0;MGGameBoardLieng.GameStatus=0;MGGameBoardLieng.TimeOut=0;MGGameBoardLieng.Cards=null;MGGameBoardLieng.CARD_WIDTH=80;MGGameBoardLieng.CARD_HEIGHT=80;MGGameBoardLieng.listUser={};MGGameBoardLieng.listUserBefore={};
MGGameBoardLieng.returnCardLieng=function(a){a.parent&&(a.retain(),a.removeFromParent(!0))};MGGameBoardLieng.clearCards=function(){for(;0<MGGameBoardLieng.Cards.length;)MGGameBoardLieng.Cards.pop().removeFromParent(!0);MGGameBoardLieng.Cards=null};var MGLieng=MGBaseGame.extend({comboButtons:null,popupDonTay:null,comboUsers:null,comboBet:null,coinBet:null,_gameInfoContain:null,boxCardContainer:null,comboText:null,comboTextBetCuoc:null,minBet:null,comboEffect:null,typeBet:null,comboXuController:null,isVan:null,textDonTay:null,timeOutDonTay:null,countClickBet:0,ctor:function(){MGBaseGame.prototype.ctor.call(this)},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.resourceGame=resourcesGameLieng;this._initUI();this.netSend=new MGNetSendLieng;
this._initComboButton();this._initComboUsers();this._initComboBet();this._initGameInfo();this._initBoxCardContainer();this._initComboText();this._initComboTextBetCuoc();this._initComboEffect();this._initComboXuController();this._initPoupDonTay()},_initUI:function(){this._initFromCocostudio(ResourceManager.MGREsourcesGameLieng.MGUILayerLieng,PreLoaderConfig.PathToResourceDefault)},_initComboButton:function(){this.comboButtons=new MGLiengButtons;this.comboButtons.cloneFromNode(this._mainLayer.getChildByName("MGComboButtonLieng"));
this.comboButtons.initObj(this);this.addChild(this.comboButtons)},_initPoupDonTay:function(){this.popupDonTay=new MGPopupDonTay;this.popupDonTay.initObj(this);this.popupDonTay.setPosition(this._mainLayer.getChildByName("MGPopupDonTay").getPosition());this.addChild(this.popupDonTay);this.popupDonTay.hidePopup()},_initComboBet:function(){this.comboBet=new MGComboXuBetLieng;this.comboBet.cloneFromNode(this._mainLayer.getChildByName("MGNodeComboBet"));this.addChild(this.comboBet)},_initComboUsers:function(){this.comboUsers=
new MGComboUsersLieng;this.comboUsers.cloneFromNode(this._mainLayer.getChildByName("MGContainUser"));this.comboUsers.initObj(this);this.addChild(this.comboUsers)},_initGameInfo:function(){this._gameInfoContain=new MGCompoGameInfo;this._gameInfoContain.setPosition(35,630);this._gameInfoContain.setVisible(!1);this.addChild(this._gameInfoContain)},_initBoxCardContainer:function(){this.boxCardContainer=new MGBoxCardContainerLieng;this.boxCardContainer.cloneFromNode(this._mainLayer.getChildByName("MGBoxCardNode"));
this.boxCardContainer.initObj(this);this.addChild(this.boxCardContainer)},_initComboText:function(){this.comboText=new MGComboTextLieng;this.comboText.cloneFromNode(this._mainLayer.getChildByName("MGComboText"));this.comboText.initObj(this);this.comboText.hideAllText();this.addChild(this.comboText)},_initComboTextBetCuoc:function(){this.comboTextBetCuoc=new MGComboBetCuoc;this.comboTextBetCuoc.cloneFromNode(this._mainLayer.getChildByName("MGComboTextBetCuoc"));this.comboTextBetCuoc.initObj(this);
this.comboTextBetCuoc.resetBetCuoc();this.addChild(this.comboTextBetCuoc)},_initComboEffect:function(){this.comboEffect=new MGComboEffectLieng;this.comboEffect.cloneFromNode(this._mainLayer.getChildByName("MGComboEffect"));this.comboEffect.initObj(this);this.addChild(this.comboEffect)},_initComboXuController:function(){this.comboXuController=new MGXuControllerLieng;this.comboXuController.cloneFromNode(this._mainLayer.getChildByName("MGComboXu"));this.comboXuController.initObj(this);this.addChild(this.comboXuController)},
_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.RequireDonTay.toString(),this.ngRequireDonTay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.RandCard.toString(),this.ngRandCard.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.ActivePlayer.toString(),
this.ngActivePlayer.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.To.toString(),this.ngTo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.Theo.toString(),this.ngTheo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.KhongTo.toString(),this.ngKhongTo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.UpBai.toString(),
this.ngUpBai.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.CalculateResult.toString(),this.ngCalculateResult.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.EndMatch.toString(),this.ngEndMatch.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_LIENG.LatTay.toString(),this.ngLatTay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGComboXuBet.ON_CLICK.toString(),
this._onSelectXu.bind(this)))},_onSelectXu:function(a){this.typeBet=a.getUserData().value;this.getTypeBetTextTo(this.typeBet)},getTypeBetTextTo:function(a){this.countClickBet++;this.typeBet=a;this.coinBet=this.comboBet.listRate[a];var b=this.comboUsers.getCompoUserByUserID(MGGameInfo.myInfo.UserID);4==a?this.comboText.setTextTo(b.getUserGold()):1==this.countClickBet?this.comboText.setTextTo(Utilities.Coin(this.coinBet)):this.comboText.setTextTo(Utilities.Coin(this.comboUsers.getStringToBet(this.comboText.textTo.getString())+
this.coinBet))},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardLieng.listUser={};MGGameBoardLieng.clearCards();this.comboButtons&&this.comboButtons.setDispose();this.comboUsers&&this.comboUsers.setDispose();this.comboBet&&this.comboBet.setDispose();this.boxCardContainer&&this.boxCardContainer.setDispose();this.comboEffect&&this.comboEffect.setDispose();this.timeOutDonTay&&clearTimeout(this.timeOutDonTay)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={DeskID:b.UInt64,MatchID:b.UInt32,MinCoin:b.UInt64,Status:b.UInt8,ListUserInfo:b.Array8,ListUserInfo_Type:b.Object8,ListUserInfo_Type_Struct:{UserID:b.UInt32,CardList:b.Array8,CardList_Type:b.UInt8,CoinPot:b.Int64,CoinPlay:b.Int64,isUpbai:b.UInt8,isLatTay:b.UInt8},ActivePlayer:b.UInt32,PlayerFirstInRound:b.UInt32,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeRemain:b.UInt16,TimeOut:b.UInt16,CoinRaiseInRound:b.Int64,RatioRaise:b.Array8,RatioRaise_Type:b.UInt16,RatioMinAnte:b.UInt16,RatioMaxnAnte:b.UInt16};
a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---GameData: "+JSON.stringify(a));this.isVan=0;this._gameInfoContain.setInfo("LIÊNG",a.DeskID,a.MinCoin,a.MatchID);this.boxCardContainer.getGameData(a.ListUserInfo);this.comboUsers.setGoldListUser(a.ListUserInfo);MGGameBoardLieng.TimeOut=a.TimeOut;MGGameBoardLieng.UserActive=a.ActivePlayer;0<a.ActivePlayer&&(this.isVan=1);this.comboBet.setComboBetCuoc(a.RatioRaise,a.MinCoin);this.coinBet=a.MinCoin;this.typeBet=0;this.minBet=a.MinCoin;this.comboXuController.updateXu(a.RatioRaise);
this.comboTextBetCuoc.setBetCuocGameData(a.ListUserInfo);this.comboText.setBetTheoGameData(a.ListUserInfo,a.CoinRaiseInRound);this.comboText.setTextTo(Utilities.Coin(this.minBet));this.comboXuController.setBetXuGameData(a.ListUserInfo);this.comboUsers.nextPlayerGameData(a.ActivePlayer,a.TimeRemain);this.popupDonTay.setMinCuoc(a.RatioMinAnte*this.minBet,a.RatioMaxnAnte*this.minBet);this.comboUsers.addListUserBeforeGameData(a.ListUserInfo);this.comboButtons.updateButtonLatTayGameData(a.ListUserInfo);
this.comboButtons.updateButtonLieng(a.ListAction);this.comboButtons.getButtonTo();this.comboButtons.updateButtonDonTay()},ngRequireDonTay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,UserCoin:b.Int64,Min:b.Int64,Max:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---RequireDonTay: "+JSON.stringify(a));this.popupDonTay.firstDonTay=1;this.popupDonTay.setMinCuoc(a.Min,a.Max);this.popupDonTay.showPopup()},ngRandCard:function(a){a=a.getUserData();
var b=BinaryConstants.DataTypeID,b={ListCardInfo:b.Array8,ListCardInfo_Type:b.Object8,ListCardInfo_Type_Struct:{UserID:b.UInt32,cardList:b.Array8,cardList_Type:b.UInt8,coinPot:b.Int64,coinPlay:b.Int64},MatchID:b.UInt32,DealerID:b.UInt32,CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---RandCard: "+JSON.stringify(a));this._gameInfoContain.setMatchIdInfo(a.MatchID);this.comboUsers.addListUserBefore();this.comboUsers.updateCoinUser(a.ListCardInfo);this.comboEffect.hideTextVanMoi();
this.comboTextBetCuoc.setBetCuocAll(a.ListCardInfo);this.comboXuController.setBetXuAll(a.ListCardInfo);this.boxCardContainer.randCardLieng(a);0==this.coinBet?(a=this.comboUsers.getCompoUserByUserID(MGGameInfo.myInfo.UserID),this.comboText.setTextTo(a.getUserGold())):this.comboText.setTextTo(Utilities.Coin(this.coinBet));this.countClickBet=0;this.isVan=1;this.comboButtons.updateButtonDonTay()},ngActivePlayer:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ActivePlayer:b.UInt32,ListAction:b.Array8,
ListAction_Type:b.UInt32,TimeOut:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ActivePlayer: "+JSON.stringify(a));MGGameBoardLieng.UserActive=a.ActivePlayer;this.comboUsers.nextPlayer(a.ActivePlayer,a.TimeOut);this.comboButtons.updateButtonLieng(a.ListAction);this.comboButtons.updateButtonDonTay()},ngTo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},
ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngTo: "+JSON.stringify(a));this.comboEffect.showEffectTo(a.ActionInfo.UserID);MGGameBoardLieng.UserActive=a.ActiveInfo.ActivePlayer;this.comboUsers.nextPlayer(a.ActiveInfo.ActivePlayer,a.ActiveInfo.TimeOut);this.comboUsers.updateCoinCuoc(a.ActionInfo.UserID,
a.ActionInfo.CoinPot);this.comboButtons.updateButtonLieng(a.ActiveInfo.ListAction);this.comboTextBetCuoc.setBetCuoc(a.ActionInfo.CoinPlay,MGGameBoardLieng.listUser[a.ActionInfo.UserID]);this.comboXuController.initXu(a.ActionInfo.UserID,a.ActionInfo.CoinAction);this.comboText.setTextTheo(a.CoinRaiseInRound-a.ActiveInfo.CoinPlay,a.ActiveInfo.ActivePlayer);this.comboButtons.getButtonTo();this.countClickBet=0;this.comboButtons.updateButtonDonTay()},ngTheo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngTheo: "+JSON.stringify(a));this.comboEffect.showEffectTheo(a.ActionInfo.UserID);MGGameBoardLieng.UserActive=a.ActiveInfo.ActivePlayer;this.comboUsers.nextPlayer(a.ActiveInfo.ActivePlayer,
a.ActiveInfo.TimeOut);this.comboButtons.updateButtonLieng(a.ActiveInfo.ListAction);this.comboTextBetCuoc.setBetCuoc(a.ActionInfo.CoinPlay,MGGameBoardLieng.listUser[a.ActionInfo.UserID]);this.comboXuController.initXu(a.ActionInfo.UserID,a.ActionInfo.CoinAction);this.comboUsers.updateCoinCuoc(a.ActionInfo.UserID,a.ActionInfo.CoinPot);this.comboText.setTextTheo(a.CoinRaiseInRound-a.ActiveInfo.CoinPlay,a.ActiveInfo.ActivePlayer);this.countClickBet=0;this.comboButtons.updateButtonDonTay()},ngKhongTo:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngKhongTo: "+JSON.stringify(a));this.comboEffect.showEffectKhongTo(a.ActionInfo.UserID);MGGameBoardLieng.UserActive=
a.ActiveInfo.ActivePlayer;this.comboUsers.nextPlayer(a.ActiveInfo.ActivePlayer,a.ActiveInfo.TimeOut);this.comboButtons.updateButtonLieng(a.ActiveInfo.ListAction);this.comboButtons.updateButtonDonTay();this.comboText.setTextTheo(a.CoinRaiseInRound-a.ActiveInfo.CoinPlay,a.ActiveInfo.ActivePlayer);this.countClickBet=0},ngUpBai:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ActionInfo:b.Object8,ActionInfo_Struct:{UserID:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,CoinAction:b.Int64},
ActiveInfo:b.Object8,ActiveInfo_Struct:{ActivePlayer:b.UInt32,CoinPot:b.Int64,CoinPlay:b.Int64,ListAction:b.Array8,ListAction_Type:b.UInt32,TimeOut:b.UInt32},CoinRaiseInRound:b.Int64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngUpBai: "+JSON.stringify(a));MGGameBoardLieng.UserActive=a.ActiveInfo.ActivePlayer;this.comboUsers.nextPlayer(a.ActiveInfo.ActivePlayer,a.ActiveInfo.TimeOut);this.comboButtons.updateButtonLieng(a.ActiveInfo.ListAction);this.comboButtons.updateButtonDonTay();
this.comboEffect.showEffectUpBo(a.ActionInfo.UserID);this.comboText.setTextTheo(a.CoinRaiseInRound-a.ActiveInfo.CoinPlay,a.ActiveInfo.ActivePlayer);this.countClickBet=0},ngCalculateResult:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultInfo:b.Array8,ResultInfo_Type:b.Object8,ResultInfo_Type_Struct:{UserID:b.UInt32,CardList:b.Array8,CardList_Type:b.UInt8,ValueCard:b.UInt8,IsUpbai:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngCalculateResult: "+
JSON.stringify(a));this.comboButtons.hideAllButton();this.comboUsers.stopAllClock();this.boxCardContainer.showCardOtherUsers(a.ResultInfo);this.comboEffect.showTypeLieng(a.ResultInfo)},ngEndMatch:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultInfo:b.Array8,ResultInfo_Type:b.Object8,ResultInfo_Type_Struct:{UserID:b.UInt32,playerNo:b.UInt8,winRank:b.UInt32,resultCoin:b.Int64,coin:b.Int64,fee:b.Int64,coinPot:b.Int64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngEndMatch: "+
JSON.stringify(a));this.comboXuController.effectXu(a.ResultInfo);this.comboEffect.playEffectEndGame(a.ResultInfo);this.comboUsers.resultMoneyLieng(a.ResultInfo);this.comboButtons.resetListLatTay();this.comboButtons.updateButtonDonTay();this.isVan=this.countClickBet=0},ngLatTay:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,CardInfo:b.Array8,ListCardInfo_Type:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this.boxCardContainer.showCardUser(a.UserID,a.CardInfo);
this.comboButtons.updateButtonLatTay(a.UserID);Utilities.showLog("---ngLatTay: "+JSON.stringify(a))}});ResourceManager.MGResourcesGameXengLuxury={Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",Font1_fnt:"res/Fonts/Number1.fnt",Font1_png:"res/Fonts/Number1.png",Font2_fnt:"res/Fonts/Number2.fnt",Font2_png:"res/Fonts/Number2.png",AtlasXengLuxury_plist1:"res/game/xengluxury/AtlasXengLuxury/atlasXengLuxury1.plist",AtlasXengLuxury1:"res/game/xengluxury/AtlasXengLuxury/atlasXengLuxury1.png",AtlasXengLuxury_plist2:"res/game/xengluxury/AtlasXengLuxury/atlasXengLuxury2.plist",AtlasXengLuxury2:"res/game/xengluxury/AtlasXengLuxury/atlasXengLuxury2.png",
MGBackGroundXeng:"res/game/xengluxury/MGBackGroundXeng.jpg",MGEffectWin_json:"res/game/xengluxury/EffectXengLuxury/XengLuxury_FX.json",MGEffectWin_atlas:"res/game/xengluxury/EffectXengLuxury/XengLuxury_FX.atlas",MGEffectWin_png:"res/game/xengluxury/EffectXengLuxury/XengLuxury_FX.png",MGEffectWinMiniGame_json:"res/game/xengluxury/EffectXengLuxury/thang.json",MGEffectWinMiniGame_atlas:"res/game/xengluxury/EffectXengLuxury/thang.atlas",MGEffectWinMiniGame_png:"res/game/xengluxury/EffectXengLuxury/thang.png",
MGEffectLoseMiniGame_json:"res/game/xengluxury/EffectXengLuxury/thua.json",MGEffectLoseMiniGame_atlas:"res/game/xengluxury/EffectXengLuxury/thua.atlas",MGEffectLoseMiniGame_png:"res/game/xengluxury/EffectXengLuxury/thua.png",MGColumnSlot:"res/game/xengluxury/UINodeItemSlotContainer.json",MGComboSlots:"res/game/xengluxury/UIItemComboSlot.json",MGUITextGiaoDich:"res/game/xengluxury/UIItemTextGiaoDich.json",MGUITextHuZdo:"res/game/xengluxury/UIItemTextHuZdo.json",MGUIPage:"res/game/xengluxury/UIItemButtonPageLS.json",
MGComboLines:"res/game/xengluxury/UIItemIconLine.json",MGUILayerXeng:"res/game/xengluxury/UILayerXeng.json",MGCompoChonDong:"res/game/xengluxury/UICompoChonDong.json",MGUIGiaoDien:"res/game/xengluxury/UIItemGiaoDien.json",MGUIButtonChoiThu:"res/game/xengluxury/UIItemButtonChoiThu.json",MGUILayerBangThuong:"res/game/xengluxury/UIItemLayerBangThuong.json",MGUIButtonBangThuong:"res/game/xengluxury/UIItemBangThuong.json",MGUIButtonQuayLai:"res/game/xengluxury/UIItemQuayLai.json",MGUILayerTongDat:"res/game/xengluxury/UIItemTongDat.json",
MGUIMiniGame:"res/game/xengluxury/UIItemPopupMiniGame.json",CAOTHAP_THANG:"res/game/xengluxury/Sounds/CaoThap_Thang.MP3",CAOTHAP_THUA:"res/game/xengluxury/Sounds/CaoThap_Thua.MP3",CLICK:"res/game/xengluxury/Sounds/click.mp3",CLICK_QUAY:"res/game/xengluxury/Sounds/ClickQuay.mp3",DUNG_QUAY:"res/game/xengluxury/Sounds/DungQuay.mp3",QUAY:"res/game/xengluxury/Sounds/Quay.mp3",QUAY_CAO_THAP:"res/game/xengluxury/Sounds/QuayCaoThap.MP3",THANG_HU:"res/game/xengluxury/Sounds/Thang_Lon.MP3",THANG_THUONG:"res/game/xengluxury/Sounds/Thang_Thuong.mp3",
THUA:"res/game/xengluxury/Sounds/Thua.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesGameXengLuxury=[];for(i in ResourceManager.MGResourcesGameXengLuxury)ResourceManager.MGResourcesGameXengLuxury[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengLuxury[i],resourcesGameXengLuxury.push(ResourceManager.MGResourcesGameXengLuxury[i]);ConstantsVariable.NETWORK_XENG_LUXURY={userUpdateCoin:13,Turning:2300,PerformTurning:2301,BetGameMini:2302,ResultGameMini:2303,StartGame:2304,CancelMiniGame:2305,UserLeftDesk:2306,ListUser:2307,GameData:2308,FreeTurning:2309,ToolResult:2310,WinBonusBox:2311,BigWin:2312,TopWinBonusBox:2313,TopBigWin:2314,OptionMiniGame:2316};var MGNetSendXengLuxury=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBet:function(a,b,d){Utilities.showLog("--Send Bet "+b);var e={};e.lineUserBet=a;e.Coin=b;e.isFake=d;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_LUXURY.Turning,{lineUserBet:BinaryConstants.DataTypeID.Array8,lineUserBet_Type:BinaryConstants.DataTypeID.UInt8,Coin:BinaryConstants.DataTypeID.UInt64,isFake:BinaryConstants.DataTypeID.UInt8},e);MGNetCore.MGSocket.sendMsg(a)},sendBetGameMini:function(a){var b=
{};b.BetKind=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_LUXURY.BetGameMini,{BetKind:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendCloseMiniGame:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_LUXURY.CancelMiniGame,null,null);MGNetCore.MGSocket.sendMsg(a)},sendOptionMiniGame:function(a){Utilities.showLog("---State: "+a);var b={};b.State=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_LUXURY.OptionMiniGame,
{State:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},sendToolResultXeng:function(a){var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_LUXURY.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});MGPopupThongBao=MGBaseNode.extend({listView:null,maxLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listView=this.getChildByName("MGListThongBao");this._initEventsGame();this.maxLine=100},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=a.getUserData();
this.listView.getItems().length>=this.maxLine&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",13,cc.color.WHITE,!0,180);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()}});MGPopupButtonPage=MGBaseNode.extend({_buttonPage:null,_textPage:null,numberPage:null,onPage:0,onVisible:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);cc.sys.isNative?this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUIPage,"res/").node):this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUIPage).node);this._buttonPage=this.getChildByName("MGBackGroundButtonPage");this._textPage=
this._buttonPage.getChildByName("MGTextPage");this._textPage.setTextColor(cc.color(255,255,255));this.setVisiblePage(!0);this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._buttonPage.addClickEventListener(this.changePageLS.bind(this))},setTextPage:function(a){this._textPage.setString(a)},setNumberPage:function(a){this.numberPage=a},setOnPage:function(){this._textPage.setColor(cc.color(255,255,0))},setOffPage:function(){this._textPage.setColor(cc.color(255,
255,255))},changePageLS:function(){cc.eventManager.dispatchCustomEvent("CHAGE_PAGE_LS",{target:this})},setVisiblePage:function(a){!0===a?(this.setVisible(!0),this.onVisible=1):(this.setVisible(!1),this.onVisible=0)}});MGPopupComboLichSu=MGBaseNode.extend({_tabGiaoDich:null,_tabVinhDanh:null,_tabHuZdo:null,_panelGiaoDich:null,_panelHuZdo:null,_titleGiaoDich:null,_titleHuZdo:null,_isTab:0,_listVinhDanh:null,_dataHuZdo:null,_dataHuZdoPanel:[],_dataGiaoDich:[],_dataVinhDanh:null,_arrPageHuZdo:[],_arrPageGiaoDich:[],ctor:function(){MGBaseNode.prototype.ctor.call(this);this._dataHuZdoPanel=[];this._dataGiaoDich=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._tabGiaoDich=this.getChildByName("MGButtonGiaoDich");
this._tabVinhDanh=this.getChildByName("MGButtonVinhDanh");this._tabHuZdo=this.getChildByName("MGButtonHuZdo");this._panelGiaoDich=this.getChildByName("MGPanelGiaoDich");this._panelHuZdo=this.getChildByName("MGPanelHuZdo");this._titleGiaoDich=this.getChildByName("MGNodeTitleGiaoDich");this._titleHuZdo=this.getChildByName("MGNodeTitleHuZdo");this._listVinhDanh=this.getChildByName("MGListVinhDanh");this._initEventsGame()},_initEventsGame:function(){this._tabGiaoDich.addClickEventListener(this.getTabGiaoDich.bind(this));
this._tabVinhDanh.addClickEventListener(this.getTabVinhDanh.bind(this));this._tabHuZdo.addClickEventListener(this.getTabHuZdo.bind(this));cc.eventManager.addCustomListener("CHAGE_PAGE_LS",this._chagePageLichSu.bind(this))},getTabGiaoDich:function(){this.hideAllTab();this._tabGiaoDich.getChildByName("MGTextOn").setVisible(!0);this._tabGiaoDich.getChildByName("MGTextOff").setVisible(!1);this._panelGiaoDich.setVisible(!0);this._titleGiaoDich.setVisible(!0);this._isTab=0},getTabVinhDanh:function(){this.hideAllTab();
this._tabVinhDanh.getChildByName("MGTextOn").setVisible(!0);this._tabVinhDanh.getChildByName("MGTextOff").setVisible(!1);this._listVinhDanh.setVisible(!0);this._isTab=1},getTabHuZdo:function(){this.hideAllTab();this._tabHuZdo.getChildByName("MGTextOn").setVisible(!0);this._tabHuZdo.getChildByName("MGTextOff").setVisible(!1);this._panelHuZdo.setVisible(!0);this._titleHuZdo.setVisible(!0);this._isTab=2},hideAllTab:function(){this._tabGiaoDich.getChildByName("MGTextOn").setVisible(!1);this._tabGiaoDich.getChildByName("MGTextOff").setVisible(!0);
this._tabVinhDanh.getChildByName("MGTextOn").setVisible(!1);this._tabVinhDanh.getChildByName("MGTextOff").setVisible(!0);this._tabHuZdo.getChildByName("MGTextOn").setVisible(!1);this._tabHuZdo.getChildByName("MGTextOff").setVisible(!0);this._titleHuZdo.setVisible(!1);this._titleGiaoDich.setVisible(!1);this._panelGiaoDich.setVisible(!1);this._panelHuZdo.setVisible(!1);this._listVinhDanh.setVisible(!1)},addDataHuZdo:function(a){this._dataHuZdo.dataBonus.splice(0,0,a);this.setDataHuDzoPanel();this.getPanelHuZdoFirst()},
addDataVinhDanh:function(a){this._dataVinhDanh.dataBigWin.splice(0,0,a);this.getDataVinhDanh()},setDataHuDzo:function(a){this._dataHuZdo=a;this.setDataHuDzoPanel();this.getPanelHuZdoFirst()},getPanelHuZdoFirst:function(){for(var a=0;a<this._arrPageHuZdo.length;a++)this._arrPageHuZdo[a].setVisible(!1);this._arrPageHuZdo=[];for(var b=9>this._dataHuZdo.dataBonus.length?this._dataHuZdo.dataBonus.length:9,a=0;a<b;a++)this._dataHuZdoPanel[a].retain(),this._dataHuZdoPanel[a].removeFromParent(!0),this._panelHuZdo.addChild(this._dataHuZdoPanel[a]),
this._dataHuZdoPanel[a].setVisible(!0),this._dataHuZdoPanel[a].setPosition(0,161-17*a);this.createArray(this._arrPageHuZdo,Math.ceil((90>this._dataHuZdo.dataBonus.length?this._dataHuZdo.dataBonus.length:90)/9),this._panelHuZdo)},setDataGiaoDich:function(a,b,d,e,f){var g=new MGPopupGiaoDich;g.initObj();g.setThoiGianGD(a);g.setPhongGD(b);g.setCuocZdo(d);g.setKetQua(e);g.setTienThang(f);this._panelGiaoDich.addChild(g);this._dataGiaoDich.splice(0,0,g);this.getPanelGiaoDichFirst()},setDataHuDzoPanel:function(){for(var a=
0;a<this._dataHuZdoPanel.length;a++)this._dataHuZdoPanel[a].setVisible(!1);this._dataHuZdoPanel=[];for(var b=null,a=0;a<this._dataHuZdo.dataBonus.length;a++)b=new MGPopupHuZdo,b.initObj(),b.setTextNgay(this._dataHuZdo.dataBonus[a].CreatedTime),b.setTextLoaiCuoc(this._dataHuZdo.dataBonus[a].CoinBet),b.setTextNickName(this._dataHuZdo.dataBonus[a].NickName),b.setTextHu(this._dataHuZdo.dataBonus[a].Rate),b.setTextTienHu(this._dataHuZdo.dataBonus[a].EarnCoin),b.setVisible(!1),this._dataHuZdoPanel.push(b),
this._panelHuZdo.addChild(b)},getPanelGiaoDichFirst:function(){for(var a=0;a<this._dataGiaoDich.length;a++)this._dataGiaoDich[a].setVisible(!1);for(a=0;a<this._arrPageGiaoDich.length;a++)this._arrPageGiaoDich[a].setVisible(!1);for(var b=9>this._dataGiaoDich.length?this._dataGiaoDich.length:9,a=0;a<b;a++)this._dataGiaoDich[a].setPosition(0,162-17*a),this._dataGiaoDich[a].setVisible(!0);this._arrPageGiaoDich=[];10>Math.ceil(this._dataGiaoDich.length/9)?this.createArray(this._arrPageGiaoDich,Math.ceil(this._dataGiaoDich.length/
9),this._panelGiaoDich):this.createArray(this._arrPageGiaoDich,10,this._panelGiaoDich)},createArray:function(a,b,d){for(var e=this.getChildByName("MGPanelGiaoDich").getChildByName("MGNodePage"),f=null,g=0;g<b;g++)f=new MGPopupButtonPage,f.setTextPage(g+1),f.setNumberPage(g+1),1>=b?f.setPosition(e.x,e.y):(2>=b?f.setPosition(e.x-15+25*g,e.y):3>=b?f.setPosition(e.x-25+25*g,e.y):4>=b?f.setPosition(e.x-40+25*g,e.y):(f.setPosition(e.x-40+25*g,e.y),3<g&&f.setVisiblePage(!1)),d.addChild(f),a.push(f));4<b&&
(f=new MGPopupButtonPage,f.setTextPage(">"),f.setPosition(e.x+60,e.y),f.setNumberPage(12),f.setVisiblePage(!0),d.addChild(f),a.push(f),f=new MGPopupButtonPage,f.setTextPage(">>"),f.setPosition(e.x+85,e.y),f.setNumberPage(13),f.setVisiblePage(!0),d.addChild(f),a.push(f),f=new MGPopupButtonPage,f.setTextPage("<<"),f.setPosition(e.x-90,e.y),f.setNumberPage(14),f.setVisiblePage(!1),d.addChild(f),a.push(f),f=new MGPopupButtonPage,f.setTextPage("<"),f.setPosition(e.x-65,e.y),f.setNumberPage(15),f.setVisiblePage(!1),
d.addChild(f),a.push(f));0!==a.length&&(a[0].setOnPage(),a[0].onPage=1)},_chagePageLichSu:function(a){a=a.getUserData().target.numberPage;11>a?(0===this._isTab&&this.changePage(a,this._arrPageGiaoDich,this._panelGiaoDich,this._dataGiaoDich),2===this._isTab&&this.changePage(a,this._arrPageHuZdo,this._panelHuZdo,this._dataHuZdoPanel)):(12===a&&(0===this._isTab&&this.nextPage(a,this._arrPageGiaoDich,this._panelGiaoDich,this._dataGiaoDich),2===this._isTab&&this.nextPage(a,this._arrPageHuZdo,this._panelHuZdo,
this._dataHuZdoPanel)),13===a&&(0===this._isTab&&this.endPage(a,this._arrPageGiaoDich,this._panelGiaoDich,this._dataGiaoDich),2===this._isTab&&this.endPage(a,this._arrPageHuZdo,this._panelHuZdo,this._dataHuZdoPanel)),14===a&&(0===this._isTab&&this.beganPage(a,this._arrPageGiaoDich,this._panelGiaoDich,this._dataGiaoDich),2===this._isTab&&this.beganPage(a,this._arrPageHuZdo,this._panelHuZdo,this._dataHuZdoPanel)),15===a&&(0===this._isTab&&this.previousPage(a,this._arrPageGiaoDich,this._panelGiaoDich,
this._dataGiaoDich),2===this._isTab&&this.previousPage(a,this._arrPageHuZdo,this._panelHuZdo,this._dataHuZdoPanel)))},changePage:function(a,b,d,e){for(d=0;d<b.length;d++)1===b[d].onPage&&(b[d].onPage=0,b[d].setOffPage());for(d=0;d<b.length;d++)b[d].numberPage===a&&(b[d].onPage=1,b[d].setOnPage(),4<b.length&&(0===d?(b[b.length-1].setVisiblePage(!1),b[b.length-2].setVisiblePage(!1),b[b.length-3].setVisiblePage(!0),b[b.length-4].setVisiblePage(!0)):d===b.length-5?(b[b.length-1].setVisiblePage(!0),b[b.length-
2].setVisiblePage(!0),b[b.length-3].setVisiblePage(!1),b[b.length-4].setVisiblePage(!1)):(b[b.length-1].setVisiblePage(!0),b[b.length-2].setVisiblePage(!0),b[b.length-3].setVisiblePage(!0),b[b.length-4].setVisiblePage(!0))),this.getPanel(b[d].numberPage-1,e))},nextPage:function(a,b,d,e){for(d=a=0;d<b.length;d++)1===b[d].onPage&&(a=d);if(0===b[a+1].onVisible){var f=this.getChildByName("MGPanelGiaoDich").getChildByName("MGNodePage");b[a-3].setVisiblePage(!1);for(d=0;4>d;d++)b[a-2+d].setVisiblePage(!0),
b[a-2+d].setPosition(f.x-40+25*d,f.y)}11>b[a+1].numberPage&&(b[a].setOffPage(),b[a+1].setOnPage(),b[a].onPage=0,b[a+1].onPage=1,b[b.length-1].setVisiblePage(!0),b[b.length-2].setVisiblePage(!0),b.length-5===a+1&&(b[b.length-3].setVisiblePage(!1),b[b.length-4].setVisiblePage(!1)),this.getPanel(b[a+1].numberPage-1,e))},previousPage:function(a,b,d,e){for(d=a=0;d<b.length;d++)1===b[d].onPage&&(a=d);if(0===b[a-1].onVisible){var f=this.getChildByName("MGPanelGiaoDich").getChildByName("MGNodePage");b[a+
3].setVisiblePage(!1);for(d=0;4>d;d++)b[a-1+d].setVisiblePage(!0),b[a-1+d].setPosition(f.x-40+25*d,f.y)}11>b[a-1].numberPage&&(b[a].setOffPage(),b[a-1].setOnPage(),b[a].onPage=0,b[a-1].onPage=1,b[b.length-3].setVisiblePage(!0),b[b.length-4].setVisiblePage(!0),0===a-1&&(b[b.length-1].setVisiblePage(!1),b[b.length-2].setVisiblePage(!1)),this.getPanel(b[a-1].numberPage-1,e))},beganPage:function(a,b,d,e){for(a=0;a<b.length;a++)1===b[a].onPage&&(b[a].setOffPage(),b[a].onPage=0);for(a=0;a<b.length-4;a++)b[a].setVisiblePage(!1);
for(a=0;4>a;a++)d=this.getChildByName("MGPanelGiaoDich").getChildByName("MGNodePage"),b[a].setVisiblePage(!0),b[a].setPosition(d.x-40+25*a,d.y);b[b.length-1].setVisiblePage(!1);b[b.length-2].setVisiblePage(!1);b[b.length-3].setVisiblePage(!0);b[b.length-4].setVisiblePage(!0);b[0].onPage=1;b[0].setOnPage();this.getPanel(b[0].numberPage-1,e)},endPage:function(a,b,d,e){for(a=0;a<b.length;a++)1===b[a].onPage&&(b[a].setOffPage(),b[a].onPage=0);for(d=0;d<b.length-4;d++)b[d].setVisiblePage(!1);a=0;for(d=
b.length-8;d<b.length-4;d++){var f=this.getChildByName("MGPanelGiaoDich").getChildByName("MGNodePage");b[d].setVisiblePage(!0);b[d].setPosition(f.x-40+25*a,f.y);a++}b[b.length-1].setVisiblePage(!0);b[b.length-2].setVisiblePage(!0);b[b.length-3].setVisiblePage(!1);b[b.length-4].setVisiblePage(!1);b[b.length-5].onPage=1;b[b.length-5].setOnPage();this.getPanel(b[b.length-5].numberPage-1,e)},getPanel:function(a,b){for(var d=0;d<b.length;d++)b[d].setVisible(!1);for(var e=9*a+9<b.length?9*a+9:b.length,
f=0,d=9*a;d<e;d++)b[d].setVisible(!0),b[d].setPosition(0,161-17*f),f++},setDataVinhDanh:function(a){this._dataVinhDanh=a;this.getDataVinhDanh()},getDataVinhDanh:function(){100<this._listVinhDanh.length&&this._listVinhDanh.removeLastItem();var a=null,b=null,d=null,e=null,f=null;this._listVinhDanh.removeAllItems();for(var g=this._dataVinhDanh.dataBigWin.length-1;-1<g;g--)d=new MGBaseRichText("Arial",11,cc.color.WHITE,!0,350),a=this._dataVinhDanh.dataBigWin[g].CreatedTime.slice(0,10)+" "+this._dataVinhDanh.dataBigWin[g].CreatedTime.slice(11,
19),f=new MGBaseRichText("Arial",11,cc.color.WHITE,!0,350),f.setString([" "],["FFFFFF"]),0===this._dataVinhDanh.dataBigWin[g].Type?d.setString(["TK ",this._dataVinhDanh.dataBigWin[g].NickName," thắng ",Utilities.Coin(this._dataVinhDanh.dataBigWin[g].EarnCoin)," ZDO lúc ",a,"."],"#FFFFFF #FFFF00 #FFFFFF #FFFF00 #FFFFFF #FFFFFF #FFFFFF".split(" ")):(b=100===this._dataVinhDanh.dataBigWin[g].CoinBet?"Nông Dân":200===this._dataVinhDanh.dataBigWin[g].CoinBet?"Địa Chủ":1E3===this._dataVinhDanh.dataBigWin[g].CoinBet?
"Qúy Tộc":"Hoàng Gia",e=new MGBaseRichText("Arial",11,cc.color.WHITE,!0,350),d.setString(["Chúc mừng ",this._dataVinhDanh.dataBigWin[g].NickName," đã nổ hũ ZDO ",b," trị giá "],["#FFFFFF","#FFFF00","#FFFFFF","#FFFF00","#FFFFFF"]),e.setString([Utilities.Coin(this._dataVinhDanh.dataBigWin[g].EarnCoin)," ZDO lúc ",a,"."],["#FFFF00","#FFFFFF","#FFFFFF","#FFFFFF"]),e.width=360,e.height=15,this._listVinhDanh.insertCustomItem(e,0)),d.width=360,d.height=15,this._listVinhDanh.insertCustomItem(d,0),0!==g&&
this._listVinhDanh.insertCustomItem(f,0)}});MGPopupGiaoDich=MGBaseNode.extend({_thoiGian:null,_phong:null,_zdo:null,_ketQua:null,_tienThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);cc.sys.isNative?this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUITextGiaoDich,"res/").node):this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUITextGiaoDich).node);this._initTextGD()},_initTextGD:function(){this._thoiGian=this.getChildByName("TextNgayThang");
this._thoiGian.ignoreContentAdaptWithSize(!0);this._phong=this.getChildByName("TextLoaiCuoc");this._phong.ignoreContentAdaptWithSize(!0);this._zdo=this.getChildByName("TextZdo");this._zdo.ignoreContentAdaptWithSize(!0);this._ketQua=this.getChildByName("TextKetQua");this._ketQua.ignoreContentAdaptWithSize(!0);this._tienThang=this.getChildByName("TextTienThang");this._tienThang.ignoreContentAdaptWithSize(!0)},setThoiGianGD:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+a.getSeconds(),
d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?a.getHours():"0"+a.getHours();this._thoiGian.setString(a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+e+":"+d+":"+b)},setPhongGD:function(a){100===a?this._phong.setString("Nông dân"):200===a?this._phong.setString("Địa chủ"):1E3===a?this._phong.setString("Qúy tộc"):this._phong.setString("Hoàng Gia")},setCuocZdo:function(a){this._zdo.setString(Utilities.Coin(a))},setKetQua:function(a){0<a?this._ketQua.setString("Thắng"):
this._ketQua.setString("Thua")},setTienThang:function(a){0<a?this._tienThang.setString(Utilities.Coin(a)):this._tienThang.setString("0")}});MGPopupHuZdo=MGBaseNode.extend({_thoiGian:null,_loaiCuoc:null,_nickName:null,_hu:null,_tienHu:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);cc.sys.isNative?this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUITextHuZdo,"res/").node):this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUITextHuZdo).node);this._initTextHD()},_initTextHD:function(){this._thoiGian=this.getChildByName("TextNgayThang");
this._thoiGian.ignoreContentAdaptWithSize(!0);this._loaiCuoc=this.getChildByName("TextLoaiCuoc");this._loaiCuoc.ignoreContentAdaptWithSize(!0);this._nickName=this.getChildByName("TextNickName");this._nickName.ignoreContentAdaptWithSize(!0);this._hu=this.getChildByName("TextSoLuong");this._hu.ignoreContentAdaptWithSize(!0);this._tienHu=this.getChildByName("TextTien");this._tienHu.ignoreContentAdaptWithSize(!0)},setTextNgay:function(a){this._thoiGian.setString(a.slice(0,10)+" "+a.slice(11,19))},setTextLoaiCuoc:function(a){100===
a?this._loaiCuoc.setString("Nông dân"):200===a?this._loaiCuoc.setString("Địa chủ"):1E3===a?this._loaiCuoc.setString("Qúy tộc"):this._loaiCuoc.setString("Hoàng Gia")},setTextNickName:function(a){this._nickName.setString(a)},setTextHu:function(a){this._hu.setString(a)},setTextTienHu:function(a){this._tienHu.setString(Utilities.Coin(a))}});MGPopupVinhDanh=MGBaseNode.extend({ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this)}});var MGSlotElement=MGBaseNode.extend({column_icon:null,delayLine:null,countCallBack:0,value:null,finishQuay:null,arr_ValueLater:null,ctor:function(){this.column_icon=[];this.arr_ValueLater=[];this.value=[];this.finishQuay=0;MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initIcon();this.initImage();this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this)},initIcon:function(){for(var a=null,b=0;6>b;b++)a=
this.getChildByName("MGItem"+b),this.column_icon.push(a)},initImage:function(){for(var a=null,b=0;6>b;b++)a=parseInt(11*Math.random())+1,this.column_icon[b].setSpriteFrame(COMBO_ELEMENT[a].IMAGE)},loadImage:function(){if(6==this.value.length)for(var a=0;6>a;a++)COMBO_ELEMENT[this.value[a]]&&this.column_icon[a].setSpriteFrame(COMBO_ELEMENT[this.value[a]].IMAGE)},loadImageBlur:function(){if(6==this.value.length)for(var a=0;6>a;a++)this.column_icon[a].setSpriteFrame(COMBO_ELEMENT[this.value[a]].IMAGE_BLUR)},
setValueColumn:function(a){this.value=a},setValueColumnAfter:function(a){this.arr_ValueLater=a},moveColumnSlot:function(){this.countCallBack++;var a=this.getPosition();-340>=a.y&&this.setPosition(a.x,-1);var a=this.getPosition(),b=null,d=b=null;1===this.countCallBack?(this.finishQuay=1,b=new cc.JumpBy(.3,cc.p(0,30),0,0),d=new cc.JumpBy(.01,cc.p(0,-30),0,0),b=cc.sequence(b,d,cc.callFunc(this.moveColumnSlot.bind(this)))):2<=this.countCallBack&&5>this.countCallBack?(2===this.countCallBack&&this.loadImageBlur(),
b=cc.sequence(cc.moveTo(.01*this.delayLine,cc.p(a.x,a.y-60)),cc.callFunc(this.moveColumnSlot.bind(this)))):25>=this.countCallBack?(20===this.countCallBack&&(this.value=this.arr_ValueLater,this.loadImageBlur()),b=cc.sequence(cc.moveTo(.03,cc.p(a.x,a.y-60)),cc.callFunc(this.moveColumnSlot.bind(this)))):(this.loadImage(),b=new cc.JumpBy(.001,cc.p(0,-25),0,0),d=new cc.JumpBy(.3,cc.p(0,25),0,0),b=cc.sequence(b,d),this.finishQuay=this.countCallBack=0,this.setPosition(a.x,-1));this.runAction(b)}});var MGComboSlot=MGBaseNode.extend({_panelColumn:null,_btnQuay:null,_btnQuayHover:null,_column:null,_effectButtonQuay:null,_valueComboSlot:null,_arrayElementLine:null,_arrayWin:null,beginQuay:0,_resultQuayBefore:null,_resultQuayAfter:null,_arrAction:null,_effect1:null,_effect2:null,_effect3:null,_textQuay:null,_ballQuay:null,_isUpDownQuay:null,_onMiniGame:0,ctor:function(){this._column=[];this._valueComboSlot=[];this._arrayElementLine=[];this._arrayWin=[];this._arrAction=[];this.beginQuay=0;this._resultQuayBefore=
[];this._resultQuayAfter=[];MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initCombo();this._initButtonQuay();this._initEffectButtonQuay();this.initElementLine();this._initEventsGame()},_initButtonQuay:function(){this._btnQuay=this.getChildByName("MGButtonQuayContainer").getChildByName("MGButtonQuay");this._btnQuayHover=new MGBaseButton;this._btnQuayHover.cloneFromButton(this.getChildByName("MGButtonQuayContainer").getChildByName("MGButtonQuayHover"));
this.getChildByName("MGButtonQuayContainer").addChild(this._btnQuayHover)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._btnQuayHover.setMouseHoverEnabled(!0);this._btnQuayHover.addMouseHoverEventListener(this.hoverButtonQuay.bind(this));this._btnQuayHover.setSwallowTouches(!1);this._btnQuay.addClickEventListener(this.moveComboElement.bind(this));this._btnQuay.setTouchEnabled(!0);this._listEvents.push(cc.eventManager.addCustomListener("GET_RESULT_QUAY",this.setResultQuay.bind(this)))},
_initCombo:function(){this._panelColumn=this.getChildByName("panelGiaoDienQuay");for(var a=null,b=0;5>b;b++)a=new MGSlotElement,a.cloneFromNode(this._panelColumn.getChildByName("MGColumn"+b)),a.initObj(),this._panelColumn.addChild(a),this._column.push(a)},_initEffectButtonQuay:function(){this._effect1=this.getChildByName("MGButtonQuayContainer").getChildByName("MGEffectQuay1");this._effect2=this.getChildByName("MGButtonQuayContainer").getChildByName("MGEffectQuay2");this._effect3=this.getChildByName("MGButtonQuayContainer").getChildByName("MGEffectUp");
this._textQuay=this.getChildByName("MGButtonQuayContainer").getChildByName("MGTextQuay");this._ballQuay=this.getChildByName("MGButtonQuayContainer").getChildByName("MGBallQuay");this._effect3.setVisible(!1);this._isUpDownQuay=1;this.effectNormalButtonQuay()},setOnMiniGame:function(a){this._onMiniGame=a},initElementLine:function(){this._arrayElementLine[1]=[this._column[0].column_icon[1],this._column[1].column_icon[1],this._column[2].column_icon[1],this._column[3].column_icon[1],this._column[4].column_icon[1]];
this._arrayElementLine[2]=[this._column[0].column_icon[0],this._column[1].column_icon[0],this._column[2].column_icon[0],this._column[3].column_icon[0],this._column[4].column_icon[0]];this._arrayElementLine[3]=[this._column[0].column_icon[2],this._column[1].column_icon[2],this._column[2].column_icon[2],this._column[3].column_icon[2],this._column[4].column_icon[2]];this._arrayElementLine[4]=[this._column[0].column_icon[1],this._column[1].column_icon[1],this._column[2].column_icon[0],this._column[3].column_icon[1],
this._column[4].column_icon[1]];this._arrayElementLine[5]=[this._column[0].column_icon[1],this._column[1].column_icon[1],this._column[2].column_icon[2],this._column[3].column_icon[1],this._column[4].column_icon[1]];this._arrayElementLine[6]=[this._column[0].column_icon[0],this._column[1].column_icon[0],this._column[2].column_icon[1],this._column[3].column_icon[0],this._column[4].column_icon[0]];this._arrayElementLine[7]=[this._column[0].column_icon[2],this._column[1].column_icon[2],this._column[2].column_icon[1],
this._column[3].column_icon[2],this._column[4].column_icon[2]];this._arrayElementLine[8]=[this._column[0].column_icon[0],this._column[1].column_icon[2],this._column[2].column_icon[0],this._column[3].column_icon[2],this._column[4].column_icon[0]];this._arrayElementLine[9]=[this._column[0].column_icon[2],this._column[1].column_icon[0],this._column[2].column_icon[2],this._column[3].column_icon[0],this._column[4].column_icon[2]];this._arrayElementLine[10]=[this._column[0].column_icon[1],this._column[1].column_icon[0],
this._column[2].column_icon[2],this._column[3].column_icon[0],this._column[4].column_icon[1]];this._arrayElementLine[11]=[this._column[0].column_icon[2],this._column[1].column_icon[1],this._column[2].column_icon[0],this._column[3].column_icon[1],this._column[4].column_icon[2]];this._arrayElementLine[12]=[this._column[0].column_icon[0],this._column[1].column_icon[1],this._column[2].column_icon[2],this._column[3].column_icon[1],this._column[4].column_icon[0]];this._arrayElementLine[13]=[this._column[0].column_icon[1],
this._column[1].column_icon[2],this._column[2].column_icon[1],this._column[3].column_icon[0],this._column[4].column_icon[1]];this._arrayElementLine[14]=[this._column[0].column_icon[1],this._column[1].column_icon[0],this._column[2].column_icon[1],this._column[3].column_icon[2],this._column[4].column_icon[1]];this._arrayElementLine[15]=[this._column[0].column_icon[2],this._column[1].column_icon[1],this._column[2].column_icon[1],this._column[3].column_icon[1],this._column[4].column_icon[2]];this._arrayElementLine[16]=
[this._column[0].column_icon[0],this._column[1].column_icon[1],this._column[2].column_icon[1],this._column[3].column_icon[1],this._column[4].column_icon[0]];this._arrayElementLine[17]=[this._column[0].column_icon[1],this._column[1].column_icon[2],this._column[2].column_icon[2],this._column[3].column_icon[2],this._column[4].column_icon[1]];this._arrayElementLine[18]=[this._column[0].column_icon[1],this._column[1].column_icon[0],this._column[2].column_icon[0],this._column[3].column_icon[0],this._column[4].column_icon[1]];
this._arrayElementLine[19]=[this._column[0].column_icon[2],this._column[1].column_icon[2],this._column[2].column_icon[1],this._column[3].column_icon[0],this._column[4].column_icon[0]];this._arrayElementLine[20]=[this._column[0].column_icon[0],this._column[1].column_icon[0],this._column[2].column_icon[1],this._column[3].column_icon[2],this._column[4].column_icon[2]];for(var a=0;20>a;a++)this._arrAction[a]=[]},moveComboElement:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK_QUAY,
MGGameInfo.gameVolume);cc.eventManager.dispatchCustomEvent("SHOW_EFFECT_QUAY",{target:this});this.beginQuay=0},moveComboElement2:function(){var a=null,b=[];if(0===this._resultQuayBefore.length)for(var a=null,d=0;15>d;d++)a=parseInt(11*Math.random())+1,this._resultQuayBefore.push(a);for(d=0;5>d;d++){for(var e=0;3>e;e++)a=this._resultQuayBefore[3*d+e],b.push(a);for(e=0;3>e;e++)a=parseInt(11*Math.random())+1,b.push(a);this._column[d].setValueColumn(b);this._column[d].delayLine=d;this._column[d].moveColumnSlot();
b=[]}},hoverButtonQuay:function(a,b){switch(b){case 1:this.effectHoverButtonQuay();break;case 0:this.effectNormalButtonQuay()}},setResultQuay:function(a){var b=a.getUserData().target;for(a=0;5>a;a++)for(var d=0;3>d;d++)this._resultQuayAfter[a+5*d]=b[a][d];var b=null,e=[];for(a=0;5>a;a++){for(d=0;3>d;d++)b=this._resultQuayAfter[5*d+a],e.push(b);for(d=0;3>d;d++)b=parseInt(11*Math.random())+1,e.push(b);this._column[a].setValueColumnAfter(e);e=[]}},setArrayWin:function(a){this._arrayWin=a},getEffectWin:function(){for(var a=
0;a<this._arrayWin.length;a++)for(var b=0;5>b;b++)this._arrayElementLine[this._arrayWin[a]][b].runAction(cc.sequence(cc.sequence(cc.scaleTo(.5,1.1,1.1),cc.scaleTo(.5,1,1)).repeat(20),cc.callFunc(this.callHideLine.bind(this))))},getStopEffect:function(){for(var a=0;a<this._arrayWin.length;a++)for(var b=0;5>b;b++)this._arrayElementLine[this._arrayWin[a]][b].stopAllActions(),this._arrayElementLine[this._arrayWin[a]][b].runAction(cc.scaleTo(0,1,1))},effectNormalButtonQuay:function(){1===this._isUpDownQuay&&
(this._effect1.runAction(cc.sequence(cc.scaleTo(0,1.4,1.4),cc.scaleTo(4,.4,.4)).repeatForever()),this._effect2.runAction(cc.sequence(cc.scaleTo(0,1.2,1.2),cc.scaleTo(4,.4,.4)).repeatForever()),this._ballQuay.runAction(cc.sequence(cc.rotateBy(4,90)).repeatForever()),this._textQuay.stopAllActions(),this._textQuay.runAction(cc.scaleTo(0,1,1)),this._effect3.setVisible(!1),this._effect3.stopAllActions(),this._effect3.runAction(cc.scaleTo(0,1,1)),this._isUpDownQuay=0)},effectHoverButtonQuay:function(){0===
this._isUpDownQuay&&0===this._onMiniGame&&(this._effect1.stopAllActions(),this._effect1.runAction(cc.scaleTo(0,1,1)),this._effect2.stopAllActions(),this._effect2.runAction(cc.scaleTo(0,1,1)),this._ballQuay.stopAllActions(),this._textQuay.runAction(cc.sequence(cc.scaleTo(0,1.2,1.2),cc.scaleTo(.4,1,1)).repeatForever()),this._effect3.setVisible(!0),this._effect3.runAction(cc.sequence(cc.scaleTo(0,1.2,1.2),cc.scaleTo(.4,1,1)).repeatForever()),this._isUpDownQuay=1)},setTextQuay:function(){this._textQuay.loadTexture("textQuay.png",
ccui.Widget.PLIST_TEXTURE)},setTextDung:function(){this._textQuay.loadTexture("textStop.png",ccui.Widget.PLIST_TEXTURE)},callHideLine:function(){cc.eventManager.dispatchCustomEvent("HIDE_LINE",null)}});var MGIconLine=MGBaseImageView.extend({value:null,hover_img:null,ctor:function(){MGBaseImageView.prototype.ctor.call(this);this._initEventsGame()},initObj:function(){MGBaseImageView.prototype.initObj.call(this);this.loadTexture("icon_line"+this.value+".png",ccui.Widget.PLIST_TEXTURE)},_initEventsGame:function(){MGBaseImageView.prototype._initEventsGame.call(this);this.setMouseHoverEnabled(!0)},setValue:function(a){this.value=a},setDispose:function(){MGBaseImageView.prototype.setDispose.call(this)}});var MGComboLine=MGBaseNode.extend({iconLines:null,hoverLines:null,_lineWins:null,_isLineWin:0,ctor:function(){this.iconLines=[];this.hoverLines=[];this._lineWins=[];MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initLines();this.initHover();this._initEventsGame()},initLines:function(){for(var a=null,b=null,d=0;20>d;d++)a=new MGIconLine,a.setValue(d+1),a.initObj(),b=this.getChildByName("icon_line"+(d+1)),a.setPosition(b.x,b.y),a.setTag(200+d),
a.setMouseHoverEnabled(!0),this.iconLines.push(a),this.addChild(a)},initHover:function(){for(var a=1;21>a;a++)this.hoverLines[a-1]=this.getChildByName("hoverline_"+a),this.hoverLines[a-1].setVisible(!1)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);for(var a=1;21>a;a++)this.iconLines[a-1].addMouseHoverEventListener(this.callHoverLine.bind(this));this._listEvents.push(cc.eventManager.addCustomListener("HIDE_LINE",this.hideLine.bind(this)))},callHoverLine:function(a,b){var d=
a.getTag()-200;switch(b){case 0:this.hoverLines[d].setVisible(!1);for(var e=0;e<this._lineWins.length;e++)this.hoverLines[d]===this.hoverLines[this._lineWins[e]-1]&&(this._isLineWin=1,this.hoverLines[d].setVisible(!0));this._isLineWin=0;break;case 1:this.hoverLines[d].setVisible(!0)}},lineWins:function(a){this._lineWins.push(a)},showLineWins:function(){for(var a=0;a<this._lineWins.length;a++)this.hoverLines[this._lineWins[a]-1].setVisible(!0)},hideLine:function(){for(var a=0;a<this._lineWins.length;a++)this.hoverLines[this._lineWins[a]-
1].setVisible(!1);this._lineWins=[]},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.iconLines.length;a++)this.iconLines[a].setDispose(),this.iconLines[a].removeFromParent(!0),this.iconLines[a]=null;this.iconLines.length=0}});var MGLineElementControl=MGBaseImageView.extend({NormalSprite:null,HoverSprite:null,_selectState:!1,LineIdx:0,ctor:function(){MGBaseImageView.prototype.ctor.call(this);this.initObj()},initObj:function(){MGBaseImageView.prototype.initObj.call(this)},createLineData:function(a,b,d){this.setTouchEnabled(!0);this.LineIdx=a;this.loadTexture(b,ccui.Widget.PLIST_TEXTURE);this.NormalSprite=b;this.HoverSprite=d;this._initEventsGame()},_initEventsGame:function(){MGBaseImageView.prototype._initEventsGame.call(this);
this.setMouseHoverEnabled(!0);this.addMouseHoverEventListener(this._onMouseHoverLine.bind(this));this.addClickEventListener(this._onClickLine.bind(this))},_onMouseHoverLine:function(a,b){switch(b){case 0:this.getTag()!==a.getTag()||this._selectState||this.setTextureImage(!1);break;case 1:this.setTextureImage(!0)}},_onClickLine:function(a){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);this.setStateLine(!this._selectState);cc.eventManager.dispatchCustomEvent("SET_TUNG_DONG_CUOC",
{target:this})},setStateLine:function(a){(this._selectState=a)?this.setTextureImage(!0):this.setTextureImage(!1)},getStateLine:function(){return this._selectState},setTextureImage:function(a){a?this.loadTexture(this.HoverSprite,ccui.Widget.PLIST_TEXTURE):this.loadTexture(this.NormalSprite,ccui.Widget.PLIST_TEXTURE)},setDispose:function(){MGBaseImageView.prototype.setDispose.call(this)}});var MGCompoSelectLine=MGBaseNode.extend({_lstBtnInit:null,_lstBtnNormalCheck:null,_lstLine:null,ctor:function(){this._lstBtnInit=[];this._lstBtnNormalCheck=[];this._lstLine=[];MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initUI();this._initEventsGame()},_initUI:function(){this._createBtn();this._createListLine()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);for(var a=0;a<this._lstBtnInit.length;a++)this._lstBtnInit[a].addClickEventListener(this._onClickBtnSelect.bind(this));
cc.eventManager.addCustomListener("SET_TUNG_DONG_CUOC",this.changeTungDongCuoc.bind(this))},_createBtn:function(){for(var a in MGCompoSelectLine.BUTTON_LIST){var b=this.getChildByName("Node_"+MGCompoSelectLine.BUTTON_LIST[a].Name);if(b&&void 0!==b){var d=new MGBaseImageView;d.setTag(a);d.initObj();d._initEventsGame();d.setPosition(b.getPosition());d.loadTexture(MGCompoSelectLine.BUTTON_LIST[a].Name+".png",ccui.Widget.PLIST_TEXTURE);d.setTouchEnabled(!0);this.addChild(d);this._lstBtnInit.push(d)}}},
_createListLine:function(){for(var a=1;20>=a;a++){var b=MGCompoSelectLine.LINE_NAME+a,d=this.getChildByName("Node_"+MGCompoSelectLine.LINE_NAME+a);if(d&&void 0!==d){var e=new MGLineElementControl;e.createLineData(a,b+"_Black.png",b+".png");e.setPosition(d.getPosition());e.setTag(MGCompoSelectLine.LINE_TAG+a);this.addChild(e);this._lstLine.push(e)}}},_onMouseHover:function(a,b){switch(b){case 0:if(-1===this._lstBtnNormalCheck.indexOf(a.getTag())){var d=MGCompoSelectLine.BUTTON_LIST[a.getTag()].Name;
a.loadTexture(d+".png",ccui.Widget.PLIST_TEXTURE);this._lstBtnNormalCheck.push(a.getTag())}break;case 1:d=MGCompoSelectLine.BUTTON_LIST[a.getTag()].Name,a.loadTexture(d+"_Black.png",ccui.Widget.PLIST_TEXTURE),d=this._lstBtnNormalCheck.indexOf(a.getTag()),-1!==d&&this._lstBtnNormalCheck.splice(d)}},_onClickBtnSelect:function(a){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);switch(parseInt(a.getTag())){case 300:this._selectLineChanLe(!1);break;case 301:this._selectLineChanLe(!0);
break;case 302:this._selectRemoveAllLine(!0);break;case 303:this._selectRemoveAllLine(!1)}cc.eventManager.dispatchCustomEvent("SET_DONG_CUOC",{target:this})},_selectLineChanLe:function(a){for(var b=0;b<this._lstLine.length;b++)a?0===this._lstLine[b].LineIdx%2?this._lstLine[b].setStateLine(!0):this._lstLine[b].setStateLine(!1):0<this._lstLine[b].LineIdx%2?this._lstLine[b].setStateLine(!0):this._lstLine[b].setStateLine(!1)},_selectRemoveAllLine:function(a){for(var b=0;b<this._lstLine.length;b++)this._lstLine[b].setStateLine(a)},
getListLineSelect:function(){for(var a=[],b=0;b<this._lstLine.length;b++)this._lstLine[b].getStateLine()&&a.push(this._lstLine[b].LineIdx);return a},setSelectLine1:function(){this._lstLine[0].setStateLine(!0)},setNoSelectLine1:function(){this._lstLine[0].setStateLine(!1)},changeTungDongCuoc:function(a){a=a.getUserData();for(var b=0;b<this._lstLine.length;b++)a.target.LineIdx===this._lstLine[b].LineIdx&&this._lstLine[b].setStateLine(a.target.getStateLine());cc.eventManager.dispatchCustomEvent("SET_DONG_CUOC",
{target:this})},hideButtonChonDong:function(){for(var a=0;a<this._lstBtnInit.length;a++)this._lstBtnInit[a].setTouchEnabled(!1);for(a=0;a<this._lstLine.length;a++)this._lstLine[a].setTouchEnabled(!1)},showButtonChonDong:function(){for(var a=0;a<this._lstBtnInit.length;a++)this._lstBtnInit[a].setTouchEnabled(!0);for(a=0;a<this._lstLine.length;a++)this._lstLine[a].setTouchEnabled(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this._lstLine.length;a++)this._lstLine[a].setDispose(),
this._lstLine[a].removeFromParent(!0),this._lstLine[a]=null;this._lstLine.length=0}});var MGGiaoDienChonMucCuoc=MGBaseNode.extend({mucCuoc:null,buttonCuoc:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.buttonCuoc=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initButton();this.initButtonImage();this._initEventsGame()},initButton:function(){for(var a=null,b=0;4>b;b++)a=this.getChildByName("BtnCuoc"+b),a.setTag("40"+b),this.buttonCuoc.push(a)},initButtonImage:function(){for(var a=null,b=0;4>b;b++)a=this.getChildByName("MGIcon"+b),a.setTag("50"+b),
this.buttonCuoc.push(a)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);for(var a=0;8>a;a++)this.buttonCuoc[a].addClickEventListener(this.chonMucCuoc.bind(this))},chonMucCuoc:function(a){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);var b=100;switch(parseInt(a.getTag())){case 400:b=this.mucCuoc=100;break;case 401:b=this.mucCuoc=200;break;case 402:b=this.mucCuoc=1E3;break;case 403:b=this.mucCuoc=1E4;break;case 500:b=this.mucCuoc=
100;break;case 501:b=this.mucCuoc=200;break;case 502:b=this.mucCuoc=1E3;break;case 503:b=this.mucCuoc=1E4}cc.eventManager.dispatchCustomEvent("SET_MUC_CUOC",{target:b})}});var MGLayerBangThuong=MGBaseNode.extend({_buttonClose:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._buttonClose=this.getChildByName("MGButtonCloseBangThuong");this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._buttonClose.addClickEventListener(this.closeBangThuong.bind(this))},closeBangThuong:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,
MGGameInfo.gameVolume);this.setVisible(!1);cc.eventManager.dispatchCustomEvent("CLOSE_BANG_THUONG",null)}});var MGLayerTongDat=MGBaseNode.extend({_textDong:null,_textMuc:null,_textTongDat:null,_textVuaThang:null,_textTuQuay:null,_buttonTuQuay:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._textDong=this.getChildByName("MGTextTongDong");this._textMuc=this.getChildByName("MGTextMuc");this._textVuaThang=this.getChildByName("MGTextVuaThang");this._textVuaThang.ignoreContentAdaptWithSize(!0);this._textTongDat=this.getChildByName("MGTextTongDat");
this._buttonTuQuay=this.getChildByName("MGButtonTuQuay");this._textTuQuay=this._buttonTuQuay.getChildByName("MGTextTuQuay");this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._buttonTuQuay.addClickEventListener(this.setTuQuay.bind(this))},setTuQuay:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);cc.eventManager.dispatchCustomEvent("SET_TU_QUAY",{target:this})},setTextDong:function(a){this._textDong.setString(a)},
setTextMuc:function(a){this._textMuc.setString(Utilities.Coin(a))},setTextTongDat:function(a){this._textTongDat.setString(Utilities.Coin(a))},setTextVuaThang:function(a){this._textVuaThang.setString(Utilities.Coin(a))},setTextTuQuay:function(a){this._textTuQuay.setString(a)}});var MGMiniGameCaoThap=MGBaseNode.extend({isCaoThap:null,_textTien:null,_onExit:0,_buttonGomXeng:null,_buttonClose:null,_buttonCao:null,_buttonThap:null,_buttonExitMiniGame:null,_iconTick:null,_arrIcon:null,_resultGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._arrIcon=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengLuxury.MGUIMiniGame,PreLoaderConfig.PathToResourceDefault).node);
this.initNumber();this.initUI();this._initEventsGame()},initUI:function(){this._textTien=this.getChildByName("MGTextTongThuong");this._buttonCao=this.getChildByName("MGButtonCao");this._buttonCao.setTag("500");this._buttonThap=this.getChildByName("MGButtonThap");this._buttonThap.setTag("501");this._buttonGomXeng=this.getChildByName("MGButtonGomXeng");this._buttonClose=this.getChildByName("MGButtonCloseMiniGame");this._buttonExitMiniGame=this.getChildByName("MGButtonTick");this._iconTick=this._buttonExitMiniGame.getChildByName("MGIconTick");
this._iconTick.setVisible(!1)},initBackGround:function(){var a=new ccui.Layout;a.setContentSize(2E3,2E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._buttonCao.addClickEventListener(this.sentOptionMiniGame.bind(this));this._buttonThap.addClickEventListener(this.sentOptionMiniGame.bind(this));
this._buttonExitMiniGame.addClickEventListener(this.exitMiniGame.bind(this));this._buttonGomXeng.addClickEventListener(this.gomXeng.bind(this));this._buttonClose.addClickEventListener(this.closeMiniGame.bind(this))},initNumber:function(){for(var a=null,b=null,d=0;4>d;d++)a=this.getChildByName("MGNumber"+d),b=new cc.LabelBMFont("9",ResourceManager.MGResourcesGameXengLuxury.Font2_fnt),this.addChild(b),b.setPosition(a.x,a.y),this._arrIcon.push(b)},setTextTien:function(a){this._textTien.setString(Utilities.Coin(a))},
sentOptionMiniGame:function(a){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);switch(a.getName()){case "MGButtonCao":this.isCaoThap=1;break;case "MGButtonThap":this.isCaoThap=0}cc.eventManager.dispatchCustomEvent("GET_OPTION_CAOTHAP",{target:this.isCaoThap})},exitMiniGame:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);0===this._onExit?(this._iconTick.setVisible(!0),this._onExit=1):(this._iconTick.setVisible(!1),
this._onExit=0);cc.eventManager.dispatchCustomEvent("GET_NEVER_MINI_GAME",{target:this._onExit})},gomXeng:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);cc.eventManager.dispatchCustomEvent("CLOSE_MINI_GAME",{target:this._onExit})},closeMiniGame:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);cc.eventManager.dispatchCustomEvent("CLOSE_MINI_GAME",{target:this._onExit})},enbleButtonMiniGame:function(){this._buttonGomXeng.setEnabled(!0);
this._buttonCao.setEnabled(!0);this._buttonThap.setEnabled(!0)},disEnbleButtonMiniGame:function(){this._buttonGomXeng.setEnabled(!1);this._buttonCao.setEnabled(!1);this._buttonThap.setEnabled(!1)},setTextResult:function(){for(var a=null,a=10>this._resultGame?"000"+this._resultGame.toString():100>this._resultGame&&9<this._resultGame?"00"+this._resultGame.toString():1E3>this._resultGame?"0"+this._resultGame.toString():this._resultGame.toString(),b=0;b<this._arrIcon.length;b++)this._arrIcon[b].setString(a.charAt(b))},
effectQuayMiniGame:function(){this.runAction(cc.sequence(cc.delayTime(.03),cc.callFunc(this.randomValue.bind(this))).repeatForever())},randomValue:function(){for(var a=null,b=0;b<this._arrIcon.length;b++)a=parseInt(10*Math.random()),this._arrIcon[b].setString(a)},setResultMiniGame:function(a){this._resultGame=a}});var COMBO_ELEMENT={1:{IMAGE:"icon_Wild.png",IMAGE_BLUR:"icon_Wild_Blur.png"},2:{IMAGE:"icon_Scatter.png",IMAGE_BLUR:"icon_Scatter_Blur.png"},3:{IMAGE:"icon_Plane.png",IMAGE_BLUR:"icon_Plane_Blur.png"},4:{IMAGE:"icon_Boat.png",IMAGE_BLUR:"icon_Boat_Blur.png"},5:{IMAGE:"icon_Car.png",IMAGE_BLUR:"icon_Car_Blur.png"},6:{IMAGE:"icon_A.png",IMAGE_BLUR:"icon_A_Blur.png"},7:{IMAGE:"icon_K.png",IMAGE_BLUR:"icon_K_Blur.png"},8:{IMAGE:"icon_Q.png",IMAGE_BLUR:"icon_Q_Blur.png"},9:{IMAGE:"icon_J.png",IMAGE_BLUR:"icon_J_Blur.png"},
10:{IMAGE:"icon_10.png",IMAGE_BLUR:"icon_10_Blur.png"},11:{IMAGE:"icon_9.png",IMAGE_BLUR:"icon_9_Blur.png"}};MGCompoSelectLine.BUTTON_LIST={300:{TagID:300,Name:"btnSelectLe"},301:{TagID:301,Name:"btnSelectChan"},302:{TagID:302,Name:"btnTatCa"},303:{TagID:303,Name:"btnBoChon"}};MGCompoSelectLine.LINE_NAME="lineImage";MGCompoSelectLine.LINE_TAG=400;var MGSlotLuxury=MGBaseGame.extend({_layerPopupSlotLuxury:null,_layerComboElement:null,_layerComboLines:null,_layerSelectLine:null,_layerChonMucCuoc:null,_layerBangThuong:null,_layerTongDat:null,_buttonChoiThu:null,_buttonBangThuong:null,_buttonQuayLai:null,_buttonMiniGame:null,_arrResultComboSlot:[],_listDongCuoc:[],_pos:null,_mucCuoc:0,_onChoiThu:0,_startQuay:null,_textTongTien:null,_textNoHu:null,_textIDBan:null,_textVuaThang:0,_layerMiniGame:null,_neverMiniGame:1,_effectWin:null,_effectCoinWin:null,
_tuQuay:0,_isTuQuay:0,_isSound:1,_buttonSound:null,_imageSound:null,_isChuaCuoc:0,_effectNoHu:null,_effectThangMiniGame:null,_effectThuaMiniGame:null,_effectCoinWinNoHu:null,_isNoHu:0,_tongTien:0,_popupThongBao:null,_popupCompoLichSu:null,_clickCaoThap:0,_thoiGian:0,_tongCuoc:0,_listThongBao:null,_vongQuayMienPhi:0,_tempTuQuay:0,_idVan:null,_isGiaoDien:2,_textVQMP:null,_isHideMiniGame:0,_coinNoHu:0,_timeTuQuayFinish:null,_timeEffectThangThua:null,_timeQuayMiniGame:null,_timeEffectMiniGame:null,_timeHideMiniGame:null,
_timeEffectEnbleButtonMiniGame:null,exitMiniGame:0,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameXengLuxury;this._startQuay=1},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendXengLuxury;this._initIconElement();this._initIconLines();this._initSlectLine();this._initChonMucCuoc();this._initButtonChoiThu();this._initLayerBangThuong();this._initButtonBangThuong();this._initButtonQuayLai();this._initButtonMiniGame();
this._initLayerTongDat();this._initText();this._initPopup();this._initSound();this._initEffect();this._initMiniGame();this._initEffectMiniGame();this.initEvent();mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.SOUND_WELCOME)},_changeBackGround:function(){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameXengLuxury.MGBackGroundXeng;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengLuxury.MGUILayerXeng,
PreLoaderConfig.PathToResourceDefault)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUserCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.StartGame.toString(),this._getStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.GameData.toString(),
this._getMinCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.Turning.toString(),this._getResultData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.PerformTurning.toString(),this._getPerformTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.BetGameMini.toString(),this._getBetGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.ResultGameMini.toString(),
this._getResultGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.CancelMiniGame.toString(),this._getCancelGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.UserLeftDesk.toString(),this._getUserLeftDesk.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.ListUser.toString(),this._getListUser.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.FreeTurning.toString(),
this._getFreeTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.WinBonusBox.toString(),this._getWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.BigWin.toString(),this._getBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.TopWinBonusBox.toString(),this._getTopWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_LUXURY.TopBigWin.toString(),
this._getTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("SET_MUC_CUOC",this.getMucCuoc.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("SET_DONG_CUOC",this.getDongCuoc.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("SHOW_EFFECT_QUAY",this.callResultQuay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("CLOSE_BANG_THUONG",this.closeLayerBangThuong.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("GET_OPTION_CAOTHAP",
this.getOptionCaoThap.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("CLOSE_MINI_GAME",this.getCloseMiniGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("GET_NEVER_MINI_GAME",this.getNerverMiniGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener("SET_TU_QUAY",this.setNumberTuQuay.bind(this)))},initEvent:function(){this._buttonChoiThu.addClickEventListener(this.showLayerQuayChoiThu.bind(this));this._buttonQuayLai.addClickEventListener(this.showLayerChonMucCuoc.bind(this));
this._buttonBangThuong.addClickEventListener(this.showLayerBangThuong.bind(this));this._buttonMiniGame.addClickEventListener(this.showLayerMiniGame.bind(this));this._buttonSound.addClickEventListener(this.showSoundGames.bind(this))},_initIconElement:function(){this._layerComboElement=new MGComboSlot;this._layerComboElement.cloneFromNode(this._mainLayer.getChildByName("MGNodeQuay"));this._layerComboElement.initObj();this.addChild(this._layerComboElement)},_initIconLines:function(){this._layerComboLines=
new MGComboLine;this._layerComboLines.cloneFromNode(this._mainLayer.getChildByName("MGNodeIconLine"));this._layerComboLines.initObj();this.addChild(this._layerComboLines)},_initSlectLine:function(){this._layerSelectLine=new MGCompoSelectLine;this._layerSelectLine.cloneFromNode(this._mainLayer.getChildByName("MGNodeChonDong"));this._layerSelectLine.initObj();this.addChild(this._layerSelectLine)},_initChonMucCuoc:function(){this._layerChonMucCuoc=new MGGiaoDienChonMucCuoc;this._layerChonMucCuoc.cloneFromNode(this._mainLayer.getChildByName("MGNodeGiaoDienDau"));
this._layerChonMucCuoc.initObj();this.addChild(this._layerChonMucCuoc)},_initButtonChoiThu:function(){var a=new MGBaseNode;a.cloneFromNode(this._mainLayer.getChildByName("MGButtonChoiThu"));this._buttonChoiThu=a.getChildByName("MGButtonChoiThu");this.addChild(a)},_initLayerBangThuong:function(){this._layerBangThuong=new MGLayerBangThuong;this._layerBangThuong.cloneFromNode(this._mainLayer.getChildByName("MGNodeBangThuong"));this._layerBangThuong.initObj();this.addChild(this._layerBangThuong)},_initButtonBangThuong:function(){var a=
new MGBaseNode;a.cloneFromNode(this._mainLayer.getChildByName("MGButtonBangThuong"));this._buttonBangThuong=a.getChildByName("MGButtonBangThuong");this.addChild(a)},_initButtonMiniGame:function(){var a=new MGBaseNode;a.cloneFromNode(this._mainLayer.getChildByName("MGButtonMiniGame"));this._buttonMiniGame=a.getChildByName("MGButtonMiniGame");this.addChild(a)},_initButtonQuayLai:function(){var a=new MGBaseNode;a.cloneFromNode(this._mainLayer.getChildByName("MGButtonQuayLai"));this._buttonQuayLai=a.getChildByName("MGButtonQuayLai");
this._buttonQuayLai.setVisible(!1);this.addChild(a)},_initLayerTongDat:function(){this._layerTongDat=new MGLayerTongDat;this._layerTongDat.cloneFromNode(this._mainLayer.getChildByName("MGNodeTongDat"));this._layerTongDat.initObj();this.addChild(this._layerTongDat)},_initText:function(){this._textTongTien=this._mainLayer.getChildByName("MGTextTongTien");this._textTongTien.ignoreContentAdaptWithSize(!0);this._textIDBan=this._mainLayer.getChildByName("MGTextMaPhong");this._textNoHu=this._mainLayer.getChildByName("MGTextNoHu");
this._textNoHu.ignoreContentAdaptWithSize(!0);this._textVQMP=this._mainLayer.getChildByName("TextVQMienPhi");this._textVQMP.setVisible(!1)},_initMiniGame:function(){var a=this._mainLayer.getChildByName("MGNodeMiniGame");this._layerMiniGame=new MGMiniGameCaoThap;this._layerMiniGame.initObj();this.addChild(this._layerMiniGame);this._layerMiniGame.setPosition(a.x,a.y);this._layerMiniGame.setVisible(!1)},_initEffect:function(){var a=this._mainLayer.getChildByName("MGTextNoHu");this._effectWin=new MGComboEffectWinCoinXeng;
this._effectWin.initObj();this.addChild(this._effectWin);this._effectWin.setPosition(640,640);this._effectWin.setProties(100,.7,70);this._effectNoHu=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengLuxury.MGEffectWin_json,ResourceManager.MGResourcesGameXengLuxury.MGEffectWin_atlas);this._effectNoHu.setPosition(a.x,a.y+10);this._effectNoHu.setVisible(!1);this.addChild(this._effectNoHu);this._effectCoinWinNoHu=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengLuxury.Font_fnt);
this._effectCoinWinNoHu.setVisible(!1);this.addChild(this._effectCoinWinNoHu);this._effectCoinWinNoHu.setPosition(a.x,a.y+10)},_initEffectMiniGame:function(){var a=this._mainLayer.getChildByName("MGNodeMiniGame");this._effectThangMiniGame=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengLuxury.MGEffectWinMiniGame_json,ResourceManager.MGResourcesGameXengLuxury.MGEffectWinMiniGame_atlas);this._effectThangMiniGame.setPosition(a.x,a.y);this.addChild(this._effectThangMiniGame);this._effectThangMiniGame.setVisible(!1);
this._effectThuaMiniGame=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengLuxury.MGEffectLoseMiniGame_json,ResourceManager.MGResourcesGameXengLuxury.MGEffectLoseMiniGame_atlas);this._effectThuaMiniGame.setPosition(a.x,a.y);this.addChild(this._effectThuaMiniGame);this._effectThuaMiniGame.setVisible(!1)},_initSound:function(){this._buttonSound=this._mainLayer.getChildByName("MGButtonSoundXeng");this._buttonSound.setVisible(!1);this._buttonSound.setTouchEnabled(!1);this._imageSound=this._buttonSound.getChildByName("MGImageSoundXeng")},
_initPopup:function(){this._popupThongBao=new MGPopupThongBao;this._popupThongBao.cloneFromNode(this._mainLayer.getChildByName("MGPopupThongBao"));this._popupThongBao.initObj();this.addChild(this._popupThongBao);this._popupCompoLichSu=new MGPopupComboLichSu;this._popupCompoLichSu.cloneFromNode(this._mainLayer.getChildByName("MGPopupVinhDanh"));this._popupCompoLichSu.initObj();this.addChild(this._popupCompoLichSu)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);mg.audio.stopAllEffects(!0);
this._popupThongBao&&(this._popupThongBao.setDispose(),this._popupThongBao.removeFromParent(!0),this._popupThongBao=null);this._layerChonMucCuoc&&(this._layerChonMucCuoc.setDispose(),this._layerChonMucCuoc.removeFromParent(!0),this._layerChonMucCuoc=null);this._layerComboElement&&(this._layerComboElement.setDispose(),this._layerComboElement.removeFromParent(!0),this._layerComboElement=null);this._layerMiniGame&&(this._layerMiniGame.setDispose(),this._layerMiniGame.removeFromParent(!0),this._layerMiniGame=
null);this._layerSelectLine&&(this._layerSelectLine.setDispose(),this._layerSelectLine.removeFromParent(!0),this._layerSelectLine=null);this._layerComboLines&&(this._layerComboLines.setDispose(),this._layerComboLines.removeFromParent(!0),this._layerComboLines=null);this._timeTuQuayFinish&&clearTimeout(this._timeTuQuayFinish);this._timeEffectThangThua&&clearTimeout(this._timeEffectThangThua);this._timeQuayMiniGame&&clearTimeout(this._timeQuayMiniGame);this._timeEffectMiniGame&&clearTimeout(this._timeEffectMiniGame);
this._timeHideMiniGame&&clearTimeout(this._timeHideMiniGame);this._timeEffectEnbleButtonMiniGame&&clearTimeout(this._timeEffectEnbleButtonMiniGame)},onExit:function(){MGBaseGame.prototype.onExit.call(this)},getMucCuoc:function(a){this._mucCuoc=a.getUserData().target;this.showLayerQuay();this._layerTongDat.setTextMuc(this._mucCuoc);this._layerTongDat.setTextTongDat(this._mucCuoc*this._listDongCuoc.length);this._onChoiThu=0},getDongCuoc:function(a){this._listDongCuoc=a.getUserData().target.getListLineSelect();
this._layerTongDat.setTextDong(this._listDongCuoc.length);this._layerTongDat.setTextTongDat(this._mucCuoc*this._listDongCuoc.length)},showLayerQuay:function(){this.hideLayerQuay();this._isGiaoDien=1;this._layerComboLines.setVisible(!0);this._layerComboElement.setVisible(!0);this._buttonQuayLai.setVisible(!0);this._layerTongDat.setVisible(!0);this._layerBangThuong.setVisible(!1);0===this._listDongCuoc.length&&(this._layerSelectLine.setSelectLine1(),this._listDongCuoc=[1],this._layerTongDat.setTextDong(1));
this._layerTongDat.setTextTongDat(this._mucCuoc*this._listDongCuoc.length)},hideLayerQuay:function(){this._buttonChoiThu.setVisible(!1);this._layerChonMucCuoc.setVisible(!1);this._layerBangThuong.setVisible(!1);this._layerTongDat.setVisible(!1);this._layerComboElement.setVisible(!1);this._layerComboLines.setVisible(!1)},showLayerChonMucCuoc:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);this.hideLayerQuay();this._layerChonMucCuoc.setVisible(!0);
this._buttonChoiThu.setVisible(!0);this._buttonQuayLai.setVisible(!1);this._layerBangThuong.setVisible(!1);this._isGiaoDien=2},showLayerHienTai:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);this.hideLayerQuay();1===this._isGiaoDien&&(this._layerComboElement.setVisible(!0),this._layerComboLines.setVisible(!0),this._layerTongDat.setVisible(!0),this._buttonQuayLai.setVisible(!0));2===this._isGiaoDien&&(this._layerChonMucCuoc.setVisible(!0),this._buttonChoiThu.setVisible(!0),
this._buttonQuayLai.setVisible(!1));this._layerBangThuong.setVisible(!1)},showLayerBangThuong:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);this.hideLayerQuay();this._layerChonMucCuoc.setVisible(!1);this._buttonChoiThu.setVisible(!1);this._buttonQuayLai.setVisible(!1);this._layerBangThuong.setVisible(!0)},showLayerQuayChoiThu:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);this.showLayerQuay();
this._onChoiThu=1;this._mucCuoc=1E3;this._layerTongDat.setTextMuc(this._mucCuoc);this._layerTongDat.setTextTongDat(this._mucCuoc*this._listDongCuoc.length)},showSoundGames:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);cc.eventManager.dispatchCustomEvent(MGCompoHeader.EVENTS.CHANGE_VOLUME,{});0<MGGameInfo.gameVolume?this._imageSound.loadTexture("SoundOn.png",ccui.Widget.PLIST_TEXTURE):this._imageSound.loadTexture("SoundOff.png",ccui.Widget.PLIST_TEXTURE)},
ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this._textTongTien.setString("TK: "+Utilities.Coin(a.Gold))},closeLayerBangThuong:function(){this.showLayerHienTai()},callResultQuay:function(a){a=a.getUserData();0===this._vongQuayMienPhi&&(this._tempTuQuay=this._tuQuay,this._textVQMP.setVisible(!1));1===this._isTuQuay&&(this._tuQuay=this._isTuQuay=0,this._layerTongDat.setTextTuQuay(this._tuQuay),this._layerComboElement.setTextQuay());
1===this._startQuay&&(0===this._listDongCuoc.length||this._mucCuoc*this._listDongCuoc.length>this._tongTien&&0==this._onChoiThu?0===this._isChuaCuoc?this._isChuaCuoc=1:this._isChuaCuoc++:(0===this._vongQuayMienPhi&&0===this._onChoiThu&&(this._tongTien-=this._mucCuoc*this._listDongCuoc.length,this._textTongTien.setString("TK: "+Utilities.Coin(this._tongTien)),MGGameInfo.myInfo.Gold=this._tongTien,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{})),this._isChuaCuoc=
0),0!==this._isChuaCuoc?(this.netSend.sendBet(this._listDongCuoc,this._mucCuoc,this._onChoiThu),this._isChuaCuoc++):(this.sendServerBet(),a.target.beginQuay=1,0!==this._tuQuay&&(this._isTuQuay=1,this.hideInTuQuay(),this._layerComboElement.setTextDung())))},sendServerBet:function(){this._thoiGian=new Date;mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.QUAY,MGGameInfo.gameVolume);(0<this._tuQuay&&1===this._isTuQuay||0<this._vongQuayMienPhi)&&0<this._tuQuay&&
0===this._vongQuayMienPhi&&0===this._onChoiThu&&(this._tongTien-=this._mucCuoc*this._listDongCuoc.length,this._textTongTien.setString("TK: "+Utilities.Coin(this._tongTien)),MGGameInfo.myInfo.Gold=this._tongTien,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{}));this.netSend.sendBet(this._listDongCuoc,this._mucCuoc,this._onChoiThu);this._layerComboLines.hideLine();this._layerComboElement.getStopEffect();this._effectWin.setVisible(!1);this._buttonMiniGame.setTouchEnabled(!1);
this._layerTongDat._buttonTuQuay.setTouchEnabled(!1);this._buttonBangThuong.setTouchEnabled(!1);this._buttonQuayLai.setTouchEnabled(!1);this._timeTuQuayFinish=setTimeout(this.showAudioDungQuay.bind(this),1500)},showAudioDungQuay:function(){mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.DUNG_QUAY,MGGameInfo.gameVolume)},hideInTuQuay:function(){this._buttonQuayLai.setTouchEnabled(!1);this._buttonBangThuong.setTouchEnabled(!1);this._buttonMiniGame.setTouchEnabled(!1);
this._layerTongDat._buttonTuQuay.setTouchEnabled(!1);this._layerSelectLine.hideButtonChonDong()},showAfterTuQuay:function(){this._buttonQuayLai.setTouchEnabled(!0);this._buttonBangThuong.setTouchEnabled(!0);this._buttonMiniGame.setTouchEnabled(!0);this._layerTongDat._buttonTuQuay.setTouchEnabled(!0);this._layerSelectLine.showButtonChonDong()},showLayerMiniGame:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CLICK,MGGameInfo.gameVolume);this.showMiniGame()},getNerverMiniGame:function(a){this.exitMiniGame=
a.getUserData().target},setNumberTuQuay:function(a){if(10>this._tuQuay)return this.setTextTuQuayTD(10),!0;if(10<=this._tuQuay&&20>this._tuQuay)return this.setTextTuQuayTD(20),!0;if(20<=this._tuQuay&&50>this._tuQuay)return this.setTextTuQuayTD(50),!0;if(50<=this._tuQuay&&100>this._tuQuay)return this.setTextTuQuayTD(100),!0;if(100<=this._tuQuay&&500>this._tuQuay)return this.setTextTuQuayTD(500),!0;this.setTextTuQuayTD(0)},setTextTuQuayTD:function(a){this._tuQuay=a;this._layerTongDat.setTextTuQuay(a)},
_getStartGame:function(a){0===this._isTuQuay&&this.showAfterTuQuay();a=a.getUserData();var b=BinaryConstants.DataTypeID,b={TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("_getStartGame "+JSON.stringify(a));this._textNoHu.setString(Utilities.Coin(a.TotalCoinBonusBox));this._textTongTien.setString("TK: "+Utilities.Coin(a.Coin));this._tongTien=a.Coin;this._layerTongDat.setTextVuaThang(this._textVuaThang);this._buttonMiniGame.setTouchEnabled(!0);
this._buttonBangThuong.setTouchEnabled(!0);this._buttonQuayLai.setTouchEnabled(!0);this._callEffectQuay();0<this._vongQuayMienPhi?this._layerTongDat.setTextTuQuay(this._tuQuay):this._layerComboElement._btnQuay.setTouchEnabled(!0);this._startQuay=1;0<this._tongCuoc&&0===this._onChoiThu&&this._popupCompoLichSu.setDataGiaoDich(this._thoiGian,this._mucCuoc,this._tongCuoc,this._textVuaThang,this._textVuaThang);MGGameInfo.myInfo.Gold=a.Coin;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,
{});Utilities.showLog("----StartGame")},_callEffectQuay:function(){this.netSend.sendOptionMiniGame(this.exitMiniGame);this._layerMiniGame.setVisible(!1);this._layerComboElement._btnQuay.setTouchEnabled(!0);0<this._vongQuayMienPhi&&this._layerComboElement._btnQuay.setTouchEnabled(!1);(0<this._tuQuay||0<this._vongQuayMienPhi)&&this._mucCuoc*this._listDongCuoc.length<=this._tongTien?(this.sendServerBet(),0===this._vongQuayMienPhi&&this._tuQuay--,this._layerTongDat.setTextTuQuay(this._tuQuay)):(this._isTuQuay=
0,this.showAfterTuQuay(),this._layerComboElement._btnQuay.setTouchEnabled(!0),this._layerComboElement.setTextQuay(),0<this._tuQuay&&this._mucCuoc*this._listDongCuoc.length>this._tongTien&&(this._tuQuay=0,this._layerTongDat.setTextTuQuay(this._tuQuay),this.netSend.sendBet(this._listDongCuoc,this._mucCuoc,this._onChoiThu)))},_getMinCoin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListBet:b.Array8,ListBet_Type:b.UInt8,MaxCoin:b.UInt64,MinCoin:b.UInt64,
MatchID:b.UInt32,CoinUser:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._textTongTien.setString("TK: "+Utilities.Coin(a.CoinUser));this._tongTien=a.CoinUser;this._textIDBan.setString("#"+a.MatchID);this._idVan=a.MatchID;this._changeBackGround()},_getResultData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,BetCoin:b.Int64,LineUserBet:b.Array8,LineUserBet_Type:b.UInt8,CoinWinBet:b.Int64,RateWinCoinListLineBet:b.Array8,
RateWinCoinListLineBet_Type:b.Double,ScatterLines:b.UInt8,TimerPerformTurning:b.UInt8,NumRoundFree:b.UInt8,CoinWinFromBonusBox:b.Int64,MatchID:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._startQuay=0;this._layerComboElement.moveComboElement2();cc.eventManager.dispatchCustomEvent("GET_RESULT_QUAY",{target:a.ArrIcon});this._textVuaThang=a.CoinWinBet;this._coinNoHu=a.CoinWinFromBonusBox;this._idVan=a.MatchID;this._textIDBan.setString("#"+this._idVan);for(b=0;b<a.RateWinCoinListLineBet.length;b++)0<
a.RateWinCoinListLineBet[b]&&this._layerComboLines.lineWins(this._listDongCuoc[b]);this._tongCuoc=this._mucCuoc*this._listDongCuoc.length;0<a.CoinWinFromBonusBox&&(this._isNoHu=1);this._layerComboElement.setArrayWin(this._layerComboLines._lineWins);this._vongQuayMienPhi=a.NumRoundFree;0===this._vongQuayMienPhi?(this._tempTuQuay=this._tuQuay,this._textVQMP.setVisible(!1)):(this.hideInTuQuay(),this._layerComboElement._btnQuay.setTouchEnabled(!1));0<=this._timeEffectThangThua&&clearTimeout(this._timeEffectThangThua);
this._timeEffectThangThua=setTimeout(this.showAudioThangThua.bind(this),2700);Utilities.showLog("----Turning: "+JSON.stringify(a))},showAudioThangThua:function(){0<this._vongQuayMienPhi&&(this._textVQMP.setVisible(!0),this._textVQMP.setString("LƯỢT QUAY MIỄN PHÍ: "+this._vongQuayMienPhi));0===this._textVuaThang?mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.THUA,MGGameInfo.gameVolume):(1===this._isNoHu?(mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.THANG_HU,MGGameInfo.gameVolume),
this._effectNoHu.setAnimation(0,"Nohu",!0),this._effectNoHu.setVisible(!0),this._effectCoinWinNoHu.setString(Utilities.Coin(this._coinNoHu)),this._effectCoinWinNoHu.setVisible(!0),this._isNoHu=0):(mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.THANG_THUONG,MGGameInfo.gameVolume),this._effectWin.setVisible(!0),this._effectWin.playAnimationWin(this._textVuaThang)),this._layerComboLines.showLineWins(),this._layerComboElement.getEffectWin(),setTimeout(this.hideEffectWin.bind(this),2E3))},
hideMiniGameafter5s:function(){0===this._clickCaoThap&&this._layerMiniGame.setVisible(!1);this._clickCaoThap=0},_getPerformTurning:function(a){},_getBetGameMini:function(a){a=a.getUserData();var b={betMoney:BinaryConstants.DataTypeID.UInt64};if(0<(new BinaryParser).initObj(b,a.content).betMoney){if(!0!==this._layerMiniGame.isVisible()&&0<this._textVuaThang&&(this.showMiniGame(),this._layerMiniGame.enbleButtonMiniGame()),0<this._tuQuay||0<this._vongQuayMienPhi)this.netSend.sendCloseMiniGame(),this.hideMiniGame()}else this.netSend.sendCloseMiniGame(),
this.hideMiniGame();Utilities.showLog("------BetGameMini")},hideEffectWin:function(){this._effectWin.setVisible(!1);this._effectNoHu.setVisible(!1);this._effectCoinWinNoHu.setVisible(!1)},_getResultGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={RandomNumber:b.UInt16,coinWin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._textVuaThang=a.coinWin;this._layerTongDat.setTextVuaThang(this._textVuaThang);this._layerMiniGame.effectQuayMiniGame();this._layerMiniGame.setResultMiniGame(a.RandomNumber);
this._timeQuayMiniGame=setTimeout(this._effectQuayMiniGame.bind(this),1E3);this._timeEffectMiniGame=setTimeout(this._effectResultMiniGame.bind(this),1700);Utilities.showLog("------ResultGameMini")},_effectQuayMiniGame:function(){0===this._textVuaThang?(mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CAOTHAP_THUA,MGGameInfo.gameVolume),this._effectThuaMiniGame.setVisible(!0),this._effectThuaMiniGame.setAnimation(0,"thua",!0)):(mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.CAOTHAP_THANG,
MGGameInfo.gameVolume),this._effectThangMiniGame.setVisible(!0),this._effectThangMiniGame.setAnimation(0,"thang",!0));this._layerMiniGame.stopAllActions();this._layerMiniGame.setTextTien(this._textVuaThang);this._layerMiniGame.setTextResult()},_effectResultMiniGame:function(){this._effectThangMiniGame.setVisible(!1);this._effectThuaMiniGame.setVisible(!1);this._timeEffectEnbleButtonMiniGame=setTimeout(this._enbleButtonMiniGame.bind(this),1300);this._layerMiniGame._buttonClose.setTouchEnabled(!0);
this._layerMiniGame._buttonGomXeng.setTouchEnabled(!0)},_enbleButtonMiniGame:function(){0<this._textVuaThang?this._layerMiniGame.enbleButtonMiniGame():this._layerMiniGame.disEnbleButtonMiniGame()},_getCancelGameMini:function(a){},_getUserLeftDesk:function(a){},_getListUser:function(a){},_getFreeTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={NumFree:b.UInt8,ListBet:b.Array8,ListBet_Type:b.UInt8,Coin:b.UInt64,TotalCoinBonusBox:b.UInt64};a=(new BinaryParser).initObj(b,a.content);
this._textNoHu.setString(Utilities.Coin(a.TotalCoinBonusBox))},showMiniGame:function(){this._layerMiniGame.setVisible(!0);this._layerMiniGame.setTextTien(this._textVuaThang);this._layerMiniGame.disEnbleButtonMiniGame();this._layerComboElement._btnQuay.setTouchEnabled(!1);this._layerMiniGame._buttonClose.setTouchEnabled(!0);this._layerMiniGame._buttonGomXeng.setTouchEnabled(!0);this._layerComboElement.setOnMiniGame(1);this._isHideMiniGame=1},hideMiniGame:function(){this.netSend.sendOptionMiniGame(this.exitMiniGame);
this._layerMiniGame.setVisible(!1);this._layerComboElement._btnQuay.setTouchEnabled(!0);this._layerComboElement.setOnMiniGame(0);this._isHideMiniGame++},getOptionCaoThap:function(a){a=a.getUserData();this._clickCaoThap=1;0<this._textVuaThang&&(this._layerMiniGame.disEnbleButtonMiniGame(),this._layerMiniGame._buttonClose.setTouchEnabled(!1),this._layerMiniGame._buttonGomXeng.setTouchEnabled(!1),this.netSend.sendBetGameMini(a.target),mg.audio.playEffect(ResourceManager.MGResourcesGameXengLuxury.QUAY_CAO_THAP,
MGGameInfo.gameVolume))},getCloseMiniGame:function(a){a.getUserData();this._layerMiniGame._buttonCao.isEnabled()&&this.netSend.sendCloseMiniGame();this._layerMiniGame.setTextTien("0");this.hideMiniGame()},_getWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._popupCompoLichSu.addDataHuZdo(a);this._popupCompoLichSu.addDataVinhDanh(a)},
_getBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._popupCompoLichSu.addDataVinhDanh(a)},_getTopWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBonus:b.Array8,dataBonus_Type:b.Object8,dataBonus_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64}};
a=(new BinaryParser).initObj(b,a.content);this._popupCompoLichSu.setDataHuDzo(a)},_getTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);this._popupCompoLichSu.setDataVinhDanh(a)}});ResourceManager.MGResourcesGameFruitKong={MGBackGroundFruitKong:"res/game/fruitkong/MGBackGroundFruitKong.jpg",UIMGUIFruitKongLayerJSON:"res/game/fruitkong/UIFruitKongLayer.json",UIMGUIFruitKongButtonCompoJSON:"res/game/fruitkong/UIFruitKongButton.json",UIMGUIFruitKongButtonNganJSON:"res/game/fruitkong/UIButtonNgan.json",UIMGUIFruitKongButtonDaiJSON:"res/game/fruitkong/UIButtonDai.json",UIMGUIFruitKongButtonChon2JSON:"res/game/fruitkong/UIButton2Collumn.json",UIMGUIFruitKongButtonChon3JSON:"res/game/fruitkong/UIButton3Collumn.json",
UIMGUIFruitKongButtonPhienJSON:"res/game/fruitkong/UIButtonPhien.json",UIMGUIFruitKongPLIST:"res/game/fruitkong/AtlasFruitKong/atlasFruitKong.plist",UIMGUIFruitKongPNG:"res/game/fruitkong/AtlasFruitKong/atlasFruitKong.png",SFX_BACKGROUND:"res/game/fruitkong/Sounds/background.mp3",SFX_CLICK:"res/game/fruitkong/Sounds/click.mp3",SFX_LOST:"res/game/fruitkong/Sounds/lost.mp3",SFX_WIN:"res/game/fruitkong/Sounds/win.mp3"};
ResourceManager.MGResourcesGameFruitKongPreloadMobile={UIMGUIFruitKongLayerJSON:"res/game/fruitkong/UIFruitKongLayer.json",UIMGUIFruitKongButtonCompoJSON:"res/game/fruitkong/UIFruitKongButton.json",UIMGUIFruitKongButtonNganJSON:"res/game/fruitkong/UIButtonNgan.json",UIMGUIFruitKongButtonDaiJSON:"res/game/fruitkong/UIButtonDai.json",UIMGUIFruitKongButtonChon2JSON:"res/game/fruitkong/UIButton2Collumn.json",UIMGUIFruitKongButtonChon3JSON:"res/game/fruitkong/UIButton3Collumn.json",UIMGUIFruitKongButtonPhienJSON:"res/game/fruitkong/UIButtonPhien.json",
UIMGUIFruitKongPLIST:"res/game/fruitkong/AtlasFruitKong/atlasFruitKong.plist",UIMGUIFruitKongPNG:"res/game/fruitkong/AtlasFruitKong/atlasFruitKong.png",SFX_BACKGROUND:"res/game/fruitkong/Sounds/background.mp3",SFX_CLICK:"res/game/fruitkong/Sounds/click.mp3",SFX_LOST:"res/game/fruitkong/Sounds/lost.mp3",SFX_WIN:"res/game/fruitkong/Sounds/win.mp3"};var resourcesGameFruitKong=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameFruitKongPreloadMobile)ResourceManager.MGResourcesGameFruitKongPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameFruitKongPreloadMobile[i],resourcesGameFruitKong.push(ResourceManager.MGResourcesGameFruitKongPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameFruitKong)ResourceManager.MGResourcesGameFruitKong[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameFruitKong[i]}else for(i in ResourceManager.MGResourcesGameFruitKong)ResourceManager.MGResourcesGameFruitKong[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameFruitKong[i],resourcesGameFruitKong.push(ResourceManager.MGResourcesGameFruitKong[i]);var MGGameBoardFruitKong=cc.Class.extend({ctor:function(){}});MGGameBoardFruitKong.mySessionInfo={Level:0,MucCuoc:100,CurrentSelect:0,ListCuoc:[],MucHienTai:0};MGGameBoardFruitKong.MaxRow=9;MGGameBoardFruitKong.CoinWin=0;MGGameBoardFruitKong.MatchID=0;MGGameBoardFruitKong.IdBet=0;MGGameBoardFruitKong.TiLeCuoc=[];MGGameBoardFruitKong.UserCoin=0;
MGGameBoardFruitKong.getCurrentRate=function(){if(MGGameBoardFruitKong.mySessionInfo.Level==MGGameBoardFruitKong.Level.DE)return MGGameBoardFruitKong.TiLeCuoc[0];if(MGGameBoardFruitKong.mySessionInfo.Level==MGGameBoardFruitKong.Level.VUA)return MGGameBoardFruitKong.TiLeCuoc[1];if(MGGameBoardFruitKong.mySessionInfo.Level==MGGameBoardFruitKong.Level.KHO)return MGGameBoardFruitKong.TiLeCuoc[2]};
MGGameBoardFruitKong.getCurrentBet=function(a){if(0>a||a>=MGGameBoardFruitKong.mySessionInfo.ListCuoc.length)return-1;var b=MGGameBoardFruitKong.mySessionInfo.ListCuoc[a];if(MGGameBoardFruitKong.UserCoin>=MGGameBoardFruitKong.mySessionInfo.ListCuoc[MGGameBoardFruitKong.mySessionInfo.ListCuoc.length-1])return MGGameBoardFruitKong.mySessionInfo.MucHienTai=a,b;if(MGGameBoardFruitKong.UserCoin<MGGameBoardFruitKong.mySessionInfo.ListCuoc[0])return MGGameBoardFruitKong.mySessionInfo.MucHienTai=0,MGGameBoardFruitKong.mySessionInfo.ListCuoc[0];
for(var b=MGGameBoardFruitKong.mySessionInfo.ListCuoc[0],d=0;d<=a;d++)MGGameBoardFruitKong.UserCoin>=MGGameBoardFruitKong.mySessionInfo.ListCuoc[d]&&(MGGameBoardFruitKong.mySessionInfo.MucHienTai=d,b=MGGameBoardFruitKong.mySessionInfo.ListCuoc[d]);return b};MGGameBoardFruitKong.getIconFrame=function(a){if(a==MGGameBoardFruitKong.Level.DE)return"chuoi.png";if(a==MGGameBoardFruitKong.Level.VUA)return"nho.png";if(a==MGGameBoardFruitKong.Level.KHO)return"tao.png"};
MGGameBoardFruitKong.truncString=function(a,b){return a.length>b?a.substring(0,b)+"..":a};MGGameBoardFruitKong.Level={DE:0,VUA:1,KHO:2};MGGameBoardFruitKong.FONT_GAP_BROWSER=2;MGGameBoardFruitKong.alignLabelBrowser=function(a,b){cc.sys.browserType==cc.sys.BROWSER_TYPE_FIREFOX&&a.setPositionY(a.getPosition().y-b)};ConstantsVariable.NETWORK_FRUIT_KONG={StartGame:2400,StartBetting:2401,NextBetting:2402,ReceiveCoin:2403,GameData:2404,ToolResult:2405,ListUser:2406,TopBigWin:2407,BigWin:2408,ResultBetting:2409,ResultAllSession:2410,MD5:2411};ConstantsVariable.STATE_FRUIT_KONG={NOT_START:0,WAIT:1,START_BETTING:2,NEXT_BETTING:3,FINISH:4};var MGNetSendFruitKong=cc.Class.extend({gameModuleID:null,ctor:function(){},sendStartBetting:function(a,b){var d={};d.LevelDifficulty=a;d.Coin=b;var e={Coin:BinaryConstants.DataTypeID.UInt64,LevelDifficulty:BinaryConstants.DataTypeID.UInt8};Utilities.showLog("sendStartBetting "+JSON.stringify(d));d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_FRUIT_KONG.StartBetting,e,d);MGNetCore.MGSocket.sendMsg(d)},sendReceiveCoin:function(){Utilities.showLog("sendReceiveCoin ");var a=
Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_FRUIT_KONG.ReceiveCoin,null,null);MGNetCore.MGSocket.sendMsg(a)},sendNextBetting:function(a){var b={};b.IdBet=a;a={IdBet:BinaryConstants.DataTypeID.UInt8};Utilities.showLog("sendNextBetting "+JSON.stringify(b));b=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_FRUIT_KONG.NextBetting,a,b);MGNetCore.MGSocket.sendMsg(b)},toolResultFruitKong:function(a){var b={};b.ListResultAllSession=a;a={ListResultAllSession:BinaryConstants.DataTypeID.Array8,
ListResultAllSession_Type:BinaryConstants.DataTypeID.Array8,ListResultAllSession_Type_Type:BinaryConstants.DataTypeID.UInt8};Utilities.showLog("toolResult "+JSON.stringify(b));b=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_FRUIT_KONG.ToolResult,a,b);MGNetCore.MGSocket.sendMsg(b)}});var MGFKButton=MGBaseNode.extend({_idButton:0,_rate:1,_listener:null,_labelNumber:null,_labelResultWin:null,_labelResultLose:null,_iconButton:null,_button:null,_opened:!1,_originX:0,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._initEventsGame()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._button=this.getChildByName("MGButton");this._labelNumber=this._button.getChildByName("MGButtonTextNumber");this._labelResultWin=this._button.getChildByName("MGButtonTextResultWin");
this._labelResultLose=this._button.getChildByName("MGButtonTextResultLose");this._iconButton=this._button.getChildByName("MGButtonIcon");this._originX=this._iconButton.getPosition().x;cc.sys.browserType==cc.sys.BROWSER_TYPE_FIREFOX&&(MGGameBoardFruitKong.alignLabelBrowser(this._labelNumber,MGGameBoardFruitKong.FONT_GAP_BROWSER),MGGameBoardFruitKong.alignLabelBrowser(this._labelResultWin,MGGameBoardFruitKong.FONT_GAP_BROWSER),MGGameBoardFruitKong.alignLabelBrowser(this._labelResultLose,MGGameBoardFruitKong.FONT_GAP_BROWSER))},
setButtonRate:function(a){this._rate=a},resetButton:function(){var a=this.calculateNumber();this._labelNumber.setString(Utilities.Coin(a));this._labelNumber.setVisible(!0);this._iconButton.setVisible(!1);this._labelResultWin.setVisible(!1);this._labelResultLose.setVisible(!1);this._button.setBright(!1);this._opened&&(this._opened=!1,this._iconButton.runAction(cc.moveTo(.01,cc.p(this._originX,this._iconButton.getPosition().y))))},setOpenButton:function(a,b){this._opened||(this._opened=!0,this._labelNumber.setVisible(!1),
this._iconButton.setVisible(!0),this.getResultLabel(a).setVisible(!0),a?(this.getResultLabel(a).setString("NGON!"),this._iconButton.setSpriteFrame(MGGameBoardFruitKong.getIconFrame(MGGameBoardFruitKong.mySessionInfo.Level))):(this.getResultLabel(a).setString("TRY AGAIN!"),this._iconButton.setSpriteFrame("shit.png")),b?(this._iconButton.setScaleX(0),this.getResultLabel(a).setScaleX(0),this._iconButton.runAction(cc.sequence(cc.callFunc(function(){this.getResultLabel(a).runAction(cc.scaleTo(.2,1,1))}.bind(this)),
cc.scaleTo(.2,1,1),cc.delayTime(.5),cc.callFunc(function(){this.getResultLabel(a).setVisible(!1)}.bind(this)),cc.moveTo(.2,cc.p(.5*this._button.getContentSize().width+.5*this._iconButton.getContentSize().width,this._iconButton.getPosition().y))))):(this.getResultLabel(a).setVisible(!1),this._iconButton.setPositionX(.5*this._button.getContentSize().width+.5*this._iconButton.getContentSize().width)))},getResultLabel:function(a){return a?this._labelResultWin:this._labelResultLose},calculateNumber:function(){return parseInt(this._rate*
MGGameBoardFruitKong.mySessionInfo.MucCuoc,10)}});var MGFruitKongButtons=MGBaseNode.extend({listButton:null,mainGame:null,labelMucuoc:null,labelButtonChoi:null,labelButtonTru:null,labelButtonCong:null,buttonChoi:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.listButton=[];this.initUI();this._initEventBtnFromNode();this.onClickChooseLevel()},initUI:function(){this.labelMucuoc=this.getChildByName("MGLabelMucCuoc");this.labelMucuoc.setString(Utilities.Coin(MGGameBoardFruitKong.mySessionInfo.MucCuoc));
this.buttonChoi=this.getChildByName("MGButtonChoi");this.labelButtonChoi=this.buttonChoi.getChildByName("MGButtonChoiText");this.labelButtonTru=this.getChildByName("MGButtonTru").getChildByName("MGButtonTruText");this.labelButtonCong=this.getChildByName("MGButtonCong").getChildByName("MGButtonCongText");this.labelButtonChoi.setString("CHƠI");cc.sys.browserType==cc.sys.BROWSER_TYPE_FIREFOX&&(MGGameBoardFruitKong.alignLabelBrowser(this.labelButtonChoi,MGGameBoardFruitKong.FONT_GAP_BROWSER+2),MGGameBoardFruitKong.alignLabelBrowser(this.labelMucuoc,
MGGameBoardFruitKong.FONT_GAP_BROWSER),MGGameBoardFruitKong.alignLabelBrowser(this.labelButtonTru,MGGameBoardFruitKong.FONT_GAP_BROWSER+2),MGGameBoardFruitKong.alignLabelBrowser(this.labelButtonCong,MGGameBoardFruitKong.FONT_GAP_BROWSER+2))},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(a[d]))},hideAll:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].setTouchEnabled(!1)},
showAll:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].setTouchEnabled(!0)},hideButton:function(a){this.getChildByName(a).setBright(!1);this.getChildByName(a).setTouchEnabled(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);this.getChildByName(a).setTouchEnabled(!0)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGFruitKongButtons.BUTTON_NAME.DE:MGGameBoardFruitKong.mySessionInfo.Level=MGGameBoardFruitKong.Level.DE;this.mainGame.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level);
this.onClickChooseLevel();break;case MGFruitKongButtons.BUTTON_NAME.VUA:MGGameBoardFruitKong.mySessionInfo.Level=MGGameBoardFruitKong.Level.VUA;this.mainGame.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level);this.onClickChooseLevel();break;case MGFruitKongButtons.BUTTON_NAME.KHO:MGGameBoardFruitKong.mySessionInfo.Level=MGGameBoardFruitKong.Level.KHO;this.mainGame.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level);this.onClickChooseLevel();
break;case MGFruitKongButtons.BUTTON_NAME.CONG:var d=MGGameBoardFruitKong.getCurrentBet(MGGameBoardFruitKong.mySessionInfo.MucHienTai+1);0<d&&(MGGameBoardFruitKong.mySessionInfo.MucCuoc=d,this.mainGame.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level),this.capnhatMucCuoc());break;case MGFruitKongButtons.BUTTON_NAME.TRU:d=MGGameBoardFruitKong.getCurrentBet(MGGameBoardFruitKong.mySessionInfo.MucHienTai-1);0<d&&(MGGameBoardFruitKong.mySessionInfo.MucCuoc=d,this.mainGame.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level),
this.capnhatMucCuoc());break;case MGFruitKongButtons.BUTTON_NAME.CHOI:this.mainGame.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level);this.mainGame.netSend.sendStartBetting(MGGameBoardFruitKong.mySessionInfo.Level,MGGameBoardFruitKong.mySessionInfo.MucCuoc);break;case MGFruitKongButtons.BUTTON_NAME.NHAN_TIEN:this.onButtonGetMoney()}this.mainGame.setGameInfoMatchID(MGGameBoardFruitKong.MatchID);mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_CLICK,
MGGameInfo.gameVolume)},onButtonGetMoney:function(){this.mainGame.netSend.sendReceiveCoin();this.mainGame.compoSessionInfo.setMySessionInfo();this.mainGame.compoGameBoardButton.getBoard(MGGameBoardFruitKong.mySessionInfo.Level).disableButtonFromRow(MGGameBoardFruitKong.mySessionInfo.CurrentSelect);this.hideAll();cc.eventManager.dispatchCustomEvent(MGFruitKongEffect.EVENT.FX_NHAN_TIEN,null);mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_WIN,MGGameInfo.gameVolume)},onClickChooseLevel:function(){MGGameBoardFruitKong.mySessionInfo.Level==
MGGameBoardFruitKong.Level.DE?(this.hideButton(MGFruitKongButtons.BUTTON_NAME.DE),this.showButton(MGFruitKongButtons.BUTTON_NAME.VUA),this.showButton(MGFruitKongButtons.BUTTON_NAME.KHO)):MGGameBoardFruitKong.mySessionInfo.Level==MGGameBoardFruitKong.Level.VUA?(this.showButton(MGFruitKongButtons.BUTTON_NAME.DE),this.hideButton(MGFruitKongButtons.BUTTON_NAME.VUA),this.showButton(MGFruitKongButtons.BUTTON_NAME.KHO)):MGGameBoardFruitKong.mySessionInfo.Level==MGGameBoardFruitKong.Level.KHO&&(this.showButton(MGFruitKongButtons.BUTTON_NAME.DE),
this.showButton(MGFruitKongButtons.BUTTON_NAME.VUA),this.hideButton(MGFruitKongButtons.BUTTON_NAME.KHO))},capnhatMucCuoc:function(){this.labelMucuoc.setString(Utilities.Coin(MGGameBoardFruitKong.mySessionInfo.MucCuoc))},capnhatNutChoi:function(a){0<a?(this.labelButtonChoi.setString("NHẬN "+Utilities.Coin(a)),this.buttonChoi.setName(MGFruitKongButtons.BUTTON_NAME.NHAN_TIEN),this.buttonChoi.setTouchEnabled(!0)):(this.labelButtonChoi.setString("CHƠI"),this.buttonChoi.setName(MGFruitKongButtons.BUTTON_NAME.CHOI),
this.buttonChoi.setTouchEnabled(!1))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGFruitKongButtons.BUTTON_NAME={DE:"MGButtonDe",VUA:"MGButtonVua",KHO:"MGButtonKho",CONG:"MGButtonCong",TRU:"MGButtonTru",CHOI:"MGButtonChoi",NHAN_TIEN:"MGButtonNhanTien"};var MGFruitKongEffect=MGBaseNode.extend({fxNhanThuong:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.fxNhanThuong=this.getChildByName("MGEffectReceiveCoin").getChildByName("MGLabelNhanThuong");this.fxNhanThuong.setVisible(!1);this.initEvents()},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGFruitKongEffect.EVENT.FX_NHAN_TIEN,this.playEffectNhanThuong.bind(this)))},playEffectNhanThuong:function(){this.fxNhanThuong.setString("+"+
Utilities.Coin(MGGameBoardFruitKong.CoinWin));this.fxNhanThuong.setVisible(!0);this.fxNhanThuong.runAction(cc.sequence(cc.spawn(cc.fadeIn(.5),cc.moveBy(.5,cc.p(0,MGFruitKongEffect.DISTANCE_NHAN_TIEN))),cc.delayTime(1),cc.fadeOut(.5),cc.callFunc(function(){this.fxNhanThuong.setVisible(!1)}.bind(this)),cc.moveBy(.01,cc.p(0,-MGFruitKongEffect.DISTANCE_NHAN_TIEN))))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGFruitKongEffect.DISTANCE_NHAN_TIEN=200;MGFruitKongEffect.EFFECT={FX_NHAN_TIEN:"fxNhanTien"};
MGFruitKongEffect.EVENT={FX_NHAN_TIEN:"fxNhanTien"};var MGFruitKongBoard=MGBaseNode.extend({listButton:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.listButton=[];this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=this.getChildren().length-1,b=0;b<a;b++){var d=new MGFKButton;d.cloneFromNode(this.getChildByName("MGButtonChon_"+b));d.initObj(this);d.resetButton();d._button.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));
d._idButton=b;this.addChild(d);this.listButton.push(d)}},onClickBtnFromCocostudio:function(a,b){var d=this.getNumberCollumn();MGGameBoardFruitKong.IdBet=a.getParent()._idButton%d;this.mainGame.netSend.sendNextBetting(a.getParent()._idButton%d);this.disableButtonFromRow(MGGameBoardFruitKong.mySessionInfo.CurrentSelect);mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_CLICK,MGGameInfo.gameVolume)},setButtonValue:function(a){if(!(MGGameBoardFruitKong.mySessionInfo.CurrentSelect>=MGGameBoardFruitKong.MaxRow)){var b=
this.getNumberCollumn()*MGGameBoardFruitKong.mySessionInfo.CurrentSelect+MGGameBoardFruitKong.IdBet;this.setResultButtonValue(a,b,!0)}},showAllResultSession:function(a){if(0!=a.ListResultAllSession.length)for(var b=0;b<MGGameBoardFruitKong.MaxRow;b++)for(var d=a.ListResultAllSession[b],e=0;e<d.length;e++){var f=this.getNumberCollumn()*b+e;this.setResultButtonValue(d[e],f,!1)}},setResultButtonValue:function(a,b,d){this.getButtonID(b).setOpenButton(a,d)},getButtonID:function(a){return this.listButton[a]},
disableAllButton:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a]._button.setTouchEnabled(!1),this.listButton[a]._button.setBright(!1)},resetAllButton:function(){if(0!=MGGameBoardFruitKong.TiLeCuoc.length)for(var a=0;a<this.listButton.length;a++){var b=this.getNumberCollumn(),b=parseInt(a/b,10);this.listButton[a].setButtonRate(MGGameBoardFruitKong.getCurrentRate()[b]);this.listButton[a].resetButton()}},disableButtonFromRow:function(a){if(!(a>=MGGameBoardFruitKong.MaxRow))for(var b=
this.getNumberCollumn(),d=a*=b;d<a+b;d++)this.listButton[d]._button.setTouchEnabled(!1)},enableButtonFromRow:function(a){for(var b=this.getNumberCollumn(),d=b*a,e=0;e<d;e++)this.listButton[e]._button.setBright(!0);if(!(a>=MGGameBoardFruitKong.MaxRow))for(e=d;e<d+b;e++)this.listButton[e]._button.setTouchEnabled(!0),this.listButton[e]._button.setBright(!0)},getNumberCollumn:function(){return MGGameBoardFruitKong.mySessionInfo.Level===MGGameBoardFruitKong.Level.VUA?2:3}});var MGFruitKongBoardButton=MGBaseNode.extend({boarButton2:null,boarButton3:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(a);this.mainGame=a;this._initUI();this.initEvents()},_initUI:function(){this.boarButton2=new MGFruitKongBoard;this.boarButton2.cloneFromNode(this.getChildByName("MGButtonChon2"));this.boarButton2.initObj(this.mainGame);this.addChild(this.boarButton2);this.boarButton3=new MGFruitKongBoard;this.boarButton3.cloneFromNode(this.getChildByName("MGButtonChon3"));
this.boarButton3.initObj(this.mainGame);this.addChild(this.boarButton3)},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.NextBetting.toString(),this.ngNextBetting.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.ResultBetting.toString(),this.ngResultBetting.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.ResultAllSession.toString(),
this.ngResultAllSession.bind(this)))},loadGameBoardButton:function(a){this.showBoard(a);this.resetBoard(a)},showBoard:function(a){1==a?(this.boarButton2.setVisible(!0),this.boarButton3.setVisible(!1)):(this.boarButton2.setVisible(!1),this.boarButton3.setVisible(!0))},resetBoard:function(a){this.getBoard(a).resetAllButton();this.getBoard(a).disableAllButton()},getBoard:function(a){return 1==a?this.boarButton2:this.boarButton3},ngNextBetting:function(a){a=a.getUserData();var b={BetMoney:BinaryConstants.DataTypeID.UInt64};
this.mainGame.compoButtons.hideAll();this.mainGame.compoButtons.capnhatNutChoi(MGGameBoardFruitKong.CoinWin);(new BinaryParser).initObj(b,a.content);a=this.getBoard(MGGameBoardFruitKong.mySessionInfo.Level);a.disableAllButton();a.enableButtonFromRow(MGGameBoardFruitKong.mySessionInfo.CurrentSelect)},ngResultBetting:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListID:b.Array8,ListID_Type:b.UInt8,CoinWin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultBetting "+
JSON.stringify(a));this.getBoard(MGGameBoardFruitKong.mySessionInfo.Level).setButtonValue(0<a.CoinWin?!0:!1);0<a.CoinWin?mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_WIN,MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_LOST,MGGameInfo.gameVolume);MGGameBoardFruitKong.CoinWin=a.CoinWin;this.mainGame.compoButtons.capnhatNutChoi(MGGameBoardFruitKong.CoinWin);0>=a.CoinWin&&this.mainGame.compoSessionInfo.setMySessionInfo();MGGameBoardFruitKong.mySessionInfo.CurrentSelect++;
if(MGGameBoardFruitKong.mySessionInfo.CurrentSelect>=MGGameBoardFruitKong.MaxRow&&0<a.CoinWin)this.mainGame.compoButtons.onButtonGetMoney()},ngResultAllSession:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListResultAllSession:b.Array8,ListResultAllSession_Type:b.Array8,ListResultAllSession_Type_Type:b.Double,ResultBeforeMd5:b.StringDynamic};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultAllSession "+JSON.stringify(a));this.getBoard(MGGameBoardFruitKong.mySessionInfo.Level).showAllResultSession(a);
this.mainGame.updateKeyInfo(a.ResultBeforeMd5)},boardGameData:function(a){for(var b=0;b<a.RateWin.length;b++)MGGameBoardFruitKong.TiLeCuoc.push(a.RateWin[b])},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGFruitKongSessionInfo=MGBaseNode.extend({listButton:null,mainGame:null,listViewMySession:null,listViewThangLon:null,currentTab:null,title:null,_dataBigWin:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._dataBigWin=[];this._currentLoad=0;this._isShowed=!1;this.listButton=[];this.initUI();this._initEventBtnFromNode();this.initEvents();this.currentTab=MGFruitKongSessionInfo.BUTTON_NAME.MY_INFO;
this.setChooseButton(this.currentTab);this.scheduleUpdate()},initUI:function(){this.listViewMySession=this.getChildByName("MGButtonListView1");this.listViewThangLon=this.getChildByName("MGButtonListView2");this.getChildByName("MGCell").setVisible(!1);this.title=this.getChildByName("MGPhienTitle")},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(a[d]))},
initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.BigWin.toString(),this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.TopBigWin.toString(),this.ngTopBigWin.bind(this)))},update:function(a){this._isShowed&&this.listViewThangLon.getBottommostItemInCurrentView()&&this.listViewThangLon.getBottommostItemInCurrentView().getTag()===this._currentLoad&&
this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+15<this._dataBigWin.length?15:this._dataBigWin.length-this._currentLoad;if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this.listViewThangLon.pushBackCustomItem(this.createCellWithInfo(this._dataBigWin[b],b+1));this.listViewThangLon.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.reArrangeSTT()}},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_CLICK,
MGGameInfo.gameVolume);this.setChooseButton(a.getName())},setChooseButton:function(a){for(var b=0;b<this.listButton.length;b++)this.listButton[b].getName()==a?(this.listButton[b].setBright(!1),this.listButton[b].setTouchEnabled(!1),this.listButton[b].setLocalZOrder(1)):(this.listButton[b].setBright(!0),this.listButton[b].setTouchEnabled(!0),this.listButton[b].setLocalZOrder(0));this.loadSessionTab(a)},loadSessionTab:function(a){a==MGFruitKongSessionInfo.BUTTON_NAME.MY_INFO?(this.listViewMySession.setVisible(!0),
this.listViewThangLon.setVisible(!1),this.title.setSpriteFrame("list_phien.png")):a==MGFruitKongSessionInfo.BUTTON_NAME.USER_INFO&&(this.listViewMySession.setVisible(!1),this.listViewThangLon.setVisible(!0),this.showBigWinLayer(),this.title.setSpriteFrame("list_thang_lon.png"));this.currentTab=a},showBigWinLayer:function(){this._isShowed||(this._isShowed=!0,this.loadMoreItem(),this.listViewThangLon.jumpToTop())},ngTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,
dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,SessionContinuousCount:b.UInt8,EarnCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.dataBigWin.length;b++)this._dataBigWin.push(a.dataBigWin[b]);this._dataBigWin.reverse()},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,SessionContinuousCount:b.UInt8,
EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._isShowed?(this.listViewThangLon.getItems().length>=MGFruitKongSessionInfo.MAX_LINE&&this.listViewThangLon.removeItem(MGFruitKongSessionInfo.MAX_LINE-1),this.listViewThangLon.insertCustomItem(this.createCellWithInfo(a,1),0),this.listViewThangLon.jumpToTop(),this.reArrangeSTT()):this._dataBigWin.splice(0,0,a)},setMySessionInfo:function(){var a={};a.CoinBet=MGGameBoardFruitKong.mySessionInfo.MucCuoc;a.NickName=MGGameBoardFruitKong.MatchID;
a.Type=MGGameBoardFruitKong.mySessionInfo.Level;a.SessionContinuousCount=MGGameBoardFruitKong.mySessionInfo.CurrentSelect;a.EarnCoin=MGGameBoardFruitKong.CoinWin;this.listViewMySession.getItems().length>=MGFruitKongSessionInfo.MAX_LINE&&this.listViewMySession.removeItem(MGFruitKongSessionInfo.MAX_LINE-1);this.listViewMySession.insertCustomItem(this.createCellWithInfo(a),0);this.listViewMySession.jumpToTop()},createCellWithInfo:function(a){var b=this.getChildByName("MGCell").clone();b.setVisible(!0);
this.setCellInfo(b,a);return b},setCellInfo:function(a,b){a.getChildByName("MGText1").setString(MGGameBoardFruitKong.truncString(b.NickName,8));a.getChildByName("MGText2").setString(Utilities.Coin(b.CoinBet));a.getChildByName("MGText3").setString(Utilities.Coin(b.EarnCoin));a.getChildByName("MGText4").setString(b.SessionContinuousCount);a.getChildByName("MGIcon").loadTexture(MGGameBoardFruitKong.getIconFrame(b.Type),ccui.Widget.PLIST_TEXTURE)},reArrangeSTT:function(){for(var a=0;a<this.listViewThangLon.getItems().length;a++)this.listViewThangLon.getItem(a).setTag(a+
1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.unscheduleUpdate()}});MGFruitKongSessionInfo.BUTTON_NAME={MY_INFO:"MGButtonMyInfo",USER_INFO:"MGButtonUserInfo"};MGFruitKongSessionInfo.MAX_LINE=100;var MGFruitKongThongBao=MGBaseNode.extend({listButton:null,listViewThongBao:null,listViewHuongDan:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listButton=[];this.initUI();this._initEventBtnFromNode();this.initEvents();this.setChooseButton(MGFruitKongThongBao.BUTTON_NAME.HUONGDAN)},initUI:function(){this.listViewThongBao=this.getChildByName("MGListViewThongBao");this.listViewHuongDan=this.getChildByName("MGListViewHuongDan")},
initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.ngThongBao.bind(this)))},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(a[d]))},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameFruitKong.SFX_CLICK,MGGameInfo.gameVolume);
this.setChooseButton(a.getName())},setChooseButton:function(a){var b=this.getChildByName(MGFruitKongThongBao.BUTTON_NAME.THONGBAO);b.setTitleText("");b.setTitleText("THÔNG BÁO");b=this.getChildByName(MGFruitKongThongBao.BUTTON_NAME.HUONGDAN);b.setTitleText("");b.setTitleText("HƯỚNG DẪN");for(b=0;b<this.listButton.length;b++)this.listButton[b].getName()==a?(this.listButton[b].setTitleColor(cc.color("#ffffff")),this.listButton[b].setTouchEnabled(!1)):(this.listButton[b].setTitleColor(cc.color("#8d4929")),
this.listButton[b].setTouchEnabled(!0));a==MGFruitKongThongBao.BUTTON_NAME.THONGBAO?(this.listViewThongBao.setVisible(!0),this.listViewHuongDan.setVisible(!1)):a==MGFruitKongThongBao.BUTTON_NAME.HUONGDAN&&(this.listViewThongBao.setVisible(!1),this.listViewHuongDan.setVisible(!0))},ngThongBao:function(a){a=a.getUserData();this.listViewThongBao.getItems().length>=MGFruitKongThongBao.MAX_LINE&&this.listViewThongBao.removeItem(MGFruitKongThongBao.MAX_LINE-1);var b=new MGBaseRichText("Arial",13,cc.color.WHITE,
!0,.9*this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listViewThongBao.insertCustomItem(b,0);this.listViewThongBao.jumpToTop()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGFruitKongThongBao.BUTTON_NAME={HUONGDAN:"MGButtonHuongDan",THONGBAO:"MGButtonThongBao"};MGFruitKongThongBao.MAX_LINE=100;var MGFruitKong=MGBaseGame.extend({netSend:null,compoButtons:null,compoGameBoardButton:null,compoSessionInfo:null,compoEffect:null,compoThongBao:null,labelMyCoin:null,labelMatchID:null,lbMd5:null,lbPreMd5:null,lbKey:null,lbPreKey:null,listCompo:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameFruitKong},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.listCompo=[];this._initUI();this.netSend=new MGNetSendFruitKong;this._initCompoButtons();this._initCompoGameBoardButtons();
this._initSessionInfoCompo();this._initEffect();this._initThongBao();mg.audio.playMusic(ResourceManager.MGResourcesGameFruitKong.SFX_BACKGROUND,MGGameInfo.gameVolume)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameFruitKong.UIMGUIFruitKongLayerJSON,PreLoaderConfig.PathToResourceDefault);this.labelMyCoin=this._mainLayer.getChildByName("MGTextGold");this.labelMyCoin.setString("");this.labelMatchID=this._mainLayer.getChildByName("MGTextTableNumber");this.labelMatchID.setString("");
var a=this._mainLayer.getChildByName("MGMd5Label");this.lbMd5=a.getChildByName("MGMd5TextLabel");this.lbMd5.setTouchEnabled(!1);this.lbMd5.setString("");this.lbPreMd5=a.getChildByName("MGMd5PreTextLabel");this.lbPreMd5.setTouchEnabled(!1);this.lbPreMd5.setString("");this.lbKey=new MGBaseEditBox(a.getChildByName("MGKeyTextLabel"));this.lbKey.setString("");this.lbKey.maxLength=1E3;a.addChild(this.lbKey);this.lbPreKey=new MGBaseEditBox(a.getChildByName("MGKeyPreTextLabel"));this.lbPreKey.setString("");
this.lbPreKey.maxLength=1E3;a.addChild(this.lbPreKey);cc.sys.browserType==cc.sys.BROWSER_TYPE_FIREFOX&&(MGGameBoardFruitKong.alignLabelBrowser(this.labelMyCoin,MGGameBoardFruitKong.FONT_GAP_BROWSER+2),MGGameBoardFruitKong.alignLabelBrowser(this.labelMatchID,MGGameBoardFruitKong.FONT_GAP_BROWSER+2))},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.StartGame.toString(),this.ngStartGame.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUserCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_FRUIT_KONG.MD5.toString(),this.ngMD5.bind(this)))},_initCompoButtons:function(){this.compoButtons=new MGFruitKongButtons;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGButtonCompo"));
this.compoButtons.initObj(this);this.addChild(this.compoButtons)},_initCompoGameBoardButtons:function(){this.compoGameBoardButton=new MGFruitKongBoardButton;this.compoGameBoardButton.cloneFromNode(this._mainLayer.getChildByName("MGGameBoard"));this.compoGameBoardButton.initObj(this);this.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level);this.addChild(this.compoGameBoardButton);this.listCompo.push(this.compoGameBoardButton)},_initSessionInfoCompo:function(){this.compoSessionInfo=
new MGFruitKongSessionInfo;this.compoSessionInfo.cloneFromNode(this._mainLayer.getChildByName("MGSessionInfo"));this.compoSessionInfo.initObj(this);this.addChild(this.compoSessionInfo);this.listCompo.push(this.compoSessionInfo)},_initEffect:function(){this.compoEffect=new MGFruitKongEffect;this.compoEffect.cloneFromNode(this._mainLayer.getChildByName("MGEffectFruitKong"));this.compoEffect.initObj();this.addChild(this.compoEffect);this.listCompo.push(this.compoEffect)},_initThongBao:function(){this.compoThongBao=
new MGFruitKongThongBao;this.compoThongBao.cloneFromNode(this._mainLayer.getChildByName("MGThongBaoFruitKong"));this.compoThongBao.initObj();this.addChild(this.compoThongBao);this.listCompo.push(this.compoThongBao)},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngStartGame "+JSON.stringify(a));MGGameBoardFruitKong.MatchID=a.MatchID;MGGameBoardFruitKong.CoinWin=0;MGGameBoardFruitKong.mySessionInfo.CurrentSelect=
0;this.compoButtons.capnhatNutChoi(0);this.compoButtons.showAll()},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,RateWin:b.Array8,RateWin_Type:b.Array8,RateWin_Type_Type:b.Double,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.Double};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData "+JSON.stringify(a));this.setGameInfo(a.CoinUser,a.MatchID);MGGameBoardFruitKong.MatchID=
a.MatchID;MGGameBoardFruitKong.mySessionInfo.Level=MGGameBoardFruitKong.Level.DE;MGGameBoardFruitKong.mySessionInfo.CurrentSelect=0;for(b=MGGameBoardFruitKong.mySessionInfo.MucHienTai=0;b<a.ListCoinCanBet.length;b++)MGGameBoardFruitKong.mySessionInfo.ListCuoc.push(a.ListCoinCanBet[b]);MGGameBoardFruitKong.mySessionInfo.MucCuoc=MGGameBoardFruitKong.getCurrentBet(MGGameBoardFruitKong.mySessionInfo.MucHienTai);this.compoButtons.capnhatMucCuoc();this.compoGameBoardButton.boardGameData(a);this.compoGameBoardButton.loadGameBoardButton(MGGameBoardFruitKong.mySessionInfo.Level);
this.changeBackGround()},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.setGameInfoCoin(a.Gold)},ngMD5:function(a){a=a.getUserData();var b={MD5Result:BinaryConstants.DataTypeID.StringDynamic};a=(new BinaryParser).initObj(b,a.content);this.updateMd5Info(a.MD5Result)},updateMd5Info:function(a){0<this.lbMd5.getString().length&&(this.lbPreMd5.setString(this.lbMd5.getString()),this.lbPreKey.setString(this.lbKey.getString()));
this.lbMd5.setString(a);this.lbKey.setString("")},updateKeyInfo:function(a){0<this.lbKey.getString().length&&this.lbPreKey.setString(this.lbKey.getString());this.lbKey.setString(a)},changeBackGround:function(){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameFruitKong.MGBackGroundFruitKong;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)},setGameInfo:function(a,b){this.setGameInfoCoin(a);this.setGameInfoMatchID(b)},setGameInfoCoin:function(a){MGGameBoardFruitKong.UserCoin=
a;this.labelMyCoin.setString(Utilities.Coin(MGGameBoardFruitKong.UserCoin))},setGameInfoMatchID:function(a){this.labelMatchID.setString("#"+a)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardFruitKong.mySessionInfo.Level=0;mg.audio.stopAllEffects();mg.audio.stopMusic(!0);for(var a=0;a<this.listCompo.length;a++)this.listCompo[a]&&(this.listCompo[a].setDispose(),this.listCompo[a].removeFromParent(!0),this.listCompo[a]=null)},onExit:function(){MGBaseGame.prototype.onExit.call(this)}});ConstantsVariable.NETWORK_SHEEP={StartGame:2500,StartBetting:2501,NextBetting:2502,ReceiveCoin:2503,GameData:2504,ToolResult:2505,ListUser:2506,TopBigWin:2507,BigWin:2508,ResultBetting:2509,RecHaftCoin:2510,EndMatch:2511,Tour:2512};var MGNetSendSheep=cc.Class.extend({maingame:null,gameModuleID:null,ctor:function(){},setDelegate:function(a){this.maingame=a},startGame:function(a){var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SHEEP.StartBetting,{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},bet:function(a){if(!this.maingame.lockBet){this.maingame.lockBet=!0;var b={};b.IdKindBet=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SHEEP.NextBetting,
{IdKindBet:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}},gomHui:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SHEEP.ReceiveCoin,null,null);MGNetCore.MGSocket.sendMsg(a)},getHaft:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_SHEEP.RecHaftCoin,null,null);MGNetCore.MGSocket.sendMsg(a)},sendToolSheep:function(a,b){var d={};d.IdBet=a;d.Color=b;d=Message.buildGameMsg(ConstantsVariable.NETWORK_SHEEP.ToolResult,
{IdBet:BinaryConstants.DataTypeID.UInt8,Color:BinaryConstants.DataTypeID.UInt8},d);MGNetCore.MGSocket.sendMsg(d)}});ResourceManager.MGResourcesGameSheep={AtlasSheep:"res/game/sheep/Atlas/AtlastSheep.png",PlistSheep:"res/game/sheep/Atlas/AtlastSheep.plist",UIMGSheepLayer:"res/game/sheep/UISheepLayer.json",UIMGHandTutorial:"res/game/sheep/UIHandTutorial.json",SheepBackGround:"res/game/sheep/MGBackGroundSheep.jpg",FontDo:"res/game/sheep/SoDo.fnt",FontDoPNG:"res/game/sheep/SoDo.png",FontVang:"res/game/sheep/SoVang.fnt",FontVangPNG:"res/game/sheep/SoVang.png",FontXanh:"res/game/sheep/SoXanh.fnt",FontXanhPNG:"res/game/sheep/SoXanh.png",
SheepPNG:"res/game/sheep/Sheep.png",SheepJSON:"res/game/sheep/Sheep.json",SheepATLAS:"res/game/sheep/Sheep.atlas",SheepUserDataCell:"res/game/sheep/UIDataCell.json",SheepLayoutSessionBet:"res/game/sheep/UIPhienCuaToi.json",SoundClick:"res/game/sheep/sounds/click.mp3",SoundBackGround:"res/game/sheep/sounds/Background.mp3",SoundWin:"res/game/sheep/sounds/Win.mp3",SoundLose:"res/game/sheep/sounds/Lose.mp3"};
ResourceManager.MGResourcesGameSheepPreloadMobile={AtlasSheep:"res/game/sheep/Atlas/AtlastSheep.png",PlistSheep:"res/game/sheep/Atlas/AtlastSheep.plist",UIMGSheepLayer:"res/game/sheep/UISheepLayer.json",UIMGHandTutorial:"res/game/sheep/UIHandTutorial.json",FontDo:"res/game/sheep/SoDo.fnt",FontDoPNG:"res/game/sheep/SoDo.png",FontVang:"res/game/sheep/SoVang.fnt",FontVangPNG:"res/game/sheep/SoVang.png",FontXanh:"res/game/sheep/SoXanh.fnt",FontXanhPNG:"res/game/sheep/SoXanh.png",SheepPNG:"res/game/sheep/Sheep.png",
SheepJSON:"res/game/sheep/Sheep.json",SheepATLAS:"res/game/sheep/Sheep.atlas",SheepUserDataCell:"res/game/sheep/UIDataCell.json",SheepLayoutSessionBet:"res/game/sheep/UIPhienCuaToi.json",SoundClick:"res/game/sheep/sounds/click.mp3",SoundBackGround:"res/game/sheep/sounds/Background.mp3",SoundWin:"res/game/sheep/sounds/Win.mp3",SoundLose:"res/game/sheep/sounds/Lose.mp3"};var resourcesGameSheep=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameSheepPreloadMobile)ResourceManager.MGResourcesGameSheepPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameSheepPreloadMobile[i],resourcesGameSheep.push(ResourceManager.MGResourcesGameSheepPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameSheep)ResourceManager.MGResourcesGameSheep[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameSheep[i]}else for(i in ResourceManager.MGResourcesGameSheep)ResourceManager.MGResourcesGameSheep[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameSheep[i],resourcesGameSheep.push(ResourceManager.MGResourcesGameSheep[i]);var MGSheepButtons=MGBaseNode.extend({_listButton:null,mainGame:null,textBetInfo:null,textKetSat:null,textTaiSan:null,textDauTu:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventHover();this.textBetInfo=this.getChildByName("Text_InfoBet");this.textBetInfo.setString("");this.textTaiSan=this.getChildByName("Text_Tai_San");this.textTaiSan.setString("0");this.textDauTu=this.getChildByName("Text_DauTu");
this.textDauTu.setString("0");this.textKetSat=this.getChildByName("Text_Ket_Sat");this.textKetSat.setString("0")},updateDauTu:function(a){this.textDauTu.setString(a)},updateTaiSan:function(a){this.textTaiSan.setString(a)},updateKetSat:function(a){this.textKetSat.setString(a)},updateBetInfo:function(a){this.textBetInfo.setString(a)},_initEventHover:function(){for(var a=0,b=[],d=this.getChildren(),e=d.length,f=0;f<e;f++)d[f]instanceof ccui.Button&&(b.push(d[f]),a++);for(d=0;d<a;)e=b[d],cc.sys.isNative?
(e.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(e)):(f=new MGBaseButton,f.cloneFromButton(e),f._initEventsGame(),f.setMouseHoverEnabled(!0),f.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),f.addMouseHoverEventListener(this._onMouseHover.bind(this)),this.addChild(f),this._listButton.push(f)),d++;b.length=0},_onMouseHover:function(a,b){switch(b){case 0:this.textBetInfo.setString("");break;case 1:var d="";switch(a.getName()){case MGSheepButtons.BUTTON_NAME.UP:d=
"Tăng : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.DOWN:d="Giảm : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.YELLOW:d="Vàng : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.YELLOW_UP:d="Vàng tăng : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.YELLOW_DOWN:d="Vàng giảm : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.RED:d="Đỏ : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.RED_DOWN:d=
"Đỏ giảm : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.RED_UP:d="Đỏ tăng : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.GREEN:d="Xanh : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.GREEN_UP:d="Xanh tăng : "+Utilities.Coin(a.getTag());break;case MGSheepButtons.BUTTON_NAME.GREEN_DOWN:d="Xanh giảm : "+Utilities.Coin(a.getTag())}this.textBetInfo.setString(d)}},hideTwoBTN:function(){this.hideButton(MGSheepButtons.BUTTON_NAME.TL5050);this.hideButton(MGSheepButtons.BUTTON_NAME.GOM_HUI)},
showTwoBTN:function(){this.showButton(MGSheepButtons.BUTTON_NAME.TL5050);this.showButton(MGSheepButtons.BUTTON_NAME.GOM_HUI)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},updateToolTip:function(a){this.getChildByName(MGSheepButtons.BUTTON_NAME.UP).setTag(a[0]);this.getChildByName(MGSheepButtons.BUTTON_NAME.DOWN).setTag(a[1]);
this.getChildByName(MGSheepButtons.BUTTON_NAME.YELLOW_UP).setTag(a[2]);this.getChildByName(MGSheepButtons.BUTTON_NAME.RED_UP).setTag(a[2]);this.getChildByName(MGSheepButtons.BUTTON_NAME.GREEN_UP).setTag(a[2]);this.getChildByName(MGSheepButtons.BUTTON_NAME.YELLOW_DOWN).setTag(a[3]);this.getChildByName(MGSheepButtons.BUTTON_NAME.RED_DOWN).setTag(a[3]);this.getChildByName(MGSheepButtons.BUTTON_NAME.GREEN_DOWN).setTag(a[3]);this.getChildByName(MGSheepButtons.BUTTON_NAME.YELLOW).setTag(a[4]);this.getChildByName(MGSheepButtons.BUTTON_NAME.RED).setTag(a[4]);
this.getChildByName(MGSheepButtons.BUTTON_NAME.GREEN).setTag(a[4])},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundClick,MGGameInfo.gameVolume);if(this.isTouched(a,b))switch(this.mainGame.isFirstPlay&&this.mainGame.resetFirstPlay(),a.getName()){case MGSheepButtons.BUTTON_NAME.UP:this.mainGame.netSend.bet(0);break;case MGSheepButtons.BUTTON_NAME.DOWN:this.mainGame.netSend.bet(1);break;case MGSheepButtons.BUTTON_NAME.YELLOW:this.mainGame.netSend.bet(2);
break;case MGSheepButtons.BUTTON_NAME.YELLOW_UP:this.mainGame.netSend.bet(3);break;case MGSheepButtons.BUTTON_NAME.YELLOW_DOWN:this.mainGame.netSend.bet(4);break;case MGSheepButtons.BUTTON_NAME.RED:this.mainGame.netSend.bet(5);break;case MGSheepButtons.BUTTON_NAME.RED_DOWN:this.mainGame.netSend.bet(7);break;case MGSheepButtons.BUTTON_NAME.RED_UP:this.mainGame.netSend.bet(6);break;case MGSheepButtons.BUTTON_NAME.GREEN:this.mainGame.netSend.bet(8);break;case MGSheepButtons.BUTTON_NAME.GREEN_DOWN:this.mainGame.netSend.bet(10);
break;case MGSheepButtons.BUTTON_NAME.GREEN_UP:this.mainGame.netSend.bet(9);break;case MGSheepButtons.BUTTON_NAME.GOM_HUI:this.mainGame.netSend.gomHui();a.runAction(cc.sequence(cc.callFunc(function(){a.setEnabled(!1)}.bind(this)),cc.delayTime(3),cc.callFunc(function(){a.setEnabled(!0)}.bind(this))));break;case MGSheepButtons.BUTTON_NAME.TL5050:this.mainGame.netSend.getHaft(),a.runAction(cc.sequence(cc.callFunc(function(){a.setEnabled(!1)}.bind(this)),cc.delayTime(3),cc.callFunc(function(){a.setEnabled(!0)}.bind(this))))}},
disableUp:function(){this.showAll();this.hideButton(MGSheepButtons.BUTTON_NAME.UP);this.hideButton(MGSheepButtons.BUTTON_NAME.YELLOW_UP);this.hideButton(MGSheepButtons.BUTTON_NAME.RED_UP);this.hideButton(MGSheepButtons.BUTTON_NAME.GREEN_UP)},disableDown:function(){this.showAll();this.hideButton(MGSheepButtons.BUTTON_NAME.DOWN);this.hideButton(MGSheepButtons.BUTTON_NAME.YELLOW_DOWN);this.hideButton(MGSheepButtons.BUTTON_NAME.RED_DOWN);this.hideButton(MGSheepButtons.BUTTON_NAME.GREEN_DOWN)},showAll:function(){for(var a=
0;a<this._listButton.length;a++)this._listButton[a].setBright(!0),this._listButton[a].setEnabled(!0);2>this.mainGame.countSheep&&this.hideTwoBTN()},isTouched:function(a,b){if(!1===cc.sys.isNative)return!0;switch(b){case ccui.Widget.TOUCH_BEGAN:this._onMouseHover(a,1);break;case ccui.Widget.TOUCH_ENDED:return this._onMouseHover(a,0),!0;case ccui.Widget.TOUCH_CANCELED:return this._onMouseHover(a,0),!1}},updateButtonBets:function(a){1>=a?this.disableDown():50<=a?this.disableUp():this.showAll()},hideAll:function(){for(var a=
0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)}});MGSheepButtons.BUTTON_NAME={UP:"Button_Up",DOWN:"Button_Down",YELLOW:"Button_Yellow",YELLOW_UP:"Button_Yellow_Up",YELLOW_DOWN:"Button_Yellow_Down",RED:"Button_Red",RED_UP:"Button_Red_Up",RED_DOWN:"Button_Red_Down",GREEN:"Button_Green",GREEN_UP:"Button_Green_Up",GREEN_DOWN:"Button_Green_Down",GOM_HUI:"Button_GomHui",TL5050:"Button_5050"};var MGCompoBtnPopup=MGBaseNode.extend({mainGame:null,listButton:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listButton=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.hideButton(MGCompoBtnPopup.BUTTON_NAME.TL);this._initEventsGame()},_initEventsGame:function(){for(var a=this.getChildren(),b=0;b<a.length;b++)a[b]instanceof ccui.Button&&(this.listButton.push(a[b]),a[b].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)))},onClickBtnFromCocostudio:function(a,
b){mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundClick,MGGameInfo.gameVolume);switch(a.getName()){case MGCompoBtnPopup.BUTTON_NAME.PCT:this.showButton(MGCompoBtnPopup.BUTTON_NAME.PCT);this.hideButton(MGCompoBtnPopup.BUTTON_NAME.TL);this.mainGame.showPhienCuaToi();break;case MGCompoBtnPopup.BUTTON_NAME.TL:this.hideButton(MGCompoBtnPopup.BUTTON_NAME.PCT),this.showButton(MGCompoBtnPopup.BUTTON_NAME.TL),this.mainGame.showThangLon()}},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);
this.getChildByName(a).setEnabled(!0)},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.listButton.length;a++)this.listButton[a]&&this.listButton[a].removeFromParent(!0);this.listButton=[]}});MGCompoBtnPopup.BUTTON_NAME={PCT:"Button_PCT",TL:"Button_TL"};var MGSheepButtonMoney=MGBaseNode.extend({_listButton:null,mainGame:null,yPos:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].setScale(.9),a[d].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]));this.yPos=this._listButton[0].getPositionY();
this.hideAll();this.showButton("Button_0")},updateValue:function(a){for(var b=0;b<a.length;b++)this._listButton[b].setTitleText(this.formatK(a[b])),this._listButton[b].setTag(a[b]);this.mainGame.curentCoinSelected=a[0]},formatK:function(a){a=a.toString();var b="";if(4<=a.length){for(var d=0;d<a.length-3;d++)b+=a.charAt(d);return b+"K"}return a},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){cc.sys.isNative||
this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1);this.getChildByName(a).stopAllActions();this.getChildByName(a).runAction(cc.sequence(cc.moveBy(.6,cc.p(0,-10)),cc.moveBy(.6,cc.p(0,10))).repeatForever())},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundClick,MGGameInfo.gameVolume);this.hideAll();this.showButton(a.getName());this.mainGame.curentCoinSelected=a.getTag();this.mainGame.isFirstPlay&&this.mainGame.setStep2Tutorial()},
hideAll:function(){for(var a=0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!0),this._listButton[a].setEnabled(!0),this._listButton[a].stopAllActions(),this._listButton[a].setScale(.9),this._listButton[a].setPositionY(this.yPos)}});var MGBabySheep=cc.Node.extend({_spriteSheep:null,_textNumber:null,subPos:0,ctor:function(){cc.Node.prototype.ctor.call(this)},init:function(a,b){this._spriteSheep=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameSheep.SheepJSON,ResourceManager.MGResourcesGameSheep.SheepATLAS);this._spriteSheep.setTimeScale(5.2);switch(a){case 3:this._spriteSheep.setSkin("Green");this._textNumber=new cc.LabelBMFont("20",ResourceManager.MGResourcesGameSheep.FontXanh);break;case 1:this._spriteSheep.setSkin("Red");
this._textNumber=new cc.LabelBMFont("20",ResourceManager.MGResourcesGameSheep.FontDo);break;case 2:this._spriteSheep.setSkin("Yellow"),this._textNumber=new cc.LabelBMFont("20",ResourceManager.MGResourcesGameSheep.FontVang)}this.addChild(this._spriteSheep);this._spriteSheep.setScale(.7);this._spriteSheep.setPositionY(-40);this._spriteSheep.setPositionX(-10);this._textNumber.setString(b);this._textNumber.setPosition(cc.p(-30,0));this.addChild(this._textNumber)},go:function(){this._spriteSheep.setTimeScale(5.2);
this._spriteSheep.setAnimation(0,"Walk",!0)},stopRun:function(){this._spriteSheep.setTimeScale(1.7);this._spriteSheep.setAnimation(0,"Idle",!0)},setSubPos:function(a){this.subPos=a}});var MGBabySheepManager=cc.Class.extend({gameMain:null,listSheep:null,ctor:function(){},setDelegate:function(a){this.mainGame=a;this.listSheep=[]},resetAllShip:function(){for(var a=0;a<this.listSheep.length;a++)this.listSheep[a].removeFromParent(!0);for(;0<this.listSheep.length;)this.listSheep.pop();this.listSheep.length=0},spawnSheep:function(a,b){var d=new MGBabySheep;d.init(a,b);this.mainGame.isFirstPlay?(d.setPosition(cc.p(150,90)),d.setSubPos(150)):d.setPosition(cc.p(0,90));d.setLocalZOrder(9);
this.mainGame.sheepNode.addChild(d);this.listSheep.push(d);for(d=0;d<this.listSheep.length;){var e=this.listSheep[d];e.stopAllActions();e.go();e.runAction(cc.sequence(cc.moveBy(1,cc.p(250-e.subPos,0)),cc.callFunc(function(){e.setSubPos(0);this.mainGame.lockBet=!1;this.allSheepStop();this.mainGame.isGameOver&&this.allSheepGoOut()}.bind(this))));d++}},allSheepStop:function(){for(var a=0;a<this.listSheep.length;a++)this.listSheep[a].stopRun()},allSheepGoOut:function(){for(var a=0;a<this.listSheep.length;a++)this.listSheep[a].stopAllActions(),
this.listSheep[a].go(),this.listSheep[a].runAction(cc.sequence(cc.moveBy(1,cc.p(1400,0)),cc.callFunc(function(){}.bind(this))))}});var MGSheepSession=cc.Class.extend({matchID:0,step:0,bet:0,win:0,ctor:function(){this.win=this.bet=this.step=this.matchID=0},updateData:function(a,b,d,e){this.matchID=a;this.step=b;this.bet=d;this.win=e}});var MGSheepUserDataCell=MGBaseNode.extend({textPhien:null,textBet:null,textWin:null,textStep:null,backGround:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameSheep.SheepUserDataCell,PreLoaderConfig.PathToResourceDefault).node);this.backGround=this.getChildByName("MGbackGround");this.textPhien=this.backGround.getChildByName("Text_Phien");this.textPhien.ignoreContentAdaptWithSize(!0);
this.textBet=this.backGround.getChildByName("Text_Bet");this.textWin=this.backGround.getChildByName("Text_Win");this.textStep=this.backGround.getChildByName("Text_Step")},updateData:function(a,b,d,e){this.textPhien.setString(a);this.textBet.setString(b);this.textWin.setString(Utilities.Coin(d));this.textStep.setString(e)}});var MGSheepLayoutUserSession=MGBaseNode.extend({listView:null,maxLine:null,listThangLon:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameSheep.SheepLayoutSessionBet,PreLoaderConfig.PathToResourceDefault).node);this.listView=this.getChildByName("MGPanel");this.maxLine=100;this.listThangLon=[]},setLayoutThangLon:function(){this.getChildByName("Text_0").setString("Tên")},updateDataPhienCuaToi:function(a){this.listView.removeAllChildren(!0);
for(var b=0;b<a.length;b++){var d=a[b],e=new MGSheepUserDataCell;e.initObj();e.backGround.removeFromParent(!0);0==b%2?e.backGround.loadTexture("cell-dark.png",ccui.Widget.PLIST_TEXTURE):e.backGround.loadTexture("cell-light.png",ccui.Widget.PLIST_TEXTURE);e.updateData(d.matchID,this.formatK(d.bet),d.win,d.step);this.listView.insertCustomItem(e.backGround,0)}},formatK:function(a){a=a.toString();var b="";if(4<=a.length){for(var d=0;d<a.length-3;d++)b+=a.charAt(d);return b+"K"}return a},updateDataThangLon:function(a){this.listThangLon=
[];this.listView.removeAllChildren(!0);for(var b=0;b<a.length;b++){var d=a[b];this.listThangLon.push(d);var e=new MGSheepUserDataCell;e.initObj();e.backGround.removeFromParent(!0);var f=d.NickName;if(10<f.length){for(var g="",h=0;8>h;h++)g+=f.charAt(h);f=g+="..."}0==b%2?e.backGround.loadTexture("cell-dark.png",ccui.Widget.PLIST_TEXTURE):e.backGround.loadTexture("cell-light.png",ccui.Widget.PLIST_TEXTURE);e.updateData(f,d.CoinBet,d.EarnCoin,d.SessionContinuousCount);this.listView.pushBackCustomItem(e.backGround);
this.listView.jumpToTop()}},addnewDataTopWin:function(a,b,d,e){var f=new MGSheepUserDataCell;f.initObj();f.backGround.removeFromParent(!0);if(10<a.length){for(var g="",h=0;8>h;h++)g+=a.charAt(h);a=g+"..."}0==this.listView.getChildrenCount()%2?f.backGround.loadTexture("cell-dark.png",ccui.Widget.PLIST_TEXTURE):f.backGround.loadTexture("cell-light.png",ccui.Widget.PLIST_TEXTURE);f.updateData(a,b,d,e);this.listView.insertCustomItem(f.backGround,0);this.listView.jumpToTop()},updateData:function(){for(var a=
0;20>a;a++){var b=new MGSheepUserDataCell;b.initObj();b.removeFromParent(!0);0==a%2?b.backGround.loadTexture("cell-dark.png",ccui.Widget.PLIST_TEXTURE):b.backGround.loadTexture("cell-light.png",ccui.Widget.PLIST_TEXTURE);this.listView.insertCustomItem(b.backGround,0)}}});var MGSheepThongBao=MGBaseNode.extend({listView:null,maxLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listView=this.getChildByName("Panel_ThongBao");this._initEventsGame();this.maxLine=100},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=
a.getUserData();this.listView.getItems().length>=this.maxLine&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",13,cc.color.WHITE,!0,180);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()}});var MGSheepHandTutorial=MGBaseNode.extend({backGroundTut:null,imageHand:null,backGroundText:null,textHand:null,mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameSheep.UIMGHandTutorial,PreLoaderConfig.PathToResourceDefault).node);this.imageHand=this.getChildByName("ImageHandSheep");this.backGroundText=this.getChildByName("BGTextHandSheep");this.textHand=
this.backGroundText.getChildByName("TextHandSheep")},moveHand:function(a){1==a||2==a?this.imageHand.setPosition(-192,29):this.imageHand.setPosition(-232,-24);a=this.imageHand.getPosition();this.imageHand.stopAllActions();this.imageHand.runAction(cc.sequence(cc.moveTo(.3,cc.p(a.x,a.y+5)),cc.moveTo(.3,cc.p(a.x,a.y-5))).repeatForever())},hideHand:function(){this.setVisible(!1)},setTextTuto1:function(){this.textHand.setString("Bước 1: Chọn mức cược")},setTextTuto2:function(){this.textHand.setString("Bước 2: Nhấn nút Play để bắt đầu chơi game")},
setTextTuto3:function(){this.textHand.setString("Bước 3: Dự đoán số, màu trên con cừu kế tiếp")}});var MGSheep=MGBaseGame.extend({netSend:null,compoButton:null,compoButtonMoney:null,babySheepManager:null,door:null,isGameOver:!1,buttonPlay:null,buttonTut:null,curentCoinSelected:0,listGamedata:[],matchID:0,step:0,layoutPhienCuaToi:null,layoutThangLon:null,layoutThongBao:null,tetxtMatchID:null,lockBet:!1,realBet:0,countSheep:0,handTutorial:null,backGroundTut:null,compoBtnPopup:null,isFirstPlay:!1,timeOutTaiSan:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameSheep},
initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendSheep;this.netSend.setDelegate(this);this.initCompoButton();this.intitCompoButtonMoney();this.babySheepManager=new MGBabySheepManager;this.babySheepManager.setDelegate(this);this.door=new cc.Sprite;this.door.setSpriteFrame("door.png");this.door.setPosition(MGSheep.DOOR_POS);this.addChild(this.door,MGSheep.Z_LOCAL_DOOR);this.tetxtMatchID=this._mainLayer.getChildByName("Text_MatchID");this.tetxtMatchID.removeFromParent();
this.addChild(this.tetxtMatchID,MGSheep.Z_LOCAL_MATCH_ID);this.intButtonPlay();this.initCompoButtonPopup();this.initLayoutThangLon();this.intLayoutPhienCuaToi();var a=new cc.Sprite;a.setSpriteFrame("ket-qua-top.png");a.setScale(1.1);a.setPosition(this._mainLayer.getChildByName("Node_PhienCuaToi").getPosition());this.addChild(a);this.sheepNode=this._mainLayer.getChildByName("Panel_Sheep");this.sheepNode.removeFromParent();this.addChild(this.sheepNode);mg.audio.playMusic(ResourceManager.MGResourcesGameSheep.SoundBackGround,
MGGameInfo.gameVolume,!0);this.compoButton.hideTwoBTN();this.matchID=0},intLayoutPhienCuaToi:function(){this.layoutPhienCuaToi=new MGSheepLayoutUserSession;this.layoutPhienCuaToi.initObj();this.layoutPhienCuaToi.setScale(1.1);this.layoutPhienCuaToi.setPosition(this._mainLayer.getChildByName("Node_PhienCuaToi").getPosition());this.addChild(this.layoutPhienCuaToi)},initLayoutThangLon:function(){this.layoutThangLon=new MGSheepLayoutUserSession;this.layoutThangLon.initObj();this.layoutThangLon.setScale(1.1);
this.layoutThangLon.setLayoutThangLon();this.layoutThangLon.setPosition(this._mainLayer.getChildByName("Node_PhienCuaToi").getPosition());this.addChild(this.layoutThangLon);this.layoutThangLon.setVisible(!1)},initLayOutThongBao:function(){this.layoutThongBao=new MGSheepThongBao;this.layoutThongBao.cloneFromNode(this._mainLayer.getChildByName("Node_ThongBao"));this.layoutThongBao.initObj();this.addChild(this.layoutThongBao)},initBackGroundTut:function(){this.backGroundTut=new ccui.Layout;this.backGroundTut.setContentSize(cc.size(cc.winSize.width,
cc.winSize.height+300));this.backGroundTut.setPosition(cc.p(-(cc.winSize.width-1280)/2,-(cc.winSize.height-720)));this.backGroundTut.setAnchorPoint(0,0);this.backGroundTut.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);this.backGroundTut.setBackGroundColor(cc.color(0,0,0));this.backGroundTut.setBackGroundColorOpacity(200);this.backGroundTut.setTouchEnabled(!0);this.addChild(this.backGroundTut,0);this.backGroundTut.setVisible(!1)},initHandTutorial:function(){this.handTutorial=new MGSheepHandTutorial;
this.handTutorial.initObj(this);this.addChild(this.handTutorial)},showThangLon:function(){this.layoutThangLon.setVisible(!0);this.layoutPhienCuaToi.setVisible(!1)},showPhienCuaToi:function(){this.layoutThangLon.setVisible(!1);this.layoutPhienCuaToi.setVisible(!0)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameSheep.UIMGSheepLayer,PreLoaderConfig.PathToResourceDefault)},_changeBackGround:function(){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameSheep.SheepBackGround;
cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);this.timeOutTaiSan&&clearTimeout(this.timeOutTaiSan);mg.audio.stopAllEffects(!0);mg.audio.stopMusic(ResourceManager.MGResourcesGameSheep.SoundBackGround)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.GameData.toString(),this.ngGameData.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.StartBetting.toString(),this.ngStartBetting.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.NextBetting.toString(),this.ngNextBetting.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.ResultBetting.toString(),
this.ngResultBetting.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.TopBigWin.toString(),this.ngTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.EndMatch.toString(),this.ngReceiveCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.RecHaftCoin.toString(),this.ngRecHaftCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.BigWin.toString(),
this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SHEEP.Tour.toString(),this.ngTour.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUserCoin.bind(this)))},initCompoButton:function(){this.compoButton=new MGSheepButtons;this.compoButton.cloneFromNode(this._mainLayer.getChildByName("MGButtonBet"));this.compoButton.initObj(this);this.addChild(this.compoButton)},intitCompoButtonMoney:function(){this.compoButtonMoney=
new MGSheepButtonMoney;this.compoButtonMoney.cloneFromNode(this._mainLayer.getChildByName("MGButtonMoney"));this.compoButtonMoney.initObj(this);this.addChild(this.compoButtonMoney)},intButtonPlay:function(){this.buttonPlay=this._mainLayer.getChildByName("Button_Play");this.buttonPlay.removeFromParent(!1);this.addChild(this.buttonPlay,2);this.buttonPlay.setTouchEnabled(!0);this.buttonPlay.addTouchEventListener(this.touchEvent,this);this.buttonTut=this._mainLayer.getChildByName("Button_Tut");this.buttonTut.removeFromParent(!0);
this.addChild(this.buttonTut,2);this.buttonTut.setTouchEnabled(!0);this.buttonTut.addTouchEventListener(function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundClick,MGGameInfo.gameVolume);break;case ccui.Widget.TOUCH_ENDED:cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{layerID:MGLayerPopupRules.LAYER.DEMCUU})}}.bind(this),this)},initCompoButtonPopup:function(){this.compoBtnPopup=new MGCompoBtnPopup;this.compoBtnPopup.cloneFromNode(this._mainLayer.getChildByName("MGComboButtonPopup"));
this.compoBtnPopup.initObj(this);this.addChild(this.compoBtnPopup)},touchEvent:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundClick,MGGameInfo.gameVolume);break;case ccui.Widget.TOUCH_ENDED:this.netSend.startGame(this.curentCoinSelected),this.isFirstPlay&&this.setStep3Tutorial()}},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32,
CoinUser:b.UInt64,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.Double};a=(new BinaryParser).initObj(b,a.content);this.compoButton.updateKetSat(Utilities.Coin(a.CoinUser));this.compoButtonMoney.updateValue(a.ListCoinCanBet);this.curentCoinSelected=a.ListCoinCanBet[0];this.compoButton.updateDauTu(this.curentCoinSelected);this.matchID=a.MatchID;this.tetxtMatchID.setString("#"+a.MatchID.toString());this.isGameOver=!1;this._changeBackGround();this.lockBet=!0;this.compoButton.hideTwoBTN();this.countSheep=
0},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.compoButton.updateDauTu(this.curentCoinSelected);this.buttonPlay.setVisible(!0);this.isGameOver=!1;this.babySheepManager.resetAllShip();this.step=0;this.matchID=a.MatchID;this.tetxtMatchID.setString("#"+this.matchID.toString());this.lockBet=!0;this.realBet=this.curentCoinSelected;this.updateDauTu();this.compoButton.hideTwoBTN();this.countSheep=
0},ngStartBetting:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListID:b.Array8,ListID_Type:b.UInt8,CoinWin:b.UInt64,ListRateCanWinWhenUserBet:b.Array8,ListRateCanWinWhenUserBet_Type:b.Double,CoinReal:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.babySheepManager.spawnSheep(a.ListID[1],a.ListID[0]);this.compoButton.updateButtonBets(a.ListID[0]);this.compoButton.updateTaiSan(Utilities.Coin(a.CoinWin));this.compoButton.updateKetSat(Utilities.Coin(a.CoinReal));this.updateDauTu();
this.realBet=this.curentCoinSelected;this.buttonPlay.setVisible(!1);this.compoButton.updateToolTip(a.ListRateCanWinWhenUserBet);this.lockBet=!1;this.countSheep=0},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.compoButton.updateKetSat(Utilities.Coin(a.Gold))},ngNextBetting:function(a){},ngResultBetting:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListID:b.Array8,ListID_Type:b.UInt8,CoinWin:b.UInt64,
ListRateCanWinWhenUserBet:b.Array8,ListRateCanWinWhenUserBet_Type:b.Double},d=(new BinaryParser).initObj(b,a.content);this.babySheepManager.spawnSheep(d.ListID[1],d.ListID[0]);this.compoButton.updateButtonBets(d.ListID[0]);this.timeOutTaiSan&&clearTimeout(this.timeOutTaiSan);this.timeOutTaiSan=setTimeout(function(){this.compoButton.updateTaiSan(Utilities.Coin(d.CoinWin))}.bind(this),1E3);this.compoButton.updateToolTip(d.ListRateCanWinWhenUserBet);0>=d.CoinWin?(this.lockBet=this.isGameOver=!0,this.countSheep=
0,this.compoButton.hideTwoBTN(),mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundLose,MGGameInfo.gameVolume)):(this.isGameOver=!1,mg.audio.playEffect(ResourceManager.MGResourcesGameSheep.SoundWin,MGGameInfo.gameVolume));this.step++;a=new MGSheepSession;a.updateData(this.matchID,this.step,this.realBet,d.CoinWin);this.listGamedata.push(a);this.layoutPhienCuaToi.updateDataPhienCuaToi(this.listGamedata);this.countSheep++;1<=this.countSheep&&this.compoButton.showTwoBTN()},ngTopBigWin:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,SessionContinuousCount:b.UInt8,EarnCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);this.layoutThangLon.updateDataThangLon(a.dataBigWin)},ngReceiveCoin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CoinWin:b.UInt64,CoinReal:b.UInt64};a=(new BinaryParser).initObj(b,a.content);
this.compoButton.updateTaiSan(0);this.compoButton.updateKetSat(Utilities.Coin(a.CoinReal));this.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){this.babySheepManager.allSheepGoOut()}.bind(this))));this.compoButton.hideTwoBTN()},ngRecHaftCoin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CoinWin:b.UInt64,CoinBet:b.UInt64,ListRateCanWinWhenUserBet:b.Array8,ListRateCanWinWhenUserBet_Type:b.Double};a=(new BinaryParser).initObj(b,a.content);this.compoButton.updateTaiSan(Utilities.Coin(a.CoinWin));
this.compoButton.updateDauTu(Utilities.Coin(a.CoinBet));this.compoButton.updateToolTip(a.ListRateCanWinWhenUserBet);this.compoButton.updateKetSat(Utilities.Coin(MGGameInfo.myInfo.Gold))},updateDauTu:function(){this.compoButton.updateDauTu(Utilities.Coin(this.curentCoinSelected))},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,SessionContinuousCount:b.UInt8,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,
a.content);this.layoutThangLon.addnewDataTopWin(a.NickName,a.CoinBet,a.EarnCoin,a.SessionContinuousCount)},ngTour:function(a){this.initBackGroundTut();this.initHandTutorial();this.compoButtonMoney.hideAll();this.isFirstPlay=!0;this.setStep1Tutorial()},setStep1Tutorial:function(){this.backGroundTut.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP1-15);this.compoButtonMoney.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP1);this.backGroundTut.setVisible(!0);this.handTutorial.setPosition(this._mainLayer.getChildByName("NodeHandCompo").getChildByName("NodeHandTutorial1").getPosition());
this.handTutorial.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP1);this.handTutorial.moveHand(1);this.handTutorial.setTextTuto1()},setStep2Tutorial:function(){this.backGroundTut.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP2-15);this.buttonPlay.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP2);this.handTutorial.setPosition(this._mainLayer.getChildByName("NodeHandCompo").getChildByName("NodeHandTutorial2").getPosition());this.handTutorial.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP2);this.handTutorial.setTextTuto2();
this.handTutorial.moveHand(2)},setStep3Tutorial:function(){this.backGroundTut.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP3-15);this.compoButton.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP3);this.sheepNode.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP3);this.handTutorial.setPosition(this._mainLayer.getChildByName("NodeHandCompo").getChildByName("NodeHandTutorial3").getPosition());this.handTutorial.setLocalZOrder(MGSheep.Z_LOCAL_TUTORIAL_STEP3);this.handTutorial.setTextTuto3();this.handTutorial.moveHand(3)},
resetFirstPlay:function(){this.isFirstPlay=!1;this.backGroundTut.setVisible(!1);this.handTutorial.hideHand();this.sheepNode.setLocalZOrder(MGSheep.Z_LOCAL_DOOR-10);this.buttonPlay.setLocalZOrder(MGSheep.Z_LOCAL_DOOR);this.buttonTut.setLocalZOrder(MGSheep.Z_LOCAL_DOOR)}});MGSheep.DOOR_POS=cc.p(180,480);MGSheep.Z_LOCAL_DOOR=100;MGSheep.Z_LOCAL_MATCH_ID=130;MGSheep.Z_LOCAL_TUTORIAL_STEP1=160;MGSheep.Z_LOCAL_TUTORIAL_STEP2=180;MGSheep.Z_LOCAL_TUTORIAL_STEP3=190;ConstantsVariable.NETWORK_MINIGAME_TAIXIU={GameData:2701,AddBet:2702,StartGame:2703,Result:2704,EndMatch:2705,ResultHistory:2706,SetTool:2707,TopUserWin:2708};ConstantsVariable.STATE_MINIGAME_TAIXIU={WAITING_BET_TIME_OUT:0,CALCULATE_RESULT:1,FINISH_GAME:2,NOT_PLAYING:3,WATCH_RESULT:4};var MGGameBoardTrenDuoi=cc.Class.extend({ctor:function(){}});MGGameBoardTrenDuoi.Type={NOT_BET:0,TAI:49,XIU:48};MGGameBoardTrenDuoi.myInfo={Bet:{Tai:0,Xiu:0},Type:{Tai:0,Xiu:0},CurentBet:0};
MGGameBoardTrenDuoi.onGameData=function(a){MGGameBoardTrenDuoi.Status=a.Status;MGGameBoardTrenDuoi.UserCoin=a.UserCoin;MGGameBoardTrenDuoi.MatchID=a.MatchID;MGGameBoardTrenDuoi.MinCoin=a.MinCoin;MGGameBoardTrenDuoi.DeskID=a.DeskID;for(var b=0;b<a.RatioBetting.length;b++)MGGameBoardTrenDuoi.ListBet.push(a.RatioBetting[b]*a.MinCoin)};
MGGameBoardTrenDuoi.onStartGame=function(a){MGGameBoardTrenDuoi.Status=ConstantsVariable.STATE_MINIGAME_TAIXIU.NOT_PLAYING;MGGameBoardTrenDuoi.TimeBet=a.timeBet;MGGameBoardTrenDuoi.TimeNotBet=a.timeNotBet;MGGameBoardTrenDuoi.timeShake=a.timeShake;MGGameBoardTrenDuoi.myInfo.Type.Tai=MGGameBoardTrenDuoi.Type.NOT_BET;MGGameBoardTrenDuoi.myInfo.Type.Xiu=MGGameBoardTrenDuoi.Type.NOT_BET;MGGameBoardTrenDuoi.myInfo.CurentBet=MGGameBoardTrenDuoi.Type.NOT_BET;MGGameBoardTrenDuoi.myInfo.Bet.Xiu=0;MGGameBoardTrenDuoi.myInfo.Bet.Tai=
0;MGGameBoardTrenDuoi.MatchID=a.matchID};MGGameBoardTrenDuoi.TimeBet=0;MGGameBoardTrenDuoi.TimeNotBet=3;MGGameBoardTrenDuoi.CountDownNextBet=8;MGGameBoardTrenDuoi.TimeShake=2;MGGameBoardTrenDuoi.Status=0;MGGameBoardTrenDuoi.MatchID=0;MGGameBoardTrenDuoi.ListBet=[];MGGameBoardTrenDuoi.UserCoin=0;MGGameBoardTrenDuoi.MinCoin=0;MGGameBoardTrenDuoi.DeskID=0;
MGGameBoardTrenDuoi.getCurrentBet=function(a){return MGGameBoardTrenDuoi.UserCoin>=a?a:MGGameBoardTrenDuoi.UserCoin<a&&MGGameBoardTrenDuoi.UserCoin>=MGGameBoardTrenDuoi.MinCoin?MGGameBoardTrenDuoi.UserCoin:0};MGGameBoardTrenDuoi.alignLabelBrowser=function(a,b){cc.sys.browserType==cc.sys.BROWSER_TYPE_FIREFOX&&a.setPositionY(a.getPosition().y-b)};
MGGameBoardTrenDuoi.clearListBet=function(){for(;0<MGGameBoardTrenDuoi.ListBet.length;)MGGameBoardTrenDuoi.ListBet.pop();MGGameBoardTrenDuoi.ListBet.length=0};var MGNetSendTrenDuoi=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBet:function(a,b){var d={};d.BetID=a;d.CoinBet=b;d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINIGAME_TAIXIU.AddBet,{BetID:BinaryConstants.DataTypeID.UInt8,CoinBet:BinaryConstants.DataTypeID.UInt64},d);MGNetCore.MGSocket.sendMsg(d)},sendTopWin:function(){var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINIGAME_TAIXIU.TopUserWin,null,null);MGNetCore.MGSocket.sendMsg(a)},
sendLeaveDesk:function(){Utilities.showLog("sendLeaveDesk "+this.gameModuleID);var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK.LEAVE_DESK,null,null);MGNetCore.MGSocket.sendMsg(a)},toolTrenDuoi:function(a){var b={};b.Dice=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINIGAME_TAIXIU.SetTool,{Dice:BinaryConstants.DataTypeID.Array8,Dice_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});ResourceManager.MGResourcesGameTrenDuoi={UIButtonBetTrenDuoi:"res/game/minigame/trenduoi/UIButtonBetTrenDuoi.json",UIButtonSupportTrenDuoi:"res/game/minigame/trenduoi/UIButtonSupportTrenDuoi.json",UICompoChatTrenDuoi:"res/game/minigame/trenduoi/UICompoChatTrenDuoi.json",UICompoHistoryTrenDuoi:"res/game/minigame/trenduoi/UICompoHistoryTrenDuoi.json",UICompoInfoTrenDuoi:"res/game/minigame/trenduoi/UICompoInfoTrenDuoi.json",UICompoTopWinTrenDuoi:"res/game/minigame/trenduoi/UICompoTopWinTrenDuoi.json",
UIHubTrenDuoi:"res/game/minigame/trenduoi/UIHubTrenDuoi.json",UITrenDuoiLayer:"res/game/minigame/trenduoi/UITrenDuoiLayer.json",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json",Hoa_Atlas:"res/game/Components/EffectThangThua/hoa.atlas",
Hoa_PNG:"res/game/Components/EffectThangThua/hoa.png",Hoa_Json:"res/game/Components/EffectThangThua/hoa.json",DICE_Atlas:"res/game/minigame/trenduoi/Effects/Dice_Only.atlas",DICE_PNG:"res/game/minigame/trenduoi/Effects/Dice_Only.png",DICE_Json:"res/game/minigame/trenduoi/Effects/Dice_Only.json",UIMGUITrenDuoiPNG:"res/game/minigame/trenduoi/AtlasTrenDuoi/atlasTrenDuoi.png",UIMGUITrenDuoiPLIST:"res/game/minigame/trenduoi/AtlasTrenDuoi/atlasTrenDuoi.plist"};var resourcesGameTrenDuoi=[];
for(i in ResourceManager.MGResourcesGameTrenDuoi)ResourceManager.MGResourcesGameTrenDuoi[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameTrenDuoi[i],resourcesGameTrenDuoi.push(ResourceManager.MGResourcesGameTrenDuoi[i]);var MGTrenDuoiButtonBet=MGBaseNode.extend({listButton:[],mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.listButton=[];this.initUI();this._initEventBtnFromNode();this.initEvent()},initUI:function(){this.setVisible(!1);this.setLocalZOrder(-1)},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoHub.EVENT.EVENT_END_BET,this.onEventEndBet.bind(this)))},
_initEventBtnFromNode:function(){for(var a=0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.getChildren()[a].getName()!=MGTrenDuoiButtonBet.BUTTON_NAME.CLOSE&&(0<MGGameBoardTrenDuoi.ListBet.length&&this.getChildren()[a].setTitleText(Utilities.CoinString(MGGameBoardTrenDuoi.ListBet[this.listButton.length])),this.getChildren()[a].setTag(this.listButton.length),this.listButton.push(this.getChildren()[a])))},
setBetValue:function(){for(var a=0;a<MGGameBoardTrenDuoi.ListBet.length;a++)this.listButton[a].setTitleText(Utilities.CoinString(MGGameBoardTrenDuoi.ListBet[a]))},onClickBtnFromCocostudio:function(a,b){if(a.getName()===MGTrenDuoiButtonBet.BUTTON_NAME.CLOSE)this.setVisible(!1);else if(MGGameBoardTrenDuoi.myInfo.CurentBet==MGGameBoardTrenDuoi.Type.TAI){var d=MGGameBoardTrenDuoi.getCurrentBet(MGGameBoardTrenDuoi.ListBet[a.getTag()]),d=0<d?d:1E4;0<d&&this.clickedSendBetting(d)}else MGGameBoardTrenDuoi.myInfo.CurentBet==
MGGameBoardTrenDuoi.Type.XIU&&(d=MGGameBoardTrenDuoi.getCurrentBet(MGGameBoardTrenDuoi.ListBet[a.getTag()]),d=0<d?d:1E4,0<d&&this.clickedSendBetting(d))},clickedSendBetting:function(a){this.mainGame.netSend.sendBet(MGGameBoardTrenDuoi.myInfo.CurentBet,a)},onEventEndBet:function(){this.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGTrenDuoiButtonBet.BUTTON_NAME={CLOSE:"MGButtonBetClose"};var MGTrenDuoiButtonSupport=MGBaseNode.extend({listButton:[],mainGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.listButton=[];this.initUI();this._initEventBtnFromNode();this.initEvent();this.setEnableButtonBet(!1)},initUI:function(){},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoHub.EVENT.EVENT_END_BET,this.onEventEndBet.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoHub.EVENT.EVENT_START_BET,this.onEventStartBet.bind(this)))},_initEventBtnFromNode:function(){for(var a=0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(this.getChildren()[a]))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiButtonSupport.BUTTON_NAME.HISTORY:this.mainGame.showCompoHistory(!0);
break;case MGTrenDuoiButtonSupport.BUTTON_NAME.TOP_WIN:this.mainGame.netSend.sendTopWin();this.mainGame.showCompoTopWin(!0);break;case MGTrenDuoiButtonSupport.BUTTON_NAME.INFO:this.mainGame.showCompoInfo(!0);break;case MGTrenDuoiButtonSupport.BUTTON_NAME.ANALYTICS:this.mainGame.showCompoAnalytics(!0);break;case MGTrenDuoiButtonSupport.BUTTON_NAME.CHAT:this.mainGame.showCompoChat(!0);this.setShowButton(MGTrenDuoiButtonSupport.BUTTON_NAME.CHAT,!1);break;case MGTrenDuoiButtonSupport.BUTTON_NAME.TAI:MGGameBoardTrenDuoi.myInfo.Type.Tai=
MGGameBoardTrenDuoi.myInfo.CurentBet=MGGameBoardTrenDuoi.Type.TAI;this.updateBetValue(MGGameBoardTrenDuoi.Type.TAI);this.mainGame.showCompoButtonBet(!0);break;case MGTrenDuoiButtonSupport.BUTTON_NAME.XIU:MGGameBoardTrenDuoi.myInfo.Type.Xiu=MGGameBoardTrenDuoi.myInfo.CurentBet=MGGameBoardTrenDuoi.Type.XIU;this.updateBetValue(MGGameBoardTrenDuoi.Type.XIU);this.mainGame.showCompoButtonBet(!0);break;case MGTrenDuoiButtonSupport.BUTTON_NAME.CLOSE:this.mainGame.closeGame()}},onAddBet:function(a){if(MGGameInfo.myInfo.UserID===
a.UserID){var b=a.ListCuoc;a=b[0].CuocID;b=b[0].CoinBet;a===MGGameBoardTrenDuoi.Type.TAI?(MGGameBoardTrenDuoi.myInfo.Bet.Tai+=b,this.updateBetValue(MGGameBoardTrenDuoi.Type.TAI)):a===MGGameBoardTrenDuoi.Type.XIU&&(MGGameBoardTrenDuoi.myInfo.Bet.Xiu+=b,this.updateBetValue(MGGameBoardTrenDuoi.Type.XIU))}},getButtonByName:function(a){return this.getChildByName(a)},setShowButton:function(a,b){this.getButtonByName(a).setVisible(b)},updateBetValue:function(a){a==MGGameBoardTrenDuoi.Type.TAI?(a=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.TAI),
a.setTitleText(Utilities.Coin(MGGameBoardTrenDuoi.myInfo.Bet.Tai)),a.setTitleColor(cc.color("#ffff00")),a.setBright(!1),a=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.XIU)):(a=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.XIU),a.setTitleText(Utilities.Coin(MGGameBoardTrenDuoi.myInfo.Bet.Xiu)),a.setTitleColor(cc.color("#ffff00")),a.setBright(!1),a=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.TAI));a.setBright(!0)},onEventEndBet:function(){this.setEnableButtonBet(!1)},
onEventStartBet:function(){var a=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.TAI);a.setTouchEnabled(!0);a.setTitleColor(cc.color("#ffffff"));a.setTitleText("ĐẶT");a=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.XIU);a.setTouchEnabled(!0);a.setTitleColor(cc.color("#ffffff"));a.setTitleText("ĐẶT")},setEnableButtonBet:function(a){var b=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.TAI);b.setTouchEnabled(a);var d=this.getButtonByName(MGTrenDuoiButtonSupport.BUTTON_NAME.XIU);
d.setTouchEnabled(a);a&&(b.setBright(a),d.setBright(a))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGTrenDuoiButtonSupport.BUTTON_NAME={HISTORY:"MGButtonSupportHistory",TOP_WIN:"MGButtonSupportTopWin",INFO:"MGButtonSupportInfo",ANALYTICS:"MGButtonSupportAnalytics",CHAT:"MGButtonSupportChat",TAI:"MGButtonSupportTai",XIU:"MGButtonSupportXiu",CLOSE:"MGButtonCloseGame"};var MGTrenDuoiCompoChat=MGBaseNode.extend({listButton:[],mainGame:null,listView:null,textField:null,canChat:!0,timeOutValue:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.listButton=[];this.mainGame=a;this.initUI();this.initEvent();this._initEventBtnFromNode()},initUI:function(){this.setVisible(!1);this.listView=this.getChildByName("MGListViewChat");this.textField=new MGBaseEditBox(this.getChildByName("MGCompoChatTextField"));
this.textField.setFontColor(cc.color("#000000"));this.textField.maxLength=1E3;this.textField.setDelegate(this);this.textField.setPlaceholderFontColor(cc.color("#7e7e7e"));this.addChild(this.textField)},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_IN_GAME,this.ngChat.bind(this)))},_initEventBtnFromNode:function(){for(var a=0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),
this.listButton.push(this.getChildren()[a]))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiCompoChat.BUTTON_NAME.CLOSE:this.setVisible(!1);this.mainGame.compoButtonSupport.setShowButton(MGTrenDuoiButtonSupport.BUTTON_NAME.CHAT,!0);break;case MGTrenDuoiCompoChat.BUTTON_NAME.SEND:this.createChatMgs(this.textField)}},editBoxReturn:function(a){this.createChatMgs(a)},createChatMgs:function(a){if(0!==a.getString().length&&this.canChat){var b={};b.GroupID=MGGameInfo.IDMiniTrenDuoi;
b.ChannelID=MGGameBoardTrenDuoi.DeskID;b.ArrMsg=[MGGameInfo.myInfo.DisplayName+":",a.getString()];b.ArrColor=["#9bdde0","#fbfdfd"];cc.eventManager.dispatchCustomEvent(MGCompoChat.EVENTS.USER_ENTER_CHAT,b);this.canChat=!1;a.setString("");this.timeOutValue&&clearTimeout(this.timeOutValue);this.timeOutValue=setTimeout(function(){a.setFocus(!0);this.canChat=!0}.bind(this),500)}},ngChat:function(a){a=a.getUserData();if(a.GroupID===MGGameInfo.IDMiniTrenDuoi&&a.ChannelID===MGGameBoardTrenDuoi.DeskID){this.listView.getItems().length>=
MGTrenDuoiCompoChat.MAX_LINE&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",16,cc.color.WHITE,!0,.96*this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()}},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.timeOutValue&&clearTimeout(this.timeOutValue)}});MGTrenDuoiCompoChat.BUTTON_NAME={CLOSE:"MGCompoChatButtonBack",SEND:"MGCompoChatButtonSend"};MGTrenDuoiCompoChat.MAX_LINE=100;var MGTrenDuoiCompoHistory=MGMoveablePopup.extend({mainGame:null,listButton:[],listView:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(a){MGMoveablePopup.prototype.initObj.call(this);this.listButton=[];this.mainGame=a;this.initUI();this.initEvent();this._initEventBtnFromNode()},initUI:function(){this.setVisible(!1);this.setMoveInfo(this.getChildByName("MGCompoHistoryBackground"));this.listView=this.getChildByName("MGCompoHistoryListView");this.listView.setSwallowTouches(!1);
this.getChildByName("MGHistoryViewCell").setVisible(!1)},initEvent:function(){this._initEventsGame()},_initEventBtnFromNode:function(){for(var a=0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(this.getChildren()[a]))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiCompoHistory.BUTTON_NAME.CLOSE:this.hide()}},setMySessionInfo:function(a){this.listView.getItems().length>=
MGTrenDuoiCompoHistory.MAX_LINE&&this.listView.removeItem(MGTrenDuoiCompoHistory.MAX_LINE-1);this.listView.insertCustomItem(this.createCellWithInfo(a),0);this.listView.jumpToTop()},createCellWithInfo:function(a){var b=this.getChildByName("MGHistoryViewCell").clone();b.setSwallowTouches(!1);b.setVisible(!0);this.setCellInfo(b,a);return b},setCellInfo:function(a,b){var d=new Date(b.Time);a.getChildByName("Text1").setString(b.Phien);var e=("0"+d.getHours()).slice(-2),f=("0"+d.getMinutes()).slice(-2),
d=("0"+d.getSeconds()).slice(-2);a.getChildByName("Text2").setString(e+":"+f+":"+d);e=[];b.CuaDat.Tai==MGGameBoardTrenDuoi.Type.TAI&&e.push("Trên");b.CuaDat.Xiu==MGGameBoardTrenDuoi.Type.XIU&&e.push("Dưới");a.getChildByName("Text3").setString(e.join(", "));a.getChildByName("Text4").setString(b.KetQua?"Thắng":"Thua");a.getChildByName("Text5").setString(Utilities.CoinString(b.TongDat));a.getChildByName("Text6").setString(Utilities.CoinString(b.ThucNhan))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});
MGTrenDuoiCompoHistory.BUTTON_NAME={CLOSE:"MGCompoHistoryButtonClose"};MGTrenDuoiCompoHistory.MAX_LINE=100;var MGTrenDuoiCompoHub=MGBaseNode.extend({mainGame:null,lbTimerBet:null,lbTimerNextBet:null,lbTalbeNumber:null,lbTaiCoin:null,lbXiuCoin:null,lbUserTai:null,lbUserXiu:null,lbTaiXiu:null,intervalBet:null,intervalNotBet:null,_timerBet:0,_timerNextBet:0,listTaiXiu:[],spCurrent:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.listTaiXiu=[];this.mainGame=a;this.initUI()},initUI:function(){this.lbTimerBet=this.getChildByName("MGHubThoiGianCuoc");
this.lbTimerBet.setVisible(!1);this.lbTimerNextBet=this.getChildByName("MGHubThoiGianVan");this.lbTimerNextBet.setVisible(!1);this.lbTalbeNumber=this.getChildByName("MGHubTable");this.lbTalbeNumber.setString("");this.lbTaiCoin=this.getChildByName("MGHubTienTai");this.lbTaiCoin.setString("");this.lbXiuCoin=this.getChildByName("MGHubTienXiu");this.lbXiuCoin.setString("");this.lbUserTai=this.getChildByName("MGHubUserTai");this.lbUserTai.setString("");this.lbUserXiu=this.getChildByName("MGHubUserXiu");
this.lbUserXiu.setString("");this.lbTaiXiu=this.getChildByName("MGHubBackgroundKetqua").getChildByName("MGLabelTaiXiu");this.lbTaiXiu.setString("")},setShowResultNumber:function(a){this.getChildByName("MGHubBackgroundKetqua").setVisible(a)},setBetCountdown:function(a){this.lbTimerBet.setVisible(!0);this.lbTimerNextBet.setVisible(!1);this.setShowResultNumber(!1);this._timerBet=a;null!=this.intervalBet&&clearInterval(this.intervalBet);this.intervalBet=setInterval(this._setTimerBet.bind(this),1E3);this._setTimerBet();
cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoHub.EVENT.EVENT_START_BET,null)},onGameData:function(a){a.Status==ConstantsVariable.STATE_MINIGAME_TAIXIU.WAITING_BET_TIME_OUT?this.startNewGame(a.MatchID,a.TimeRemain):a.Status==ConstantsVariable.STATE_MINIGAME_TAIXIU.CALCULATE_RESULT&&this.setNextBetCountdown(MGGameBoardTrenDuoi.CountDownNextBet-a.TimeRemain);this.setDisplayInfo(a)},startNewGame:function(a,b){this.setTableNumber(a);this.setBetCountdown(b);var d={};d.TotalUserBetTai=d.TotalUserBetXiu=
d.TotalBettingTai=d.TotalBettingXiu=0;this.setDisplayInfo(d)},setDisplayInfo:function(a){this.setUserTaiNumber(a.TotalUserBetTai);this.setUserXiuNumber(a.TotalUserBetXiu);this.setCoinTaiNumber(a.TotalBettingTai);this.setCoinXiuNumber(a.TotalBettingXiu)},setNextBetCountdown:function(a){this.lbTimerNextBet.setVisible(!0);this._timerNextBet=a;null!=this.intervalNotBet&&clearInterval(this.intervalNotBet);this.intervalNotBet=setInterval(this._setTimerNextBet.bind(this),1E3);this._setTimerNextBet()},setTableNumber:function(a){this.lbTalbeNumber.setString("#"+
a)},setUserTaiNumber:function(a){this.lbUserTai.setString(Utilities.CoinString(a))},setUserXiuNumber:function(a){this.lbUserXiu.setString(Utilities.CoinString(a))},setCoinTaiNumber:function(a){this.lbTaiCoin.setString(Utilities.CoinString(a))},setCoinXiuNumber:function(a){this.lbXiuCoin.setString(Utilities.CoinString(a))},setTaiXiuNumber:function(a){this.lbTaiXiu.setString(a)},_getTimerFormat:function(a){var b=("0"+parseInt(a/60,10)).slice(-2);a=("0"+a%60).slice(-2);return b+":"+a},_setTimerBet:function(){this.lbTimerBet.setString(this._getTimerFormat(this._timerBet));
this._timerBet==MGGameBoardTrenDuoi.TimeNotBet?(this.lbTimerBet.setColor(cc.color(255,0,0,255)),cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoHub.EVENT.EVENT_END_BET,null)):this._timerBet>MGGameBoardTrenDuoi.TimeNotBet&&this.lbTimerBet.setColor(cc.color(255,255,255,255));0==this._timerBet&&(this.lbTimerBet.setVisible(!1),clearInterval(this.intervalBet));this._timerBet--},_setTimerNextBet:function(){this.lbTimerNextBet.setString(this._getTimerFormat(this._timerNextBet));0==this._timerNextBet&&
(this.lbTimerNextBet.setVisible(!1),clearInterval(this.intervalNotBet));this._timerNextBet--},addListTaiXiu:function(a){var b=a===MGGameBoardTrenDuoi.Type.TAI?"sp_tai.png":"sp_xiu.png";a=new cc.Sprite;a.setSpriteFrame(b);b=this.getChildByName("MGTaiXiuListResult");this.listTaiXiu.length>=MGTrenDuoiCompoHub.MAX_LIST&&(this.listTaiXiu[0].removeFromParent(!0),this.listTaiXiu.splice(0,1));b.addChild(a);this.listTaiXiu.push(a);this.spCurrent&&(this.spCurrent.getParent().stopAllActions(),this.spCurrent.removeFromParent(!0),
this.spCurrent=null);this.resortList();this.spCurrent=new cc.Sprite;this.spCurrent.setSpriteFrame("sp_current.png");a.addChild(this.spCurrent,-1);this.spCurrent.setPosition(cc.p(.5*a.getContentSize().width,.5*a.getContentSize().height));a.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.3,cc.p(a.getPosition().x,a.getPosition().y+4)),cc.moveTo(.3,cc.p(a.getPosition().x,a.getPosition().y-4)))))},resortList:function(){for(var a=0;a<this.listTaiXiu.length;a++)this.listTaiXiu[a].setPosition(a*this.listTaiXiu[a].getContentSize().width,
0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);null!=this.intervalBet&&clearInterval(this.intervalBet);null!=this.intervalNotBet&&clearInterval(this.intervalNotBet)}});MGTrenDuoiCompoHub.EVENT={EVENT_END_BET:"event_end_bet",EVENT_START_BET:"event_start_bet"};MGTrenDuoiCompoHub.MAX_LIST=15;var MGTrenDuoiCompoInfo=MGMoveablePopup.extend({mainGame:null,listButton:[],ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(a){MGMoveablePopup.prototype.initObj.call(this);this.listButton=[];this.mainGame=a;this.initUI();this._initEventBtnFromNode()},initUI:function(){this.setVisible(!1);this.getChildByName("ScrollView_1").setSwallowTouches(!1);this.setMoveInfo(this.getChildByName("MGCompoInfoBackground"))},_initEventBtnFromNode:function(){for(var a=0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof
ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(this.getChildren()[a]))},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiCompoInfo.BUTTON_NAME.CLOSE:this.hide()}},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGTrenDuoiCompoInfo.BUTTON_NAME={CLOSE:"MGCompoInfoButtonClose"};var MGTrenDuoiCompoTopWin=MGMoveablePopup.extend({mainGame:null,listButton:[],listView:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(a){MGMoveablePopup.prototype.initObj.call(this);this.listButton=[];this.mainGame=a;this.initUI();this.initEvent();this._initEventBtnFromNode()},initUI:function(){this.setVisible(!1);this.setMoveInfo(this.getChildByName("MGCompoTopWinBackground"));this.listView=this.getChildByName("MGCompoTopWinListView");this.listView.setSwallowTouches(!1);
this.getChildByName("MGTopWinViewCell").setVisible(!1)},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.TopUserWin.toString(),this.ngBigWin.bind(this)))},_initEventBtnFromNode:function(){for(var a=0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(this.getChildren()[a]))},
onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiCompoTopWin.BUTTON_NAME.CLOSE:this.hide()}},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,d={ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,CoinWin:b.UInt64,Nickname:b.StringDynamic}},b=(new BinaryParser).initObj(d,a.content);Utilities.showLog("ngBigWin: "+JSON.stringify(b));b=(new BinaryParser).initObj(d,a.content);this.listView.removeAllItems();for(a=0;a<b.ListUser.length;a++)this.listView.pushBackCustomItem(this.createCellWithInfo(b.ListUser[a],
a+1));this.listView.jumpToBottom()},createCellWithInfo:function(a,b){var d=this.getChildByName("MGTopWinViewCell").clone();d.setSwallowTouches(!1);d.setTag(b);d.setVisible(!0);this.setCellInfo(d,a);return d},setCellInfo:function(a,b){a.getChildByName("Text1").setString(a.getTag());a.getChildByName("Text2").setString(b.Nickname);a.getChildByName("Text3").setString(Utilities.Coin(b.CoinWin))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGTrenDuoiCompoTopWin.BUTTON_NAME={CLOSE:"MGCompoTopWinButtonClose"};var MGTrenDuoiCompoAnalytics=MGMoveablePopup.extend({listButton:[],listCheckBox:[],listSpriteGraph1:[],listSpriteGraph2:[],listSpriteGraph3:[],listSpriteGraph4:[],spCurrent:null,pageView:null,mainGame:null,numberTai:0,numberXiu:0,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(a){MGMoveablePopup.prototype.initObj.call(this);this.mainGame=a;this.listButton=[];this.listCheckBox=[];this.listSpriteGraph1[0]=[];this.listSpriteGraph2[0]=[];this.listSpriteGraph3=[];this.listSpriteGraph4[0]=
[];this.listSpriteGraph4[1]=[];this.listSpriteGraph4[2]=[];this.initUI();this._initEventBtnFromNode();this._initEventCheckBoxFromNode();this.initEvent()},initUI:function(){this.setVisible(!1);this.setMoveInfo(this.getChildByName("MGCompoAnalyticsBackground"));this.pageView=this.getChildByName("MGCompoAnalyticsPageView");this.pageView.addEventListener(this.onPageViewDidScroll.bind(this));this.pageView.scrollToItem(0)},initEvent:function(){this._initEventsGame()},_initEventBtnFromNode:function(){for(var a=
0;a<this.getChildren().length;a++)this.getChildren()[a]instanceof ccui.Button&&(this.getChildren()[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.listButton.push(this.getChildren()[a]))},_initEventCheckBoxFromNode:function(){for(var a=this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage2").getChildren(),b=0;b<a.length;b++)a[b]instanceof ccui.CheckBox&&(a[b].addEventListener(this.onClickCheckBoxFromCocostudio.bind(this),this),this.listCheckBox.push(a[b]))},
addResultMatchList:function(a){this.renderGraph1(a);this.renderGraph2(a);this.renderGraph3(a);this.renderGraph4(a);this.updateNumberTrenDuoi()},addResultMatch:function(a){this.addDataToGraph1(a);this.addDataToGraph2(a);this.addDataToGraph3(a);this.addDataToGraph4(a);this.updateNumberTrenDuoi()},createSpriteForGraph1:function(a){var b=new cc.Sprite;b.setSpriteFrame(10<a?"sp_text_tai.png":"sp_text_xiu.png");var d=new cc.LabelTTF(a,"",13);d.setPosition(cc.p(.5*b.getContentSize().width,.5*b.getContentSize().height));
d.setName("value");MGGameBoardTrenDuoi.alignLabelBrowser(d,3);b.addChild(d);d=this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage1").getChildByName("MGGraph1");b.setTag(a);d.addChild(b);return b},createSpriteForGraph2:function(a){var b=new cc.Sprite;b.setSpriteFrame(10<a?"sp_tai.png":"sp_xiu.png");var d=this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage1").getChildByName("MGGraph2");b.setTag(a);d.addChild(b);10<a?this.numberTai++:this.numberXiu++;return b},
createSpriteForGraph3:function(a){var b=new cc.Sprite;b.setSpriteFrame(10<a?"sp_dot_black.png":"sp_dot_white.png");b.setTag(a);this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage2").getChildByName("MGGraph1").addChild(b);a=new cc.Sprite;a.setSpriteFrame("sp_line_total.png");a.setAnchorPoint(cc.p(.5,0));a.setPosition(cc.p(.5*b.getContentSize().width,.5*b.getContentSize().height));a.setName("path");b.addChild(a,-1);a.setScaleY(0);return b},createSpriteForGraph4:function(a,b){var d=
new cc.Sprite;d.setSpriteFrame(0===a?"sp_dot_yellow.png":1===a?"sp_dot_red.png":"sp_dot_blue.png");d.setTag(b);this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage2").getChildByName("MGGraph2").addChild(d);var e=new cc.Sprite;e.setSpriteFrame(0===a?"sp_line_yellow.png":1===a?"sp_line_red.png":"sp_line_blue.png");e.setAnchorPoint(cc.p(.5,0));e.setPosition(cc.p(.5*d.getContentSize().width,.5*d.getContentSize().height));e.setName("path");d.addChild(e,-1);e.setScaleY(0);return d},
sortGraph1:function(){for(var a=0;a<this.listSpriteGraph1.length;a++)for(var b=0;b<this.listSpriteGraph1[a].length;b++){var d=this.listSpriteGraph1[a][b],e=d.getParent(),f=e.getContentSize().width/MGTrenDuoiCompoAnalytics.GRAPH.WIDTH,g=e.getContentSize().height/MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT;d.setPosition(cc.p(f*a+.5*f,e.getContentSize().height-b*g-.5*g));e=d.getChildByName("value");d=d.getTag();e.setColor(cc.color(a===this.listSpriteGraph1.length-1&&b===this.listSpriteGraph1[a].length-1?"ffff00":
10>=d?"#FFFFFF":"#62F0FC"))}},sortGraph2:function(){for(var a=0;a<this.listSpriteGraph2.length;a++)for(var b=0;b<this.listSpriteGraph2[a].length;b++){var d=this.listSpriteGraph2[a][b],e=d.getParent(),f=e.getContentSize().width/MGTrenDuoiCompoAnalytics.GRAPH.WIDTH,g=e.getContentSize().height/MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT;this.spCurrent&&(this.spCurrent.getParent().stopAllActions(),this.spCurrent.removeFromParent(!0),this.spCurrent=null);d.setPosition(cc.p(f*a+.5*f,e.getContentSize().height-
b*g-.5*g));this.spCurrent=new cc.Sprite;this.spCurrent.setSpriteFrame("sp_current.png");d.addChild(this.spCurrent,-1);this.spCurrent.setPosition(cc.p(.5*d.getContentSize().width,.5*d.getContentSize().height));d.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.3,cc.p(d.getPosition().x,d.getPosition().y+4)),cc.moveTo(.3,cc.p(d.getPosition().x,d.getPosition().y-4)))))}},sortGraph3:function(){for(var a=0;a<this.listSpriteGraph3.length;a++){var b=this.listSpriteGraph3[a],d=b.getParent(),e=d.getContentSize().width/
MGTrenDuoiCompoAnalytics.GRAPH.WIDTH,d=d.getContentSize().height/MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT;b.setPosition(cc.p(e*a+e,b.getTag()*d/3))}for(a=0;a<this.listSpriteGraph3.length;a++)a<this.listSpriteGraph3.length-1&&(b=this.listSpriteGraph3[a],e=cc.pDistance(b.getPosition(),this.listSpriteGraph3[a+1].getPosition()),d=cc.pSub(this.listSpriteGraph3[a+1].getPosition(),b.getPosition()),d=180*cc.pAngle(cc.p(0,1),d)/Math.PI,b=b.getChildByName("path"),b.setRotation(d),b.setScaleY(e/b.getContentSize().height)),
a===this.listSpriteGraph3.length-1&&2<=this.listSpriteGraph3.length&&(b=this.listSpriteGraph3[a],this.setAddEffect(this.listSpriteGraph3[a-1].getChildByName("path"),b))},sortGraph4:function(){for(var a=0;a<this.listSpriteGraph4.length;a++)for(var b=0;b<this.listSpriteGraph4[a].length;b++){var d=this.listSpriteGraph4[a][b],e=d.getParent(),f=e.getContentSize().width/MGTrenDuoiCompoAnalytics.GRAPH.WIDTH,e=e.getContentSize().height/MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT;d.setPosition(cc.p(f*b+f,d.getTag()*
e))}for(a=0;a<this.listSpriteGraph4.length;a++)for(b=0;b<this.listSpriteGraph4[a].length;b++)b<this.listSpriteGraph4[a].length-1?(d=this.listSpriteGraph4[a][b],f=cc.pDistance(d.getPosition(),this.listSpriteGraph4[a][b+1].getPosition()),e=cc.pSub(this.listSpriteGraph4[a][b+1].getPosition(),d.getPosition()),e=180*cc.pAngle(cc.p(0,1),e)/Math.PI,d=d.getChildByName("path"),d.setRotation(e),d.setScaleY(f/d.getContentSize().height)):b===this.listSpriteGraph4[a].length-1&&2<=this.listSpriteGraph4[a].length&&
this.canShowGraph(a)&&(d=this.listSpriteGraph4[a][b],this.setAddEffect(this.listSpriteGraph4[a][b-1].getChildByName("path"),d))},addDataToGraph1:function(a){var b=this.listSpriteGraph1[this.listSpriteGraph1.length-1],d=a[0]+a[1]+a[2];a=this.listSpriteGraph1.length-1;if(0<b.length){var e=b[b.length-1].getTag();if(10<d&&10>=e||10>=d&&10<e||b.length==MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT){if(this.listSpriteGraph1.length===MGTrenDuoiCompoAnalytics.GRAPH.WIDTH){for(b=0;b<this.listSpriteGraph1[0].length;b++)this.listSpriteGraph1[0][b].removeFromParent(!0);
this.listSpriteGraph1.splice(0,1)}else a++;this.listSpriteGraph1[a]=[]}}b=this.createSpriteForGraph1(d);this.listSpriteGraph1[a].push(b);this.sortGraph1()},addDataToGraph2:function(a){var b=this.listSpriteGraph2[this.listSpriteGraph2.length-1],d=this.listSpriteGraph2.length-1;a=a[0]+a[1]+a[2];if(0<b.length&&b.length==MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT){if(this.listSpriteGraph2.length==MGTrenDuoiCompoAnalytics.GRAPH.WIDTH){for(b=0;b<this.listSpriteGraph2[0].length;b++)this.listSpriteGraph2[0].removeFromParent(!0);
this.listSpriteGraph2.splice(0,1)}else d++;this.listSpriteGraph2[d]=[]}b=this.createSpriteForGraph2(a);this.listSpriteGraph2[d].push(b);this.sortGraph2()},addDataToGraph3:function(a){a=a[0]+a[1]+a[2];this.listSpriteGraph3.length==MGTrenDuoiCompoAnalytics.GRAPH.WIDTH&&(this.listSpriteGraph3[0].removeFromParent(!0),this.listSpriteGraph3.splice(0,1));a=this.createSpriteForGraph3(a);this.listSpriteGraph3.push(a);this.sortGraph3()},addDataToGraph4:function(a){if(this.listSpriteGraph4[0].length==MGTrenDuoiCompoAnalytics.GRAPH.WIDTH)for(var b=
0;b<this.listSpriteGraph4.length;b++)this.listSpriteGraph4[b][0].removeFromParent(!0),this.listSpriteGraph4[b].splice(0,1);for(b=0;3>b;b++){var d=this.createSpriteForGraph4(b,a[b]);d.setVisible(this.canShowGraph(b));this.listSpriteGraph4[b].push(d)}this.sortGraph4()},renderGraph1:function(a){for(var b=0,d=0,e=0,f=0;f<a.length;f++){var g=a[f].result,g=g[0]+g[1]+g[2];0!=e&&10<g&&10>=e&&(b=0,d++,this.listSpriteGraph1[d]=[]);0!=e&&10>=g&&10<e&&(b=0,d++,this.listSpriteGraph1[d]=[]);e=this.createSpriteForGraph1(g);
this.listSpriteGraph1[d].push(e);e=g;b++}this.sortGraph1()},renderGraph2:function(a){for(var b=0,d=0,e=0;e<a.length;e++){var f=a[e].result,f=f[0]+f[1]+f[2];b==MGTrenDuoiCompoAnalytics.GRAPH.HEIGHT&&(b=0,d++,this.listSpriteGraph2[d]=[]);f=this.createSpriteForGraph2(f);this.listSpriteGraph2[d].push(f);b++}this.sortGraph2()},renderGraph3:function(a){for(var b=0;b<a.length;b++){var d=a[b].result,d=this.createSpriteForGraph3(d[0]+d[1]+d[2]);this.listSpriteGraph3.push(d)}this.sortGraph3()},renderGraph4:function(a){for(var b=
0;b<a.length;b++)for(var d=a[b].result,e=0;3>e;e++){var f=this.createSpriteForGraph4(e,d[e]);f.setVisible(this.canShowGraph(e));this.listSpriteGraph4[e].push(f)}this.sortGraph4()},updateNumberTrenDuoi:function(){this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage1").getChildByName("MGBackgroundTaiXiu1").getChildByName("MGTextTai").setString("TRÊN:"+this.numberTai);this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage1").getChildByName("MGBackgroundTaiXiu1").getChildByName("MGTextXiu").setString("DƯỚI:"+
this.numberXiu);this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage1").getChildByName("MGBackgroundTaiXiu2").getChildByName("MGTextTai").setString("TRÊN:"+this.numberTai);this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage1").getChildByName("MGBackgroundTaiXiu2").getChildByName("MGTextXiu").setString("DƯỚI:"+this.numberXiu)},updateLabelPhienInfo:function(a,b){var d=this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage2").getChildByName("MGTextPhienInfo");
d.setString("Phiên gần nhất(#"+a+") -");var e=b[0]+b[1]+b[2],d=this.getChildByName("MGCompoAnalyticsPageView").getChildByName("MGCompoPage2").getChildByName("MGTextTaiXiuInfo"),e=(10<e?"Trên "+e+":":"Dưới "+e+":")+("("+b.join("-")+")");d.setString(e)},setShowGraph:function(a,b){for(var d=0;d<this.listSpriteGraph4[a].length;d++)this.listSpriteGraph4[a][d].setVisible(b)},onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiCompoAnalytics.BUTTON_NAME.CLOSE:this.hide();break;case MGTrenDuoiCompoAnalytics.BUTTON_NAME.PRE:this.pageView.scrollToItem(0);
break;case MGTrenDuoiCompoAnalytics.BUTTON_NAME.NEXT:this.pageView.scrollToItem(1)}},onClickCheckBoxFromCocostudio:function(a,b){switch(a.getName()){case MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.TONG:this.setShowGraph(0,!b);this.setShowGraph(1,!b);this.setShowGraph(2,!b);this.getCheckBoxByName(MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC1).setSelected(!b);this.getCheckBoxByName(MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC2).setSelected(!b);this.getCheckBoxByName(MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC3).setSelected(!b);
break;case MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC1:case MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC2:case MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC3:this.setShowGraph(this.getDiceByName(a.getName()),!b),this.getCheckBoxByName(MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.TONG).setSelected(this.canSetTongEnable())}},setAddEffect:function(a,b){var d=a.getScaleY();b.setVisible(!1);a.setScaleY(0);a.runAction(cc.sequence(cc.scaleTo(1.5,1,d),cc.callFunc(function(){b.setVisible(!0)}.bind(this))))},
onPageViewDidScroll:function(a,b){0===a.getCurrentPageIndex()?(this.getChildByName("MGCompoButtonPre").setVisible(!1),this.getChildByName("MGCompoButtonNext").setVisible(!0)):(this.getChildByName("MGCompoButtonNext").setVisible(!1),this.getChildByName("MGCompoButtonPre").setVisible(!0))},getCheckBoxByName:function(a){for(var b=0;b<this.listCheckBox.length;b++)if(a===this.listCheckBox[b].getName())return this.listCheckBox[b]},getDiceByName:function(a){if(a===MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC1)return 0;
if(a===MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC2)return 1;if(a===MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC3)return 2},getNameByDice:function(a){if(0===a)return MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC1;if(1===a)return MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC2;if(2===a)return MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.XUCSAC3},canSetTongEnable:function(){for(var a=0;a<this.listCheckBox.length;a++)if(!this.listCheckBox[a].isSelected()&&this.listCheckBox[a].getName()!=MGTrenDuoiCompoAnalytics.CHECKBOX_NAME.TONG)return!1;
return!0},canShowGraph:function(a){return this.getCheckBoxByName(this.getNameByDice(a)).isSelected()},setDispose:function(){for(MGBaseNode.prototype.setDispose.call(this);0<this.listSpriteGraph1.length;)this.listSpriteGraph1.pop();for(;0<this.listSpriteGraph2.length;)this.listSpriteGraph2.pop();for(;0<this.listSpriteGraph3.length;)this.listSpriteGraph3.pop();for(;0<this.listSpriteGraph4.length;)this.listSpriteGraph4.pop()}});
MGTrenDuoiCompoAnalytics.BUTTON_NAME={CLOSE:"MGCompoAnalyticsButtonClose",PRE:"MGCompoButtonPre",NEXT:"MGCompoButtonNext"};MGTrenDuoiCompoAnalytics.CHECKBOX_NAME={TONG:"MGCheckBoxTong",XUCSAC1:"MGCheckBox1",XUCSAC2:"MGCheckBox2",XUCSAC3:"MGCheckBox3"};MGTrenDuoiCompoAnalytics.GRAPH={WIDTH:20,HEIGHT:7};var MGTrenDuoiCompoEffect=MGBaseNode.extend({fcThang:null,fxThua:null,fxHoa:null,fxDice:null,fxTren:null,fxDuoi:null,fxNhanThuong:null,listDice:[],listTimeOut:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.listDice=[];this.listTimeOut=[];this.initUI();this.initEffect();this.initEvents()},initUI:function(){for(var a=1;3>=a;a++){var b=this.getChildByName("Dice_"+a),d=new cc.Sprite;d.setPosition(b.getPosition());d.setVisible(!1);d.setScale(.8);this.addChild(d);this.listDice.push(d)}this.fxNhanThuong=
this.getChildByName("MGLabelNhanThuong");this.fxNhanThuong.setVisible(!1);this.fxNhanThuong.ignoreContentAdaptWithSize(!0)},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_THANG,this.playEffectThang.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_THUA,this.playEffectThua.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_HOA,
this.playEffectHoa.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_DICE,this.playEffectDice.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_TREN,this.playEffectTren.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_DUOI,this.playEffectDuoi.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGTrenDuoiCompoEffect.EVENT.FX_NHAN_TIEN,
this.playEffectNhanThuong.bind(this)))},initEffect:function(){var a=this.getChildByName("MGEffectWinLose").getPosition();this.fxThang=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTrenDuoi.Thang_Json,ResourceManager.MGResourcesGameTrenDuoi.Thang_Atlas);this.fxThang.setPosition(a);this.addChild(this.fxThang);this.fxThang.setVisible(!1);this.fxThua=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTrenDuoi.Thua_Json,ResourceManager.MGResourcesGameTrenDuoi.Thua_Atlas);this.fxThua.setPosition(a);
this.addChild(this.fxThua);this.fxThua.setVisible(!1);this.fxHoa=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTrenDuoi.Hoa_Json,ResourceManager.MGResourcesGameTrenDuoi.Hoa_Atlas);this.fxHoa.setPosition(a);this.addChild(this.fxHoa);this.fxHoa.setVisible(!1);this.fxDice=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameTrenDuoi.DICE_Json,ResourceManager.MGResourcesGameTrenDuoi.DICE_Atlas);this.fxDice.setPosition(a);this.fxDice.setScale(.5);this.addChild(this.fxDice);this.fxDice.setVisible(!1);
this.fxTren=new cc.Sprite;this.fxTren.setSpriteFrame("effect.png");this.fxTren.setPosition(this.getChildByName("MGEffectTren").getPosition());this.addChild(this.fxTren);this.fxTren.setVisible(!1);this.fxTren.runAction(cc.repeatForever(cc.rotateBy(2,360)));this.fxDuoi=new cc.Sprite;this.fxDuoi.setSpriteFrame("effect.png");this.fxDuoi.setPosition(this.getChildByName("MGEffectDuoi").getPosition());this.addChild(this.fxDuoi);this.fxDuoi.setVisible(!1);this.fxDuoi.runAction(cc.repeatForever(cc.rotateBy(2,
360)))},playEffectThang:function(a){this.fxThang.setAnimation(0,"thang",!1);this.fxThang.setVisible(!0);this.listTimeOut.push(setTimeout(this.hideEffect.bind(this,this.fxThang),3E3))},playEffectThua:function(a){this.fxThua.setAnimation(0,"thua",!1);this.fxThua.setVisible(!0);this.listTimeOut.push(setTimeout(this.hideEffect.bind(this,this.fxThua),3E3))},playEffectHoa:function(a){this.fxHoa.setAnimation(0,"hoa",!1);this.fxHoa.setVisible(!0);this.listTimeOut.push(setTimeout(this.hideEffect.bind(this,
this.fxHoa),3E3))},playEffectTren:function(a){this.fxTren.setVisible(!0);this.listTimeOut.push(setTimeout(this.hideEffect.bind(this,this.fxTren),3E3))},playEffectDuoi:function(a){this.fxDuoi.setVisible(!0);this.listTimeOut.push(setTimeout(this.hideEffect.bind(this,this.fxDuoi),3E3))},playEffectNhanThuong:function(a){a=a.getUserData();a="+"+Utilities.Coin(a.CoinWinLose).toString();this.fxNhanThuong.setString(a);this.fxNhanThuong.setVisible(!0);this.fxNhanThuong.runAction(cc.sequence(cc.spawn(cc.fadeIn(.5),
cc.moveBy(.5,cc.p(0,MGTrenDuoiCompoEffect.DISTANCE_NHAN_TIEN))),cc.delayTime(1),cc.fadeOut(.5),cc.callFunc(function(){this.fxNhanThuong.setVisible(!1)}.bind(this)),cc.moveBy(.01,cc.p(0,-MGTrenDuoiCompoEffect.DISTANCE_NHAN_TIEN))))},playEffectDice:function(a){var b=a.getUserData();this.runAction(cc.sequence(cc.callFunc(function(){this.fxDice.setAnimation(0,"Shaking",!1);this.fxDice.setVisible(!0)}.bind(this)),cc.delayTime(1.2),cc.callFunc(function(){this.fxDice.setVisible(!1);this.showDice(b)}.bind(this))))},
hideEffect:function(a){a.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this.listTimeOut.length;a++)this.listTimeOut[a]&&clearTimeout(this.listTimeOut[a])},resetDice:function(){for(var a=0;3>a;a++)this.listDice[a].setVisible(!1)},showDice:function(a){for(var b=0;b<a.length;b++)this.listDice[b].setSpriteFrame("DiceTD"+a[b].toString()+".png"),this.listDice[b].setVisible(!0)}});
MGTrenDuoiCompoEffect.EVENT={FX_THANG:"fxThang",FX_THUA:"fxThua",FX_HOA:"fxHoa",FX_DICE:"fxDice",FX_TREN:"fxTren",FX_DUOI:"fxDuoi",FX_NHAN_TIEN:"fxNhanTien"};MGTrenDuoiCompoEffect.DISTANCE_NHAN_TIEN=80;var MGTrenDuoi=MGBaseGame.extend({netSend:null,compoButtonBet:null,compoButtonSupport:null,compoChat:null,compoHistory:null,compoHub:null,compoInfo:null,compoTopWin:null,compoAnalytics:null,compoEffect:null,_gap:null,_move:!1,_nodePos:null,listCompo:[],_isTai:!1,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameTrenDuoi},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.listCompo=[];this.initUI();this.netSend=new MGNetSendTrenDuoi;this.initCompoButtonBet();
this.initCompoHub();this.initCompoButtonSupport();this.initCompoEffect();this._isTai=!1;var a=new cc.Sprite;a.setSpriteFrame("duoi.png");a.setPosition(this._mainLayer.getChildByName("MGTextDuoi").getPosition());this.addChild(a);a=new cc.Sprite;a.setSpriteFrame("tren.png");a.setPosition(this._mainLayer.getChildByName("MGTextTren").getPosition());this.addChild(a);this.initCompoAnalytics();this.initCompoChat();this.initCompoHistory();this.initCompoInfo();this.initCompoTopWin();this.initEvent()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameTrenDuoi.UITrenDuoiLayer,
PreLoaderConfig.PathToResourceDefault);this._mainLayer.getChildByName("MGTaiXiuBackground").addTouchEventListener(this.onTouchGameFromCocostudio.bind(this),this);this._mainLayer.getChildByName("MGTaiXiuBackground").setTouchEnabled(!0);this._mainLayer.getChildByName("MGTaiXiuBackground").setSwallowTouches(!0);this._nodePos=this._mainLayer.getChildByName("MGTaiXiuBackground").getPosition()},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.GameData.toString(),
this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.Result.toString(),this.ngResult.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.AddBet.toString(),this.ngAddBet.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.ResultHistory.toString(),
this.ngResultHistory.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_TAIXIU.EndMatch.toString(),this.ngEndMatch.bind(this)))},initCompoEffect:function(){this.compoEffect=new MGTrenDuoiCompoEffect;this.compoEffect.cloneFromNode(this._mainLayer.getChildByName("MGCompoEffect"));this.compoEffect.initObj(this);this.addChild(this.compoEffect);this.listCompo.push(this.compoEffect)},initCompoButtonBet:function(){this.compoButtonBet=new MGTrenDuoiButtonBet;
this.compoButtonBet.cloneFromNode(this._mainLayer.getChildByName("MGCompoButtonBet"));this.compoButtonBet.initObj(this);this.addChild(this.compoButtonBet);this.listCompo.push(this.compoButtonBet)},initCompoButtonSupport:function(){this.compoButtonSupport=new MGTrenDuoiButtonSupport;this.compoButtonSupport.cloneFromNode(this._mainLayer.getChildByName("MGCompoButtonSupport"));this.compoButtonSupport.initObj(this);this.addChild(this.compoButtonSupport);this.listCompo.push(this.compoButtonSupport)},initCompoChat:function(){this.compoChat=
new MGTrenDuoiCompoChat;this.compoChat.cloneFromNode(this._mainLayer.getChildByName("MGCompoChat"));this.compoChat.initObj(this);this.addChild(this.compoChat);this.listCompo.push(this.compoChat)},initCompoHistory:function(){this.compoHistory=new MGTrenDuoiCompoHistory;this.compoHistory.cloneFromNode(this._mainLayer.getChildByName("MGCompoHistory"));this.compoHistory.initObj(this);this.addChild(this.compoHistory);this.listCompo.push(this.compoHistory)},initCompoHub:function(){this.compoHub=new MGTrenDuoiCompoHub;
this.compoHub.cloneFromNode(this._mainLayer.getChildByName("MGCompoHub"));this.compoHub.initObj(this);this.addChild(this.compoHub);this.listCompo.push(this.compoHub)},initCompoInfo:function(){this.compoInfo=new MGTrenDuoiCompoInfo;this.compoInfo.cloneFromNode(this._mainLayer.getChildByName("MGCompoInfo"));this.compoInfo.initObj(this);this.addChild(this.compoInfo);this.listCompo.push(this.compoInfo)},initCompoTopWin:function(){this.compoTopWin=new MGTrenDuoiCompoTopWin;this.compoTopWin.cloneFromNode(this._mainLayer.getChildByName("MGCompoTopWin"));
this.compoTopWin.initObj(this);this.addChild(this.compoTopWin);this.listCompo.push(this.compoTopWin)},initCompoAnalytics:function(){this.compoAnalytics=new MGTrenDuoiCompoAnalytics;this.compoAnalytics.cloneFromNode(this._mainLayer.getChildByName("MGCompoAnalytics"));this.compoAnalytics.initObj(this);this.addChild(this.compoAnalytics);this.listCompo.push(this.compoAnalytics)},showCompoButtonBet:function(a){this.compoButtonBet.setVisible(a)},showCompoChat:function(a){this.compoChat.setVisible(a)},showCompoHistory:function(a){this.compoHistory.setVisible(a)},
showCompoInfo:function(a){this.compoInfo.setVisible(a)},showCompoTopWin:function(a){this.compoTopWin.setVisible(a)},showCompoAnalytics:function(a){this.compoAnalytics.setVisible(a)},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={timeBet:b.UInt16,timeShake:b.UInt16,MinCoin:b.UInt64,MaxCoin:b.UInt64,matchID:b.UInt32,timeNotBet:b.UInt16};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngStartGame "+JSON.stringify(a));MGGameBoardTrenDuoi.onStartGame(a);this.compoButtonSupport.setEnableButtonBet(!0);
this.compoHub.startNewGame(MGGameBoardTrenDuoi.MatchID,MGGameBoardTrenDuoi.TimeBet);this.compoEffect.resetDice();this._isTai=!1},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={DeskID:b.UInt64,Status:b.UInt8,TimeRemain:b.UInt16,TotalUserBetTai:b.UInt64,TotalUserBetXiu:b.UInt64,TotalBettingTai:b.UInt64,TotalBettingXiu:b.UInt64,MaxCoin:b.UInt64,MinCoin:b.UInt64,UserCoin:b.UInt64,MatchID:b.UInt32,UserID:b.UInt32,RatioBetting:b.Array8,RatioBetting_Type:b.UInt32};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("ngGameData "+JSON.stringify(a));this.compoHub.onGameData(a);a.Status==ConstantsVariable.STATE_MINIGAME_TAIXIU.WAITING_BET_TIME_OUT&&(this.compoButtonSupport.setEnableButtonBet(!0),MGGameBoardTrenDuoi.MatchID===a.MatchID?(0<MGGameBoardTrenDuoi.myInfo.Bet.Tai&&(this.compoButtonSupport.updateBetValue(MGGameBoardTrenDuoi.Type.TAI),MGGameBoardTrenDuoi.myInfo.CurentBet=MGGameBoardTrenDuoi.Type.TAI,this.showCompoButtonBet(!0)),0<MGGameBoardTrenDuoi.myInfo.Bet.Xiu&&(this.compoButtonSupport.updateBetValue(MGGameBoardTrenDuoi.Type.XIU),
MGGameBoardTrenDuoi.myInfo.CurentBet=MGGameBoardTrenDuoi.Type.XIU,this.showCompoButtonBet(!0))):(MGGameBoardTrenDuoi.myInfo.Type.Tai=MGGameBoardTrenDuoi.myInfo.Type.Xiu=MGGameBoardTrenDuoi.myInfo.CurentBet=MGGameBoardTrenDuoi.Type.NOT_BET,MGGameBoardTrenDuoi.myInfo.Bet.Xiu=MGGameBoardTrenDuoi.myInfo.Bet.Tai=0));MGGameBoardTrenDuoi.onGameData(a);this.compoButtonBet.setBetValue()},ngAddBet:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,ListCuoc:b.Array8,ListCuoc_Type:b.Object8,
ListCuoc_Type_Struct:{CuocID:b.UInt8,CoinBet:b.UInt64},Coin:b.UInt64,TotalUserBetTai:b.UInt64,TotalUserBetXiu:b.UInt64,TotalBettingTai:b.UInt64,TotalBettingXiu:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngAddBet "+JSON.stringify(a));MGGameInfo.myInfo.UserID===a.UserID&&(MGGameBoardTrenDuoi.UserCoin=a.Coin);this.compoHub.setDisplayInfo(a);this.compoButtonSupport.onAddBet(a)},ngResult:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={result:b.StringDynamic,
md5:b.StringDynamic,key:b.StringDynamic,countdown:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResult "+JSON.stringify(a));MGGameBoardTrenDuoi.CountDownNextBet=a.countdown-MGGameBoardTrenDuoi.TimeShake;this.compoHub.setBetCountdown(0);cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_DICE,this.parseResult(a));this.scheduleOnce(this._showResult.bind(this,this.parseResult(a)),MGGameBoardTrenDuoi.TimeShake,"mainLayerScheduleShowResult")},parseResult:function(a){a=
a.result.split(",");for(var b=[],d=0;d<a.length;d++){var e=Number(a[d]);Number.isNaN(e)||b.push(e)}return b},ngResultHistory:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ResultHistory:b.Array8,ResultHistory_Type:b.Object8,ResultHistory_Type_Struct:{StatisticCommon:b.Array8,StatisticCommon_Type:b.Object8,StatisticCommon_Type_Struct:{numTai:b.UInt16,numXiu:b.UInt16,numBao:b.UInt16,percentOne:b.UInt16,percentTwo:b.UInt16,percentThree:b.UInt16,percentFour:b.UInt16,percentFive:b.UInt16,
percentSix:b.UInt16},SixMatch:b.Array8,SixMatch_Type:b.Object8,SixMatch_Type_Struct:{matchID:b.UInt32,result:b.Array8,result_Type:b.UInt8}}},d=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultHistory"+JSON.stringify(d));for(var b=[],e=d.ResultHistory[0].SixMatch.length-1;0<=e;e--)a=d.ResultHistory[0].SixMatch[e],b.push(a);for(e=0;e<b.length;e++)a=b[e].result,d=a[0]+a[1]+a[2],this.compoHub.setTaiXiuNumber(d),this.compoAnalytics.updateLabelPhienInfo(b[e].matchID,a),MGGameBoardTrenDuoi.Status!=
ConstantsVariable.STATE_MINIGAME_TAIXIU.WAITING_BET_TIME_OUT&&this.compoEffect.showDice(a),10<d?this.compoHub.addListTaiXiu(MGGameBoardTrenDuoi.Type.TAI):this.compoHub.addListTaiXiu(MGGameBoardTrenDuoi.Type.XIU);this.compoAnalytics.addResultMatchList(b)},ngEndMatch:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ListResultId:b.Array8,ListResultId_Type:b.Int8,ListUser:b.Array8,ListUser_Type:b.Object8,ListUser_Type_Struct:{UserID:b.UInt32,CoinWinLose:b.Int64,CoinUser:b.UInt64,ListBetWin:b.Array8,
ListBetWin_Type:b.Int8},MatchID:b.UInt32,StatisticResult:b.StringDynamic};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngEndMatch: "+JSON.stringify(a));a=a.ListUser;for(b=0;b<a.length;b++)if(a[b].UserID==MGGameInfo.myInfo.UserID){MGGameBoardTrenDuoi.UserCoin=a[b].CoinUser;var d=!1;0<a[b].CoinWinLose?(d=!0,cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_THANG,null),cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_NHAN_TIEN,a[b])):0>a[b].CoinWinLose?
cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_THUA,null):0===a[b].CoinWinLose&&cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_HOA,null);this.getMyInfoHistory(d,a[b].CoinWinLose);break}},_showResult:function(a){var b=a[0]+a[1]+a[2];this.compoAnalytics.addResultMatch(a);this.compoAnalytics.updateLabelPhienInfo(MGGameBoardTrenDuoi.MatchID,a);this.compoHub.setTaiXiuNumber(b);this.compoHub.setNextBetCountdown(MGGameBoardTrenDuoi.CountDownNextBet);this.compoHub.setShowResultNumber(!0);
10<b?(this.compoHub.addListTaiXiu(MGGameBoardTrenDuoi.Type.TAI),cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_TREN,null),this._isTai=!0):(this.compoHub.addListTaiXiu(MGGameBoardTrenDuoi.Type.XIU),cc.eventManager.dispatchCustomEvent(MGTrenDuoiCompoEffect.EVENT.FX_DUOI,null),this._isTai=!1)},getMyInfoHistory:function(a,b){var d={};d.Phien=MGGameBoardTrenDuoi.MatchID;d.Time=(new Date).getTime();d.CuaDat=MGGameBoardTrenDuoi.myInfo.Type;d.KetQua=a;d.TongDat=MGGameBoardTrenDuoi.myInfo.Bet.Tai+
MGGameBoardTrenDuoi.myInfo.Bet.Xiu;d.ThucNhan=0>b?0:0==this._isTai?b+MGGameBoardTrenDuoi.myInfo.Bet.Xiu:b+MGGameBoardTrenDuoi.myInfo.Bet.Tai;this.compoHistory.setMySessionInfo(d)},closeGame:function(){this.netSend.sendLeaveDesk()},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);MGGameBoardTrenDuoi.clearListBet();for(var a=0;a<this.listCompo.length;a++)this.listCompo[a]&&(this.listCompo[a].setDispose(),this.listCompo[a].removeFromParent(!0),this.listCompo[a]=null)},onExit:function(){MGBaseGame.prototype.onExit.call(this)},
onTouchGameFromCocostudio:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this._move=!1;var d=this.getParent().convertToNodeSpace(a.getTouchBeganPosition());this._gap=cc.p(this.getPosition().x+.5*cc.winSize.width-d.x,this.getPosition().y+.5*cc.winSize.height-d.y);break;case ccui.Widget.TOUCH_MOVED:this._move=!0;this.moveGameLayout(a);break;case ccui.Widget.TOUCH_ENDED:this.updatePosisionAfterMoved(a);break;case ccui.Widget.TOUCH_CANCELED:this.updatePosisionAfterMoved(a)}},moveGameLayout:function(a){a=
this.getParent().convertToNodeSpace(a.getTouchMovePosition());this.setPosition(a.x-.5*cc.winSize.width+this._gap.x,a.y-.5*cc.winSize.height+this._gap.y)},updatePosisionAfterMoved:function(a){if(this._move){this._move=!1;var b=this._mainLayer.getChildByName("MGTaiXiuBackground"),d=this.convertToWorldSpace(b.getPosition());a=d.y;var d=d.x,e=cc.winSize.height-this.getScaleY()*b.getContentSize().height*.5,f=this.getScaleY()*b.getContentSize().height*.5,g=cc.winSize.width-this.getScaleX()*b.getContentSize().width*
.5,b=this.getScaleX()*b.getContentSize().width*.5;a>e?a=e:a<f&&(a=f);d>g?d=g:d<b&&(d=b);a=this.getParent().convertToNodeSpace(cc.p(d,a));a.x-=this._nodePos.x;a.y-=this._nodePos.y;this.runAction(cc.moveTo(.1,a))}}});ResourceManager.MGResourcesGameDiamond777={MGBackGroundDiamond777:"res/game/diamond777/Background777.jpg",AtlasDiamond_plist:"res/game/diamond777/AtlasDiamond777/atlasDiamond777.plist",AtlasDiamond_png:"res/game/diamond777/AtlasDiamond777/atlasDiamond777.png",Font_fnt:"res/Fonts/Number-export.fnt",Font_png:"res/Fonts/Number-export.png",MGEffectWin_json:"res/game/diamond777/EffectDiamond777/thang_lon.json",MGEffectWin_atlas:"res/game/diamond777/EffectDiamond777/thang_lon.atlas",MGEffectWin_png:"res/game/diamond777/EffectDiamond777/thang_lon.png",
MGItemContainLS:"res/game/diamond777/UIItemContainLS.json",MGItemContainTL:"res/game/diamond777/UIItemContainThangLon.json",MGUIPopupLS:"res/game/diamond777/UIPopupLishSu.json",MGUIPopupTB:"res/game/diamond777/UIPopupThongBao.json",MGUIPopupTL:"res/game/diamond777/UIPopupThangLon.json",MGUILayerDiamond:"res/game/diamond777/UILayerDiamond777.json",CLICK:"res/game/diamond777/Sounds/click.mp3",CLICK_QUAY:"res/game/diamond777/Sounds/ClickQuay.mp3",DUNG_QUAY:"res/game/diamond777/Sounds/DungQuay.mp3",QUAY:"res/game/diamond777/Sounds/Quay.mp3",
THANG_LON:"res/game/diamond777/Sounds/Thang_Lon.mp3",THANG_THUONG:"res/game/diamond777/Sounds/Thang_Thuong.mp3",THUA:"res/game/diamond777/Sounds/Thua.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesGameDiamond777=[];for(i in ResourceManager.MGResourcesGameDiamond777)ResourceManager.MGResourcesGameDiamond777[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameDiamond777[i],resourcesGameDiamond777.push(ResourceManager.MGResourcesGameDiamond777[i]);ConstantsVariable.EVENTS_DIAMOND777={GET_BET:"GET_BET",GET_QUAY:"GET_QUAY",GET_THONGBAO:"GET_THONGBAO",GET_LICHSU:"GET_LICHSU",GET_BXH:"GET_BXH",GET_TU_QUAY:"GET_TU_QUAY",FINISH_QUAY:"FINISH_QUAY",HIDE_EFFECT:"HIDE_EFFECT",SUB_LINE:"SUB_LINE",ADD_LINE:"ADD_LINE"};
ConstantsVariable.IMAGE_ELEMENT={1:{IMAGE777:"Image7.png",IMAGE777_BLUR:"Image7_Blur.png",IMAGE_SMALL:"Image7_Small.png"},2:{IMAGE777:"ImageDiamond.png",IMAGE777_BLUR:"ImageDiamond_Blur.png",IMAGE_SMALL:"ImageDiamond_Small.png"},3:{IMAGE777:"Image3Bar.png",IMAGE777_BLUR:"Image3Bar_Blur.png",IMAGE_SMALL:"Image3Bar_Small.png"},4:{IMAGE777:"Image2Bar.png",IMAGE777_BLUR:"Image2Bar_Blur.png",IMAGE_SMALL:"Image2Bar_Small.png"},5:{IMAGE777:"Image1Bar.png",IMAGE777_BLUR:"Image1Bar_Blur.png",IMAGE_SMALL:"Image1Bar_Small.png"},
6:{IMAGE777:"ImageChuong.png",IMAGE777_BLUR:"ImageChuong_Blur.png",IMAGE_SMALL:"ImageChuong_Small.png"},7:{IMAGE777:"ImageEmpty.png",IMAGE777_BLUR:"ImageEmpty_Blur.png",IMAGE_SMALL:"ImageEmpty_Small.png"}};var MGNetSendDiamond777=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBet:function(a,b){Utilities.showLog("--Send Bet");var d={};d.lineUserBet=a;d.Coin=b;d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_DIAMOND777.Turning,{lineUserBet:BinaryConstants.DataTypeID.Array8,lineUserBet_Type:BinaryConstants.DataTypeID.UInt8,Coin:BinaryConstants.DataTypeID.UInt64},d);MGNetCore.MGSocket.sendMsg(d)},sendToolResult777:function(a){Utilities.showLog("Tool Result");var b={};b.ArrIcon=
a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_DIAMOND777.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});ConstantsVariable.NETWORK_DIAMOND777={Turning:2600,PerformTurning:2601,StartGame:2602,UserLeftDesk:2603,ListUser:2604,GameData:2605,ToolResult:2616,BigWin:2617,TopBigWin:2618};var MGComboBet=MGBaseNode.extend({_comboBet:null,_betCuoc:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._comboBet=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBet();this._initBet10()},_initBet:function(){for(var a=0;6>a;a++)this._comboBet[a]=this.getChildByName("MGButtonBet"+a),this._comboBet[a].setTag("40"+a),this._comboBet[a].addClickEventListener(this._selectBet.bind(this))},_initBet10:function(){this.getDisabledAllBet();this._comboBet[0].setEnabled(!1)},
_selectBet:function(a){this.getDisabledAllBet();a.setEnabled(!1);this._betCuoc=a.mucCuoc;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.GET_BET,this._betCuoc);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},getDisabledAllBet:function(){for(var a=0;a<this._comboBet.length;a++)this._comboBet[a].setEnabled(!0)},getMucCuoc:function(a){for(var b=0;b<this._comboBet.length;b++)if(this._comboBet[b].mucCuoc=a[b],1E3<=a[b]){var d=a[b]/1E3;
this._comboBet[b].getChildByName("MGTextTien").setString(d+"K")}else this._comboBet[b].getChildByName("MGTextTien").setString(a[b])}});var MGComboLine777=MGBaseNode.extend({_comboLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._comboLine=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);for(var a=0;3>a;a++){var b=this.getChildByName("MGLine"+a);b.setVisible(!1);this._comboLine.push(b)}this._comboLine[0].setVisible(!0)},hideAllLine:function(){for(var a=0;a<this._comboLine.length;a++)this._comboLine[a].setVisible(!1)},showLineSelect:function(a){this.hideAllLine();for(var b=0;b<a;b++)this._comboLine[b].setVisible(!0)},
showEffectWinLine:function(a){for(var b=0;b<a.length;b++)0<a[b]&&(this._comboLine[b].setVisible(!0),this._comboLine[b].runAction(cc.sequence(cc.sequence(cc.fadeIn(.5),cc.fadeOut(.5)).repeat(20),cc.callFunc(this.hideEffectWinLine.bind(this)))))},hideEffectWinLine:function(){for(var a=0;a<this._comboLine.length;a++)this._comboLine[a].setOpacity(255),this._comboLine[a].stopAllActions();this.hideAllLine()}});var MGComboButton=MGBaseNode.extend({_comboButton:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._comboButton=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initUI()},_initUI:function(){var a=null,a=this.getChildByName("MGButtonQuay");a.addClickEventListener(this._callQuay.bind(this));this._comboButton.push(a);a=this.getChildByName("MGButtonThongBao");a.addClickEventListener(this._callThongBao.bind(this));this._comboButton.push(a);a=this.getChildByName("MGButtonLichSu");
a.addClickEventListener(this._callLichSu.bind(this));this._comboButton.push(a);a=this.getChildByName("MGButtonBXH");a.addClickEventListener(this._callBXH.bind(this));this._comboButton.push(a);a=this.getChildByName("MGButtonCheckTuQuay");a.addClickEventListener(this._getTuQuay.bind(this));a.getChildByName("MGImageCheck").setVisible(!1);this._comboButton.push(a)},_callQuay:function(a){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.GET_QUAY,null);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK_QUAY,
MGGameInfo.gameVolume)},_callThongBao:function(a){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.GET_THONGBAO,null);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},_callLichSu:function(a){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.GET_LICHSU,null);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},_callBXH:function(a){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.GET_BXH,
null);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},_getTuQuay:function(a){var b=null;a.getChildByName("MGImageCheck").isVisible()?(a.getChildByName("MGImageCheck").setVisible(!1),b=!1):(a.getChildByName("MGImageCheck").setVisible(!0),b=!0);cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.GET_TU_QUAY,b);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},enbleButtonQuay:function(){this._comboButton[0].setEnabled(!0);
this._comboButton[0].setTouchEnabled(!0)},disEnbleButtonQuay:function(){this._comboButton[0].setEnabled(!1);this._comboButton[0].setTouchEnabled(!1)}});var MGContainElement=MGBaseNode.extend({listImage:null,_valueListImage:null,_countCallBack:null,delayLine:null,_result:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listImage=[];this._countCallBack=0;this._valueListImage=[];this._result=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initIcon()},_initIcon:function(){for(var a=null,b=null,d=0;6>d;d++)b=parseInt(6*Math.random())+1,a=this.getChildByName("MGImage"+d),a.setSpriteFrame(ConstantsVariable.IMAGE_ELEMENT[b].IMAGE777),
this.listImage.push(a)},loadImage:function(){for(var a=0;6>a;a++)this.listImage[a].setVisible(!0),this.listImage[a].setSpriteFrame(ConstantsVariable.IMAGE_ELEMENT[this._valueListImage[a]].IMAGE777)},_loadImageBlur:function(){for(var a=0;6>a;a++)this.listImage[a].setSpriteFrame(ConstantsVariable.IMAGE_ELEMENT[this._valueListImage[a]].IMAGE777_BLUR)},setValueElement:function(a){for(var b=0;b<a.length;b++)this._valueListImage[b+1]=a[b];a=null;for(b=4;6>b;b++)a=parseInt(6*Math.random())+1,this._valueListImage[b]=
a;a=parseInt(6*Math.random())+1;this._valueListImage[0]=a},moveContainElement:function(){this._countCallBack++;var a=this.getPosition();-300>=a.y&&this.setPosition(a.x,-73);var a=this.getPosition(),b=null,d=b=null;1===this._countCallBack?(b=new cc.JumpBy(.3,cc.p(0,30),0,0),d=new cc.JumpBy(.01,cc.p(0,-30),0,0),b=cc.sequence(cc.delayTime(.8*this.delayLine),b,d,cc.callFunc(this.moveContainElement.bind(this)))):2<=this._countCallBack&&5>this._countCallBack?(2===this._countCallBack&&this._loadImageBlur(),
b=cc.sequence(cc.moveTo(.01,cc.p(a.x,a.y-60)),cc.callFunc(this.moveContainElement.bind(this)))):25>=this._countCallBack?b=cc.sequence(cc.moveTo(.009,cc.p(a.x,a.y-60)),cc.callFunc(this.moveContainElement.bind(this))):(this.loadImage(),b=new cc.JumpBy(.001,cc.p(0,-25),0,0),d=new cc.JumpBy(.3,cc.p(0,25),0,0),2===this.delayLine?(b=cc.sequence(b,d,cc.delayTime(.5),cc.callFunc(this._finishQuay.bind(this)),cc.delayTime(4),cc.callFunc(this._getCallStartGame.bind(this))),mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.DUNG_QUAY,
MGGameInfo.gameVolume)):b=cc.sequence(b,d),this._countCallBack=0,this.setPosition(a.x,-73));this.runAction(b)},_getCallStartGame:function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.HIDE_EFFECT,null)},_finishQuay:function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.FINISH_QUAY,null)},showEffect:function(a){this.listImage[a].runAction(cc.sequence(cc.sequence(cc.scaleTo(.5,1.2,1.2),cc.scaleTo(.5,1,1)).repeat(20),cc.callFunc(this.hideEffect.bind(this))))},
hideEffect:function(){for(var a=0;a<this.listImage.length;a++)this.listImage[a].stopAllActions(),this.listImage[a].runAction(cc.scaleTo(0,1,1))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.unscheduleAllCallbacks()}});var MGComboElement=MGBaseNode.extend({_listColumn:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._listColumn=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initListImage()},_initListImage:function(){for(var a=null,b=this.getChildByName("MGPanelColum"),d=0;3>d;d++)a=new MGContainElement,a.cloneFromNode(b.getChildByName("MGColumn"+(d+1))),a.initObj(),b.addChild(a),this._listColumn.push(a);b.removeFromParent(!0);this.addChild(b)},moveAllCombo:function(){for(var a=
0;3>a;a++)this._listColumn[a].delayLine=a,this._listColumn[a].moveContainElement();mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.QUAY,MGGameInfo.gameVolume)},getComboElement:function(a){for(var b=0;b<this._listColumn.length;b++)this._listColumn[b].setValueElement(this._getValueArr(a,b))},_getValueArr:function(a,b){for(var d=[],e=0;3>e;e++)d[e]=a[b][e];return d},showEffectWinElement:function(a){for(var b=0;b<a.length;b++)if(0<a[b])for(var d=0;d<this._listColumn.length;d++)0==b?this._listColumn[d].showEffect(2):
1==b?this._listColumn[d].showEffect(1):this._listColumn[d].showEffect(3)},hideAllEffect:function(){for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].hideEffect()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].setDispose(),this._listColumn[a].removeFromParent(!0)}});var MGTextThang=MGBaseNode.extend({_textThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._textThang=this.getChildByName("MGTextTienThang")},setTienThang:function(a,b){this._textThang.setString(Utilities.Coin(a));100>a?this.setPosition(b.x+60,b.y):100<=a&&1E3>a?this.setPosition(b.x+50,b.y):1E3<=a&&1E4>a?this.setPosition(b.x+30,b.y):1E4<=a&&1E5>a?this.setPosition(b.x+20,b.y):1E5<=a&&1E6>a?this.setPosition(b.x+10,b.y):1E8<=
a&&2E9>a?this.setPosition(b.x-35,b.y):this.setPosition(b.x,b.y);this.showTextTienThang()},showTextTienThang:function(){this.setVisible(!0)},hideTextTienThang:function(){this.setVisible(!1)}});var MGComboSelectLine777=MGBaseNode.extend({_buttonSub:null,_buttonAdd:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._buttonSub=this.getChildByName("MGButtonSelect0");this._buttonAdd=this.getChildByName("MGButtonSelect1");this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._buttonSub.addClickEventListener(this.getSubLine.bind(this));this._buttonAdd.addClickEventListener(this.getAddLine.bind(this))},
getSubLine:function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.SUB_LINE,null);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},getAddLine:function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS_DIAMOND777.ADD_LINE,null);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},enbleComboButton:function(){this._buttonAdd.setTouchEnabled(!0);this._buttonSub.setTouchEnabled(!0)},
disEnbleComboButton:function(){this._buttonAdd.setTouchEnabled(!1);this._buttonSub.setTouchEnabled(!1)}});var MGComboEffect=MGBaseNode.extend({_effectTextThang:null,_effectThang:null,effectWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initEffectThang();this._initEffectTextThang();this.initEffectWin()},_initEffectTextThang:function(){this._effectTextThang=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameDiamond777.Font_fnt);this._effectTextThang.setVisible(!1);this._effectTextThang.setPosition(810,350);
this.addChild(this._effectTextThang)},_initEffectThang:function(){this._effectThang=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameDiamond777.MGEffectWin_json,ResourceManager.MGResourcesGameDiamond777.MGEffectWin_atlas);this._effectThang.setPosition(800,420);this._effectThang.setVisible(!1);this.addChild(this._effectThang)},initEffectWin:function(){this.effectWin=new MGComboEffectWinCoinXeng;this.effectWin.initObj();this.addChild(this.effectWin);this.effectWin.setPosition(797,600);this.effectWin.setProties(180,
.8,80)},showEffectThangLon:function(a){this._effectTextThang.setVisible(!0);this._effectTextThang.setString("+"+Utilities.Coin(a));this._effectTextThang.runAction(cc.sequence(cc.sequence(cc.jumpBy(.1,cc.p(0,20),0,0),cc.jumpBy(.1,cc.p(0,-20),0,0),cc.jumpBy(.1,cc.p(0,20),0,0),cc.jumpBy(.1,cc.p(0,-20),0,0),cc.delayTime(.3)).repeat(6),cc.callFunc(this.hideEffect.bind(this))));this._effectThang.setVisible(!0);this._effectThang.setAnimation(0,"thang_lon",!0)},hideEffect:function(){this.effectWin.stopAnimationWin();
this._effectTextThang.setVisible(!1);this._effectTextThang.stopAllActions();this._effectTextThang.setPosition(810,350);this._effectThang.setVisible(!1)}});var MGContainTextLS=MGBaseNode.extend({containLS:null,_textPhien:null,_textThoiGian:null,_textCuoc:null,_textDongTrung:null,_textTienTrung:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDiamond777.MGItemContainLS,PreLoaderConfig.PathToResourceDefault).node);this.containLS=this.getChildByName("MGBackGroundTitle");this._textPhien=this.containLS.getChildByName("TextPhien");
this._textPhien.ignoreContentAdaptWithSize(!0);this._textThoiGian=this.containLS.getChildByName("TextThoiGianCuoc");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textCuoc=this.containLS.getChildByName("TextCuoc");this._textCuoc.ignoreContentAdaptWithSize(!0);this._textDongTrung=this.containLS.getChildByName("TextDongTrung");this._textDongTrung.ignoreContentAdaptWithSize(!0);this._textTienTrung=this.containLS.getChildByName("TextTienTrung");this._textTienTrung.ignoreContentAdaptWithSize(!0)},
getContainLS:function(a,b,d,e,f){this._textPhien.setString(a);this._getThoiGian(b);this._textCuoc.setString(Utilities.Coin(d));this._getDongTrung(e);this._textTienTrung.setString(Utilities.Coin(f))},_getThoiGian:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+a.getSeconds(),d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?a.getHours():"0"+a.getHours();this._textThoiGian.setString(e+":"+d+":"+b+"  "+a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear())},
_getDongTrung:function(a){for(var b=[],d=0;d<a.length;d++)0<a[d]&&b.push(d+1);0==b.length&&b.push(0);this._textDongTrung.setString(b.toString())}});var MGPopupLichSu=MGBaseNode.extend({_listLichSu:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDiamond777.MGUIPopupLS,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("MGListLichSu")},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(2E3,2E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);
a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButtonCloseLS").addClickEventListener(this.hidePopup.bind(this))},getContainLichSu:function(a,b,d,e,f){var g=new MGContainTextLS;g.initObj();g.getContainLS(a,b,d,e,f);g.containLS.removeFromParent(!0);this._listLichSu.insertCustomItem(g.containLS,0);this._showListLichSu()},_showListLichSu:function(){this._listLichSu.getItems().length>=
MGPopupLichSu.MAX_LINE&&this._listLichSu.removeItem(MGPopupLichSu.MAX_LINE-1)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},showPopup:function(){this.setVisible(!0)}});MGPopupLichSu.MAX_LINE=100;var MGContainTextThangLon=MGBaseNode.extend({containThangLon:null,_textSTT:null,_textMaTK:null,_textTenHienThi:null,_ketQua:null,_tienThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDiamond777.MGItemContainTL,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("MGBackGroundTitle");this._textSTT=this.containThangLon.getChildByName("TextSTT");
this._textSTT.ignoreContentAdaptWithSize(!0);this._textMaTK=this.containThangLon.getChildByName("TextMaTK");this._textMaTK.ignoreContentAdaptWithSize(!0);this._textTenHienThi=this.containThangLon.getChildByName("TextTenHienThi");this._textTenHienThi.ignoreContentAdaptWithSize(!0);this._tienThang=this.containThangLon.getChildByName("TextTienThang");this._tienThang.ignoreContentAdaptWithSize(!0)},getContainThangLon:function(a,b,d,e){this._textMaTK.setString(a);this._textTenHienThi.setString(b);this._tienThang.setString(Utilities.Coin(e));
this._getKetQua(d)},getSTT:function(a){this._textSTT.setString(a)},_getKetQua:function(a){a=a.split(",");for(var b=0;3>b;b++)this.containThangLon.getChildByName("Image"+b).setSpriteFrame(ConstantsVariable.IMAGE_ELEMENT[a[b]].IMAGE_SMALL)}});var MGPopupThangLon=MGBaseNode.extend({_dataThangLon:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._dataThangLon=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDiamond777.MGUIPopupTL,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listThangLon=this.getChildByName("MGListThangLon")},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(2E3,2E3);a.setAnchorPoint(.5,
.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButtonCloseTL").addClickEventListener(this.hidePopup.bind(this))},getListDataThangLon:function(a){for(var b=a.length<MGPopupThangLon.MAX_LINE?a.length:MGPopupThangLon.MAX_LINE,d=0;d<b;d++){var e=new MGContainTextThangLon;e.initObj();
e.getContainThangLon(a[d].UserID,a[d].NickName,a[d].Type,a[d].EarnCoin);e.containThangLon.removeFromParent(!0);this._dataThangLon.push(e);this._listThangLon.addChild(e.containThangLon)}this.getSTTListData()},getSTTListData:function(){for(var a=0;a<this._dataThangLon.length;a++)this._dataThangLon[a].getSTT(a+1)},getDataThangLon:function(a){var b=new MGContainTextThangLon;b.initObj();b.getContainThangLon(a.UserID,a.NickName,a.Type,a.EarnCoin);b.containThangLon.removeFromParent(!0);this._dataThangLon.splice(0,
0,b);this._listThangLon.insertCustomItem(b.containThangLon,0);this._listThangLon.getItems().length>MGPopupThangLon.MAX_LINE&&(this._listThangLon.removeItem(MGPopupThangLon.MAX_LINE),this._dataThangLon.splice(this._dataThangLon.length-1,1));this.getSTTListData()},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},showPopup:function(){this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);
this._listThangLon.removeAllChildren(!0);this._dataThangLon.splice(0,this._dataThangLon.length);this._dataThangLon=[]}});MGPopupThangLon.MAX_LINE=50;var MGPopupThongBao777=MGBaseNode.extend({listView:null,maxLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDiamond777.MGUIPopupTB,PreLoaderConfig.PathToResourceDefault).node);this.listView=this.getChildByName("MGListThongBao");this._initEventsGame();this.maxLine=100},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(2E3,2E3);a.setAnchorPoint(.5,
.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButtonClosePopup").addClickEventListener(this.hidePopup.bind(this));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=a.getUserData();
this.listView.getItems().length>=this.maxLine&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",13,cc.color.WHITE,!0,430);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()},showPopup:function(){this.setVisible(!0)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.CLICK,MGGameInfo.gameVolume)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGDiamonds777=MGBaseGame.extend({_comboBet:null,_comboElement:null,_mucCuoc:10,_dongCuoc:1,_comboLine:[],_buttonQuay:null,_tongTien:null,_matchID:null,_comboButton:null,_tuQuay:!1,_isTuQuay:!1,_popupLichSu:null,_popupThongBao:null,_popupThangLon:null,_coinWin:0,_lineWin:[],_textThang:null,_thoiGian:null,_comboSelectLine:null,_comboEffect:null,_comboMatchID:null,_compoTongTK:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameDiamond777},initObj:function(){MGBaseGame.prototype.initObj.call(this);
this.netSend=new MGNetSendDiamond777;this._initUI();this._initComboBet();this._initComboElement();this._initDongCuoc();this._initComboLine();this._initComboButton();this._initTextThang();this._initPopupLichSu();this._initPopupThongBao();this._initPopupThangLon();this._initEffect();mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.SOUND_WELCOME)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameDiamond777.MGUILayerDiamond,PreLoaderConfig.PathToResourceDefault);
this._comboMatchID=this._mainLayer.getChildByName("MGComboMatchID");this._compoTongTK=this._mainLayer.getChildByName("MGComboTongTK");cc.sys.isNative&&(this._comboMatchID.setPosition(this._mainLayer.getChildByName("MGComboMatchID_M").getPosition()),this._compoTongTK.setPosition(this._mainLayer.getChildByName("MGComboTongTK_M").getPosition()))},_changeBackGround:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameDiamond777.MGBackGroundDiamond777;
cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)}},_initComboBet:function(){this._comboBet=new MGComboBet;this._comboBet.cloneFromNode(this._mainLayer.getChildByName("MGComboBet"));this._comboBet.initObj();this.addChild(this._comboBet)},_initComboElement:function(){this._comboElement=new MGComboElement;this._comboElement.cloneFromNode(this._mainLayer.getChildByName("MGNodeElement"));this._comboElement.initObj();this.addChild(this._comboElement)},_initDongCuoc:function(){this._comboSelectLine=
new MGComboSelectLine777;this._comboSelectLine.cloneFromNode(this._mainLayer.getChildByName("MGNodeSelectLine"));this._comboSelectLine.initObj();this.addChild(this._comboSelectLine);this._mainLayer.getChildByName("MGTextCuoc").setString(Utilities.Coin(this._dongCuoc*this._mucCuoc));this._mainLayer.getChildByName("MGTextThang").setString("0")},_initComboLine:function(){this._comboLine=new MGComboLine777;this._comboLine.cloneFromNode(this._mainLayer.getChildByName("MGNodeComboLine"));this._comboLine.initObj();
this._comboLine.hideAllLine();this._comboLine.showLineSelect(this._dongCuoc);this.addChild(this._comboLine)},_initComboButton:function(){this._comboButton=new MGComboButton;this._comboButton.cloneFromNode(this._mainLayer.getChildByName("MGNodeComboButton"));this._comboButton.initObj();this.addChild(this._comboButton)},_initPopupLichSu:function(){this._popupLichSu=new MGPopupLichSu;this._popupLichSu.initObj();this._popupLichSu.setVisible(!1);this._popupLichSu.setPosition(this._mainLayer.getChildByName("MGNodePopup").getPosition());
this.addChild(this._popupLichSu)},_initPopupThongBao:function(){this._popupThongBao=new MGPopupThongBao777;this._popupThongBao.initObj();this._popupThongBao.setVisible(!1);this._popupThongBao.setPosition(this._mainLayer.getChildByName("MGNodePopup").getPosition());this.addChild(this._popupThongBao)},_initPopupThangLon:function(){this._popupThangLon=new MGPopupThangLon;this._popupThangLon.initObj();this._popupThangLon.setVisible(!1);this._popupThangLon.setPosition(this._mainLayer.getChildByName("MGNodePopup").getPosition());
this.addChild(this._popupThangLon)},_initTextThang:function(){this._textThang=new MGTextThang;this._textThang.cloneFromNode(this._mainLayer.getChildByName("MGNodeTextThang"));this._textThang.initObj();this._textThang.hideTextTienThang();this.addChild(this._textThang)},_initEffect:function(){this._comboEffect=new MGComboEffect;this._comboEffect.initObj();this.addChild(this._comboEffect)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),
this.ngUserCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DIAMOND777.Turning.toString(),this._getTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DIAMOND777.PerformTurning.toString(),this._performTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DIAMOND777.StartGame.toString(),this._getStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DIAMOND777.GameData.toString(),
this._getGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DIAMOND777.BigWin.toString(),this._getBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DIAMOND777.TopBigWin.toString(),this._getTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.GET_BET.toString(),this.getBetCuoc.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.GET_QUAY.toString(),
this._sendBetServer.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.GET_LICHSU.toString(),this._showPopupLS.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.GET_THONGBAO.toString(),this._showPopupThongBao.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.GET_BXH.toString(),this._showPopupThangLon.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.GET_TU_QUAY.toString(),
this._getTuQuay.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.FINISH_QUAY.toString(),this._showEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.HIDE_EFFECT.toString(),this._finishEffect.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.SUB_LINE.toString(),this._giamDongCuoc.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS_DIAMOND777.ADD_LINE.toString(),
this._tangDongCuoc.bind(this)))},getBetCuoc:function(a){this._mucCuoc=a.getUserData();this._mainLayer.getChildByName("MGTextCuoc").setString(Utilities.Coin(this._dongCuoc*this._mucCuoc))},_giamDongCuoc:function(){1<this._dongCuoc&&(this._dongCuoc--,this._mainLayer.getChildByName("MGTextDongCuoc").setString(this._dongCuoc),this._mainLayer.getChildByName("MGTextCuoc").setString(Utilities.Coin(this._dongCuoc*this._mucCuoc)),this._comboLine.showLineSelect(this._dongCuoc))},_tangDongCuoc:function(){3>
this._dongCuoc&&(this._dongCuoc++,this._mainLayer.getChildByName("MGTextDongCuoc").setString(this._dongCuoc),this._mainLayer.getChildByName("MGTextCuoc").setString(Utilities.Coin(this._dongCuoc*this._mucCuoc)),this._comboLine.showLineSelect(this._dongCuoc))},_sendBetServer:function(){for(var a=[],b=0;b<this._dongCuoc;b++)a[b]=b+1;this.netSend.sendBet(a,this._mucCuoc)},_showPopupLS:function(){this._popupLichSu.showPopup()},_showPopupThongBao:function(){this._popupThongBao.showPopup()},_showPopupThangLon:function(){this._popupThangLon.showPopup()},
_getTuQuay:function(a){this._tuQuay=a.getUserData()},_hideInQuay:function(){this._comboSelectLine.disEnbleComboButton();this._comboButton.disEnbleButtonQuay();this._comboLine.hideAllLine()},_finishEffect:function(){},_showEffect:function(){this._mainLayer.getChildByName("MGTextThang").setString(Utilities.Coin(this._coinWin));if(1!=this._tuQuay)if(this._comboElement.showEffectWinElement(this._lineWin),this._comboLine.showEffectWinLine(this._lineWin),0<this._coinWin){this._comboEffect.effectWin.playAnimationWin(this._coinWin);
var a=this._mainLayer.getChildByName("MGPosTextThang").getPosition();this._textThang.setTienThang(this._coinWin,a);50<=this._coinWin/(this._dongCuoc*this._mucCuoc)?(this._comboEffect.showEffectThangLon(this._coinWin),mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.THANG_LON,MGGameInfo.gameVolume)):mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.THANG_THUONG,MGGameInfo.gameVolume)}else mg.audio.playEffect(ResourceManager.MGResourcesGameDiamond777.THUA,MGGameInfo.gameVolume)},
_getTextTien:function(a){this._tongTien=a;this._compoTongTK.getChildByName("MGTextTongTien").ignoreContentAdaptWithSize(!0);this._compoTongTK.getChildByName("MGTextTongTien").setString(Utilities.Coin(this._tongTien))},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);this._comboElement&&this._comboElement.setDispose();this._popupThongBao&&this._popupThongBao.setDispose();mg.audio.stopAllEffects(!0)},_getStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,
TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this._getTextTien(a.Coin);this._thoiGian&&this._popupLichSu.getContainLichSu(this._matchID,this._thoiGian,this._mucCuoc*this._dongCuoc,this._lineWin,this._coinWin);Utilities.showLog("--SG: "+JSON.stringify(a));this._matchID=a.MatchID;this._comboButton.enbleButtonQuay();this._comboSelectLine.enbleComboButton();1==this._tuQuay&&this._sendBetServer()},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};
a=(new BinaryParser).initObj(b,a.content);this._getTextTien(a.Gold)},_getGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListBet:b.Array8,ListBet_Type:b.UInt8,MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.Double};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--GD: "+JSON.stringify(a));this._getTextTien(a.CoinUser);this._matchID=a.MatchID;this._comboMatchID.getChildByName("TextMatchID").ignoreContentAdaptWithSize(!0);
this._comboMatchID.getChildByName("TextMatchID").setString("#"+this._matchID);this._comboBet.getMucCuoc(a.ListCoinCanBet);this._changeBackGround();1==a.Status?this._comboButton.enbleButtonQuay():this._comboButton.disEnbleButtonQuay()},_getTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,BetCoin:b.Int64,LineUserBet:b.Array8,LineUserBet_Type:b.UInt8,CoinWinBet:b.Int64,RateWinCoinListLineBet:b.Array8,RateWinCoinListLineBet_Type:b.Double,
TimerPerformTurning:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this._comboMatchID.getChildByName("TextMatchID").setString("#"+this._matchID);this._comboElement.hideAllEffect();this._comboElement.moveAllCombo();this._comboElement.getComboElement(a.ArrIcon);this._coinWin=a.CoinWinBet;this._hideInQuay();this._lineWin=a.RateWinCoinListLineBet;this._comboLine.hideEffectWinLine();this._textThang.hideTextTienThang();this._thoiGian=new Date;this._comboEffect.hideEffect();this._isTuQuay=this._tuQuay;
Utilities.showLog("--Turning: "+JSON.stringify(a))},_performTurning:function(a){},_getTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.StringDynamic,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--TopBigWin: "+JSON.stringify(a));this._popupThangLon.getListDataThangLon(a.dataBigWin)},
_getBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.StringDynamic,EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--BigWin: "+JSON.stringify(a));this._popupThangLon.getDataThangLon(a)}});ResourceManager.MGResourcesGameBAPD={BAPDBackgroundOutGame:"res/game/bianphuongdong/BAPDBackgroundOutGame.jpg",AtlasBAPD:"res/game/bianphuongdong/atlas/AtlasBAPD/AtlasBAPD.plist",AtlasItemsBAPD:"res/game/bianphuongdong/atlas/AtlasItem/AtlasItemsBAPD.plist",AtlasLineBAPD0:"res/game/bianphuongdong/atlas/AtlasLineBAPD/AtlasLineBAPD0.plist",AtlasLineBAPD1:"res/game/bianphuongdong/atlas/AtlasLineBAPD/AtlasLineBAPD1.plist",AtlasMiniGame:"res/game/bianphuongdong/atlas/AtlasMiniGame/AtlasMiniGameBAPD.plist",
BackgroundGameBAPD:"res/game/bianphuongdong/atlas/background/BackgroundGameBAPD.jpg",CCSUIBiAnPhuongDongLayer:"res/game/bianphuongdong/UIBiAnPhuongDongLayer.json",CCSUIMGBigWinBAPD:"res/game/bianphuongdong/UIMGBigWinBAPD.json",CCSUIMGButtonMiniGame:"res/game/bianphuongdong/UIMGButtonMiniGame.json",CCSUIMGCompoMiniGameBAPD:"res/game/bianphuongdong/UIMGCompoMiniGameBAPD.json",CCSUIMGPopupBigWinNode:"res/game/bianphuongdong/UIMGPopupBigWinNode.json",CCSUIMGPopupGameInfoNode:"res/game/bianphuongdong/UIMGPopupGameInfoNode.json",
CCSUIMGPopupNotifyNode:"res/game/bianphuongdong/UIMGPopupNotifyNode.json",CCSUIMGPopupHistoryNode:"res/game/bianphuongdong/UIMGPopupHistoryNode.json",CCSUIMGPopupMiniGameBAPD:"res/game/bianphuongdong/UIMGPopupMiniGameBAPD.json",CCSUIMGScrollNode:"res/game/bianphuongdong/UIMGScrollNode.json",BonusBox_Atlas:"res/game/bianphuongdong/EffectBAPD/NoHu_FX.atlas",BonusBox_PNG:"res/game/bianphuongdong/EffectBAPD/NoHu_FX.png",BonusBox_Json:"res/game/bianphuongdong/EffectBAPD/NoHu_FX.json",FXItem4_Atlas:"res/game/bianphuongdong/EffectBAPD/item1.atlas",
FXItem4_PNG:"res/game/bianphuongdong/EffectBAPD/item1.png",FXItem4_Json:"res/game/bianphuongdong/EffectBAPD/item1.json",FXItem2_Atlas:"res/game/bianphuongdong/EffectBAPD/item2.atlas",FXItem2_PNG:"res/game/bianphuongdong/EffectBAPD/item2.png",FXItem2_Json:"res/game/bianphuongdong/EffectBAPD/item2.json",FXItem3_Atlas:"res/game/bianphuongdong/EffectBAPD/item3.atlas",FXItem3_PNG:"res/game/bianphuongdong/EffectBAPD/item3.png",FXItem3_Json:"res/game/bianphuongdong/EffectBAPD/item3.json",FXItem6_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_den.atlas",
FXItem6_PNG:"res/game/bianphuongdong/EffectBAPD/rong_den.png",FXItem6_Json:"res/game/bianphuongdong/EffectBAPD/rong_den.json",FXItem8_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_do.atlas",FXItem8_PNG:"res/game/bianphuongdong/EffectBAPD/rong_do.png",FXItem8_Json:"res/game/bianphuongdong/EffectBAPD/rong_do.json",FXItem7_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_trang.atlas",FXItem7_PNG:"res/game/bianphuongdong/EffectBAPD/rong_trang.png",FXItem7_Json:"res/game/bianphuongdong/EffectBAPD/rong_trang.json",
FXItem5_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_vang.atlas",FXItem5_PNG:"res/game/bianphuongdong/EffectBAPD/rong_vang.png",FXItem5_Json:"res/game/bianphuongdong/EffectBAPD/rong_vang.json",SFX_BtnQuay:"res/game/bianphuongdong/Sounds/BAPDBTNQuay.mp3",SFX_Click:"res/game/bianphuongdong/Sounds/BAPDclick.mp3",SFX_JackPot:"res/game/bianphuongdong/Sounds/BAPDJackPot.mp3",SFX_Quay:"res/game/bianphuongdong/Sounds/BAPDQuay.mp3",SFX_RongDen:"res/game/bianphuongdong/Sounds/BAPDRongDen.mp3",SFX_RongDo:"res/game/bianphuongdong/Sounds/BAPDRongDo.mp3",
SFX_RongTrang:"res/game/bianphuongdong/Sounds/BAPDRongTrang.mp3",SFX_RongVang:"res/game/bianphuongdong/Sounds/BAPDRongVang.mp3",SFX_Win:"res/game/bianphuongdong/Sounds/BAPDWin.mp3",Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};
ResourceManager.MGResourcesGameBAPDPreloadMobile={AtlasBAPD:"res/game/bianphuongdong/atlas/AtlasBAPD/AtlasBAPD.plist",AtlasItemsBAPD:"res/game/bianphuongdong/atlas/AtlasItem/AtlasItemsBAPD.plist",AtlasLineBAPD0:"res/game/bianphuongdong/atlas/AtlasLineBAPD/AtlasLineBAPD0.plist",AtlasLineBAPD1:"res/game/bianphuongdong/atlas/AtlasLineBAPD/AtlasLineBAPD1.plist",AtlasMiniGame:"res/game/bianphuongdong/atlas/AtlasMiniGame/AtlasMiniGameBAPD.plist",CCSUIBiAnPhuongDongLayer:"res/game/bianphuongdong/UIBiAnPhuongDongLayer.json",
CCSUIMGBigWinBAPD:"res/game/bianphuongdong/UIMGBigWinBAPD.json",CCSUIMGButtonMiniGame:"res/game/bianphuongdong/UIMGButtonMiniGame.json",CCSUIMGCompoMiniGameBAPD:"res/game/bianphuongdong/UIMGCompoMiniGameBAPD.json",CCSUIMGPopupBigWinNode:"res/game/bianphuongdong/UIMGPopupBigWinNode.json",CCSUIMGPopupGameInfoNode:"res/game/bianphuongdong/UIMGPopupGameInfoNode.json",CCSUIMGPopupNotifyNode:"res/game/bianphuongdong/UIMGPopupNotifyNode.json",CCSUIMGPopupHistoryNode:"res/game/bianphuongdong/UIMGPopupHistoryNode.json",
CCSUIMGPopupMiniGameBAPD:"res/game/bianphuongdong/UIMGPopupMiniGameBAPD.json",CCSUIMGScrollNode:"res/game/bianphuongdong/UIMGScrollNode.json",BonusBox_Atlas:"res/game/bianphuongdong/EffectBAPD/NoHu_FX.atlas",BonusBox_PNG:"res/game/bianphuongdong/EffectBAPD/NoHu_FX.png",BonusBox_Json:"res/game/bianphuongdong/EffectBAPD/NoHu_FX.json",FXItem4_Atlas:"res/game/bianphuongdong/EffectBAPD/item1.atlas",FXItem4_PNG:"res/game/bianphuongdong/EffectBAPD/item1.png",FXItem4_Json:"res/game/bianphuongdong/EffectBAPD/item1.json",
FXItem2_Atlas:"res/game/bianphuongdong/EffectBAPD/item2.atlas",FXItem2_PNG:"res/game/bianphuongdong/EffectBAPD/item2.png",FXItem2_Json:"res/game/bianphuongdong/EffectBAPD/item2.json",FXItem3_Atlas:"res/game/bianphuongdong/EffectBAPD/item3.atlas",FXItem3_PNG:"res/game/bianphuongdong/EffectBAPD/item3.png",FXItem3_Json:"res/game/bianphuongdong/EffectBAPD/item3.json",FXItem6_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_den.atlas",FXItem6_PNG:"res/game/bianphuongdong/EffectBAPD/rong_den.png",FXItem6_Json:"res/game/bianphuongdong/EffectBAPD/rong_den.json",
FXItem8_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_do.atlas",FXItem8_PNG:"res/game/bianphuongdong/EffectBAPD/rong_do.png",FXItem8_Json:"res/game/bianphuongdong/EffectBAPD/rong_do.json",FXItem7_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_trang.atlas",FXItem7_PNG:"res/game/bianphuongdong/EffectBAPD/rong_trang.png",FXItem7_Json:"res/game/bianphuongdong/EffectBAPD/rong_trang.json",FXItem5_Atlas:"res/game/bianphuongdong/EffectBAPD/rong_vang.atlas",FXItem5_PNG:"res/game/bianphuongdong/EffectBAPD/rong_vang.png",
FXItem5_Json:"res/game/bianphuongdong/EffectBAPD/rong_vang.json",SFX_BtnQuay:"res/game/bianphuongdong/Sounds/BAPDBTNQuay.mp3",SFX_Click:"res/game/bianphuongdong/Sounds/BAPDclick.mp3",SFX_JackPot:"res/game/bianphuongdong/Sounds/BAPDJackPot.mp3",SFX_Quay:"res/game/bianphuongdong/Sounds/BAPDQuay.mp3",SFX_RongDen:"res/game/bianphuongdong/Sounds/BAPDRongDen.mp3",SFX_RongDo:"res/game/bianphuongdong/Sounds/BAPDRongDo.mp3",SFX_RongTrang:"res/game/bianphuongdong/Sounds/BAPDRongTrang.mp3",SFX_RongVang:"res/game/bianphuongdong/Sounds/BAPDRongVang.mp3",
SFX_Win:"res/game/bianphuongdong/Sounds/BAPDWin.mp3",Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesBAPD=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameBAPDPreloadMobile)ResourceManager.MGResourcesGameBAPDPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameBAPDPreloadMobile[i],resourcesBAPD.push(ResourceManager.MGResourcesGameBAPDPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameBAPD)ResourceManager.MGResourcesGameBAPD[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameBAPD[i]}else for(i in ResourceManager.MGResourcesGameBAPD)ResourceManager.MGResourcesGameBAPD[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameBAPD[i],resourcesBAPD.push(ResourceManager.MGResourcesGameBAPD[i]);ConstantsVariable.NETWORK_BAPD={StartGame:2800,Turning:2801,StartMiniGame:2802,BetGameMini:2803,ResultStepGameMini:2804,NextStepGameMini:2805,ResultGameMini:2806,UserLeftDesk:2807,ListUser:2808,GameData:2809,FreeTurning:2810,ToolResult:2811,WinBonusBox:2812,BigWin:2813,TopWinBonusBox:2814,TopBigWin:2815};ConstantsVariable.STATE_BAPD={NOT_START:0,WAIT:1,TURNING:2,GAME_MINI:3,FINISH:4};var MGNetSendBAPD=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBet:function(a){Utilities.showLog("sendBet "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BAPD.Turning,{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendBetGameMini:function(a){var b={};b.BetKind=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BAPD.BetGameMini,{BetKind:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},
sendToolResulBAPD:function(a){var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_BAPD.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGBAPDColScroll=cc.Class.extend({listItem:null,scrollCol:null,numIconShow:3,index:0,listResult:null,callBackFinish:null,dx:0,dy:0,listItemEffect:null,_moreTime:0,ctor:function(){},initObj:function(a,b){this.scrollCol=a;this.index=b;this.initListItem();this.listItemEffect={};this.listItemEffect[2]=[];this.listItemEffect[3]=[];this.listItemEffect[4]=[];this.listItemEffect[5]=[];this.listItemEffect[6]=[];this.listItemEffect[7]=[];this.listItemEffect[8]=[];this.randomTopItem();this.updateBottomItem()},
initListItem:function(){var a=this.scrollCol.getChildren(),b=a.length;this.listItem=[];for(var d=0;d<b;d++)this.listItem[d]={},this.listItem[d].itemImg=a[d],this.listItem[d].itemEffect=null,this.listItem[d].ItemID=0,this.listItem[d].row=d,this.listItem[d].collumn=this.index;this.dy=-this.listItem[this.numIconShow-1].itemImg.getPositionY()+this.listItem[this.numIconShow-1].itemImg.height/2;this.dx=this.scrollCol.getPositionX()},randomTopItem:function(){var a=0,b=this.numIconShow,d,e;for(a;a<b;a++)d=
parseInt(12*Math.random())+1,e="Item"+d+".png",this.listItem[a].ItemID=d,this.listItem[a].textureName=e,this.listItem[a].itemImg.loadTexture(e,ccui.Widget.PLIST_TEXTURE)},updateBottomItem:function(){var a=0,b=this.numIconShow,d=this.listItem.length;for(a;a<b;a++)this.listItem[d-(this.numIconShow-a)].ItemID=this.listItem[a].ItemID,this.listItem[d-(this.numIconShow-a)].textureName=this.listItem[a].textureName,this.listItem[d-(this.numIconShow-a)].itemImg.loadTexture(this.listItem[a].textureName,ccui.Widget.PLIST_TEXTURE)},
updateReult:function(){var a=0,b=this.numIconShow,d;for(a;a<b;a++)d="Item"+this.listResult[a]+".png",this.listItem[a].textureName=d,this.listItem[a].ItemID=this.listResult[a],this.listItem[a].itemImg.loadTexture(d,ccui.Widget.PLIST_TEXTURE),1<this.listResult[a]&&9>this.listResult[a]&&(d=this.getItemEffect(this.listResult[a]),d.setPosition(this.listItem[a].itemImg.getPosition()),this.listItem[a].itemEffect=d,this.scrollCol.addChild(d))},getItemEffect:function(a){var b;b=this.listItemEffect[a].pop();
b||(b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameBAPD["FXItem"+a+"_Json"],ResourceManager.MGResourcesGameBAPD["FXItem"+a+"_Atlas"]),b.ID=a);b.setVisible(!1);return b},turning:function(a,b){this._moreTime=b;for(var d=this.listItem.length,e=0;e<d;e++)this.listItem[e].itemEffect&&(this.listItem[e].itemEffect.retain(),this.listItemEffect[this.listItem[e].itemEffect.ID].push(this.listItem[e].itemEffect),this.listItem[e].itemEffect.removeFromParent(!1),this.listItem[e].itemEffect=null);this.scrollFist();
this.listResult=a},scrollFist:function(){var a=-this.listItem[this.numIconShow].itemImg.getPositionY()/2+37;this.scrollCol.runAction(cc.sequence(cc.jumpBy(.3,cc.p(0,30),0,0),cc.jumpBy(.1,cc.p(0,a),0,0),cc.callFunc(this.scrollSecond.bind(this))))},scrollSecond:function(){this.scrollCol.setPositionY(0);this.updateBottomItem();var a=0;0<this._moreTime&&(a=parseInt(this._moreTime/.2));this.scrollCol.runAction(cc.sequence(cc.sequence(cc.callFunc(function(){this.scrollCol.setPositionY(0)}.bind(this)),cc.jumpBy(.2,
cc.p(0,-488),0,0)).repeat(4+a+this.index),cc.callFunc(this.scrollLast.bind(this))))},scrollLast:function(){this.updateReult();this.scrollCol.setPositionY(0);this.scrollCol.runAction(cc.sequence(cc.jumpBy(.5,cc.p(0,-588),0,0),cc.jumpBy(.1,cc.p(0,50),0,0),cc.callFunc(function(){this.updateBottomItem();var a={};a.Index=this.index;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,a);this.callBackFinish&&this.callBackFinish()}.bind(this))))},setDispose:function(){delete this.listItemEffect[2];
delete this.listItemEffect[3];delete this.listItemEffect[4];delete this.listItemEffect[5];delete this.listItemEffect[6];delete this.listItemEffect[7];delete this.listItemEffect[8];this.scrollCol.stopAllActions();this.scrollCol.removeAllChildren(!0)}});var MGBAPDCompoScroll=cc.Class.extend({listColumn:null,listItemResult:null,mainGame:null,ctor:function(){},initObj:function(a,b){this.mainGame=b;this.listColumn=[];this.listItemResult=[];var d=0,e,f=a.getChildByName("Panel");for(d;5>d;d++)e=new MGBAPDColScroll,e.initObj(f.getChildByName("MGScroll"+d),d),this.listColumn.push(e),this.listItemResult.push(e.listItem[0]),this.listItemResult.push(e.listItem[1]),this.listItemResult.push(e.listItem[2])},getListItemsResult:function(){return this.listItemResult},
turning:function(a){var b=0;this.mainGame.compoEffect.compoEffectNode.addReelData(a.ArrIcon,1,[3,4]);for(b;5>b;b++)this.listColumn[b].turning(a.ArrIcon[b],this.mainGame.compoEffect.compoEffectNode.getMoreTimeEffect(b));this.listColumn[4].callBackFinish=this.finishScroll.bind(this)},finishScroll:function(){MGGameBoardBAPD.AutoSping||this.mainGame.compoEffect.playEffectEndMatch();this.mainGame.footer.updateCoinWinEndMatch()},setDispose:function(){var a=0,b=this.listColumn.length;for(a;a<b;a++)this.listColumn[a].setDispose(),
this.listColumn[a]=null;this.listColumn=null}});var MGCompoItemEffectBAPD=cc.Class.extend({listItemResult:null,listLine:null,_effectNode:null,ctor:function(a){this._effectNode=a},initObj:function(a){this.listItemResult=a;this.listLine=[];this.listLine[0]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13]];this.listLine[1]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLine[2]=[this.listItemResult[2],
this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLine[3]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[12]];this.listLine[4]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14]];this.listLine[5]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[13]];
this.listLine[6]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[13]];this.listLine[7]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[14]];this.listLine[8]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],this.listItemResult[12]];this.listLine[9]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],
this.listItemResult[13]];this.listLine[10]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[13]];this.listLine[11]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[12]];this.listLine[12]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[14]];this.listLine[13]=[this.listItemResult[0],this.listItemResult[4],
this.listItemResult[6],this.listItemResult[10],this.listItemResult[12]];this.listLine[14]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[14]];this.listLine[15]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[13]];this.listLine[16]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[13]];this.listLine[17]=
[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[9],this.listItemResult[12]];this.listLine[18]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[11],this.listItemResult[14]];this.listLine[19]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[12]];this.listLine[20]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],
this.listItemResult[14]];this.listLine[21]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[6],this.listItemResult[11],this.listItemResult[13]];this.listLine[22]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[8],this.listItemResult[9],this.listItemResult[13]];this.listLine[23]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[6],this.listItemResult[11],this.listItemResult[12]];this.listLine[24]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[8],
this.listItemResult[9],this.listItemResult[14]]},hideAllEffect:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)this.listItemResult[a].itemImg.setVisible(!0),this.listItemResult[a].itemEffect&&3!=this.listItemResult[a].ItemID&&4!=this.listItemResult[a].ItemID&&this.listItemResult[a].itemEffect.setVisible(!1);this._effectNode.compoEffectNode.hideAllEffect()},playEffectLine:function(a,b){this.hideAllEffect();for(var d=0;5>d;d++){if(this.listLine[a][d].ItemID==b){if(this.listLine[a][d].itemEffect)switch(this.listLine[a][d].itemEffect.setVisible(!0),
this.listLine[a][d].itemEffect.setAnimation(0,"animation",!1),this.listLine[a][d].itemImg.setVisible(!1),mg.audio.stopAllEffects(),this.listLine[a][d].ItemID){case 5:mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_RongVang,MGGameInfo.gameVolume);break;case 6:mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_RongDen,MGGameInfo.gameVolume);break;case 7:mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_RongTrang,MGGameInfo.gameVolume);break;case 8:mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_RongDo,
MGGameInfo.gameVolume)}8<b&&this.showFrameFx(this.listLine[a][d].row+3*this.listLine[a][d].collumn)}2==this.listLine[a][d].ItemID&&(this.listLine[a][d].itemEffect.setVisible(!0),this.listLine[a][d].itemEffect.setAnimation(0,"animation",!1),this.listLine[a][d].itemImg.setVisible(!1))}},showFrameFx:function(a){this._effectNode.compoEffectNode.showEffectItem(a,2)},playEffectScatter:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)3==this.listItemResult[a].ItemID&&(this.listItemResult[a].itemEffect.setVisible(!0),
this.listItemResult[a].itemEffect.setAnimation(0,"animation",!0),this.listItemResult[a].itemImg.setVisible(!1))},playEffectBonus:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)4==this.listItemResult[a].ItemID&&(this.listItemResult[a].itemEffect.setVisible(!0),this.listItemResult[a].itemEffect.setAnimation(0,"animation",!0),this.listItemResult[a].itemImg.setVisible(!1))},playEffectOnReel:function(a){a.itemEffect.setVisible(!0);a.itemEffect.setAnimation(0,"animation",!1);a.itemImg.setVisible(!1)},
onPlayReelEffect:function(a){for(var b=0;3>b;b++){var d=this.listItemResult[3*a+b];3!=d.ItemID&&4!=d.ItemID||this.playEffectOnReel(d)}}});var MGBAPBHeader=MGBaseNode.extend({txtJackpot:null,txtCoin:null,txtMatchID:null,txtFreeTurning:null,btnBigWin:null,btnHistory:null,btnNotify:null,mainGame:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.txtJackpot=a.getChildByName("MGtxtJackpot");this.txtCoin=a.getChildByName("MGTxtCoin");this.txtMatchID=a.getChildByName("MGTxtMatchID");this.txtFreeTurning=a.getChildByName("MGTxtFreeTurning");this.btnBigWin=
a.getChildByName("MGBtnTopWin");this.btnBigWin.addClickEventListener(this.onBtnBigWinClick.bind(this));this.btnHistory=a.getChildByName("MGBtnHistory");this.btnHistory.addClickEventListener(this.onBtnHistoryClick.bind(this));this.btnNotify=a.getChildByName("MGBtnNotify");this.btnNotify.addClickEventListener(this.onBtnNotifyClick.bind(this))},updateGameData:function(a){this.updateCoin(a.CoinUser);this.updateJackpot(0);this.updateMatchID(a.MatchID);this.txtFreeTurning.setString("")},updateCoin:function(a){this.txtCoin.setString(Utilities.Coin(a))},
updateMatchID:function(a){this.txtMatchID.setString("#"+a)},updateJackpot:function(a){this.txtJackpot.setString(Utilities.Coin(a))},updateFreeTurning:function(a){0===a?this.txtFreeTurning.setString(""):this.txtFreeTurning.setString("LƯỢT QUAY MIỄN PHÍ: "+a)},onBtnBigWinClick:function(a,b){this.mainGame.popup.showPopupBigWin()},onBtnHistoryClick:function(a,b){this.mainGame.popup.showPopupHistory()},onBtnNotifyClick:function(a,b){this.mainGame.popup.showPopupNotify()}});var MGBAPDCompoBottom=MGBaseNode.extend({mainGame:null,btnMinus:null,btnPlus:null,txtCoinBet:null,btnMaxBet:null,btnStart:null,btnStop:null,btnGameInfo:null,listValueBet:null,txtDes:null,txtCon:null,betIndex:0,betValue:0,coinWinBet:0,timeoutBtnStart:null,isEndTouch:!0,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.btnMinus=a.getChildByName("ButtonMinus");this.btnPlus=a.getChildByName("ButtonPlus");this.btnMaxBet=
a.getChildByName("ButtonMaxBet");this.btnStart=a.getChildByName("ButtonStart");this.btnStop=a.getChildByName("ButtonStop");this.txtCoinBet=a.getChildByName("TxtCoinBet");this.btnGameInfo=a.getChildByName("ButtonGameInfo");this.txtDes=a.getChildByName("MGTextLineBet").getChildByName("TxtTop");this.txtCon=a.getChildByName("MGTextLineBet").getChildByName("TxtBottom");this.btnMinus.addClickEventListener(this.onBtnMinusClick.bind(this));this.btnPlus.addClickEventListener(this.onBtnPlusClick.bind(this));
this.btnMaxBet.addClickEventListener(this.onBtnMaxBetClick.bind(this));this.btnStart.addTouchEventListener(this.onBtnStartClick.bind(this));this.btnStop.addClickEventListener(this.onBtnStopClick.bind(this));this.btnGameInfo.addClickEventListener(this.onBtnGameInfoClick.bind(this))},updateGameData:function(a){this.listValueBet=a.ListCoinCanBet;this.updateCoinBet()},onBtnMinusClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);0<MGGameBoardBAPD.FreeTurning||
(this.betIndex--,0>this.betIndex&&(this.betIndex=this.listValueBet.length-1),this.betIndex>this.getMaxIndexCanBet()&&(this.betIndex=this.getMaxIndexCanBet()),this.updateCoinBet())},onBtnPlusClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);0<MGGameBoardBAPD.FreeTurning||(this.betIndex++,this.betIndex>=this.listValueBet.length&&(this.betIndex=0),this.betIndex>this.getMaxIndexCanBet()&&(this.betIndex=this.getMaxIndexCanBet()),this.updateCoinBet())},
onBtnMaxBetClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);0<MGGameBoardBAPD.FreeTurning||(this.betIndex=this.listValueBet.length-1,this.updateCoinBet())},onBtnStartClick:function(a,b){switch(b){case ccui.Widget.TOUCH_BEGAN:this.isEndTouch=!1;this.timeoutBtnStart=setTimeout(this.ontimeoutBtnStart.bind(this),400);break;case ccui.Widget.TOUCH_ENDED:this.isEndTouch=!0,this.timeoutBtnStart&&(clearTimeout(this.timeoutBtnStart),this.timeoutBtnStart=
null),MGGameBoardBAPD.AutoSping||(mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_BtnQuay,MGGameInfo.gameVolume),this.sendBetting())}},ontimeoutBtnStart:function(){this.isEndTouch||(this.sendBetting(),this.btnStop.setVisible(!0),this.btnStart.setVisible(!1),MGGameBoardBAPD.AutoSping=!0)},sendBetting:function(){MGGameInfo.myInfo.Gold<this.betValue&&(this.betIndex>this.getMaxIndexCanBet()&&(this.betIndex=this.getMaxIndexCanBet()),this.updateCoinBet());if(0==this.betValue){var a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=
ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]="Bạn không đủ gold. \nXin vui lòng nạp gold để tiếp tục chơi";cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a);MGGameBoardBAPD.AutoSping&&this.mainGame.stopAutoSping()}else this.mainGame.netSend.sendBet(this.betValue)},onBtnStopClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);this.btnStop.setVisible(!1);this.btnStart.setVisible(!0);MGGameBoardBAPD.AutoSping=!1},
onBtnGameInfoClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);this.mainGame.popup.showPopupGameInfo()},updateCoinBet:function(){this.betValue=0<=this.betIndex?this.listValueBet[this.betIndex]:0;this.txtCoinBet.setString(Utilities.Coin(this.betValue.toString()))},ngStartGame:function(a){this.enableButton(a)},turning:function(a){this.coinWinBet=a.CoinWinBet;this.txtDes.setString("THẮNG");this.txtCon.setString("0");this.enableButton(!1)},enableButton:function(a){this.btnStart.setTouchEnabled(a);
this.btnStart.setBright(a);this.btnPlus.setTouchEnabled(a);this.btnPlus.setBright(a);this.btnMinus.setTouchEnabled(a);this.btnMinus.setBright(a);this.btnMaxBet.setTouchEnabled(a);this.btnMaxBet.setBright(a)},updateCoinWinEndMatch:function(){this.txtDes.setString("THẮNG");this.txtCon.setString(Utilities.Coin(this.coinWinBet.toString()))},disableButtonFreeTurning:function(a){this.btnMaxBet.setTouchEnabled(!a);this.btnMaxBet.setBright(!a);this.btnPlus.setTouchEnabled(!a);this.btnPlus.setBright(!a);this.btnMinus.setTouchEnabled(!a);
this.btnMinus.setBright(!a)},getMaxIndexCanBet:function(){for(var a=this.listValueBet.length-1;0<=a;){if(MGGameInfo.myInfo.Gold>=this.listValueBet[a])return a;a--}return-1}});var MGBAPDCompoLines=MGBaseNode.extend({listLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.listLine=a.getChildren();this.hideAllLine()},hideAllLine:function(){var a=0,b=this.listLine.length;for(a;a<b;a++)this.listLine[a].stopAllActions(),this.listLine[a].setVisible(!1)},playEffectAllLine:function(a){this.hideAllLine();var b=0,d=a.length;for(b;b<d;b++)this.listLine[a[b]].setVisible(!0),this.listLine[a[b]].setOpacity(255),
this.listLine[a[b]].runAction(cc.sequence(cc.fadeIn(.3),cc.fadeOut(.3)).repeat(3))},playEffectLine:function(a){this.hideAllLine();this.listLine[a].setVisible(!0);this.listLine[a].setOpacity(255);this.listLine[a].runAction(cc.sequence(cc.fadeIn(.3),cc.fadeOut(.3)).repeat(3))}});var MGEffectBAPD=MGBaseNode.extend({compoLine:null,compoItemEffect:null,listLinesWin:null,listIconLineWin:null,intervalEffect:null,totalLine:null,currentLine:null,effectBonusBox:null,effectCoinWinNoHu:null,_compoItemEffectNode:null,effectWin:null,coinWin:null,compoEffectNode:null,effectSpecialXeng:null,_gameObj:null,ctor:function(a,b,d){MGBaseNode.prototype.ctor.call(this);this.compoLine=a;this._compoItemEffectNode=d;this.compoItemEffect=new MGCompoItemEffectBAPD(this);this.compoItemEffect.initObj(b.getListItemsResult());
this.listLinesWin=[];this.listIconLineWin=[];this.compoEffectNode=new MGCompoEffectNode;this.compoEffectNode.setCallbackOnPlayEffectReel(this.compoItemEffect.onPlayReelEffect.bind(this.compoItemEffect));d.addChild(this.compoEffectNode)},initEffectSpecialXeng:function(){this.effectSpecialXeng=new MGComboEffectSpecialXeng;this.effectSpecialXeng.initObj();this.effectSpecialXeng.setCallBackSuccess(this.playLinesEffectEndMatch.bind(this));this._compoItemEffectNode.addChild(this.effectSpecialXeng)},initEvents:function(){this._initEventsGame();
this._listEvents.push(cc.eventManager.addCustomListener(MGEffectBAPD.EVENT.FX_BONUS_BOX,this.playEffectBonusBox.bind(this)))},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this._gameObj=a;for(a=1;15>=a;a++)this.compoEffectNode.addEffectItem(cc.size(220,220),this._compoItemEffectNode.getChildByName("Item"+a).getPosition());for(a=1;5>=a;a++)this.compoEffectNode.addEffectReel(cc.size(240,520),this._compoItemEffectNode.getChildByName("MGEffectReel"+a).getPosition());this.initEvents()},setDataNewMatch:function(a){this.listLinesWin.length=
0;this.listIconLineWin.length=0;this.coinWin=a.CoinWinBet;a=a.IconWinListLineBet;var b=0,d=a.length;for(b;b<d;b++)0<a[b]&&(this.listLinesWin.push(b),this.listIconLineWin.push(a[b]));this.compoLine.hideAllLine();this.intervalEffect&&clearInterval(this.intervalEffect);this.currentLine=this.totalLine=this.listLinesWin.length;this.compoItemEffect.hideAllEffect();this.effectWin&&this.effectWin.stopAnimationWin()},playLinesEffectEndMatch:function(){this.intervalEffect&&clearInterval(this.intervalEffect);
this.intervalEffect=setInterval(this.showNextEffect.bind(this),2500);this.compoEffectNode.hideAllEffectReel();0<MGGameBoardBAPD.ScatterLines&&this.compoItemEffect.playEffectScatter()},playFireWallEffectEndMatch:function(){this.effectSpecialXeng||this.initEffectSpecialXeng();this.effectSpecialXeng.playEffectWinScatter(320)},playBonusEffectEndMatch:function(){this.effectSpecialXeng||this.initEffectSpecialXeng();this.effectSpecialXeng.playEffectWinBonus(320)},playEffectEndMatch:function(){this.compoEffectNode.hideAllEffectReel();
0<MGGameBoardBAPD.ScatterLines?this.playFireWallEffectEndMatch():0<MGGameBoardBAPD.HaveMiniGame?this.playBonusEffectEndMatch():this.playLinesEffectEndMatch()},playEffectBonus:function(){this.compoItemEffect.playEffectBonus()},showNextEffect:function(){this.effectWin||(this.effectWin=new MGComboEffectWinCoinXeng,this.effectWin.initObj(),this._gameObj.addChild(this.effectWin),this.effectWin.setPosition(630,640),this.effectWin.setPositionText(220),this.effectWin.setPositionAni(85));this.currentLine>=
this.totalLine?(this.compoItemEffect.hideAllEffect(),this.compoLine.playEffectAllLine(this.listLinesWin),this.currentLine=0,0<this.totalLine&&(0>=MGGameBoardBAPD.HaveMiniGame&&mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Win,MGGameInfo.gameVolume),this.effectWin.playAnimationWin(this.coinWin))):(this.effectWin.stopAnimationWin(),this.compoLine.playEffectLine(this.listLinesWin[this.currentLine]),this.compoItemEffect.playEffectLine(this.listLinesWin[this.currentLine],this.listIconLineWin[this.currentLine]),
this.currentLine++)},hideAllEffect:function(){this.effectWin&&this.effectWin.stopAnimationWin();this.compoLine.hideAllEffect();this.compoItemEffect.hideAllEffect();this.compoEffectNode.hideAllEffect()},playEffectBonusBox:function(a){a=a.getUserData();mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_JackPot,MGGameInfo.gameVolume);MGGameBoardBAPD.HaveJackPot=!0;if(!this.effectBonusBox){var b=this._gameObj.getChildByName("MGEffectBonusBox").getPosition();this.effectBonusBox=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameBAPD.BonusBox_Json,
ResourceManager.MGResourcesGameBAPD.BonusBox_Atlas);this.effectBonusBox.setPosition(b);this._gameObj.addChild(this.effectBonusBox);this.effectBonusBox.setVisible(!1);this.effectCoinWinNoHu=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameBAPD.Font_fnt);this.effectCoinWinNoHu.setVisible(!1);this._gameObj.addChild(this.effectCoinWinNoHu);this.effectCoinWinNoHu.setPosition(b.x,b.y+10)}this.effectBonusBox.setAnimation(0,"animation",!1);this.effectBonusBox.setVisible(!0);this.effectCoinWinNoHu.setString(Utilities.Coin(a.EarnCoin));
this.effectCoinWinNoHu.setVisible(!0);this.effectCoinWinNoHu.setScale(30);this.effectCoinWinNoHu.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinNoHu.setVisible(!1)}.bind(this))));setTimeout(this.hideEffect.bind(this,this.effectBonusBox),4E3)},hideEffect:function(a){a.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.intervalEffect&&clearInterval(this.intervalEffect);delete this.compoItemEffect;delete this.compoLine;
this.compoEffectNode.setDispose()}});MGEffectBAPD.EVENT={FX_BONUS_BOX:"fxNoHu"};var MGCompoMiniGameBAPD=MGBaseNode.extend({listButton:[],popup:null,lbTotalCoin:null,totalCoin:0,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listButton=[];this.initUI();this._initEventBtnFromNode();this._initEventsGame()},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.ResultStepGameMini.toString(),
this.ngResultStepGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.ResultGameMini.toString(),this.ngResultGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.NextStepGameMini.toString(),this.ngNextStepGameMini.bind(this)))},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameBAPD.CCSUIMGCompoMiniGameBAPD,PreLoaderConfig.PathToResourceDefault);this._mainLayer.getChildByName("MGBackgroundMiniGame").setTouchEnabled(!0);
this._mainLayer.getChildByName("MGBackgroundMiniGame").setSwallowTouches(!0);this.lbTotalCoin=this._mainLayer.getChildByName("LabelTotalCoin");this.popup=new MGPopupMiniGameBAPD;this.popup.cloneFromNode(this._mainLayer.getChildByName("MGPopupMiniGame"));this.popup.initObj(this);this.addChild(this.popup)},_initEventBtnFromNode:function(){for(var a=this._mainLayer.getChildByName("MGMiniGameButtonBet"),b=a.getChildren(),d=1;d<=b.length;d++){var e=new MGMiniGameButtonBAPD;e.cloneFromNode(a.getChildByName("MGButton_"+
d));e.initObj();e.button.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));e.idButton=d;a.addChild(e);this.listButton.push(e)}},setShowMiniGame:function(a){this.setVisible(a);a&&(this.resetAllButton(),this.disableAllButton(),this.enableButtonFromRow(1),this.lbTotalCoin.setString(0),this.totalCoin=0)},disableAllButton:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].button.setEnabled(!1)},resetAllButton:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].resetButton()},
disableButtonFromRow:function(a){a*=7;for(var b=a-7;b<a;b++)this.listButton[b].button.setEnabled(!1)},enableButtonFromRow:function(a){a*=7;for(var b=0;b<a;b++)this.listButton[b].button.setBright(!0);for(b=a-7;b<a;b++)this.listButton[b].button.setEnabled(!0)},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);var d=a.getParent().idButton%7;0===d&&(d=7);this.mainGame.netSend.sendBetGameMini(d)},ngResultStepGameMini:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={CurrentStep:b.UInt8,ListResult:b.Array8,ListResult_Type:b.UInt64,ID:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this.disableButtonFromRow(a.CurrentStep);for(b=1;7>=b;b++)this.getButton(a.CurrentStep,b).showResult(a.CurrentStep,a.ID===b?!0:!1,a.ListResult[b-1]),a.ID===b&&(this.totalCoin+=a.ListResult[b-1],this.lbTotalCoin.setString(this.totalCoin))},ngResultGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={WinCoin:b.UInt64,
Rate:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this.popup.setShowPopupWithInfo(a)},ngNextStepGameMini:function(a){a=a.getUserData();var b={Step:BinaryConstants.DataTypeID.UInt8};a=(new BinaryParser).initObj(b,a.content);this.enableButtonFromRow(a.Step)},getButton:function(a,b){return this.listButton[7*(a-1)+b-1]},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGMiniGameButtonBAPD=MGBaseNode.extend({idButton:0,button:null,lbValue:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.button=this.getChildByName("MGButton");this.lbValue=this.getChildByName("MGTextNumber")},resetButton:function(){this.button.loadTextureNormal("up.png",ccui.Widget.PLIST_TEXTURE);this.lbValue.setString("")},showResult:function(a,b,d){this.button.loadTextureNormal("mini_"+a+(b?"":"-1")+".png",ccui.Widget.PLIST_TEXTURE);
this.lbValue.setString(0===d?"Game Over":d);0===d?this.lbValue.setFontSize(50):this.lbValue.setFontSize(80);b?(this.lbValue.setTextColor(cc.color("#FFE400")),this.lbValue.enableOutline(cc.color("#FF0000"),4)):(this.lbValue.setTextColor(cc.color("#af4b28")),this.lbValue.enableOutline(cc.color("#551b01"),4))}});var MGPopupMiniGameBAPD=MGBaseNode.extend({btnBackToGame:null,lbResultGold:null,lbCalculate:null,miniGame:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.miniGame=a;this.initUI();this.showPopup(!1)},initUI:function(){this.lbResultGold=this.getChildByName("MGTextGold");this.lbCalculate=this.getChildByName("MGTextCalculate");this.btnBackToGame=this.getChildByName("MGButtonBackToGame");this.btnBackToGame.addClickEventListener(this.onBtnBackToGameClick.bind(this))},
onBtnBackToGameClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);this.showPopup(!1);this.miniGame.setShowMiniGame(!1)},setShowPopupWithInfo:function(a){this.lbResultGold.setString(a.WinCoin);this.lbCalculate.setString(a.WinCoin+" X "+a.Rate+" = "+a.WinCoin*a.Rate);this.showPopup(!0)},showPopup:function(a){this.setVisible(a)}});var MGPopupGameInfoBAPD=MGBaseNode.extend({btnBack:null,btnBackToGame:null,btnNext:null,pageView:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initFromCocostudio(ResourceManager.MGResourcesGameBAPD.CCSUIMGPopupGameInfoNode,PreLoaderConfig.PathToResourceDefault);this.btnBack=this._mainLayer.getChildByName("ButtonBack");this.btnBackToGame=this._mainLayer.getChildByName("ButtonBackToGame");this.btnNext=this._mainLayer.getChildByName("ButtonNext");
this.pageView=this._mainLayer.getChildByName("PageView");this.btnBack.addClickEventListener(this.onBtnBackClick.bind(this));this.btnBackToGame.addClickEventListener(this.onBtnBackToGameClick.bind(this));this.btnNext.addClickEventListener(this.onBtnNextClick.bind(this))},onBtnBackClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);var d=this.pageView.getCurrentPageIndex();0<d?d--:d=2;this.pageView.scrollToPage(d)},onBtnBackToGameClick:function(a,
b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);this.setVisible(!1)},onBtnNextClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Click,MGGameInfo.gameVolume);var d=this.pageView.getCurrentPageIndex();2>d?d++:d=0;this.pageView.scrollToPage(d)}});var MGPopupNotifyBAPD=MGBaseNode.extend({btnClose:null,listView:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initUI();this.initEvents()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameBAPD.CCSUIMGPopupNotifyNode,PreLoaderConfig.PathToResourceDefault);this.btnClose=this._mainLayer.getChildByName("ButtonClose");this.btnClose.addClickEventListener(this.onBtnClosetClick.bind(this));this.listView=this._mainLayer.getChildByName("ListViewContent")},
initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.ngThongBao.bind(this)))},onBtnClosetClick:function(a,b){this.setVisible(!1)},ngThongBao:function(a){a=a.getUserData();this.listView.getItems().length>=MGPopupNotifyBAPD.MAX_LINE&&this.listView.removeItem(MGPopupNotifyBAPD.MAX_LINE-1);var b=new MGBaseRichText("Arial",18,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);
this.listView.insertCustomItem(b,0);this.listView.jumpToTop()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGPopupNotifyBAPD.MAX_LINE=100;var MGPopupBigWinBAPD=MGBaseNode.extend({listView:null,btnClose:null,_dataBigWin:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._currentLoad=0;this._isShowed=!1;this._dataBigWin=[];this.initUI();this.initEvent();this.scheduleUpdate()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameBAPD.CCSUIMGPopupBigWinNode,PreLoaderConfig.PathToResourceDefault);this.listView=this._mainLayer.getChildByName("MGCompoTopWinListView");
this._mainLayer.getChildByName("MGTopWinViewCell").setVisible(!1);this.btnClose=this._mainLayer.getChildByName("MGCompoTopWinButtonClose");this.btnClose.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.BigWin.toString(),this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.TopBigWin.toString(),
this.ngTopBigWin.bind(this)))},update:function(a){this._isShowed&&this.listView.getBottommostItemInCurrentView()&&this.listView.getBottommostItemInCurrentView().getTag()===this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+10<this._dataBigWin.length?10:this._dataBigWin.length-this._currentLoad;if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this.listView.pushBackCustomItem(this.createCellWithInfo(this._dataBigWin[b],b+1));this.listView.jumpToItem(this._currentLoad,
cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.reArrangeSTT()}},onClickBtnFromCocostudio:function(a,b){this.setVisible(!1)},showBigWinLayer:function(){this._isShowed||(this._isShowed=!0,this.loadMoreItem(),this.listView.jumpToTop());this.setVisible(!0)},ngTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,
UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.dataBigWin.length;b++)this._dataBigWin.push(a.dataBigWin[b])},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this._isShowed?(this.listView.getItems().length>=MGPopupBigWinBAPD.MAX_LINE&&this.listView.removeItem(MGPopupBigWinBAPD.MAX_LINE-1),
this.listView.insertCustomItem(this.createCellWithInfo(a,1),0),this.listView.jumpToTop(),this.reArrangeSTT()):this._dataBigWin.splice(0,0,a)},createCellWithInfo:function(a,b){var d=this._mainLayer.getChildByName("MGTopWinViewCell").clone();d.setVisible(!0);this.setCellInfo(d,a);return d},setCellInfo:function(a,b){a.getChildByName("Text1").setString(a.getTag());a.getChildByName("Text2").setString(b.UserID);a.getChildByName("Text3").setString(b.NickName);1===b.Type?a.getChildByName("Text4").setString("NỔ HŨ"):
2===b.Type?a.getChildByName("Text4").setString("5 WILD"):a.getChildByName("Text4").setString("THƯỜNG");a.getChildByName("Text5").setString(Utilities.Coin(b.EarnCoin))},reArrangeSTT:function(){for(var a=0;a<this.listView.getItems().length;a++)this.listView.getItem(a).setTag(a+1),this.listView.getItem(a).getChildByName("Text1").setString(a+1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.unscheduleUpdate()}});MGPopupBigWinBAPD.MAX_LINE=100;var MGPopupHistoryBAPD=MGBaseNode.extend({listView:null,btnClose:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initUI()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameBAPD.CCSUIMGPopupHistoryNode,PreLoaderConfig.PathToResourceDefault);this.listView=this._mainLayer.getChildByName("MGHistoryListView");this._mainLayer.getChildByName("MGHistoryViewCell").setVisible(!1);this.btnClose=this._mainLayer.getChildByName("ButtonClose");
this.btnClose.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){this.setVisible(!1)},setHistoryInfo:function(a){this.listView.insertCustomItem(this.createCellWithInfo(a),0);this.listView.jumpToTop()},createCellWithInfo:function(a){var b=this._mainLayer.getChildByName("MGHistoryViewCell").clone();b.setVisible(!0);this.setCellInfo(b,a);return b},setCellInfo:function(a,b){var d=new Date(b.Time),e=("0"+d.getHours()).slice(-2),f=("0"+d.getMinutes()).slice(-2),
g=("0"+d.getSeconds()).slice(-2),h=("0"+d.getDate()).slice(-2),k=("0"+(d.getMonth()+1)).slice(-2),d=d.getFullYear();a.getChildByName("Text1").setString(b.MatchID);a.getChildByName("Text2").setString(e+":"+f+":"+g+"\n"+h+"/"+k+"/"+d);a.getChildByName("Text3").setString(Utilities.Coin(b.CoinBet));a.getChildByName("Text4").setString(b.DongTrung);a.getChildByName("Text5").setString(Utilities.Coin(b.EarnCoin))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});
MGPopupBigWinBAPD.MAX_LINE=100;var MGPopupBAPD=MGBaseNode.extend({popupGameInfo:null,popupHistory:null,popupNotify:null,popupBigWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.popupNotify||(this.popupNotify=new MGPopupNotifyBAPD,this.popupNotify.initObj(),this.addChild(this.popupNotify));this.popupNotify.setVisible(!1);this.popupBigWin||(this.popupBigWin=new MGPopupBigWinBAPD,this.popupBigWin.initObj(),this.addChild(this.popupBigWin));this.popupBigWin.setVisible(!1);
this.popupHistory||(this.popupHistory=new MGPopupHistoryBAPD,this.popupHistory.initObj(),this.addChild(this.popupHistory));this.popupHistory.setVisible(!1)},showPopupGameInfo:function(){this.popupGameInfo||(this.popupGameInfo=new MGPopupGameInfoBAPD,this.popupGameInfo.initObj(),this.addChild(this.popupGameInfo));this.popupGameInfo.setVisible(!0)},showPopupNotify:function(){this.popupNotify.setVisible(!0)},showPopupBigWin:function(){this.popupBigWin.showBigWinLayer()},setHistoryInfo:function(a){this.popupHistory.setHistoryInfo(a)},
showPopupHistory:function(){this.popupHistory.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.popupNotify&&this.popupNotify.setDispose();this.popupBigWin&&this.popupBigWin.setDispose()}});var MGGameBoardBAPD=cc.Class.extend({_listEvents:null,ctor:function(){}});MGGameBoardBAPD.FreeTurning=0;MGGameBoardBAPD.ScatterLines=0;MGGameBoardBAPD.HaveMiniGame=0;MGGameBoardBAPD.HaveBonus=!1;MGGameBoardBAPD.HaveJackPot=!1;MGGameBoardBAPD.MatchID=0;MGGameBoardBAPD.AutoSping=!1;var MGBiAnPhuongDong=MGBaseGame.extend({netSend:null,contenHistory:null,header:null,footer:null,compoLine:null,popup:null,compoScroll:null,compoEffect:null,compoMiniGame:null,isShowMiniGame:!1,ctor:function(){MGBaseGame.prototype.ctor.call(this)},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.resourceGame=resourcesBAPD;this._initFromCocostudio(ResourceManager.MGResourcesGameBAPD.CCSUIBiAnPhuongDongLayer,PreLoaderConfig.PathToResourceDefault);this.netSend=new MGNetSendBAPD;this.contenHistory=
null;this.initHeader();this.initFooter();this.initCompoScroll();this.initCompoLine();this.initCompoEffect();this.initPopup();this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SOUND_WELCOME)}.bind(this),.2)},initHeader:function(){this.header=new MGBAPBHeader(this);this.header.initObj(this._mainLayer.getChildByName("MGHeader"))},initFooter:function(){this.footer=new MGBAPDCompoBottom(this);this.footer.initObj(this._mainLayer.getChildByName("MGBottom"))},initCompoScroll:function(){this.compoScroll=
new MGBAPDCompoScroll;this.compoScroll.initObj(this._mainLayer.getChildByName("MGScrollContain"),this)},initCompoLine:function(){this.compoLine=new MGBAPDCompoLines;this.compoLine.initObj(this._mainLayer.getChildByName("MGCompoLine"))},initCompoEffect:function(){this.compoEffect=new MGEffectBAPD(this.compoLine,this.compoScroll,this._mainLayer.getChildByName("MGCompoItemEffect"));this.compoEffect.initObj(this._mainLayer.getChildByName("MGCompoEffect"))},initCompoMiniGame:function(){this.compoMiniGame=
new MGCompoMiniGameBAPD(this);this.addChild(this.compoMiniGame)},initPopup:function(){this.popup=new MGPopupBAPD;this.popup.initObj();this.addChild(this.popup)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUserCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK.toString(),this.ngSubMenuLeaveRoom.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.Turning.toString(),this.ngTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.FreeTurning.toString(),
this.ngFreeTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.StartMiniGame.toString(),this.ngStartMiniGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_BAPD.WinBonusBox.toString(),this.ngWinBonusBox.bind(this)))},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={matchID:b.UInt64,TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.footer.ngStartGame(!0);
this.footer.disableButtonFreeTurning(MGGameBoardBAPD.FreeTurning);this.header.updateJackpot(a.TotalCoinBonusBox);this.header.updateFreeTurning(MGGameBoardBAPD.FreeTurning);MGGameBoardBAPD.HaveMiniGame=0;MGGameBoardBAPD.MatchID=a.matchID;this.contenHistory&&this.popup.setHistoryInfo(this.contenHistory);MGGameBoardBAPD.AutoSping&&(MGGameBoardBAPD.HaveBonus?(this.stopAutoSping(),MGGameBoardBAPD.HaveBonus=!1):MGGameBoardBAPD.HaveJackPot?(this.stopAutoSping(),MGGameBoardBAPD.HaveJackPot=!1):this.footer.sendBetting())},
stopAutoSping:function(){MGGameBoardBAPD.AutoSping=!1;this.footer.btnStart.setVisible(!0);this.footer.btnStop.setVisible(!1)},ngGameData:function(a){this.changeBackGround();a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.header.updateGameData(a);this.footer.updateGameData(a);a.Status===ConstantsVariable.STATE_BAPD.NOT_START&&
a.Status===ConstantsVariable.STATE_BAPD.WAIT||this.footer.ngStartGame(!1);MGGameBoardBAPD.MatchID=a.MatchID},changeBackGround:function(){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameBAPD.BAPDBackgroundOutGame;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.header.updateCoin(a.Gold)},
ngSubMenuLeaveRoom:function(a){if(0<MGGameBoardBAPD.ScatterLines||0<MGGameBoardBAPD.FreeTurning)MGGameBoardBAPD.AutoSping&&this.stopAutoSping(),this.footer.enableButton(!1)},ngTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,CoinWinBet:b.UInt64,RateWinCoinListLineBet:b.Array8,RateWinCoinListLineBet_Type:b.Double,ScatterLines:b.UInt8,NumRoundFree:b.UInt8,CoinWinFromBonusBox:b.UInt64,IconWinListLineBet:b.Array8,
IconWinListLineBet_Type:b.UInt8,IsHaveMini:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTurning "+JSON.stringify(a));this.compoEffect.setDataNewMatch(a);this.compoScroll.turning(a);this.header.updateMatchID(MGGameBoardBAPD.MatchID);this.footer.turning(a);MGGameBoardBAPD.FreeTurning=a.NumRoundFree;MGGameBoardBAPD.ScatterLines=a.ScatterLines;MGGameBoardBAPD.HaveMiniGame=a.IsHaveMini;mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameBAPD.SFX_Quay,
MGGameInfo.gameVolume);this.createHistoryInfo(a)},ngFreeTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={NumFree:b.UInt8,ListBet:b.Array8,ListBet_Type:b.UInt8,Coin:b.UInt64,TotalCoinBonusBox:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.header.updateJackpot(a.TotalCoinBonusBox);MGGameBoardBAPD.FreeTurning=a.NumFree;this.footer.disableButtonFreeTurning(MGGameBoardBAPD.FreeTurning);this.header.updateFreeTurning(MGGameBoardBAPD.FreeTurning)},ngWinBonusBox:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGEffectBAPD.EVENT.FX_BONUS_BOX,a)},ngStartMiniGame:function(a){MGGameBoardBAPD.HaveBonus=!0;this.showMiniGame(!0);this.compoEffect.playEffectBonus()},showMiniGame:function(a){this.compoMiniGame||this.initCompoMiniGame();this.compoMiniGame.setShowMiniGame(a)},
createHistoryInfo:function(a){for(var b={},d=0,e=0;e<a.RateWinCoinListLineBet.length;e++)0<a.RateWinCoinListLineBet[e]&&d++;b.MatchID=MGGameBoardBAPD.MatchID;b.CoinBet=this.footer.betValue;b.Time=(new Date).getTime();b.DongTrung=d;b.EarnCoin=a.CoinWinBet;this.contenHistory=b},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);mg.audio.stopAllEffects();mg.audio.stopMusic(!0);MGGameBoardBAPD.AutoSping=!1;this.header&&(this.header.setDispose(),this.header=null);this.footer&&(this.footer.setDispose(),
this.footer=null);this.compoScroll&&(this.compoScroll.setDispose(),this.compoScroll=null);this.compoLine&&(this.compoLine.setDispose(),this.compoLine=null);this.compoMiniGame&&(this.compoMiniGame.setDispose(),this.compoMiniGame=null);this.compoEffect&&this.compoEffect.setDispose();this.popup&&this.popup.setDispose()}});ResourceManager.MGResourcesGameXengVanPhuc={MGBackGroundVP:"res/game/xengVanPhuc/BackGroundVP.jpg",UIMGUIXengVanPhucLayer:"res/game/xengVanPhuc/UIXengVanPhucLayer.json",UIMGMiniGame:"res/game/xengVanPhuc/MGXVPPopupMiniGame.json",UIMGUIScrollNode:"res/game/xengVanPhuc/MGScrollNode.json",XengVanPhucAtlas:"res/game/xengVanPhuc/Atlas/atlasXengVanPhuc.plist",XengVanPhucPng:"res/game/xengVanPhuc/Atlas/atlasXengVanPhuc.png",XengVanPhucItemAtlas:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucItem.plist",XengVanPhucItemPng:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucItem.png",
LineXVPPng0:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine0.png",LineXVPAtlas0:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine0.plist",LineXVPPng1:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine1.png",LineXVPAtlas1:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine1.plist",LineXVPPng2:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine2.png",LineXVPAtlas2:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine2.plist",LineXVPPng3:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine3.png",LineXVPAtlas3:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine3.plist",
LineXVPPng4:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine4.png",LineXVPAtlas4:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine4.plist",LineXVPPng5:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine5.png",LineXVPAtlas5:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine5.plist",LineXVPPng6:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine6.png",LineXVPAtlas6:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine6.plist",LineXVPPng7:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine7.png",LineXVPAtlas7:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine7.plist",
LineXVPPng8:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine8.png",LineXVPAtlas8:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine8.plist",LineXVPPng9:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine9.png",LineXVPAtlas9:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine9.plist",LineXVPPng10:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine10.png",LineXVPAtlas10:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine10.plist",SpineXVP_Item_PNG:"res/game/xengVanPhuc/spine/XengVanPhuc_ItemFX.png",SpineXVP_Item_JSON:"res/game/xengVanPhuc/spine/XengVanPhuc_ItemFX.json",
SpineXVP_Item_ATLAS:"res/game/xengVanPhuc/spine/XengVanPhuc_ItemFX.atlas",SpineXVP_Bonus_PNG:"res/game/xengVanPhuc/spine/XengVanPhuc_BonusFX.png",SpineXVP_Bonus_JSON:"res/game/xengVanPhuc/spine/XengVanPhuc_BonusFX.json",SpineXVP_Bonus_ATLAS:"res/game/xengVanPhuc/spine/XengVanPhuc_BonusFX.atlas",SpineNo_Hu_PNG:"res/Effects/NoHu_FX.png",SpineNo_Hu_JSON:"res/Effects/NoHu_FX.json",SpineNo_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",SpineNo_ThangLon_PNG:"res/Effects/big_win.png",SpineNo_ThangLon_JSON:"res/Effects/big_win.json",
SpineNo_ThangLon_ATLAS:"res/Effects/big_win.atlas",UIMGItemThangLon:"res/game/xengVanPhuc/MGXVPItemThangLon.json",UIMGPopupThangLon:"res/game/xengVanPhuc/MGXVPPopupThangLon.json",UIMGPopupThongBao:"res/game/xengVanPhuc/MGXVPPopupThongBao.json",UIMGTutorial:"res/game/xengVanPhuc/MGXVPTutorial.json",UIMGItemLichSu:"res/game/xengVanPhuc/MGXVPItemLichSu.json",UIMGPopupLichSu:"res/game/xengVanPhuc/MGXVPPopupLichSu.json",FontXPNG:"res/Fonts/Number-export.png",FontX:"res/Fonts/Number-export.fnt",FontBigWinXPNG:"res/Fonts/fontWin.png",
FontBigWinX:"res/Fonts/fontWin.fnt",FontfontNoHuPNG:"res/Fonts/fontNoHu.png",FontfontNoHu:"res/Fonts/fontNoHu.fnt",XVP_Sound_Click:"res/game/xengVanPhuc/sounds/click.mp3",XVP_Sound_Click_Spin:"res/game/xengVanPhuc/sounds/ClickQuay.mp3",XVP_Sound_Spin:"res/game/xengVanPhuc/sounds/Quay.mp3",XVP_Sound_BigWin:"res/game/xengVanPhuc/sounds/BigWin.mp3",XVP_Sound_Win1:"res/game/xengVanPhuc/sounds/Win1.mp3",XVP_Sound_Win2:"res/game/xengVanPhuc/sounds/Win2.mp3",XVP_Sound_Win3:"res/game/xengVanPhuc/sounds/Win3.mp3",
SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3",XVP_Sound_MiniGame:"res/game/xengVanPhuc/Sounds/XengVanPhucBGM.mp3",XVP_Sound_Bonus:"res/game/xengVanPhuc/Sounds/TrungBonus.mp3",XVP_Sound_FreeSpin:"res/game/xengVanPhuc/Sounds/TrungFreeSpin.mp3"};
ResourceManager.MGResourcesGameXengVanPhucPreloadMobile={XengVanPhucAtlas:"res/game/xengVanPhuc/Atlas/atlasXengVanPhuc.plist",XengVanPhucPng:"res/game/xengVanPhuc/Atlas/atlasXengVanPhuc.png",XengVanPhucItemAtlas:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucItem.plist",XengVanPhucItemPng:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucItem.png",LineXVPPng0:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine0.png",LineXVPAtlas0:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine0.plist",LineXVPPng1:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine1.png",
LineXVPAtlas1:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine1.plist",LineXVPPng2:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine2.png",LineXVPAtlas2:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine2.plist",LineXVPPng3:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine3.png",LineXVPAtlas3:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine3.plist",LineXVPPng4:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine4.png",LineXVPAtlas4:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine4.plist",LineXVPPng5:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine5.png",
LineXVPAtlas5:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine5.plist",LineXVPPng6:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine6.png",LineXVPAtlas6:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine6.plist",LineXVPPng7:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine7.png",LineXVPAtlas7:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine7.plist",LineXVPPng8:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine8.png",LineXVPAtlas8:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine8.plist",LineXVPPng9:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine9.png",
LineXVPAtlas9:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine9.plist",LineXVPPng10:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine10.png",LineXVPAtlas10:"res/game/xengVanPhuc/Atlas/atlasXengVanPhucLine10.plist",UIMGUIXengVanPhucLayer:"res/game/xengVanPhuc/UIXengVanPhucLayer.json",UIMGMiniGame:"res/game/xengVanPhuc/MGXVPPopupMiniGame.json",UIMGUIScrollNode:"res/game/xengVanPhuc/MGScrollNode.json",SpineXVP_Item_PNG:"res/game/xengVanPhuc/spine/XengVanPhuc_ItemFX.png",SpineXVP_Item_JSON:"res/game/xengVanPhuc/spine/XengVanPhuc_ItemFX.json",
SpineXVP_Item_ATLAS:"res/game/xengVanPhuc/spine/XengVanPhuc_ItemFX.atlas",SpineXVP_Bonus_PNG:"res/game/xengVanPhuc/spine/XengVanPhuc_BonusFX.png",SpineXVP_Bonus_JSON:"res/game/xengVanPhuc/spine/XengVanPhuc_BonusFX.json",SpineXVP_Bonus_ATLAS:"res/game/xengVanPhuc/spine/XengVanPhuc_BonusFX.atlas",SpineNo_Hu_PNG:"res/Effects/NoHu_FX.png",SpineNo_Hu_JSON:"res/Effects/NoHu_FX.json",SpineNo_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",SpineNo_ThangLon_PNG:"res/Effects/big_win.png",SpineNo_ThangLon_JSON:"res/Effects/big_win.json",
SpineNo_ThangLon_ATLAS:"res/Effects/big_win.atlas",UIMGItemThangLon:"res/game/xengVanPhuc/MGXVPItemThangLon.json",UIMGPopupThangLon:"res/game/xengVanPhuc/MGXVPPopupThangLon.json",UIMGPopupThongBao:"res/game/xengVanPhuc/MGXVPPopupThongBao.json",UIMGTutorial:"res/game/xengVanPhuc/MGXVPTutorial.json",UIMGItemLichSu:"res/game/xengVanPhuc/MGXVPItemLichSu.json",UIMGPopupLichSu:"res/game/xengVanPhuc/MGXVPPopupLichSu.json",FontXPNG:"res/Fonts/Number-export.png",FontX:"res/Fonts/Number-export.fnt",FontBigWinXPNG:"res/Fonts/fontWin.png",
FontBigWinX:"res/Fonts/fontWin.fnt",FontfontNoHuPNG:"res/Fonts/fontNoHu.png",FontfontNoHu:"res/Fonts/fontNoHu.fnt",XVP_Sound_Click:"res/game/xengVanPhuc/sounds/click.mp3",XVP_Sound_Click_Spin:"res/game/xengVanPhuc/sounds/ClickQuay.mp3",XVP_Sound_Spin:"res/game/xengVanPhuc/sounds/Quay.mp3",XVP_Sound_BigWin:"res/game/xengVanPhuc/sounds/BigWin.mp3",XVP_Sound_Win1:"res/game/xengVanPhuc/sounds/Win1.mp3",XVP_Sound_Win2:"res/game/xengVanPhuc/sounds/Win2.mp3",XVP_Sound_Win3:"res/game/xengVanPhuc/sounds/Win3.mp3",
SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3",XVP_Sound_MiniGame:"res/game/xengVanPhuc/Sounds/XengVanPhucBGM.mp3",XVP_Sound_Bonus:"res/game/xengVanPhuc/Sounds/TrungBonus.mp3",XVP_Sound_FreeSpin:"res/game/xengVanPhuc/Sounds/TrungFreeSpin.mp3"};var resourcesVanPhuc=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengVanPhucPreloadMobile)ResourceManager.MGResourcesGameXengVanPhucPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengVanPhucPreloadMobile[i],resourcesVanPhuc.push(ResourceManager.MGResourcesGameXengVanPhucPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengVanPhuc)ResourceManager.MGResourcesGameXengVanPhuc[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengVanPhuc[i]}else for(i in ResourceManager.MGResourcesGameXengVanPhuc)ResourceManager.MGResourcesGameXengVanPhuc[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameXengVanPhuc[i],resourcesVanPhuc.push(ResourceManager.MGResourcesGameXengVanPhuc[i]);ConstantsVariable.NETWORK_XENG_VANPHUC={Turning:2900,PerformTurning:2901,FortuneWheel:2902,StartGame:2904,UserLeftDesk:2906,ListUser:2907,GameData:2908,FreeTurning:2909,ToolResult:2910,WinBonusBox:2911,BigWin:2912,TopWinBonusBox:2913,TopBigWin:2914};var MGNetSendXengVanPhuc=cc.Class.extend({gameModuleID:null,maiGame:null,ctor:function(a){this.maiGame=a},spinMiniGame:function(){Utilities.showLog("spinMiniGame: ");this.maiGame.stopAllEffect();var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_VANPHUC.FortuneWheel.toString(),null,null);MGNetCore.MGSocket.sendMsg(a)},spin:function(a){Utilities.showLog("spin: "+a);this.maiGame.stopAllEffect();var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_VANPHUC.Turning.toString(),
{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},autoSpin:function(a){Utilities.showLog("auto spin: "+a);this.maiGame.stopAllEffect();var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_VANPHUC.FreeTurning.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendToolVanPhuc:function(a){Utilities.showLog("ToolResult");var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_VANPHUC.ToolResult,
{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXVPItemThangLon=MGBaseNode.extend({containThangLon:null,_textSTT:null,_textMaTK:null,_textTenHienThi:null,_textKetQua:null,_tienThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGItemThangLon,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("BackGroundItemThangLon");this._textSTT=this.containThangLon.getChildByName("TextSTT");
this._textSTT.ignoreContentAdaptWithSize(!0);this._textMaTK=this.containThangLon.getChildByName("TextMTK");this._textMaTK.ignoreContentAdaptWithSize(!0);this._textTenHienThi=this.containThangLon.getChildByName("TextNickName");this._textTenHienThi.ignoreContentAdaptWithSize(!0);this._textKetQua=this.containThangLon.getChildByName("TextKetQua");this._textKetQua.ignoreContentAdaptWithSize(!0);this._tienThang=this.containThangLon.getChildByName("TextGoldThang");this._tienThang.ignoreContentAdaptWithSize(!0)},
getContainThangLon:function(a,b,d,e){if(14<b.length){for(var f="",g=0;11>g;g++)f+=b.charAt(g);b=f+"..."}this._textMaTK.setString(a);this._textTenHienThi.setString(b);this._tienThang.setString(Utilities.Coin(e));this._getKetQua(d)},getSTT:function(a){this._textSTT.setString(a)},_getKetQua:function(a){0==a?this._textKetQua.setString("5 WILD"):1==a?this._textKetQua.setString("NỔ HŨ"):this._textKetQua.setString("Thắng Thường")}});var MGXVPPopupThangLon=MGBaseNode.extend({_dataThangLon:null,_listThangLon:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._currentLoad=0;this._isShowed=!1;this._dataThangLon=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGPopupThangLon,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listThangLon=this.getChildByName("MGListThangLon");
this.scheduleUpdate()},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(4E3,4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButtonBackGame").addClickEventListener(this.hidePopup.bind(this))},update:function(a){this._isShowed&&this._listThangLon.getBottommostItemInCurrentView()&&
this._listThangLon.getBottommostItemInCurrentView().getTag()===this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+10<this._dataThangLon.length?10:this._dataThangLon.length-this._currentLoad;if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this._listThangLon.pushBackCustomItem(this.createCellInfo(this._dataThangLon[b],b+1));this._listThangLon.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.getSTTListData()}},getListDataThangLon:function(a){for(var b=
a.length<MGXVPPopupThangLon.MAX_LINE?a.length:MGXVPPopupThangLon.MAX_LINE,d=0;d<b;d++)this._dataThangLon.push(a[d])},getSTTListData:function(){for(var a=0;a<this._listThangLon.getItems().length;a++)this._listThangLon.getItem(a).setTag(a+1),this._listThangLon.getItem(a).getChildByName("TextSTT").setString(a+1)},createCellInfo:function(a,b){var d=new MGXVPItemThangLon;d.initObj();d.getContainThangLon(a.UserID,a.NickName,a.Type,a.EarnCoin);d.containThangLon.removeFromParent(!0);return d.containThangLon},
getDataThangLon:function(a){this._isShowed?(a=this.createCellInfo(a,0),this._listThangLon.insertCustomItem(a,0),this._listThangLon.getItems().length>MGXVPPopupThangLon.MAX_LINE&&(this._listThangLon.removeItem(MGXVPPopupThangLon.MAX_LINE),this._dataThangLon.splice(this._dataThangLon.length-1,1)),this.getSTTListData()):this._dataThangLon.splice(0,0,a)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click)},showPopup:function(){this._isShowed||
(this._isShowed=!0,this.loadMoreItem(),this._listThangLon.jumpToTop());this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this._listThangLon.removeAllChildren(!0);this._dataThangLon.splice(0,this._dataThangLon.length);this._dataThangLon=[];this.unscheduleUpdate()}});MGXVPPopupThangLon.MAX_LINE=100;var MGXVPPopupThongBao=MGBaseNode.extend({listView:null,maxLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGPopupThongBao,PreLoaderConfig.PathToResourceDefault).node);this.listView=this.getChildByName("MGListThongBao");this._initEventsGame();this.maxLine=100},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(4E3,
4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButtonBackGame").addClickEventListener(this.hidePopup.bind(this));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=
a.getUserData();this.listView.getItems().length>=this.maxLine&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",15,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()},showPopup:function(){this.setVisible(!0)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGXVPItemLichSu=MGBaseNode.extend({containLS:null,_textPhien:null,_textThoiGian:null,_textCuoc:null,_textDongTrung:null,_textTienTrung:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGItemLichSu,PreLoaderConfig.PathToResourceDefault).node);this.containLS=this.getChildByName("BackGroundItemLichSu");this._textPhien=this.containLS.getChildByName("TextPhien");
this._textPhien.ignoreContentAdaptWithSize(!0);this._textThoiGian=this.containLS.getChildByName("TextThoiGian");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textCuoc=this.containLS.getChildByName("TextCuoc");this._textCuoc.ignoreContentAdaptWithSize(!0);this._textDongTrung=this.containLS.getChildByName("TextDongTrung");this._textDongTrung.ignoreContentAdaptWithSize(!0);this._textTienTrung=this.containLS.getChildByName("TextTienTrung");this._textTienTrung.ignoreContentAdaptWithSize(!0)},
getContainLS:function(a,b,d,e,f){this._textPhien.setString(a);this._getThoiGian(b);this._textCuoc.setString(Utilities.Coin(d));this._getDongTrung(e);this._textTienTrung.setString(Utilities.Coin(f))},_getThoiGian:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+a.getSeconds(),d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?a.getHours():"0"+a.getHours();this._textThoiGian.setString(e+":"+d+":"+b+"  "+a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear())},
_getDongTrung:function(a){for(var b=[],d=0;d<a.length;d++)0<a[d]&&b.push(d+1);this._textDongTrung.setString(b.length)}});var MGXVPPopupLichSu=MGBaseNode.extend({_listLichSu:null,_thoiGian:null,_tienCuoc:null,_dongTrung:null,_coinWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGPopupLichSu,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("MGListLichSu")},_initBackGround:function(){var a=new ccui.Layout;
a.setContentSize(4E3,4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButtonBackGame").addClickEventListener(this.hidePopup.bind(this))},getContainLichSu:function(a){var b=new MGXVPItemLichSu;b.initObj();b.getContainLS(a,this._thoiGian,this._tienCuoc,this._dongTrung,
this._coinWin);b.containLS.removeFromParent(!0);this._listLichSu.insertCustomItem(b.containLS,0);this._showListLichSu()},getCoinWin:function(a,b,d,e){this._thoiGian=a;this._tienCuoc=b;this._dongTrung=d;this._coinWin=e},_showListLichSu:function(){this._listLichSu.getItems().length>=MGXVPPopupLichSu.MAX_LINE&&this._listLichSu.removeItem(MGXVPPopupLichSu.MAX_LINE-1)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click)},showPopup:function(){this.setVisible(!0)},
setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXVPPopupLichSu.MAX_LINE=100;var MGXVPCompoButtons=MGBaseNode.extend({_listButton:null,mainGame:null,_benginTouch:!1,_count:0,_canSpin:!0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this._benginTouch=!1;this._count=0;this._canSpin=!0;this.getChildByName(MGXVPCompoButtons.BUTTON_NAME.STOP).setVisible(!1);this.hideButtonSpin()},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,
d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]));this.scheduleUpdate()},update:function(a){this._benginTouch&&(this._count+=a,.5<=this._count&&(this._count=0,this._benginTouch=this._canSpin=!1,this.getChildByName(MGXVPCompoButtons.BUTTON_NAME.SPIN).setVisible(!1),this.mainGame.isAutoSpin=!0,this.getChildByName(MGXVPCompoButtons.BUTTON_NAME.STOP).setVisible(!0),this.hideButtonSpin(),0==this.mainGame.gameStatust&&
this.mainGame.netSend.spin(this.mainGame.getBetGold())))},hideWhenSpin:function(){this.hideButton(MGXVPCompoButtons.BUTTON_NAME.BET_UP);this.hideButton(MGXVPCompoButtons.BUTTON_NAME.BET_DOWN);this.hideButton(MGXVPCompoButtons.BUTTON_NAME.MAX_BET)},showWhenSpinDone:function(){this.showButton(MGXVPCompoButtons.BUTTON_NAME.BET_UP);this.showButton(MGXVPCompoButtons.BUTTON_NAME.BET_DOWN);this.showButton(MGXVPCompoButtons.BUTTON_NAME.MAX_BET)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);
this.getChildByName(a).setEnabled(!1)},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},stopAutoSpin:function(){this.getChildByName(MGXVPCompoButtons.BUTTON_NAME.SPIN).setVisible(!0);this.mainGame.isAutoSpin=!1;this.getChildByName(MGXVPCompoButtons.BUTTON_NAME.STOP).setVisible(!1);this.showButton(MGXVPCompoButtons.BUTTON_NAME.SPIN);this._canSpin=!0},onClickBtnFromCocostudio:function(a,b){Utilities.showLog(b);0==b&&(a.getName()==MGXVPCompoButtons.BUTTON_NAME.SPIN?
mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click_Spin,MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click,MGGameInfo.gameVolume));switch(a.getName()){case MGXVPCompoButtons.BUTTON_NAME.SPIN:switch(b){case 0:this._benginTouch=!0;this._count=0;break;case 1:this._benginTouch=!0;break;case 2:this._count=0;this._benginTouch=!1;this._canSpin&&this.mainGame.netSend.spin(this.mainGame.getBetGold());break;case 3:this._count=0,
this._benginTouch=!1}break;case MGXVPCompoButtons.BUTTON_NAME.INFO:0==b&&this.mainGame.showTutorialLayer();break;case MGXVPCompoButtons.BUTTON_NAME.BET_DOWN:if(0==b)this.mainGame.onClickDown();break;case MGXVPCompoButtons.BUTTON_NAME.BET_UP:if(0==b)this.mainGame.onClickUp();break;case MGXVPCompoButtons.BUTTON_NAME.MAX_BET:if(0==b)this.mainGame.onMaxBetClick();break;case MGXVPCompoButtons.BUTTON_NAME.THANG_LON:0==b&&this.mainGame.popupThangLon.showPopup();break;case MGXVPCompoButtons.BUTTON_NAME.THONG_BAO:0==
b&&this.mainGame.popupThongBao.showPopup();break;case MGXVPCompoButtons.BUTTON_NAME.LICH_SU:0==b&&this.mainGame.popupLichSu.showPopup();break;case MGXVPCompoButtons.BUTTON_NAME.STOP:0==b&&this.stopAutoSpin()}},showButtonSpin:function(){this.showButton(MGXVPCompoButtons.BUTTON_NAME.SPIN);this._canSpin=!0},hideButtonSpin:function(){this.hideButton(MGXVPCompoButtons.BUTTON_NAME.SPIN)},hideAll:function(){for(var a=0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)}});
MGXVPCompoButtons.BUTTON_NAME={SPIN:"Button_Spin",STOP:"Button_Stop",MAX_BET:"Button_MaxBet",BET_UP:"Button_Up",BET_DOWN:"Button_Down",INFO:"Button_Info",THANG_LON:"Button_ThangLon",THONG_BAO:"Button_ThongBao",LICH_SU:"Button_LichSu"};var MGXVPHub=MGBaseNode.extend({mainGame:null,textBigWin:null,textUserGold:null,textMatchID:null,textUserBet:null,textGameStatus:null,textGameResult:null,textFreeSpin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.textBigWin=this.getChildByName("Text_BigGold");this.textBigWin.setString(0);this.textUserGold=this.getChildByName("Text_UserGold");this.textUserGold.setString(Utilities.Coin(MGGameInfo.myInfo.Gold));
this.textMatchID=this.getChildByName("Text_MatchID");this.textMatchID.setString("#0");this.textUserBet=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengVanPhuc.FontX);this.textUserBet.setPosition(this.getChildByName("Text_TotalBet").getPosition());this.textUserBet.setPositionY(this.textUserBet.getPositionY()+5);this.getChildByName("Text_TotalBet").setVisible(!1);this.addChild(this.textUserBet);this.textUserBet.setString("0");this.textGameStatus=this.getChildByName("Text_GameStatus");this.textGameStatus.setString("Dòng Cược");
this.textGameStatus.ignoreContentAdaptWithSize(!0);this.textGameResult=new cc.LabelBMFont("50",ResourceManager.MGResourcesGameXengVanPhuc.FontX);this.textGameResult.setPosition(this.getChildByName("Text_GameResult").getPosition());this.addChild(this.textGameResult);this.textGameResult.setPositionY(this.textGameResult.getPositionY()+5);this.getChildByName("Text_GameResult").setVisible(!1);this.textGameResult.setString("50");this.textFreeSpin=this.getChildByName("Text_FreeSpin")},updateFreeSpin:function(a,
b){var d=b;0<a?(d=a,this.mainGame.isPinBonus=!1):0<b&&0>=a&&(this.mainGame.isPinBonus=!0);0>=d?(this.mainGame.isPinBonus=!1,this.textFreeSpin.setVisible(!1)):(this.textFreeSpin.setVisible(!0),this.mainGame.isPinBonus?(this.textFreeSpin.setString("LƯỢT QUAY BONUS: "+d),mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Bonus,MGGameInfo.gameVolume)):(this.textFreeSpin.setString("LƯỢT QUAY MIỄN PHÍ: "+d),mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_FreeSpin,
MGGameInfo.gameVolume)))},resetStateGame:function(){this.textGameStatus.setString("Dòng Cược");this.textGameResult.setString("50")},updateCoinWin:function(a){this.textGameStatus.setString("Tiền Thắng");this.textGameResult.setString(Utilities.Coin(a))},updateMatchID:function(a){this.textMatchID.setString("#"+a.toString())},updateBigWin:function(a){this.textBigWin.setString(Utilities.Coin(a))},updateUserGold:function(a){this.textUserGold.setString(Utilities.Coin(a))},updateUserBet:function(a){this.textUserBet.setString(Utilities.Coin(a))}});var MGXVPColumn=cc.Class.extend({listItem:null,scrollCol:null,numIconShow:4,index:0,listResult:null,callBackFinish:null,_moreTime:0,ctor:function(){},initObj:function(a,b){this.scrollCol=a;this.listItem=a.getChildren();this.listItem.reverse();this.index=b;this.addEffect();this.randomTopItem();this.updateBottomItem()},addEffect:function(){var a=0,b=this.numIconShow;for(a;a<b;a++)this.listItem[a].row=a,this.listItem[a].col=this.index},randomTopItem:function(){var a=0,b=this.numIconShow,d,e;for(a;a<
b;a++)d=parseInt(14*Math.random())+1,e="Item"+d+".png",this.listItem[a].ItemID=d,this.listItem[a].textureName=e,this.listItem[a].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0),this.listItem[a].setLocalZOrder(10),this.listItem[a].setVisible(!0)},beginScroll:function(){var a=0,b=this.numIconShow;for(a;a<b;a++)this.listItem[a].setVisible(!0)},randomHideItem:function(){var a=0,b=this.numIconShow,d,e,f=this.listItem.length;for(a;a<b;a++)d=parseInt(14*Math.random())+
1,e="Item"+d+".png",this.listItem[f-(this.numIconShow-a)].ItemID=d,this.listItem[f-(this.numIconShow-a)].textureName=e,this.listItem[f-(this.numIconShow-a)].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[f-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateBottomItem:function(){var a=0,b=this.numIconShow,d=this.listItem.length;for(a;a<b;a++)this.listItem[d-(this.numIconShow-a)].ItemID=this.listItem[a].ItemID,this.listItem[d-(this.numIconShow-a)].textureName=this.listItem[a].textureName,
this.listItem[d-(this.numIconShow-a)].loadTexture(this.listItem[a].textureName,ccui.Widget.PLIST_TEXTURE),this.listItem[d-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0),"Item13.png"==this.listItem[a].textureName||"Item2.png"==this.listItem[a].textureName?this.listItem[d-(this.numIconShow-a)].setLocalZOrder(900):this.listItem[d-(this.numIconShow-a)].setLocalZOrder(10)},updateReult:function(){var a=0,b=this.numIconShow,d;for(a;a<b;a++)d="Item"+this.listResult[a]+".png",this.listItem[a].textureName=
d,this.listItem[a].ItemID=this.listResult[a],this.listItem[a].loadTexture(d,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0)},turning:function(a,b){this._moreTime=b;this.scrollFist();this.listResult=a},scrollFist:function(){this.beginScroll();var a=-this.listItem[this.numIconShow-0].getPositionY()/2+37;this.scrollCol.runAction(cc.sequence(cc.jumpBy(.3,cc.p(0,30),0,0),cc.jumpBy(.1,cc.p(0,a),0,0),cc.callFunc(this.scrollSecond.bind(this))))},scrollSecond:function(){this.scrollCol.setPositionY(0);
var a=0;0<this._moreTime&&(a=parseInt(this._moreTime/.2));this.updateBottomItem();this.scrollCol.runAction(cc.sequence(cc.sequence(cc.callFunc(function(){this.randomHideItem();this.scrollCol.setPositionY(0)}.bind(this)),cc.jumpBy(.2,cc.p(0,-488),0,0)).repeat(5+a+2*this.index),cc.callFunc(this.scrollLast.bind(this))))},scrollLast:function(){this.updateReult();this.updateBottomItem();this.scrollCol.setPositionY(0);this.scrollCol.runAction(cc.sequence(cc.jumpBy(.5,cc.p(0,-538),0,0),cc.jumpBy(.1,cc.p(0,
50),0,0),cc.callFunc(function(){this.updateBottomItem();var a={};a.Index=this.index;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,a);this.callBackFinish&&this.callBackFinish()}.bind(this))))}});var MGXVPSpinLayout=cc.Class.extend({listColumn:null,listItemResult:null,mainGame:null,ctor:function(){},initObj:function(a){this.listColumn=[];this.listItemResult=[];var b=0,d=a.getChildByName("Panel");for(b;5>b;b++)a=new MGXVPColumn,a.initObj(d.getChildByName("MGScroll"+b),b),this.listColumn.push(a),this.listItemResult.push(a.listItem[0]),this.listItemResult.push(a.listItem[1]),this.listItemResult.push(a.listItem[2]),this.listItemResult.push(a.listItem[3])},setDelegate:function(a){this.mainGame=
a},getListItemsResult:function(){return this.listItemResult},turning:function(a){var b=0,d=this.mainGame.compoEffect.compoItemEffect.compoEffectNode;d.addReelData(a.ArrIcon,1,[2,14]);for(b;5>b;b++)this.listColumn[b].turning(a.ArrIcon[b],d.getMoreTimeEffect(b)),13==a.ArrIcon[0][b]&&13==a.ArrIcon[1][b]&&13==a.ArrIcon[2][b]&&13==a.ArrIcon[3][b]&&13==a.ArrIcon[4][b]&&(this.mainGame.isShowNohu=!0);this.listColumn[4].callBackFinish=this.finishScroll.bind(this)},setDispose:function(){for(;0<this.listItemResult.length;)this.listItemResult.pop();
for(;0<this.listColumn.length;)this.listColumn.pop()},finishScroll:function(){mg.audio.stopAllEffects();this.mainGame.isAutoSpin||this.mainGame.compoEffect.playEffectEndMatch();this.mainGame.updateGoldWin()}});var MGXVPSpinItemEffect=cc.Class.extend({listItemResult:null,listLine:null,listSpine:null,compoEffectNode:null,gameMain:null,ctor:function(){},initObj:function(a,b){this.gameMain=b;this.listItemResult=a;this.listLine=[];this.listLine[0]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[9],this.listItemResult[13],this.listItemResult[17]];this.listLine[1]=[this.listItemResult[2],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14],this.listItemResult[18]];this.listLine[2]=
[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[12],this.listItemResult[16]];this.listLine[3]=[this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[15],this.listItemResult[19]];this.listLine[4]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[10],this.listItemResult[13],this.listItemResult[16]];this.listLine[5]=[this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14],
this.listItemResult[19]];this.listLine[6]=[this.listItemResult[1],this.listItemResult[6],this.listItemResult[11],this.listItemResult[14],this.listItemResult[17]];this.listLine[7]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[8],this.listItemResult[13],this.listItemResult[18]];this.listLine[8]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[8],this.listItemResult[13],this.listItemResult[16]];this.listLine[9]=[this.listItemResult[3],this.listItemResult[6],this.listItemResult[11],
this.listItemResult[14],this.listItemResult[19]];this.listLine[10]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[9],this.listItemResult[12],this.listItemResult[17]];this.listLine[11]=[this.listItemResult[2],this.listItemResult[7],this.listItemResult[10],this.listItemResult[15],this.listItemResult[18]];this.listLine[12]=[this.listItemResult[1],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14],this.listItemResult[17]];this.listLine[13]=[this.listItemResult[2],
this.listItemResult[5],this.listItemResult[10],this.listItemResult[13],this.listItemResult[18]];this.listLine[14]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[9],this.listItemResult[12],this.listItemResult[16]];this.listLine[15]=[this.listItemResult[3],this.listItemResult[7],this.listItemResult[10],this.listItemResult[15],this.listItemResult[19]];this.listLine[16]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[10],this.listItemResult[13],this.listItemResult[17]];
this.listLine[17]=[this.listItemResult[2],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14],this.listItemResult[18]];this.listLine[18]=[this.listItemResult[2],this.listItemResult[6],this.listItemResult[11],this.listItemResult[14],this.listItemResult[18]];this.listLine[19]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[8],this.listItemResult[13],this.listItemResult[17]];this.listLine[20]=[this.listItemResult[1],this.listItemResult[6],this.listItemResult[10],
this.listItemResult[14],this.listItemResult[17]];this.listLine[21]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[9],this.listItemResult[13],this.listItemResult[18]];this.listLine[22]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[8],this.listItemResult[12],this.listItemResult[17]];this.listLine[23]=[this.listItemResult[2],this.listItemResult[7],this.listItemResult[11],this.listItemResult[15],this.listItemResult[18]];this.listLine[24]=[this.listItemResult[3],
this.listItemResult[6],this.listItemResult[10],this.listItemResult[14],this.listItemResult[19]];this.listLine[25]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[9],this.listItemResult[13],this.listItemResult[16]];this.listLine[26]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[8],this.listItemResult[12],this.listItemResult[18]];this.listLine[27]=[this.listItemResult[1],this.listItemResult[7],this.listItemResult[11],this.listItemResult[15],this.listItemResult[17]];
this.listLine[28]=[this.listItemResult[3],this.listItemResult[5],this.listItemResult[9],this.listItemResult[13],this.listItemResult[19]];this.listLine[29]=[this.listItemResult[0],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14],this.listItemResult[16]];this.listLine[30]=[this.listItemResult[2],this.listItemResult[6],this.listItemResult[8],this.listItemResult[14],this.listItemResult[18]];this.listLine[31]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[11],
this.listItemResult[13],this.listItemResult[17]];this.listLine[32]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[10],this.listItemResult[12],this.listItemResult[16]];this.listLine[33]=[this.listItemResult[3],this.listItemResult[7],this.listItemResult[9],this.listItemResult[15],this.listItemResult[19]];this.listLine[34]=[this.listItemResult[3],this.listItemResult[7],this.listItemResult[8],this.listItemResult[15],this.listItemResult[19]];this.listLine[35]=[this.listItemResult[0],
this.listItemResult[4],this.listItemResult[11],this.listItemResult[12],this.listItemResult[16]];this.listLine[36]=[this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12],this.listItemResult[16]];this.listLine[37]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[10],this.listItemResult[15],this.listItemResult[19]];this.listLine[38]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[9],this.listItemResult[14],this.listItemResult[19]];
this.listLine[39]=[this.listItemResult[3],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13],this.listItemResult[16]];this.listLine[40]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[8],this.listItemResult[12],this.listItemResult[16]];this.listLine[41]=[this.listItemResult[1],this.listItemResult[6],this.listItemResult[11],this.listItemResult[15],this.listItemResult[19]];this.listLine[42]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],
this.listItemResult[13],this.listItemResult[18]];this.listLine[43]=[this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[14],this.listItemResult[17]];this.listLine[44]=[this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[13],this.listItemResult[17]];this.listLine[45]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[10],this.listItemResult[14],this.listItemResult[18]];this.listLine[46]=[this.listItemResult[1],
this.listItemResult[5],this.listItemResult[9],this.listItemResult[14],this.listItemResult[19]];this.listLine[47]=[this.listItemResult[2],this.listItemResult[6],this.listItemResult[10],this.listItemResult[13],this.listItemResult[16]];this.listLine[48]=[this.listItemResult[1],this.listItemResult[7],this.listItemResult[8],this.listItemResult[15],this.listItemResult[17]];this.listLine[49]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[11],this.listItemResult[12],this.listItemResult[18]];
this.listSpine=[];this.compoEffectNode=new MGCompoEffectNode;var d=this.gameMain._mainLayer.getChildByName("MGCompoItemEffect");d.addChild(this.compoEffectNode);this.compoEffectNode.setCallbackOnPlayEffectReel(this.onPlayReelEffect.bind(this));for(var e=0;e<a.length;e++){var f="Item"+(e+1);this.compoEffectNode.addEffectItem(cc.size(180,180),d.getChildByName(f).getPosition())}for(e=1;5>=e;e++)f="MGEffectReel"+e,this.compoEffectNode.addEffectReel(cc.size(240,520),d.getChildByName(f).getPosition())},
hideAllEffect:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)this.listItemResult[a].stopAllActions();this.clearAllSpine();this.compoEffectNode.hideAllEffectReel();this.compoEffectNode.hideAllEffectItem()},playEffectLine:function(a,b){for(var d=0;5>d;d++)this.listLine[a][d].ItemID==b?this._playEffectItem(this.listLine[a][d],b):1==this.listLine[a][d].ItemID&&this._playEffectItem(this.listLine[a][d],1)},setDispose:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)this.listItemResult[a].stopAllActions();
for(this.clearAllSpine();0<this.listItemResult.length;)this.listItemResult.pop();for(;0<this.listItemResult.length;)this.listItemResult.pop();this.compoEffectNode.setDispose()},clearAllSpine:function(){for(var a=0;a<this.listSpine.length;a++)this.listSpine[a].removeFromParent(!0);for(;0<this.listSpine.listSpine;)this.listSpine.pop();this.listSpine=[];this.compoEffectNode.hideAllEffectItem();this.compoEffectNode.hideAllEffectReel()},_playEffectItem:function(a,b){a.setVisible(!0);if(2==b){var d=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Bonus_JSON,
ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Bonus_ATLAS);d.setAnimation(0,"bonusFX",!1);d.setPosition(a.getPosition());d.retain();a.getParent().addChild(d,999);this.listSpine.push(d);a.setVisible(!1);a.runAction(cc.sequence(cc.delayTime(1.8),cc.callFunc(function(){a.setVisible(!0);d.removeFromParent(!0)}.bind(this))))}else if(6==b||7==b||8==b||9==b||13==b)a.setVisible(!0),this.compoEffectNode.showEffectItem(4*a.col+a.row,2),a.runAction(cc.sequence(cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.3,1,1)).repeat(3));
else{var e="";switch(b){case 1:e="WildFX";break;case 3:e="Unicorn";break;case 4:e="Lion";break;case 5:e="Frog";break;case 10:e="Turtle";break;case 11:e="Coins";break;case 12:e="Van";break;case 14:e="Scatter"}d=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Item_JSON,ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Item_ATLAS);d.setAnimation(0,e,!1);d.setPosition(a.getPosition());d.retain();a.getParent().addChild(d,999);this.listSpine.push(d);a.setVisible(!1);a.runAction(cc.sequence(cc.delayTime(1.8),
cc.callFunc(function(){a.setVisible(!0);d.removeFromParent(!0)}.bind(this))))}},_playEffectItemOnReel:function(a,b){a.setVisible(!0);if(2==b){var d=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Bonus_JSON,ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Bonus_ATLAS);d.setAnimation(0,"bonusFX",!1)}else{var e="";switch(b){case 14:e="Scatter"}d=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Item_JSON,ResourceManager.MGResourcesGameXengVanPhuc.SpineXVP_Item_ATLAS);
d.setAnimation(0,e,!1)}d.setPosition(a.getPosition());d.retain();a.getParent().addChild(d,999);this.listSpine.push(d);a.setVisible(!1);a.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){a.setVisible(!0);d.removeFromParent(!0)}.bind(this))))},onPlayReelEffect:function(a){for(var b=0;4>b;b++){var d=this.listItemResult[4*a+b];14!=d.ItemID&&2!=d.ItemID||this._playEffectItemOnReel(d,d.ItemID)}}});var MGXVPEffect=cc.Class.extend({compoLine:null,compoItemEffect:null,listLinesWin:null,listIconLineWin:null,intervalEffect:null,totalLine:null,currentLine:null,canPlayEff:!1,effectWin:null,mainGame:null,ctor:function(a,b,d){this.compoLine=a;this.compoItemEffect=new MGXVPSpinItemEffect;this.compoItemEffect.initObj(b.getListItemsResult(),d);this.mainGame=d;this.listLinesWin=[];this.listIconLineWin=[]},setDataEndMatch:function(a){this.mainGame.effectWin&&this.mainGame.effectWin.stopAnimationWin();this.listLinesWin.length=
0;this.listIconLineWin.length=0;a=a.TypeWinListLineBet;var b=0,d=a.length;for(b;b<d;b++)0<a[b]&&(this.listLinesWin.push(b),this.listIconLineWin.push(a[b]));this.hideAllEffect();null!=this.intervalEffect&&clearInterval(this.intervalEffect);this.currentLine=this.totalLine=this.listLinesWin.length;this.compoItemEffect.clearAllSpine()},stopAllEfect:function(){for(;0<this.listIconLineWin.length;)this.listIconLineWin.pop();for(;0<this.listLinesWin.length;)this.listLinesWin.pop();this.hideAllEffect();null!=
this.intervalEffect&&clearInterval(this.intervalEffect);this.intervalEffect=null;this.compoItemEffect.clearAllSpine();this.canPlayEff=!1},playEffectEndMatch:function(){this.canPlayEff=!0;null!=this.intervalEffect&&clearInterval(this.intervalEffect);cc.delayTime(1);this.showNextEffect();this.intervalEffect=setInterval(this.showNextEffect.bind(this),3E3)},showNextEffect:function(){0!=this.canPlayEff&&(this.mainGame.effectWin||this.mainGame.initEffectWin(),this.currentLine>=this.totalLine?(0<this.mainGame.goldWin&&
this.mainGame.effectWin.playAnimationWin(this.mainGame.goldWin),this.compoItemEffect.hideAllEffect(),this.compoLine.playEffectAllLine(this.listLinesWin),this.currentLine=0):(this.mainGame.effectWin.stopAnimationWin(),this.compoLine.playEffectLine(this.listLinesWin[this.currentLine]),this.compoItemEffect.playEffectLine(this.listLinesWin[this.currentLine],this.listIconLineWin[this.currentLine]),this.currentLine++))},hideAllEffect:function(){this.mainGame.effectWin&&this.mainGame.effectWin.stopAnimationWin();
this.compoLine.hideAllLine()},setDispose:function(){this.canPlayEff=!1;for(null!=this.intervalEffect&&clearInterval(this.intervalEffect);0<this.listIconLineWin.length;)this.listIconLineWin.pop();for(;0<this.listLinesWin.length;)this.listLinesWin.pop();this.compoItemEffect.setDispose();delete this.compoItemEffect;delete this.compoLine}});var MGXVPCompoLine=MGBaseNode.extend({listLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.listLine=a.getChildren();this.hideAllLine()},hideAllLine:function(){var a=0,b=this.listLine.length;for(a;a<b;a++)this.listLine[a].stopAllActions(),this.listLine[a].setVisible(!1)},playEffectAllLine:function(a){this.hideAllLine();var b=0,d=a.length;for(b;b<d;b++)this.listLine[a[b]].setVisible(!0),this.listLine[a[b]].setOpacity(255),
this.listLine[a[b]].runAction(cc.sequence(cc.fadeIn(.3),cc.fadeOut(.3)).repeat(3))},playEffectLine:function(a){this.hideAllLine();this.listLine[a].setVisible(!0);this.listLine[a].setOpacity(255);this.listLine[a].runAction(cc.sequence(cc.fadeIn(.3),cc.fadeOut(.3)).repeat(3))}});var MGXVPPopupMiniGame=MGBaseNode.extend({typeResult:null,timeOutEffectResult:null,timeOutGetReult:null,buttonQuay:null,imageIcon:null,backgroundIcon:null,circleWin:null,_lastIDResult:0,timeOutCallEffect:null,timeOutShowMiniGame:null,mainGame:null,music:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGMiniGame,PreLoaderConfig.PathToResourceDefault).node);
this.buttonQuay=this.getChildByName("MGButtonQuay");this.imageIcon=this.getChildByName("MGListIcon");this.backgroundIcon=this.getChildByName("MGBackGroundIcon");this.backgroundIcon.setVisible(!1);this.circleWin=this.getChildByName("MGCircleWin");this.circleWin.setVisible(!1);this.mainGame=a;this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.buttonQuay.addClickEventListener(this.effectQuay.bind(this))},setTypeResult:function(a){var b=a.length;1==
b?this.typeResult=3:2==b?(1==a[0]&&3==a[1]&&(this.typeResult=0),0==a[0]&&2==a[1]&&(this.typeResult=1),3==a[0]&&4==a[1]&&(this.typeResult=4),0==a[0]&&4==a[1]&&(this.typeResult=5),1==a[0]&&4==a[1]&&(this.typeResult=6)):this.typeResult=3==b?7:2;this.timeOutShowMiniGame=setTimeout(this.showPopupMiniGame.bind(this),3E3);this.timeOutCallEffect=setTimeout(this.effectQuay.bind(this),26E3)},effectQuay:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click_Spin,MGGameInfo.gameVolume);
this.timeOutCallEffect&&clearTimeout(this.timeOutCallEffect);this.buttonQuay.setTouchEnabled(!1);var a=this.processResult(this.typeResult);this.imageIcon.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Spin,MGGameInfo.gameVolume)}.bind(this)),cc.rotateBy(.3,-15).easing(cc.easeIn(1)),cc.rotateBy(7,2895-a).easing(cc.easeInOut(2.5)),cc.callFunc(this.onRollComplete.bind(this))));this._lastIDResult=this.typeResult},
processResult:function(a){return 45*(a-this._lastIDResult)},onRollComplete:function(){this.backgroundIcon.setVisible(!0);this.circleWin.setVisible(!0);this.circleWin.runAction(cc.sequence(cc.sequence(cc.sequence(cc.fadeIn(.3),cc.fadeOut(.3)).repeat(10)),cc.callFunc(this.hideEffectMiniGame.bind(this))))},hideEffectMiniGame:function(){this.circleWin.setVisible(!1);this.backgroundIcon.setVisible(!1);this.buttonQuay.setTouchEnabled(!0);this.mainGame.netSend.spinMiniGame();this.hidePopupMiniGame()},showPopupMiniGame:function(){this.setVisible(!0);
mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_MiniGame,MGGameInfo.gameVolume)},hidePopupMiniGame:function(){this.setVisible(!1);mg.audio.stopAllEffects()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.timeOutCallEffect&&clearTimeout(this.timeOutCallEffect);this.timeOutShowMiniGame&&clearTimeout(this.timeOutShowMiniGame)}});var MGXVPTutorialLayer=MGBaseNode.extend({pageView:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengVanPhuc.UIMGTutorial,PreLoaderConfig.PathToResourceDefault).node);this.pageView=this.getChildByName("PageView");this._initEventBtnFromNode();this.hide();this.pageView.addEventListener(function(a,b){this.updateStatutButton(a.getCurPageIndex())}.bind(this))},_initEventBtnFromNode:function(){for(var a=
this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){Utilities.showLog(a.getName());0==b&&mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Click,MGGameInfo.gameVolume);switch(a.getName()){case MGXVPTutorialLayer.BUTTON_NAME.EXIT:2==b&&this.hide();break;case MGXVPTutorialLayer.BUTTON_NAME.BACK:if(2==b){var d=this.pageView.getCurrentPageIndex();0<d?d--:
d=0;this.updateStatutButton(d);this.pageView.scrollToPage(d)}break;case MGXVPTutorialLayer.BUTTON_NAME.NEXT:2==b&&(d=this.pageView.getCurrentPageIndex(),2>d?d++:d=0,this.updateStatutButton(d),this.pageView.scrollToPage(d))}},updateStatutButton:function(a){Utilities.showLog("Index "+a);0==a?(this.hideButton(MGXVPTutorialLayer.BUTTON_NAME.BACK),this.showButton(MGXVPTutorialLayer.BUTTON_NAME.NEXT)):2==a?(this.hideButton(MGXVPTutorialLayer.BUTTON_NAME.NEXT),this.showButton(MGXVPTutorialLayer.BUTTON_NAME.BACK)):
(this.showButton(MGXVPTutorialLayer.BUTTON_NAME.BACK),this.showButton(MGXVPTutorialLayer.BUTTON_NAME.NEXT))},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0);var a=this.pageView.getCurrentPageIndex();this.updateStatutButton(a)}});
MGXVPTutorialLayer.BUTTON_NAME={EXIT:"Button_Exit",NEXT:"Button_Next",BACK:"Button_Back"};var MGXengVanPhuc=MGBaseGame.extend({compoGameHub:null,compoButtons:null,compoEffect:null,compoSpin:null,compoLine:null,netSend:null,listCanBet:null,countBet:0,popupMiniGame:null,popupThangLon:null,popupThongBao:null,effectNoHu:null,popupLichSu:null,timeTurning:null,tutorialLayer:null,effectLayer:null,countSpinFree:0,isAutoSpin:!1,autoSpinValue:0,spineThangLon:null,gameStatust:0,goldWin:0,textBigWin:null,darkLayer:null,goldCount:0,countSpinBonus:0,isShowNohu:!1,matchID:0,isPinBonus:!1,textNuHu:null,
goldNoHu:0,countNoHu:0,ccAni:null,effectWin:null,extendEffect:null,timeOutBonus:null,checkOneFreeSpin:!1,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesVanPhuc},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=new MGNetSendXengVanPhuc(this);this.initCompoGameHub();this.initCompoSpin();this.initCompoButtons();this.initCompoLine();this.initCompoEffect();this.initPopupThangLon();this.initPopupThongBao();this.initPopupLichSu();this.darkLayer=
this._mainLayer.getChildByName("Dark_Layer");this.darkLayer.removeFromParent(!0);this.darkLayer.setVisible(!1);this.addChild(this.darkLayer);this.listCanBet=[];this.countSpinFree=0;this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.SOUND_WELCOME)}.bind(this),.2)},googleLogin:function(){},facebookLogin:function(){},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengVanPhuc.UIMGUIXengVanPhucLayer,PreLoaderConfig.PathToResourceDefault)},
_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.Turning.toString(),this.ngTurning.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.FreeTurning.toString(),this.ngFreeTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.FortuneWheel.toString(),this.ngFortuneWheel.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.TopBigWin.toString(),this.ngTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_VANPHUC.BigWin.toString(),
this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUserCoin.bind(this)))},_changeBackGroundVP:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameXengVanPhuc.MGBackGroundVP;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)}},initTutorialLayer:function(){this.tutorialLayer=new MGXVPTutorialLayer;this.tutorialLayer.initObj();
this.addChild(this.tutorialLayer);this.effectLayer=new cc.Node;this.effectLayer.setPosition(this._mainLayer.getChildByName("MGScrollContain").getChildByName("Panel").getPosition());this.addChild(this.effectLayer)},showTutorialLayer:function(){this.tutorialLayer||this.initTutorialLayer();this.tutorialLayer.show()},initCompoGameHub:function(){this.compoGameHub=new MGXVPHub;this.compoGameHub.cloneFromNode(this._mainLayer.getChildByName("MGCompoHub"));this.compoGameHub.initObj(this);this.addChild(this.compoGameHub)},
initCompoButtons:function(){this.compoButtons=new MGXVPCompoButtons;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGCompoButton"));this.compoButtons.initObj(this);this.addChild(this.compoButtons)},initCompoSpin:function(){this.compoSpin=new MGXVPSpinLayout;this.compoSpin.setDelegate(this);this.compoSpin.initObj(this._mainLayer.getChildByName("MGScrollContain"))},initCompoLine:function(){this.compoLine=new MGXVPCompoLine;this.compoLine.initObj(this._mainLayer.getChildByName("MGCompoLine"))},
initCompoEffect:function(){this.compoEffect=new MGXVPEffect(this.compoLine,this.compoSpin,this)},initEffectWin:function(){this.effectWin=new MGComboEffectWinCoinXeng;this.effectWin.initObj();this.addChild(this.effectWin);this.effectWin.setPosition(cc.p(640,640));this.effectWin.setPositionText(220);this.effectWin.setPositionAni(85)},initPopupMiniGame:function(){this.popupMiniGame=new MGXVPPopupMiniGame;this.popupMiniGame.initObj(this);this.popupMiniGame.hidePopupMiniGame();this.addChild(this.popupMiniGame)},
initPopupThangLon:function(){this.popupThangLon=new MGXVPPopupThangLon;this.popupThangLon.cloneFromNode(this._mainLayer.getChildByName("MGPopupThangLon"));this.popupThangLon.initObj();this.popupThangLon.hidePopup();this.addChild(this.popupThangLon)},initPopupThongBao:function(){this.popupThongBao=new MGXVPPopupThongBao;this.popupThongBao.cloneFromNode(this._mainLayer.getChildByName("MGPopupThongBao"));this.popupThongBao.initObj();this.popupThongBao.hidePopup();this.addChild(this.popupThongBao)},showNoHu:function(){this.countNoHu=
0;this.isShowNohu=!1;null==this.effectNoHu&&(this.effectNoHu=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengVanPhuc.SpineNo_Hu_JSON,ResourceManager.MGResourcesGameXengVanPhuc.SpineNo_Hu_ATLAS),this.effectNoHu.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2)),this.darkLayer.addChild(this.effectNoHu));null==this.textNuHu&&(this.textNuHu=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengVanPhuc.FontfontNoHu),this.textNuHu.setPosition(cc.p(MGGameInfo.appRealWidth/
2,MGGameInfo.appRealHeight/2)),this.darkLayer.addChild(this.textNuHu));this.darkLayer.setVisible(!0);this.textNuHu.setVisible(!0);this.textNuHu.setString(Utilities.Coin(0));this.runEffectNoHu();this.effectNoHu.setAnimation(0,"animation",!1);this.effectNoHu.setVisible(!0);setTimeout(function(){this.effectNoHu.setVisible(!1);this.textNuHu.setVisible(!1);this.darkLayer.setVisible(!1)}.bind(this),4E3);mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_BigWin)},showSpineThangLon:function(){null==
this.spineThangLon&&(this.spineThangLon=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengVanPhuc.SpineNo_ThangLon_JSON,ResourceManager.MGResourcesGameXengVanPhuc.SpineNo_ThangLon_ATLAS),this.spineThangLon.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2)),this.darkLayer.addChild(this.spineThangLon));null==this.textBigWin&&(this.textBigWin=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengVanPhuc.FontBigWinX),this.textBigWin.setPosition(cc.p(MGGameInfo.appRealWidth/
2,MGGameInfo.appRealHeight/2-50)),this.darkLayer.addChild(this.textBigWin));this.darkLayer.setVisible(!0);this.textBigWin.setVisible(!0);this.textBigWin.setString(0);this.goldCount=0;this.runEffectBigWin();this.spineThangLon.setAnimation(0,"animation",!1);this.spineThangLon.setVisible(!0);setTimeout(function(){this.spineThangLon.setVisible(!1);this.textBigWin.setVisible(!1);this.darkLayer.setVisible(!1);this.goldWin=0}.bind(this),4E3);mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_BigWin)},
runEffectBigWin:function(){if(this.goldCount>=this.goldWin)this.textBigWin.setString(Utilities.Coin(this.goldWin));else{var a=Math.floor(this.goldWin/30);setTimeout(function(){this.goldCount+=a;this.goldCount>=this.goldWin&&(this.goldCount=this.goldWin);this.textBigWin.setString(Utilities.Coin(this.goldCount));this.runEffectBigWin()}.bind(this),30)}},runEffectNoHu:function(){if(this.countNoHu>=this.goldNoHu)this.textNuHu.setString(Utilities.Coin(this.goldNoHu));else{var a=Math.floor(this.goldNoHu/
30);setTimeout(function(){this.countNoHu+=a;this.countNoHu>=this.goldNoHu&&(this.countNoHu=this.goldNoHu);this.textNuHu.setString(Utilities.Coin(this.countNoHu));this.runEffectNoHu()}.bind(this),30)}},initPopupLichSu:function(){this.popupLichSu=new MGXVPPopupLichSu;this.popupLichSu.cloneFromNode(this._mainLayer.getChildByName("MGPopupLichSu"));this.popupLichSu.initObj();this.popupLichSu.hidePopup();this.addChild(this.popupLichSu)},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};
a=(new BinaryParser).initObj(b,a.content);this.compoGameHub.updateUserGold(a.Gold)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListBet:b.Array8,ListBet_Type:b.UInt8,MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));this._changeBackGroundVP();this.compoGameHub.updateMatchID(a.MatchID);
this.compoGameHub.updateUserGold(a.CoinUser);this.listCanBet=a.ListCoinCanBet;this.countSpinBonus=this.countBet=0;this.compoGameHub.updateUserBet(this.listCanBet[0]);this.compoButtons.hideButtonSpin();this.compoGameHub.updateFreeSpin(0,0)},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("StartGame : "+JSON.stringify(a));this.matchID=a.MatchID;this.compoGameHub.updateBigWin(a.TotalCoinBonusBox);
this.compoGameHub.updateUserGold(a.Coin);this.compoButtons.showButtonSpin();this.gameStatust=0;this.isAutoSpin&&this.netSend.spin(this.getBetGold());this.compoButtons.showWhenSpinDone();this.isShowNohu=!1},ngFreeTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={NumFree:b.UInt8,LinesBet:b.Array8,LinesBet_Type:b.UInt8,Coin:b.UInt64,TotalCoinBonusBox:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngFreeTurning : "+JSON.stringify(a));this.countSpinFree=
a.NumFree},ngTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,BetCoin:b.Int64,TypeWinListLineBet:b.Array8,TypeWinListLineBet_Type:b.UInt8,CoinWinBet:b.Int64,RateWinCoinListLineBet:b.Array8,RateWinCoinListLineBet_Type:b.Double,ScatterLines:b.UInt8,TimerPerformTurning:b.UInt8,NumRoundFree:b.UInt8,CoinWinFromBonusBox:b.Int64,NumFreeBonus:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("Turning : "+
JSON.stringify(a));this.isShowNohu=!1;this.compoGameHub.updateUserGold(MGGameInfo.myInfo.Gold);this.compoEffect.setDataEndMatch(a);this.compoSpin.turning(a);this.compoButtons.hideButtonSpin();this.goldWin=a.CoinWinBet;this.compoGameHub.updateCoinWin(0);this.timeTurning=new Date;this.popupLichSu.getCoinWin(this.timeTurning,this.getBetGold(),a.RateWinCoinListLineBet,a.CoinWinBet);this.gameStatust=1;0>=this.countSpinFree&&0<a.NumRoundFree&&(this.checkOneFreeSpin=!0);this.countSpinFree=a.NumRoundFree;
this.countSpinBonus=a.NumFreeBonus;this.compoButtons.hideWhenSpin();mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Spin,MGGameInfo.gameVolume);this.compoGameHub.updateMatchID(this.matchID);this.timeTurning&&this.popupLichSu.getContainLichSu(this.matchID);this.goldNoHu=a.CoinWinFromBonusBox},stopAllEffect:function(){this.compoEffect.stopAllEfect()},ngFortuneWheel:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ColumnsWild:b.Array8,
ColumnsWild_Type:b.UInt8,NumRoundFree:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this.countSpinFree=a.NumRoundFree;this.popupMiniGame||this.initPopupMiniGame();this.popupMiniGame.setTypeResult(a.ColumnsWild);this.compoButtons.stopAutoSpin();Utilities.showLog("FortuneWheel : "+JSON.stringify(a));0<a.NumRoundFree&&(this.isPinBonus=!0,this.playEffectBonus())},ngTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,
CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);this.popupThangLon.getListDataThangLon(a.dataBigWin)},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.popupThangLon.getDataThangLon(a);Utilities.showLog("--Big Win : "+JSON.stringify(a))},
onClickUp:function(){this.countBet++;this.countBet>=this.listCanBet.length&&(this.countBet=0);this.compoGameHub.updateUserBet(this.listCanBet[this.countBet])},onClickDown:function(){this.countBet--;0>this.countBet&&(this.countBet=this.listCanBet.length-1);this.compoGameHub.updateUserBet(this.listCanBet[this.countBet])},onMaxBetClick:function(){this.countBet=this.listCanBet.length-1;this.compoGameHub.updateUserBet(this.listCanBet[this.countBet])},getBetGold:function(){return this.listCanBet[this.countBet]},
initExtendEffect:function(){this.extendEffect=new MGComboEffectSpecialXeng;this.extendEffect.initObj();this.addChild(this.extendEffect)},playEffectBonus:function(){this.extendEffect||this.initExtendEffect();this.extendEffect.playEffectWinBonus(MGGameInfo.appRealHeight/2);this.timeOutBonus&&clearTimeout(this.timeOutBonus);this.timeOutBonus=setTimeout(function(){this.extendEffect.stopEffectWinSpecial()}.bind(this),2E3)},playEffectScatter:function(){this.extendEffect||this.initExtendEffect();this.extendEffect.playEffectWinScatter(MGGameInfo.appRealHeight/
2);this.timeOutBonus&&clearTimeout(this.timeOutBonus);this.timeOutBonus=setTimeout(function(){this.extendEffect.stopEffectWinSpecial()}.bind(this),2E3)},updateGoldWin:function(){this.compoGameHub.updateCoinWin(this.goldWin);this.compoGameHub.updateFreeSpin(this.countSpinFree,this.countSpinBonus);this.compoGameHub.updateUserGold(MGGameInfo.myInfo.Gold);0<this.countSpinFree&&1==this.checkOneFreeSpin&&(this.checkOneFreeSpin=!1,this.playEffectScatter());if(this.isShowNohu)this.showNoHu();else if(0<this.goldWin&&
0==this.isShowNohu)if(this.goldWin>=5*this.getBetGold())this.isPinBonus||this.showSpineThangLon();else{var a=parseInt(3*Math.random())+1;1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Win1,MGGameInfo.gameVolume):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Win2,MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameXengVanPhuc.XVP_Sound_Win3,MGGameInfo.gameVolume)}},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);
mg.audio.stopAllEffects();this.compoSpin.setDispose();this.compoEffect.setDispose();this.popupThongBao&&this.popupThongBao.setDispose();this.timeOutBonus&&clearTimeout(this.timeOutBonus)}});ResourceManager.MGResourcesGameXengPanda={MGBackGroundPanda:"res/game/xengpanda/BackGroundPanda.jpg",EffectPanda_json:"res/game/xengpanda/EffectPD/xeng_pd.json",EffectPanda_atlas:"res/game/xengpanda/EffectPD/xeng_pd.atlas",EffectPanda_png:"res/game/xengpanda/EffectPD/xeng_pd.png",SpineNo_Hu_PNG:"res/Effects/NoHu_FX.png",SpineNo_Hu_JSON:"res/Effects/NoHu_FX.json",SpineNo_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",SpineNo_ThangLon_PNG:"res/Effects/big_win.png",SpineNo_ThangLon_JSON:"res/Effects/big_win.json",
SpineNo_ThangLon_ATLAS:"res/Effects/big_win.atlas",AtlasXengPanda:"res/game/xengpanda/Atlas/AtlasXengPanda.png",PlistXengPanda:"res/game/xengpanda/Atlas/AtlasXengPanda.plist",AtlasComboSpinButtons:"res/game/xengpanda/Atlas/AtlasComboSpinButtons.png",PlistComboSpinButtons:"res/game/xengpanda/Atlas/AtlasComboSpinButtons.plist",FontfontNoHuPNG:"res/Fonts/fontNoHu.png",FontfontNoHu:"res/Fonts/fontNoHu.fnt",FontXPNG:"res/Fonts/Number-export.png",FontX:"res/Fonts/Number-export.fnt",FontBigWinXPNG:"res/Fonts/fontWin.png",
FontBigWinX:"res/Fonts/fontWin.fnt",UIMGUIXengPandaLayer:"res/game/xengpanda/UIXengPandaLayer.json",UIMGContentLichSu:"res/game/xengpanda/MGContentLichSuPD.json",UIMGContentThangLon:"res/game/xengpanda/MGContentThangLonPD.json",UIMGPopupTutorial:"res/game/xengpanda/MGPopupTutorialXPD.json",UIMGPopupLichSu:"res/game/xengpanda/MGPopupLichSuPanda.json",UIMGPopupThangLon:"res/game/xengpanda/MGPopupThangLonPanda.json",UIMGPopupThongBao:"res/game/xengpanda/MGPopupThongBaoPanda.json",XPD_Sound_Click:"res/game/xengpanda/sounds/click.mp3",
XPD_Sound_Click_Spin:"res/game/xengpanda/sounds/ClickQuay.mp3",XPD_Sound_Spin:"res/game/xengpanda/sounds/Quay.mp3",XPD_Sound_BigWin:"res/game/xengpanda/sounds/BigWin.mp3",XPD_Sound_Win1:"res/game/xengpanda/sounds/Win1.mp3",XPD_Sound_Win2:"res/game/xengpanda/sounds/Win2.mp3",XPD_Sound_Win3:"res/game/xengpanda/sounds/Win3.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};
ResourceManager.MGResourcesGameXengPandaPreloadMobile={EffectPanda_json:"res/game/xengpanda/EffectPD/xeng_pd.json",EffectPanda_atlas:"res/game/xengpanda/EffectPD/xeng_pd.atlas",EffectPanda_png:"res/game/xengpanda/EffectPD/xeng_pd.png",SpineNo_Hu_PNG:"res/Effects/NoHu_FX.png",SpineNo_Hu_JSON:"res/Effects/NoHu_FX.json",SpineNo_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",SpineNo_ThangLon_PNG:"res/Effects/big_win.png",SpineNo_ThangLon_JSON:"res/Effects/big_win.json",SpineNo_ThangLon_ATLAS:"res/Effects/big_win.atlas",
AtlasXengPanda:"res/game/xengpanda/Atlas/AtlasXengPanda.png",PlistXengPanda:"res/game/xengpanda/Atlas/AtlasXengPanda.plist",AtlasComboSpinButtons:"res/game/xengpanda/Atlas/AtlasComboSpinButtons.png",PlistComboSpinButtons:"res/game/xengpanda/Atlas/AtlasComboSpinButtons.plist",FontfontNoHuPNG:"res/Fonts/fontNoHu.png",FontfontNoHu:"res/Fonts/fontNoHu.fnt",FontXPNG:"res/Fonts/Number-export.png",FontX:"res/Fonts/Number-export.fnt",FontBigWinXPNG:"res/Fonts/fontWin.png",FontBigWinX:"res/Fonts/fontWin.fnt",
UIMGUIXengPandaLayer:"res/game/xengpanda/UIXengPandaLayer.json",UIMGContentLichSu:"res/game/xengpanda/MGContentLichSuPD.json",UIMGContentThangLon:"res/game/xengpanda/MGContentThangLonPD.json",UIMGPopupTutorial:"res/game/xengpanda/MGPopupTutorialXPD.json",UIMGPopupLichSu:"res/game/xengpanda/MGPopupLichSuPanda.json",UIMGPopupThangLon:"res/game/xengpanda/MGPopupThangLonPanda.json",UIMGPopupThongBao:"res/game/xengpanda/MGPopupThongBaoPanda.json",XPD_Sound_Click:"res/game/xengpanda/sounds/click.mp3",XPD_Sound_Click_Spin:"res/game/xengpanda/sounds/ClickQuay.mp3",
XPD_Sound_Spin:"res/game/xengpanda/sounds/Quay.mp3",XPD_Sound_BigWin:"res/game/xengpanda/sounds/BigWin.mp3",XPD_Sound_Win1:"res/game/xengpanda/sounds/Win1.mp3",XPD_Sound_Win2:"res/game/xengpanda/sounds/Win2.mp3",XPD_Sound_Win3:"res/game/xengpanda/sounds/Win3.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesPanda=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengPandaPreloadMobile)ResourceManager.MGResourcesGameXengPandaPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengPandaPreloadMobile[i],resourcesPanda.push(ResourceManager.MGResourcesGameXengPandaPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengPanda)ResourceManager.MGResourcesGameXengPanda[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengPanda[i]}else for(i in ResourceManager.MGResourcesGameXengPanda)ResourceManager.MGResourcesGameXengPanda[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameXengPanda[i],resourcesPanda.push(ResourceManager.MGResourcesGameXengPanda[i]);ConstantsVariable.NETWORK_XENGPANDA={StartGame:3E3,Turning:3001,UserLeftDesk:3002,ListUser:3003,GameData:3004,FreeTurning:3005,ToolResult:3006,WinBonusBox:3007,BigWin:3008,TopWinBonusBox:3009,TopBigWin:3010,BonusBoxInfo:3011};ConstantsVariable.TYPE_ICON_XPD={WILD:1,SCATTER:2,COIN:3,TURTLE:4,FISH:5,BIRD:6,FLOWER:7,A:8,K:9,Q:10,J:11,TEN:12,NINE:13};ConstantsVariable.TYPE_BOX={NHO:1,VUA:2,KHA:3,LON:4};var MGNetSendXengPanda=cc.Class.extend({gameModuleID:null,ctor:function(){},spin:function(a){var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGPANDA.Turning.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendToolPanda:function(a){var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGPANDA.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,
ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXPDColumn=cc.Class.extend({listItem:null,scrollCol:null,numIconShow:3,index:0,totalIcons:null,callBackFinish:null,_moreTime:0,ctor:function(){this.totalIcons=13;this.numIconShow=3},initObj:function(a,b){this.scrollCol=a;this.listItem=[];for(var d=0;d<a.getChildren().length;d++)this.listItem.push(a.getChildren()[d]);this.index=b;this.randomTopItem();this.updateBottomItem()},randomTopItem:function(){var a=0,b=this.numIconShow,d,e;for(a;a<b;a++)d=parseInt(Math.random()*this.totalIcons)+1,e=MGXPDColumn.ITEMS_ARRAY[d],
this.listItem[a].ItemID=d,this.listItem[a].textureName=e,this.listItem[a].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0),this.listItem[a].setVisible(!0)},beginScroll:function(){var a=0,b=this.numIconShow;for(a;a<b;a++)this.listItem[a].setVisible(!0)},randomHideItem:function(){var a=0,b=this.numIconShow,d,e,f=this.listItem.length;for(a;a<b;a++)d=parseInt(Math.random()*this.totalIcons)+1,e=MGXPDColumn.ITEMS_ARRAY[d],this.listItem[f-(this.numIconShow-a)].ItemID=
d,this.listItem[f-(this.numIconShow-a)].textureName=e,this.listItem[f-(this.numIconShow-a)].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[f-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateBottomItem:function(){var a=0,b=this.numIconShow,d=this.listItem.length;for(a;a<b;a++)this.listItem[d-(this.numIconShow-a)].ItemID=this.listItem[a].ItemID,this.listItem[d-(this.numIconShow-a)].textureName=this.listItem[a].textureName,this.listItem[d-(this.numIconShow-a)].loadTexture(this.listItem[a].textureName,
ccui.Widget.PLIST_TEXTURE),this.listItem[d-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateReult:function(){var a=0,b=this.numIconShow,d;for(a;a<b;a++)d=MGXPDColumn.ITEMS_ARRAY[this.listResult[b-1-a]],this.listItem[a].textureName=d,this.listItem[a].ItemID=this.listResult[b-1-a],this.listItem[a].loadTexture(d,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0)},turning:function(a,b){this._moreTime=b;this.scrollFist();this.listResult=a},scrollFist:function(){this.beginScroll();
var a=-this.listItem[this.numIconShow].getPositionY()/2+37;this.scrollCol.runAction(cc.sequence(cc.jumpBy(.3,cc.p(0,30),0,0),cc.jumpBy(.1,cc.p(0,a),0,0),cc.callFunc(this.scrollSecond.bind(this))))},scrollSecond:function(){this.scrollCol.setPositionY(0);this.updateBottomItem();var a=0;0<this._moreTime&&(a=parseInt(this._moreTime/.2));this.scrollCol.runAction(cc.sequence(cc.sequence(cc.callFunc(function(){this.randomHideItem();this.scrollCol.setPositionY(0)}.bind(this)),cc.jumpBy(.2,cc.p(0,-488),0,
0)).repeat(5+a+2*this.index),cc.callFunc(this.scrollLast.bind(this))))},scrollLast:function(){this.updateReult();this.updateBottomItem();this.scrollCol.setPositionY(0);this.scrollCol.runAction(cc.sequence(cc.jumpBy(.5,cc.p(0,-538),0,0),cc.jumpBy(.1,cc.p(0,138),0,0),cc.callFunc(function(){this.updateBottomItem();var a={};a.Index=this.index;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,a);this.callBackFinish&&this.callBackFinish()}.bind(this))))},getItemFromIndex:function(a){return this.listItem[this.listItem.length-
a-1]},setDispose:function(){this.scrollCol.stopAllActions();this.listItem=[]}});MGXPDColumn.ITEMS_ARRAY=" ImagePandaPanda.png ImageADPanda.png ImageCoinPanda.png ImageKamePanda.png ImageFishPanda.png ImageBirdPanda.png ImageLotusPanda.png ImageAPanda.png ImageKPanda.png ImageQPanda.png ImageJPanda.png Image10Panda.png Image9Panda.png".split(" ");var MGXPDCompoButtonsSpin=MGBaseNode.extend({_listButton:null,mainGame:null,_benginTouch:!1,_count:0,_canSpin:!0,listValueBet:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this._benginTouch=!1;this._count=0;this._canSpin=!0;this.listValueBet=[]},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),
this._listButton.push(a[d]));this.scheduleUpdate()},update:function(a){this._benginTouch&&(this._count+=a,.5<=this._count&&(this._count=0,this._benginTouch=this._canSpin=!1,this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN).setVisible(!1),this.mainGame.isAutoSpin=!0,this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setVisible(!0),this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setEnabled(!0),this.hideButtonSpin(),0==this.mainGame.gameStatus&&this.mainGame.netSend.spin(this.mainGame.getBetGold())))},
hideWhenSpin:function(){this.hideButton(MGXPDCompoButtonsSpin.BUTTON_NAME.BET_UP);this.hideButton(MGXPDCompoButtonsSpin.BUTTON_NAME.BET_DOWN);this.hideButton(MGXPDCompoButtonsSpin.BUTTON_NAME.MAX_BET);this.hideButtonSpin()},showWhenSpinDone:function(){this.showButton(MGXPDCompoButtonsSpin.BUTTON_NAME.BET_UP);this.showButton(MGXPDCompoButtonsSpin.BUTTON_NAME.BET_DOWN);this.showButton(MGXPDCompoButtonsSpin.BUTTON_NAME.MAX_BET);this.showButtonSpin()},hideButton:function(a){this.getChildByName(a).setEnabled(!1);
this.getChildByName(a).setBright(!1)},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},stopAutoSpin:function(){this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN).setVisible(!0);this.mainGame.isAutoSpin=!1;this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setVisible(!1);this._canSpin=!0},onClickBtnFromCocostudio:function(a,b){0==b&&(a.getName()==MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN?mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Click_Spin):
mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Click));switch(a.getName()){case MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN:switch(b){case 0:this._benginTouch=!0;this._count=0;break;case 1:this._benginTouch=!0;break;case 2:this._count=0;this._benginTouch=!1;this._canSpin&&this.sendBetting();break;case 3:this._count=0,this._benginTouch=!1}break;case MGXPDCompoButtonsSpin.BUTTON_NAME.INFO:0==b&&this.mainGame.layerPopup.showPopupTutorial();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.BET_DOWN:if(0==
b)this.mainGame.onClickDown();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.BET_UP:if(0==b)this.mainGame.onClickUp();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.MAX_BET:if(0==b)this.mainGame.onMaxBetClick();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.THANG_LON:0==b&&this.mainGame.layerPopup.showPopupThangLon();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.THONG_BAO:0==b&&this.mainGame.layerPopup.popupThongBao.showPopup();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.LICH_SU:0==b&&this.mainGame.layerPopup.popupLichSu.showPopup();
break;case MGXPDCompoButtonsSpin.BUTTON_NAME.STOP:0==b&&this.stopAutoSpin()}},showButtonSpin:function(){this.showButton(MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN);this._canSpin=!0},hideButtonSpin:function(){this.hideButton(MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN)},hideAll:function(){for(var a=0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)},sendBetting:function(){if(MGGameInfo.myInfo.Gold<this.mainGame.getBetGold()){var a=this.getMaxIndexCanBet();
if(0>a){a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]="Bạn không đủ gold. \nXin vui lòng nạp gold để tiếp tục chơi";cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a);this.mainGame.isAutoSpin&&(this.stopAutoSpin(),this.showWhenSpinDone());return}this.mainGame.setCountBet(a)}this.mainGame.netSend.spin(this.mainGame.getBetGold())},updateListBet:function(a){this.listValueBet=a},getMaxIndexCanBet:function(){for(var a=this.listValueBet.length-
1;0<=a;){if(MGGameInfo.myInfo.Gold>=this.listValueBet[a])return a;a--}return-1}});MGXPDCompoButtonsSpin.BUTTON_NAME={SPIN:"Button_Spin",STOP:"Button_Stop",MAX_BET:"Button_MaxBet",BET_UP:"Button_Up",BET_DOWN:"Button_Down",INFO:"Button_Info",THANG_LON:"Button_ThangLon",THONG_BAO:"Button_ThongBao",LICH_SU:"Button_LichSu"};var MGXPDSpinLayout=cc.Class.extend({listColumn:null,mainGame:null,math:null,listItemResult:null,ctor:function(){},initObj:function(a){this.listColumn=[];this.listItemResult=[];this.math=new MGXPDMath;var b=0,d=a.getChildByName("Panel");for(b;5>b;b++)a=new MGXPDColumn,a.initObj(d.getChildByName("MGScrollXPD"+b),b),this.listColumn.push(a),this.listItemResult.push(a.listItem[5]),this.listItemResult.push(a.listItem[4]),this.listItemResult.push(a.listItem[3])},setDelegate:function(a){this.mainGame=a},
getListItemsResult:function(){return this.listItemResult},turning:function(a){this.mainGame.compoEffect.compoEffectNode.addReelData(a.ArrIcon,1,[ConstantsVariable.TYPE_ICON_XPD.SCATTER]);var b=0;for(b;5>b;b++)this.listColumn[b].turning(a.ArrIcon[b],this.mainGame.compoEffect.compoEffectNode.getMoreTimeEffect(b));0<a.InfoWin.length&&this.caculateResult(a);this.listColumn[4].callBackFinish=this.finishScroll.bind(this)},finishScroll:function(){mg.audio.stopAllEffects();this.mainGame.isAutoSpin||this.mainGame.compoEffect.playEffectEndMatch();
this.mainGame.updateGoldWin()},caculateResult:function(a){var b=0;leng=5;var d=[];this.math.setPropertiesPrepare(a.ArrIcon,3);a=this.getIndexItemWin(a);for(b;b<a.length;b++){this.math.setRootNode(a[b]);this.math.floodFill(0,a[b].index,a[b].value);if(0<this.math.getListResult().length)for(var d=this.math.getListResult().slice(0),e=0;e<d.length;e++)this.mainGame.compoEffect.pushLineToList(d[e]);this.math.clearList()}for(;0<a.length;)a.pop()},getIndexItemWin:function(a){for(var b=a.ArrIcon[0].slice(0),
d=[],e=0,f=0,e=0;e<a.InfoWin.length;e++)for(f=0;f<b.length;f++)if(a.InfoWin[e].Icon==b[f]||a.InfoWin[e].IsReplaceWild&&b[f]==ConstantsVariable.TYPE_ICON_XPD.WILD)d.push(new MGXPPosion(0,f,a.InfoWin[e].Icon,a.InfoWin[e].IsReplaceWild)),b[f]=-1;return d},getItemFromCol:function(a,b){return this.listColumn[a].getItemFromIndex(b)},setDispose:function(){for(var a=this.listColumn.length-1;0<this.listColumn.length;)this.listColumn[a].setDispose(),this.listColumn.pop(),a--;for(;0<this.listItemResult.length;)this.listItemResult.pop();
this.math.setDispose()}});var MGXPDTextHub=MGBaseNode.extend({mainGame:null,textUserGold:null,textMatchID:null,textUserBet:null,textGameStatus:null,textGameResult:null,textFreeSpin:null,textHuNho:null,textHuVua:null,textHuKha:null,textHuLon:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.textUserGold=this.getChildByName(MGXPDTextHub.ITEMS_NAME.USER_GOLD);this.textUserGold.setString(Utilities.Coin(MGGameInfo.myInfo.Gold));this.textMatchID=
this.getChildByName(MGXPDTextHub.ITEMS_NAME.MATCH_ID);this.textMatchID.setString("#0");this.textUserBet=this.getChildByName(MGXPDTextHub.ITEMS_NAME.TONG_CUOC);this.textUserBet.setString("0");this.textGameStatus=this.getChildByName(MGXPDTextHub.ITEMS_NAME.GAME_STATUS);this.textGameStatus.setString("DÒNG CƯỢC");this.textGameResult=this.getChildByName(MGXPDTextHub.ITEMS_NAME.SO_DONG);this.textGameResult.setString("243 DÒNG");this.textFreeSpin=this.getChildByName(MGXPDTextHub.ITEMS_NAME.FREE_SPINS);this.textHuNho=
this.getChildByName(MGXPDTextHub.ITEMS_NAME.HU_NHO);this.textHuVua=this.getChildByName(MGXPDTextHub.ITEMS_NAME.HU_VUA);this.textHuKha=this.getChildByName(MGXPDTextHub.ITEMS_NAME.HU_KHA);this.textHuLon=this.getChildByName(MGXPDTextHub.ITEMS_NAME.HU_LON)},updateFreeSpin:function(a){0>=a?this.textFreeSpin.setVisible(!1):(this.textFreeSpin.setVisible(!0),this.textFreeSpin.setString("LƯỢT QUAY MIỄN PHÍ: "+a))},resetStateGame:function(){this.textGameStatus.setString("DÒNG CƯỢC");this.textGameResult.setString("243 DÒNG")},
updateCoinWin:function(a){this.textGameStatus.setString("TIỀN THẮNG");this.textGameResult.setString(Utilities.Coin(a))},updateMatchID:function(a){this.textMatchID.setString("#"+a.toString())},updateUserGold:function(a){this.textUserGold.setString(Utilities.Coin(a))},updateUserBet:function(a){this.textUserBet.setString(Utilities.Coin(a))},updateBonusBoxs:function(a){for(var b=0;b<a.Info.length;b++)switch(a.Info[b].BoxType){case ConstantsVariable.TYPE_BOX.NHO:this.textHuNho.setString(Utilities.Coin(a.Info[b].Coint));
break;case ConstantsVariable.TYPE_BOX.VUA:this.textHuVua.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.KHA:this.textHuKha.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.LON:this.textHuLon.setString(Utilities.Coin(a.Info[b].Coint))}}});
MGXPDTextHub.ITEMS_NAME={TONG_CUOC:"Text_TongCuoc_Value",SO_DONG:"Text_LinesNumber",GAME_STATUS:"Text_Status",HU_LON:"Text_HuLon",HU_KHA:"Text_HuKha",HU_VUA:"Text_HuVua",HU_NHO:"Text_HuNho",MATCH_ID:"Text_MatchID",FREE_SPINS:"Text_FreeSpin",USER_GOLD:"Text_UserGold"};var MGXPDEffectPanda=MGBaseNode.extend({posListAni:null,mapEffects:null,listLine3Row:null,canPlayEff:null,totalLine:null,currentLine:null,darkLayer:null,mainGame:null,effectBonusBox:null,effectCoinWinNoHu:null,timeOutEffectBonus:null,haveJackPot:!1,effectBigWin:null,effectCoinWinBigWin:null,timeOutEffectBigWin:null,scatterLines:0,listResult:null,effectWin:null,effectSpecialXeng:null,compoEffectNode:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.listLine3Row=[];this.compoEffectNode=
new MGCompoEffectNode;this.addChild(this.compoEffectNode,MGXPDEffectPanda.INDEX_EFFECT_NODE)},initObj:function(a,b){MGBaseNode.prototype.initObj.call(this);this.posListAni=a;this.listResult=b;this.initEffectReel();this.initSkeAnimation();this.mapEffects=[];this.mapEffects[0]=[0,0,0,0,0];this.mapEffects[1]=[0,0,0,0,0];this.mapEffects[2]=[0,0,0,0,0];for(var d=0,e=0;5>e;e++)for(var f=0;3>f;f++)this.mapEffects[f][e]=d,d++;this.initEvents()},initEvents:function(){this._listEvents=[];this._listEvents.push(cc.eventManager.addCustomListener(MGXPDEffectPanda.EVENT.FX_BONUS_BOX,
this.playEffectBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGXPDEffectPanda.EVENT.FX_BIG_WIN,this.playEffectBigWin.bind(this)))},initSkeAnimation:function(){for(var a=0;15>a;a++)this.compoEffectNode.addEffectItem(cc.size(200,200),this.posListAni.getChildByName("Effect_"+a).getPosition())},createSkeletonAnimation:function(a){var b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengPanda.EffectPanda_json,ResourceManager.MGResourcesGameXengPanda.EffectPanda_atlas),
d=this.posListAni.getChildByName("Effect_"+a).getPosition();b.setPosition(cc.p(d.x+6.5,d.y+3.5));b.setVisible(!1);this.addChild(b,MGXPDEffectPanda.INDEX_EFFECT_ITEM);this.listResult[a].AnimationEff=b},initEffectWin:function(){this.effectWin=new MGComboEffectWinCoinXeng;this.effectWin.initObj();this.addChild(this.effectWin,MGXPDEffectPanda.INDEX_EFFECT_COIN);this.effectWin.setPosition(640,540);this.effectWin.setProties(180,.8,80)},initBonusBox:function(){var a=this.mainGame._mainLayer.getChildByName("MGEffectBonusBox").getPosition();
this.effectBonusBox=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengPanda.SpineNo_Hu_JSON,ResourceManager.MGResourcesGameXengPanda.SpineNo_Hu_ATLAS);this.effectBonusBox.setPosition(a);this.mainGame.darkLayer.addChild(this.effectBonusBox);this.effectBonusBox.setVisible(!1);this.effectCoinWinNoHu=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengPanda.FontfontNoHu);this.effectCoinWinNoHu.setVisible(!1);this.mainGame.darkLayer.addChild(this.effectCoinWinNoHu);this.effectCoinWinNoHu.setPosition(a.x,
a.y+10)},initBigWin:function(){var a=this.mainGame._mainLayer.getChildByName("MGEffectBonusBox").getPosition();this.effectBigWin=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengPanda.SpineNo_ThangLon_JSON,ResourceManager.MGResourcesGameXengPanda.SpineNo_ThangLon_ATLAS);this.effectBigWin.setPosition(a.x,a.y+50);this.mainGame.darkLayer.addChild(this.effectBigWin);this.effectBigWin.setVisible(!1);this.effectCoinWinBigWin=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengPanda.FontBigWinX);
this.effectCoinWinBigWin.setVisible(!1);this.mainGame.darkLayer.addChild(this.effectCoinWinBigWin);this.effectCoinWinBigWin.setPosition(a.x,a.y-50)},initEffectSpecialXeng:function(){this.effectSpecialXeng=new MGComboEffectSpecialXeng;this.effectSpecialXeng.initObj();this.effectSpecialXeng.setCallBackSuccess(this.playLinesEffectEndMatch.bind(this));this.mainGame.addChild(this.effectSpecialXeng)},initEffectReel:function(){for(var a=1;5>=a;a++)this.compoEffectNode.addEffectReel(cc.size(240,426),this.posListAni.getChildByName("EffectReel_"+
a).getPosition());this.compoEffectNode.setCallbackOnPlayEffectReel(this.onPlayReelEffect.bind(this))},showAnimation:function(a,b){this.listResult[a].AnimationEff||this.createSkeletonAnimation(a);this.listResult[a].AnimationEff.setVisible(!0);this.listResult[a].AnimationEff.setAnimation(0,b,!0);this.listResult[a].setVisible(!1)},showAnimationOnReel:function(a,b){this.listResult[a].AnimationEff||this.createSkeletonAnimation(a);this.listResult[a].AnimationEff.setVisible(!0);this.listResult[a].AnimationEff.setAnimation(0,
b,!1);this.listResult[a].setVisible(!1);this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.hideAnimation(a)}.bind(this))))},showFrameFx:function(a){var b=this.listResult[a];this.compoEffectNode.showEffectItem(a,2);b.runAction(cc.sequence(cc.sequence(cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.3,1,1)).repeat(3),cc.callFunc(this.hideAllAnimationNormal.bind(this,!1))))},hideAllFrameFx:function(){for(var a=0;a<this.listResult.length;a++)this.compoEffectNode.hideEffectItem(a)},hideAnimation:function(a){this.listResult[a].AnimationEff&&
this.listResult[a].AnimationEff.setVisible(!1);this.listResult[a].setVisible(!0)},hideAllAnimationNormal:function(a){for(var b=0;b<this.listResult.length;b++)a?this.listResult[b].ItemID==ConstantsVariable.TYPE_ICON_XPD.SCATTER&&(this.listResult[b].setVisible(!0),this.listResult[b].AnimationEff&&this.listResult[b].AnimationEff.setVisible(!1)):this.listResult[b].ItemID!=ConstantsVariable.TYPE_ICON_XPD.SCATTER&&(this.listResult[b].setVisible(!0),this.listResult[b].AnimationEff&&this.listResult[b].AnimationEff.setVisible(!1))},
hideAllAnimation:function(){this.effectWin&&this.effectWin.stopAnimationWin();for(var a=0;a<this.listResult.length;a++)this.listResult[a].AnimationEff&&this.listResult[a].AnimationEff.setVisible(!1),this.listResult[a].setVisible(!0);this.compoEffectNode.hideAllEffect()},playLineEffects:function(a){var b=0;length=a.length;for(b;b<length;b++){var d=this.mapEffects[a[b].index][a[b].col];8>a[b].value?this.showAnimation(d,MGXPDEffectPanda.ANIMATION_NAME[a[b].value].NAME):this.showFrameFx(d)}},pushLineToList:function(a){this.listLine3Row.push(a)},
showNextEffect:function(){if(0!=this.canPlayEff&&0!=this.totalLine){this.effectWin||this.initEffectWin();this.currentLine<this.totalLine?(this.effectWin.stopAnimationWin(),this.hideAllAnimationNormal(!1),this.hideAllFrameFx(),this.playLineEffects(this.listLine3Row[this.currentLine]),this.currentLine++):(this.currentLine=0,this.hideAllAnimationNormal(!1),this.hideAllFrameFx(),this.playAllLinesEffects(),0<this.mainGame.goldWin&&this.effectWin.playAnimationWin(this.mainGame.goldWin));mg.audio.stopAllEffects();
var a=parseInt(3*Math.random())+1;1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Win1,MGGameInfo.gameVolume,!1):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Win2,MGGameInfo.gameVolume,!1):mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Win3,MGGameInfo.gameVolume,!1)}},playAllLinesEffects:function(){var a=0;for(a;a<this.listLine3Row.length;a++)this.playLineEffects(this.listLine3Row[a])},resetListLine:function(){for(;0<
this.listLine3Row.length;)this.listLine3Row.pop()},playEffectEndMatch:function(){this.compoEffectNode.hideAllEffectReel();0<this.scatterLines?this.playFireWallEffectEndMatch():this.playLinesEffectEndMatch()},playLinesEffectEndMatch:function(){this.canPlayEff=!0;this.currentLine=this.totalLine=this.listLine3Row.length;0<this.totalLine&&this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.showNextEffect();this.schedule(this.showNextEffect,3)}.bind(this))));0<this.scatterLines&&this.playEffectScatter()},
playFireWallEffectEndMatch:function(){this.effectSpecialXeng||this.initEffectSpecialXeng();this.effectSpecialXeng.playEffectWinScatter(320)},setScatterLines:function(a){this.scatterLines=a},playEffectScatter:function(){for(var a=0;5>a;a++)for(var b=0;3>b;b++)2==this.mainGame.compoSpin.getItemFromCol(a,b).ItemID&&this.showAnimation(this.mapEffects[b][a],MGXPDEffectPanda.ANIMATION_NAME[ConstantsVariable.TYPE_ICON_XPD.SCATTER].NAME)},clearArraysMap:function(){this.listLine3Row=[];this.mapEffects=[];
this.listResult=[]},stopAllEfect:function(){this.unschedule(this.showNextEffect);this.scatterLines=this.totalLine=0;this.resetListLine();this.hideAllAnimation();this.compoEffectNode.hideAllEffect();this.canPlayEff=!1},playEffectBonusBox:function(a){a=a.getUserData();this.mainGame.darkLayer.setVisible(!0);mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_BigWin,MGGameInfo.gameVolume);this.haveJackPot=!0;this.effectBonusBox||this.initBonusBox();this.effectBonusBox.setAnimation(0,
"animation",!1);this.effectBonusBox.setVisible(!0);this.effectCoinWinNoHu.setString(Utilities.Coin(a.EarnCoin));this.effectCoinWinNoHu.setVisible(!0);this.effectCoinWinNoHu.setScale(30);this.effectCoinWinNoHu.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinNoHu.setVisible(!1);this.mainGame.darkLayer.setVisible(!1);this.haveJackPot=!1}.bind(this))));this.timeOutEffectBonus=setTimeout(this.hideEffect.bind(this,this.effectBonusBox),4E3)},playEffectBigWin:function(a){a=
a.getUserData();0==this.haveJackPot&&(this.mainGame.darkLayer.setVisible(!0),mg.audio.stopAllEffects(),mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_BigWin,MGGameInfo.gameVolume),this.effectBigWin||this.initBigWin(),this.effectBigWin.setAnimation(0,"animation",!1),this.effectBigWin.setVisible(!0),this.effectCoinWinBigWin.setString(Utilities.Coin(a.EarnCoin)),this.effectCoinWinBigWin.setVisible(!0),this.effectCoinWinBigWin.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),
cc.callFunc(function(){this.effectCoinWinBigWin.setVisible(!1);this.mainGame.darkLayer.setVisible(!1)}.bind(this)))),this.timeOutEffectBigWin=setTimeout(this.hideEffect.bind(this,this.effectBigWin),4E3))},onPlayReelEffect:function(a){for(var b=0;3>b;b++)Utilities.showLog("onPlayReelEffect  "+a+" i"+b),this.mainGame.compoSpin.getItemFromCol(a,b).ItemID==ConstantsVariable.TYPE_ICON_XPD.SCATTER&&this.showAnimationOnReel(this.mapEffects[b][a],MGXPDEffectPanda.ANIMATION_NAME[ConstantsVariable.TYPE_ICON_XPD.SCATTER].NAME,
!1,!0)},hideEffect:function(a){a.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoEffectNode&&this.compoEffectNode.setDispose();this.timeOutEffectBonus&&clearTimeout(this.timeOutEffectBonus);this.timeOutEffectBigWin&&clearTimeout(this.timeOutEffectBigWin);this.unschedule(this.showNextEffect);this.stopAllActions()}});MGXPDEffectPanda.ANIMATION_NAME={1:{NAME:"panda"},5:{NAME:"ca"},6:{NAME:"co"},3:{NAME:"coin"},2:{NAME:"batquai"},4:{NAME:"rua"},7:{NAME:"sen"}};
MGXPDEffectPanda.EVENT={FX_BONUS_BOX:"fxNoHu",FX_BIG_WIN:"fxBigWin"};MGXPDEffectPanda.INDEX_EFFECT_ITEM=30;MGXPDEffectPanda.INDEX_EFFECT_NODE=50;MGXPDEffectPanda.INDEX_EFFECT_COIN=70;var MGXPDTutorial=MGBaseNode.extend({pageView:null,listButton:null,backGround:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listButton=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengPanda.UIMGPopupTutorial,PreLoaderConfig.PathToResourceDefault).node);this.pageView=this.getChildByName("PageView");this.listButton=this.getChildren();this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=
0;a<this.listButton.length;a++)this.listButton[a]instanceof ccui.Button&&this.listButton[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.pageView.addEventListener(function(a,d){this.updateButtonTutorial(a.getCurPageIndex())}.bind(this))},onClickBtnFromCocostudio:function(a){mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Click);switch(a.getName()){case MGXPDTutorial.BUTTON_NAME.EXIT:this.hidePopup();break;case MGXPDTutorial.BUTTON_NAME.NEXT:a=this.pageView.getCurrentPageIndex();
a=3>a?++a:3;this.updatePageView(a);break;case MGXPDTutorial.BUTTON_NAME.BACK:a=this.pageView.getCurrentPageIndex(),a=0<a?--a:0,this.updatePageView(a)}},updatePageView:function(a){this.pageView.scrollToPage(a);this.updateButtonTutorial(a)},updateButtonTutorial:function(a){0==a?(this.showButton(MGXPDTutorial.BUTTON_NAME.NEXT),this.hideButton(MGXPDTutorial.BUTTON_NAME.BACK)):3==a?(this.showButton(MGXPDTutorial.BUTTON_NAME.BACK),this.hideButton(MGXPDTutorial.BUTTON_NAME.NEXT)):(this.showButton(MGXPDTutorial.BUTTON_NAME.BACK),
this.showButton(MGXPDTutorial.BUTTON_NAME.NEXT))},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showPopup:function(){this.backGround.setVisible(!0);this.setVisible(!0);var a=this.pageView.getCurrentPageIndex();this.updateButtonTutorial(a)},hidePopup:function(){this.backGround.setVisible(!1);this.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});
MGXPDTutorial.BUTTON_NAME={EXIT:"Button_Exit_TTPD",NEXT:"Button_Next_XPD",BACK:"Button_Back_XPD"};var MGXPDThongBao=MGBaseNode.extend({listView:null,backGround:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengPanda.UIMGPopupThongBao,PreLoaderConfig.PathToResourceDefault).node);this.listView=this.getChildByName("ListThongBaoPanda");this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("Button_Exit_TBPD").addClickEventListener(this.hidePopup.bind(this));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=a.getUserData();this.listView.getItems().length>=MGXPDThongBao.MAX_LINE&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",15,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()},showPopup:function(){this.backGround.setVisible(!0);this.setVisible(!0)},
hidePopup:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Click);this.backGround.setVisible(!1);this.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXPDThongBao.MAX_LINE=100;var MGXPDContentThangLon=MGBaseNode.extend({containThangLon:null,_textSTT:null,_textMaTK:null,_textTenHienThi:null,_textKetQua:null,_tienThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengPanda.UIMGContentThangLon,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("BackGroundContentTLPD");this._textSTT=this.containThangLon.getChildByName("TextSTTPanda");
this._textSTT.ignoreContentAdaptWithSize(!0);this._textMaTK=this.containThangLon.getChildByName("TextMTKPanda");this._textMaTK.ignoreContentAdaptWithSize(!0);this._textTenHienThi=this.containThangLon.getChildByName("TextNickNamePanda");this._textTenHienThi.ignoreContentAdaptWithSize(!0);this._textKetQua=this.containThangLon.getChildByName("TextDongTrungPanda");this._textKetQua.ignoreContentAdaptWithSize(!0);this._tienThang=this.containThangLon.getChildByName("TextTienTrungPanda");this._tienThang.ignoreContentAdaptWithSize(!0)},
getContainThangLon:function(a,b,d,e){this._textMaTK.setString(a);this._textTenHienThi.setString(b);this._tienThang.setString(Utilities.Coin(e));this._getKetQua(d)},getSTT:function(a){this._textSTT.setString(a)},_getKetQua:function(a){0<=a&&4>=a&&this._textKetQua.setString(MGXPDContentThangLon.TYPE_NOHU[a])}});MGXPDContentThangLon.TYPE_NOHU={0:"THẮNG LỚN",1:"NỔ HŨ NHỎ",2:"NỔ HŨ VỪA",3:"NỔ HŨ KHÁ",4:"NỔ HŨ LỚN"};var MGXPDThangLon=MGBaseNode.extend({_dataThangLon:null,_listThangLon:null,backGround:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._currentLoad=0;this._isShowed=!1;this._dataThangLon=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengPanda.UIMGPopupThangLon,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listThangLon=this.getChildByName("ListThangLonPanda");
this.scheduleUpdate()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("Button_Exit_TLPD").addClickEventListener(this.hidePopup.bind(this))},update:function(a){this._isShowed&&this._listThangLon.getBottommostItemInCurrentView()&&this._listThangLon.getBottommostItemInCurrentView().getTag()===this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+10<this._dataThangLon.length?10:this._dataThangLon.length-this._currentLoad;
if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this._listThangLon.pushBackCustomItem(this.createCellInfo(this._dataThangLon[b],b+1));this._listThangLon.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.getSTTListData()}},getListDataThangLon:function(a){for(var b=a.length<MGXPDThangLon.MAX_LINE?a.length:MGXPDThangLon.MAX_LINE,d=0;d<b;d++)this._dataThangLon.push(a[d])},getSTTListData:function(){for(var a=0;a<this._listThangLon.getItems().length;a++)this._listThangLon.getItem(a).setTag(a+
1),this._listThangLon.getItem(a).getChildByName("TextSTTPanda").setString(a+1)},createCellInfo:function(a,b){var d=new MGXPDContentThangLon;d.initObj();d.getContainThangLon(a.UserID,a.NickName,a.Type,a.EarnCoin);d.containThangLon.removeFromParent(!0);return d.containThangLon},getDataThangLon:function(a){this._isShowed?(a=this.createCellInfo(a,0),this._listThangLon.insertCustomItem(a,0),this._listThangLon.getItems().length>MGXPDThangLon.MAX_LINE&&(this._listThangLon.removeItem(MGXPDThangLon.MAX_LINE),
this._dataThangLon.splice(this._dataThangLon.length-1,1)),this.getSTTListData()):this._dataThangLon.splice(0,0,a)},hidePopup:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Click);this.backGround.setVisible(!1);this.setVisible(!1)},showPopup:function(){this._isShowed||(this._isShowed=!0,this.loadMoreItem(),this._listThangLon.jumpToTop());this.backGround.setVisible(!0);this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this._listThangLon.removeAllChildren(!0);
this._dataThangLon.splice(0,this._dataThangLon.length);this._dataThangLon=[];this.unscheduleUpdate()}});MGXPDThangLon.MAX_LINE=100;var MGXPDContentLichSu=MGBaseNode.extend({containLS:null,_textPhien:null,_textThoiGian:null,_textCuoc:null,_textDongTrung:null,_textTienTrung:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengPanda.UIMGContentLichSu,PreLoaderConfig.PathToResourceDefault).node);this.containLS=this.getChildByName("BackGroundContentLSPD");this._textPhien=this.containLS.getChildByName("TextPhienPanda");
this._textPhien.ignoreContentAdaptWithSize(!0);this._textThoiGian=this.containLS.getChildByName("TextThoiGianPanda");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textCuoc=this.containLS.getChildByName("TextCuocPanda");this._textCuoc.ignoreContentAdaptWithSize(!0);this._textDongTrung=this.containLS.getChildByName("TextDongTrungPanda");this._textDongTrung.ignoreContentAdaptWithSize(!0);this._textTienTrung=this.containLS.getChildByName("TextTienTrungPanda");this._textTienTrung.ignoreContentAdaptWithSize(!0)},
getContainLS:function(a,b,d,e,f){this._textPhien.setString(a);this._getThoiGian(b);this._textCuoc.setString(Utilities.Coin(d));this._getDongTrung(e);this._textTienTrung.setString(Utilities.Coin(f))},_getThoiGian:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+a.getSeconds(),d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?a.getHours():"0"+a.getHours();this._textThoiGian.setString(e+":"+d+":"+b+"  "+a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear())},
_getDongTrung:function(a){var b=0;if(0==a.length)b=0;else for(var d=0;d<a.length;d++)b+=a[d].NumLineWin;this._textDongTrung.setString(b)}});var MGXPDLichSu=MGBaseNode.extend({_listLichSu:null,_matchID:null,backGround:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengPanda.UIMGPopupLichSu,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("ListLichSuPanda")},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this._listEvents.push(this.getChildByName("Button_Exit_LSPD").addClickEventListener(this.hidePopup.bind(this)))},
getContainLichSu:function(a,b,d,e){var f=new MGXPDContentLichSu;f.initObj();f.getContainLS(this._matchID,a,b,d,e);f.containLS.removeFromParent(!0);this._listLichSu.insertCustomItem(f.containLS,0);this._showListLichSu()},getMatchID:function(a){this._matchID=a},_showListLichSu:function(){this._listLichSu.getItems().length>=MGXPDLichSu.MAX_LINE&&this._listLichSu.removeItem(MGXPDLichSu.MAX_LINE-1)},hidePopup:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Click);this.backGround.setVisible(!1);
this.setVisible(!1)},showPopup:function(){this.backGround.setVisible(!0);this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this._listLichSu.removeAllChildren(!0)}});MGXPDLichSu.MAX_LINE=100;var MGXPDLayerPopup=MGBaseNode.extend({backGroundPopup:null,popupTutorial:null,popupThongBao:null,popupThangLon:null,popupLichSu:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initBackGround();this.initPopupThongBao();this.initPopupThangLon();this.initPopupLichSu()},initBackGround:function(){this.backGroundPopup=new ccui.Layout;this.backGroundPopup.setContentSize(2560,1440);this.backGroundPopup.setPosition(cc.p(0,0));this.backGroundPopup.setAnchorPoint(.5,
.5);this.backGroundPopup.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);this.backGroundPopup.setBackGroundColor(cc.color(0,0,0));this.backGroundPopup.setBackGroundColorOpacity(210);this.backGroundPopup.setTouchEnabled(!0);this.addChild(this.backGroundPopup,0);this.backGroundPopup.setVisible(!1)},initPopupTutorial:function(){this.popupTutorial=new MGXPDTutorial;this.popupTutorial.initObj(this.backGroundPopup);this.popupTutorial.hidePopup();this.addChild(this.popupTutorial)},showPopupTutorial:function(){this.popupTutorial||
this.initPopupTutorial();this.popupTutorial.showPopup()},showPopupThangLon:function(){this.popupThangLon.showPopup()},initPopupThongBao:function(){this.popupThongBao=new MGXPDThongBao;this.popupThongBao.initObj(this.backGroundPopup);this.popupThongBao.hidePopup();this.addChild(this.popupThongBao)},initPopupThangLon:function(){this.popupThangLon=new MGXPDThangLon;this.popupThangLon.initObj(this.backGroundPopup);this.popupThangLon.hidePopup();this.addChild(this.popupThangLon)},initPopupLichSu:function(){this.popupLichSu=
new MGXPDLichSu;this.popupLichSu.initObj(this.backGroundPopup);this.popupLichSu.hidePopup();this.addChild(this.popupLichSu)}});var MGXPDMath=cc.Class.extend({row:0,col:0,listPositions:null,listArrayPositions:null,listSource:null,maxCount:0,rootIndex:0,rootCol:0,rootIsWild:!1,rootNodePos:null,ctor:function(){this.listPositions=[];this.listArrayPositions=[];this.listSource=[]},setPropertiesPrepare:function(a,b){this.maxCount=b;this.listSource=a;this.listArrayPositions=[];this.listPositions=[]},clearList:function(){this.listArrayPositions=[];this.listPositions=[];this.rootNodePos=null},setRootNode:function(a){this.rootNodePos=
a},floodFill:function(a,b,d){for(var e=!1,f=-2;2>=f;f++)for(var g=1;1>=g;g++){var h=a+g,k=b+f;-1<k&&5>h&&3>k&&(this.listSource[h][k]==d||this.listSource[h][k]==ConstantsVariable.TYPE_ICON_XPD.WILD)&&(e=!0,this.listPositions.push(new MGXPPosion(h,k,this.listSource[h][k]==ConstantsVariable.TYPE_ICON_XPD.WILD?ConstantsVariable.TYPE_ICON_XPD.WILD:this.listSource[h][k],!1)),3<this.listPositions.length&&(this.listArrayPositions.push(this.listPositions.slice(0)),this.listArrayPositions[this.listArrayPositions.length-
1].unshift(new MGXPPosion(this.rootNodePos.col,this.rootNodePos.index,this.rootNodePos.isWild?ConstantsVariable.TYPE_ICON_XPD.WILD:this.rootNodePos.value,!1))),this.floodFill(h,k,d))}!e&&1<this.listPositions.length&&3>=this.listPositions.length&&(this.listArrayPositions.push(this.listPositions.slice(0)),this.listArrayPositions[this.listArrayPositions.length-1].unshift(new MGXPPosion(this.rootNodePos.col,this.rootNodePos.index,this.rootNodePos.isWild?ConstantsVariable.TYPE_ICON_XPD.WILD:this.rootNodePos.value,
!1)));0<this.listPositions.length&&this.listPositions.pop()},getListResult:function(){return this.listArrayPositions},setDispose:function(){this.listArrayPositions=[];this.listPositions=[];this.listSource=[]}}),MGXPPosion=cc.Class.extend({col:0,index:0,value:0,isWild:!1,ctor:function(a,b,d,e){this.col=a;this.index=b;this.value=d;this.isWild=e}});var MGXengPanda=MGBaseGame.extend({netSend:null,layerPopup:null,compoButtonsSpin:null,compoGameTextHub:null,compoSpin:null,compoEffect:null,listCanBet:null,countBet:0,goldWin:0,countSpinFree:0,isAutoSpin:null,gameStatus:0,timeTurning:null,isShowNohu:!1,effectNoHu:null,textNoHu:null,goldNoHu:0,countNoHu:0,isPinBonus:!1,matchID:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesPanda},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.netSend=
new MGNetSendXengPanda;this.initCompoButtonsSpin();this.initCompoSpin();this.darkLayer=this._mainLayer.getChildByName("Dark_Layer");this.darkLayer.removeFromParent(!0);this.darkLayer.setVisible(!1);this.initCompoEffect();this.initCompoTextHub();this.addChild(this.darkLayer);this.initLayerPopup();this.listCanBet=[];this.countSpinFree=0;this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.SOUND_WELCOME)}.bind(this),.2)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengPanda.UIMGUIXengPandaLayer,
PreLoaderConfig.PathToResourceDefault)},initCompoButtonsSpin:function(){this.compoButtonsSpin=new MGXPDCompoButtonsSpin;this.compoButtonsSpin.cloneFromNode(this._mainLayer.getChildByName("MGCompoButtonsXPD"));this.compoButtonsSpin.initObj(this);this.addChild(this.compoButtonsSpin)},initCompoTextHub:function(){this.compoGameTextHub=new MGXPDTextHub;this.compoGameTextHub.cloneFromNode(this._mainLayer.getChildByName("MGCompoTextHubXPD"));this.compoGameTextHub.initObj(this);this.addChild(this.compoGameTextHub)},
initCompoSpin:function(){this.compoSpin=new MGXPDSpinLayout;this.compoSpin.setDelegate(this);this.compoSpin.initObj(this._mainLayer.getChildByName("MGScrollContainXPD"))},initCompoEffect:function(){this.compoEffect=new MGXPDEffectPanda(this);this.compoEffect.initObj(this._mainLayer.getChildByName("NodeCompoEffect"),this.compoSpin.getListItemsResult());this.addChild(this.compoEffect)},_changeBackGroundPanda:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=
ResourceManager.MGResourcesGameXengPanda.MGBackGroundPanda;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)}},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.StartGame.toString(),this.ngStartGame.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.Turning.toString(),this.ngTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.TopBigWin.toString(),this.ngTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.BigWin.toString(),this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.BonusBoxInfo.toString(),
this.ngBonusBoxInfo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGPANDA.WinBonusBox.toString(),this.ngWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK.toString(),this.ngSubMenuLeaveRoom.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this.ngUserCoin.bind(this)))},initLayerPopup:function(){this.layerPopup=
new MGXPDLayerPopup;this.layerPopup.cloneFromNode(this._mainLayer.getChildByName("NodeLayerPopup"));this.layerPopup.initObj();this.addChild(this.layerPopup)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,NumRoundFree:b.UInt8};a=(new BinaryParser).initObj(b,a.content);this.isShowNohu=!1;this.countSpinFree=a.NumRoundFree;this.countSpinBonus=0;this.listCanBet=
a.ListCoinCanBet;this.compoGameTextHub.updateMatchID(a.MatchID);this.compoGameTextHub.updateUserGold(a.CoinUser);this.compoGameTextHub.updateUserBet(this.listCanBet[0]);this.compoButtonsSpin.updateListBet(a.ListCoinCanBet);this.layerPopup.popupLichSu.getMatchID(a.MatchID);this.compoGameTextHub.updateFreeSpin(this.countSpinFree);this._changeBackGroundPanda();this.compoButtonsSpin.hideButtonSpin();this.matchID=a.MatchID},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,
TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.gameStatus=0;this.matchID=a.MatchID;this.layerPopup.popupLichSu.getMatchID(a.MatchID);this.isAutoSpin?this.compoButtonsSpin.sendBetting():0<this.countSpinFree?this.compoButtonsSpin.showButtonSpin():this.compoButtonsSpin.showWhenSpinDone()},ngTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,CoinWinBet:b.UInt64,ScatterLines:b.UInt8,
NumRoundFree:b.UInt8,CoinWinFromBonusBox:b.UInt64,InfoWin:b.Array8,InfoWin_Type:b.Object8,InfoWin_Type_Struct:{Icon:b.UInt8,NumLineWin:b.UInt8,IsReplaceWild:b.UInt8}};a=(new BinaryParser).initObj(b,a.content);this.gameStatus=1;this.isShowNohu=!1;this.goldWin=a.CoinWinBet;this.countSpinFree=a.NumRoundFree;this.compoGameTextHub.updateMatchID(this.matchID);this.compoGameTextHub.resetStateGame();this.compoButtonsSpin.hideWhenSpin();this.compoEffect.stopAllEfect();this.compoEffect.setScatterLines(a.ScatterLines);
this.compoSpin.turning(a);this.timeTurning=new Date;this.layerPopup.popupLichSu.getContainLichSu(this.timeTurning,this.getBetGold(),a.InfoWin,a.CoinWinBet);this.goldNoHu=a.CoinWinFromBonusBox;mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengPanda.XPD_Sound_Spin)},ngTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,
Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);this.layerPopup.popupThangLon.getListDataThangLon(a.dataBigWin)},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this.layerPopup.popupThangLon.getDataThangLon(a);MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGXPDEffectPanda.EVENT.FX_BIG_WIN,
a)},ngWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64,TypeBox:b.UInt8};a=(new BinaryParser).initObj(b,a.content);MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGXPDEffectPanda.EVENT.FX_BONUS_BOX,a)},ngBonusBoxInfo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Info:b.Array8,Info_Type:b.Object8,Info_Type_Struct:{BoxType:b.UInt8,
Coint:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);this.compoGameTextHub.updateBonusBoxs(a)},ngTopWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBonus:b.Array8,dataBonus_Type:b.Object8,dataBonus_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64,BoxType:b.UInt8}};(new BinaryParser).initObj(b,a.content)},ngSubMenuLeaveRoom:function(a){0<this.countSpinFree&&this.isAutoSpin&&this.compoButtonsSpin.stopAutoSpin()},
ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.compoGameTextHub.updateUserGold(a.Gold)},onMaxBetClick:function(){this.countBet=this.listCanBet.length-1;this.compoGameTextHub.updateUserBet(this.listCanBet[this.countBet])},onClickUp:function(){this.countBet++;this.countBet>=this.listCanBet.length&&(this.countBet=0);this.compoGameTextHub.updateUserBet(this.listCanBet[this.countBet])},onClickDown:function(){this.countBet--;
0>this.countBet&&(this.countBet=this.listCanBet.length-1);this.compoGameTextHub.updateUserBet(this.listCanBet[this.countBet])},getBetGold:function(){return this.listCanBet[this.countBet]},setCountBet:function(a){this.countBet=a;this.compoGameTextHub.updateUserBet(this.listCanBet[this.countBet])},updateGoldWin:function(){this.compoGameTextHub.updateCoinWin(this.goldWin);this.compoGameTextHub.updateFreeSpin(this.countSpinFree);this.compoGameTextHub.updateUserGold(MGGameInfo.myInfo.Gold)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);
this.countSpinFree=0;mg.audio.stopAllEffects();this.compoEffect&&(this.compoEffect.stopAllEfect(),this.compoEffect.clearArraysMap(),this.compoEffect.setDispose());this.compoSpin&&this.compoSpin.setDispose();this.compoGameTextHub&&this.compoGameTextHub.setDispose();this.layerPopup&&this.layerPopup.setDispose()}});ResourceManager.MGResourcesGameXengHoangCung={XHCBackgroundOutGame:"res/game/xenghoangcung/XHCBackgroundOutGame.jpg",XHCGameBackground:"res/game/xenghoangcung/atlas/Background/XHCGameBackground.jpg",XHCMiniGameBackground:"res/game/xenghoangcung/atlas/Background/XHCMiniGameBackground.jpg",EffectHoangCung_json:"res/game/xenghoangcung/Effect/XengHoangCung.json",EffectHoangCung_atlas:"res/game/xenghoangcung/Effect/XengHoangCung.atlas",EffectHoangCung_png:"res/game/xenghoangcung/Effect/XengHoangCung.png",
PlistXengHoangCung:"res/game/xenghoangcung/atlas/AtlasXHC/AtlasXHC.plist",AtlasXengHoangCung:"res/game/xenghoangcung/atlas/AtlasXHC/AtlasXHC.png",PlistItemsXHC:"res/game/xenghoangcung/atlas/AtlasItem/AtlasItemsXHC.plist",AtlasItemsXHC:"res/game/xenghoangcung/atlas/AtlasItem/AtlasItemsXHC.png",UIMGUIXengHoangCungLayer:"res/game/xenghoangcung/UIXengHoangCungLayer.json",UIMGUICompoMiniGame:"res/game/xenghoangcung/UIMGXHCCompoMiniGame.json",UIMGPopupBigWinNode:"res/game/xenghoangcung/UIMGXHCPopupBigWin.json",
UIMGPopupHistoryNode:"res/game/xenghoangcung/UIMGXHCPopupHistory.json",UIMGPopupNotifyNode:"res/game/xenghoangcung/UIMGXHCPopupNotify.json",UIMGPopupGameInfoNode:"res/game/xenghoangcung/UIMGXHCPopupGameInfoNode.json",UIMGPopupFreeTuring:"res/game/xenghoangcung/UIMGXHCPopupFreeTurning.json",BonusBox_Atlas:"res/Effects/NoHu_FX.atlas",BonusBox_PNG:"res/Effects/NoHu_FX.png",BonusBox_Json:"res/Effects/NoHu_FX.json",ThangLon_PNG:"res/Effects/big_win.png",ThangLon_JSON:"res/Effects/big_win.json",ThangLon_ATLAS:"res/Effects/big_win.atlas",
Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",FontWin_fnt:"res/Fonts/fontWin.fnt",FontWin_png:"res/Fonts/fontWin.png",FontVua_fnt:"res/Fonts/VuaNumber-export.fnt",FontVua_png:"res/Fonts/VuaNumber-export.png",FontLon_fnt:"res/Fonts/LonNumber-export.fnt",FontLon_png:"res/Fonts/LonNumber-export.png",FontNho_fnt:"res/Fonts/NhoNumber-export.fnt",FontNho_png:"res/Fonts/NhoNumber-export.png",FontKha_fnt:"res/Fonts/KhaNumber-export.fnt",FontKha_png:"res/Fonts/KhaNumber-export.png",FontFree_fnt:"res/Fonts/FreeNumber-export.fnt",
FontFree_png:"res/Fonts/FreeNumber-export.png",SFX_Click:"res/game/xenghoangcung/Sounds/click.mp3",SFX_ClickQuay:"res/game/xenghoangcung/Sounds/clickquay.mp3",SFX_Bigwin:"res/game/xenghoangcung/Sounds/bigwin.mp3",SFX_Quay:"res/game/xenghoangcung/Sounds/quay.mp3",SFX_Win1:"res/game/xenghoangcung/Sounds/win1.mp3",SFX_Win2:"res/game/xenghoangcung/Sounds/win2.mp3",SFX_Win3:"res/game/xenghoangcung/Sounds/win3.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};
ResourceManager.MGResourcesGameXengHoangCungPreloadMobile={EffectHoangCung_json:"res/game/xenghoangcung/Effect/XengHoangCung.json",EffectHoangCung_atlas:"res/game/xenghoangcung/Effect/XengHoangCung.atlas",EffectHoangCung_png:"res/game/xenghoangcung/Effect/XengHoangCung.png",PlistXengHoangCung:"res/game/xenghoangcung/atlas/AtlasXHC/AtlasXHC.plist",AtlasXengHoangCung:"res/game/xenghoangcung/atlas/AtlasXHC/AtlasXHC.png",PlistItemsXHC:"res/game/xenghoangcung/atlas/AtlasItem/AtlasItemsXHC.plist",AtlasItemsXHC:"res/game/xenghoangcung/atlas/AtlasItem/AtlasItemsXHC.png",
UIMGUIXengHoangCungLayer:"res/game/xenghoangcung/UIXengHoangCungLayer.json",UIMGUICompoMiniGame:"res/game/xenghoangcung/UIMGXHCCompoMiniGame.json",UIMGPopupBigWinNode:"res/game/xenghoangcung/UIMGXHCPopupBigWin.json",UIMGPopupHistoryNode:"res/game/xenghoangcung/UIMGXHCPopupHistory.json",UIMGPopupNotifyNode:"res/game/xenghoangcung/UIMGXHCPopupNotify.json",UIMGPopupGameInfoNode:"res/game/xenghoangcung/UIMGXHCPopupGameInfoNode.json",UIMGPopupFreeTuring:"res/game/xenghoangcung/UIMGXHCPopupFreeTurning.json",
BonusBox_Atlas:"res/Effects/NoHu_FX.atlas",BonusBox_PNG:"res/Effects/NoHu_FX.png",BonusBox_Json:"res/Effects/NoHu_FX.json",ThangLon_PNG:"res/Effects/big_win.png",ThangLon_JSON:"res/Effects/big_win.json",ThangLon_ATLAS:"res/Effects/big_win.atlas",Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",FontWin_fnt:"res/Fonts/fontWin.fnt",FontWin_png:"res/Fonts/fontWin.png",FontVua_fnt:"res/Fonts/VuaNumber-export.fnt",FontVua_png:"res/Fonts/VuaNumber-export.png",FontLon_fnt:"res/Fonts/LonNumber-export.fnt",
FontLon_png:"res/Fonts/LonNumber-export.png",FontNho_fnt:"res/Fonts/NhoNumber-export.fnt",FontNho_png:"res/Fonts/NhoNumber-export.png",FontKha_fnt:"res/Fonts/KhaNumber-export.fnt",FontKha_png:"res/Fonts/KhaNumber-export.png",FontFree_fnt:"res/Fonts/FreeNumber-export.fnt",FontFree_png:"res/Fonts/FreeNumber-export.png",SFX_Click:"res/game/xenghoangcung/Sounds/click.mp3",SFX_ClickQuay:"res/game/xenghoangcung/Sounds/clickquay.mp3",SFX_Bigwin:"res/game/xenghoangcung/Sounds/bigwin.mp3",SFX_Quay:"res/game/xenghoangcung/Sounds/quay.mp3",
SFX_Win1:"res/game/xenghoangcung/Sounds/win1.mp3",SFX_Win2:"res/game/xenghoangcung/Sounds/win2.mp3",SFX_Win3:"res/game/xenghoangcung/Sounds/win3.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesXengHoangCung=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengHoangCungPreloadMobile)ResourceManager.MGResourcesGameXengHoangCungPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengHoangCungPreloadMobile[i],resourcesXengHoangCung.push(ResourceManager.MGResourcesGameXengHoangCungPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengHoangCung)ResourceManager.MGResourcesGameXengHoangCung[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengHoangCung[i]}else for(i in ResourceManager.MGResourcesGameXengHoangCung)ResourceManager.MGResourcesGameXengHoangCung[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameXengHoangCung[i],resourcesXengHoangCung.push(ResourceManager.MGResourcesGameXengHoangCung[i]);ConstantsVariable.NETWORK_XENGHOANGCUNG={StartGame:3100,Turning:3101,UserLeftDesk:3102,ListUser:3103,GameData:3104,FreeTurning:3105,ToolResult:3106,WinBonusBox:3107,BigWin:3108,TopWinBonusBox:3109,TopBigWin:3110,BonusBoxInfo:3111,StartMiniGame:3112,ChoiceGameMini:3113,ResultGameMini:3114};ConstantsVariable.TYPE_ICON_XHC={NOTHING:0,WILD:1,SCATTER:2,COIN:3,TURTLE:4,FISH:5,LION:6,FROG:7,TEN:8,A:9,K:10,Q:11,J:12};ConstantsVariable.TYPE_BOX={NHO:1,VUA:2,KHA:3,LON:4};
ConstantsVariable.STATE_XHC={NOT_START:0,WAIT:1,TURNING:2,GAME_MINI:3,FINISH:4};var MGXHCMath=cc.Class.extend({row:0,col:0,listPositions:null,listArrayPositions:null,listSource:null,maxCount:0,rootIndex:0,rootCol:0,rootIsWild:!1,rootNodePos:null,ctor:function(){this.listPositions=[];this.listArrayPositions=[];this.listSource=[]},setPropertiesPrepare:function(a,b){this.maxCount=b;this.listSource=a;this.listArrayPositions=[];this.listPositions=[]},clearList:function(){this.listArrayPositions=[];this.listPositions=[];this.rootNodePos=null},setRootNode:function(a){this.rootNodePos=
a},floodFill:function(a,b,d){for(var e=!1,f=-2;2>=f;f++)for(var g=1;1>=g;g++){var h=a+g,k=b+f;-1<k&&5>h&&3>k&&(this.listSource[h][k]==d||this.listSource[h][k]==ConstantsVariable.TYPE_ICON_XHC.WILD)&&(e=!0,this.listPositions.push(new MGXHCPosion(h,k,this.listSource[h][k]==ConstantsVariable.TYPE_ICON_XHC.WILD?ConstantsVariable.TYPE_ICON_XHC.WILD:this.listSource[h][k],!1)),3<this.listPositions.length&&(this.listArrayPositions.push(this.listPositions.slice(0)),this.listArrayPositions[this.listArrayPositions.length-
1].unshift(new MGXHCPosion(this.rootNodePos.col,this.rootNodePos.index,this.rootNodePos.isWild?ConstantsVariable.TYPE_ICON_XHC.WILD:this.rootNodePos.value,!1))),this.floodFill(h,k,d))}e||(2>=this.listPositions.length&&d===ConstantsVariable.TYPE_ICON_XHC.LION?(this.listArrayPositions.push(this.listPositions.slice(0)),this.listArrayPositions[this.listArrayPositions.length-1].unshift(new MGXHCPosion(this.rootNodePos.col,this.rootNodePos.index,this.rootNodePos.isWild?ConstantsVariable.TYPE_ICON_XHC.WILD:
this.rootNodePos.value,!1))):1<this.listPositions.length&&3>=this.listPositions.length&&(this.listArrayPositions.push(this.listPositions.slice(0)),this.listArrayPositions[this.listArrayPositions.length-1].unshift(new MGXHCPosion(this.rootNodePos.col,this.rootNodePos.index,this.rootNodePos.isWild?ConstantsVariable.TYPE_ICON_XHC.WILD:this.rootNodePos.value,!1))));0<this.listPositions.length&&this.listPositions.pop()},getListResult:function(){return this.listArrayPositions},setDispose:function(){this.listArrayPositions=
[];this.listPositions=[];this.listSource=[]}}),MGXHCPosion=cc.Class.extend({col:0,index:0,value:0,isWild:!1,ctor:function(a,b,d,e){this.col=a;this.index=b;this.value=d;this.isWild=e}});var MGNetSendXengHoangCung=cc.Class.extend({gameModuleID:null,ctor:function(){},spin:function(a){Utilities.showLog("spin: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGHOANGCUNG.Turning.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendChoiceGameMini:function(a){var b={};b.Index=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGHOANGCUNG.ChoiceGameMini,{Index:BinaryConstants.DataTypeID.UInt8},
b);MGNetCore.MGSocket.sendMsg(a)},sendToolHoangCung:function(a){var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGHOANGCUNG.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXHCColumn=cc.Class.extend({listItem:null,scrollCol:null,numIconShow:3,index:0,totalIcons:null,callBackFinish:null,_moreTime:0,ctor:function(){this.totalIcons=12;this.numIconShow=3},initObj:function(a,b){this.scrollCol=a;this.listItem=[];for(var d=0;d<a.getChildren().length;d++)this.listItem.push(a.getChildren()[d]);this.index=b;this.randomTopItem();this.updateBottomItem()},randomTopItem:function(){var a=0,b=this.numIconShow,d,e;for(a;a<b;a++)d=parseInt(Math.random()*this.totalIcons)+1,e="Item"+
d+".png",this.listItem[a].ItemID=d,this.listItem[a].textureName=e,this.listItem[a].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0),this.listItem[a].setVisible(!0)},beginScroll:function(){var a=0,b=this.numIconShow;for(a;a<b;a++)this.listItem[a].setVisible(!0)},randomHideItem:function(){var a=0,b=this.numIconShow,d,e,f=this.listItem.length;for(a;a<b;a++)d=parseInt(Math.random()*this.totalIcons)+1,e="Item"+d+".png",this.listItem[f-(this.numIconShow-a)].ItemID=
d,this.listItem[f-(this.numIconShow-a)].textureName=e,this.listItem[f-(this.numIconShow-a)].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[f-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateBottomItem:function(){var a=0,b=this.numIconShow,d=this.listItem.length;for(a;a<b;a++)this.listItem[d-(this.numIconShow-a)].ItemID=this.listItem[a].ItemID,this.listItem[d-(this.numIconShow-a)].textureName=this.listItem[a].textureName,this.listItem[d-(this.numIconShow-a)].loadTexture(this.listItem[a].textureName,
ccui.Widget.PLIST_TEXTURE),this.listItem[d-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateReult:function(){var a=0,b=this.numIconShow,d;for(a;a<b;a++)d="Item"+this.listResult[a]+".png",this.listItem[a].textureName=d,this.listItem[a].ItemID=this.listResult[a],this.listItem[a].loadTexture(d,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0)},turning:function(a,b){this._moreTime=b;this.scrollFist();this.listResult=a},scrollFist:function(){this.beginScroll();var a=
-this.listItem[this.numIconShow].getPositionY()/2+37;this.scrollCol.runAction(cc.sequence(cc.jumpBy(.3,cc.p(0,30),0,0),cc.jumpBy(.1,cc.p(0,a),0,0),cc.callFunc(this.scrollSecond.bind(this))))},scrollSecond:function(){this.scrollCol.setPositionY(0);this.updateBottomItem();var a=0;0<this._moreTime&&(a=parseInt(this._moreTime/.2));this.scrollCol.runAction(cc.sequence(cc.sequence(cc.callFunc(function(){this.randomHideItem();this.scrollCol.setPositionY(0)}.bind(this)),cc.jumpBy(.2,cc.p(0,-488),0,0)).repeat(5+
a+2*this.index),cc.callFunc(this.scrollLast.bind(this))))},scrollLast:function(){this.updateReult();this.updateBottomItem();this.scrollCol.setPositionY(0);this.scrollCol.runAction(cc.sequence(cc.jumpBy(.5,cc.p(0,-538),0,0),cc.jumpBy(.1,cc.p(0,112),0,0),cc.callFunc(function(){this.updateBottomItem();var a={};a.Index=this.index;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,a);this.callBackFinish&&this.callBackFinish()}.bind(this))))},getItemFromIndex:function(a){return this.listItem[a]},
setDispose:function(){this.scrollCol.stopAllActions();this.listItem=[]}});var MGXHCSpinLayout=cc.Class.extend({listColumn:null,mainGame:null,math:null,listItemResult:null,xFrameData:null,ctor:function(){},initObj:function(a){this.listColumn=[];this.listItemResult=[];this.math=new MGXHCMath;var b=0,d=a.getChildByName("Panel");for(b;5>b;b++)a=new MGXHCColumn,a.initObj(d.getChildByName("MGScroll"+b),b),this.listColumn.push(a),this.listItemResult.push(a.listItem[0]),this.listItemResult.push(a.listItem[1]),this.listItemResult.push(a.listItem[2])},setDelegate:function(a){this.mainGame=
a},getListItemsResult:function(){return this.listItemResult},turning:function(a){this.xFrameData=a.RatioWildLine;var b=0,d=a.ArrIcon.length;this.mainGame.compoEffect.compoEffectNode.addReelData(a.ArrIcon,1,[ConstantsVariable.TYPE_ICON_XHC.COIN,ConstantsVariable.TYPE_ICON_XHC.SCATTER]);for(b;b<d;b++)this.listColumn[b].turning(a.ArrIcon[b],this.mainGame.compoEffect.compoEffectNode.getMoreTimeEffect(b));0<a.InfoWin.length&&this.caculateResult(a);this.listColumn[d-1].callBackFinish=this.finishScroll.bind(this)},
finishScroll:function(){mg.audio.stopAllEffects();this.mainGame.isAutoSpin||(this.mainGame.compoEffect.playEffectEndMatch(),this.mainGame.compoEffect.showAllXFrameRatio(this.xFrameData),this.xFrameData=null);this.mainGame.updateGoldWin()},caculateResult:function(a){var b=0;leng=5;var d=[];this.math.setPropertiesPrepare(a.ArrIcon,3);a=this.getIndexItemWin(a);for(b;b<a.length;b++){this.math.setRootNode(a[b]);this.math.floodFill(0,a[b].index,a[b].value);if(0<this.math.getListResult().length)for(var d=
this.math.getListResult().slice(0),e=0;e<d.length;e++)this.mainGame.compoEffect.pushLineToList(d[e]);this.math.clearList()}for(;0<a.length;)a.pop()},getIndexItemWin:function(a){for(var b=a.ArrIcon[0].slice(0),d=[],e=0,f=0,e=0;e<a.InfoWin.length;e++)for(f=0;f<b.length;f++)if(a.InfoWin[e].Icon==b[f]||a.InfoWin[e].IsReplaceWild&&b[f]==ConstantsVariable.TYPE_ICON_XHC.WILD)Utilities.showLog("getIndexItemWin Icon Index "+a.InfoWin[e].Icon),d.push(new MGXPPosion(0,f,a.InfoWin[e].Icon,a.InfoWin[e].IsReplaceWild)),
b[f]=-1;return d},getItemFromCol:function(a,b){return this.listColumn[a].getItemFromIndex(b)},setDispose:function(){for(var a=this.listColumn.length-1;0<this.listColumn.length;)this.listColumn[a].setDispose(),this.listColumn.pop(),a--;for(;0<this.listItemResult.length;)this.listItemResult.pop();this.math.setDispose()}});var MGXHCEffect=MGBaseNode.extend({posListAni:null,mapEffects:null,listLine3Row:null,canPlayEff:null,totalLine:null,currentLine:null,darkLayer:null,mainGame:null,effectBonusBox:null,effectCoinWinNoHu:null,timeOutEffectBonus:null,haveJackPot:!1,effectBigWin:null,effectCoinWinBigWin:null,timeOutEffectBigWin:null,scatterLines:0,listResult:null,effectWin:null,compoEffectNode:null,effectSpecialXeng:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.listLine3Row=[];this.effectSpecialXeng=
this.effectWin=null;this.compoEffectNode=new MGCompoEffectNode;this.addChild(this.compoEffectNode,3)},initObj:function(a,b){MGBaseNode.prototype.initObj.call(this);this.posListAni=a;this.listResult=b;this.initSkeAnimation();this.initEffectReel();this.mapEffects=[];this.mapEffects[0]=[0,0,0,0,0];this.mapEffects[1]=[0,0,0,0,0];this.mapEffects[2]=[0,0,0,0,0];for(var d=0,e=0;5>e;e++)for(var f=0;3>f;f++)this.mapEffects[f][e]=d,d++;this.initEvents()},initEffectSpecialXeng:function(){this.effectSpecialXeng=
new MGComboEffectSpecialXeng;this.effectSpecialXeng.initObj();this.effectSpecialXeng.setCallBackSuccess(this.playLinesEffectEndMatch.bind(this));this.addChild(this.effectSpecialXeng,3)},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGXHCEffect.EVENT.FX_BONUS_BOX,this.playEffectBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGXHCEffect.EVENT.FX_BIG_WIN,this.playEffectBigWin.bind(this)))},initEffectReel:function(){for(var a=
1;5>=a;a++)this.compoEffectNode.addEffectReel(cc.size(240,426),this.posListAni.getChildByName("MGEffectReel"+a).getPosition());this.compoEffectNode.setCallbackOnPlayEffectReel(this.onPlayReelEffect.bind(this));this.compoEffectNode.setCallbackOnHideEffectReel(this.onHideAllReelEffect.bind(this))},initSkeAnimation:function(){for(var a=0;15>a;a++){this.compoEffectNode.addEffectItem(cc.size(200,200),this.posListAni.getChildByName("Effect_"+a).getPosition());var b=new cc.Sprite;b.setPosition(cc.p(this.posListAni.getChildByName("Effect_"+
a).getPosition().x+70,this.posListAni.getChildByName("Effect_"+a).getPosition().y-50));b.setVisible(!1);this.addChild(b,3);this.listResult[a].xFrame=b}},createSkeletonAnimation:function(a){var b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengHoangCung.EffectHoangCung_json,ResourceManager.MGResourcesGameXengHoangCung.EffectHoangCung_atlas);b.setPosition(this.posListAni.getChildByName("Effect_"+a).getPosition());b.setVisible(!1);this.addChild(b,2);this.listResult[a].AnimationEff=b},initEffectWin:function(){this.effectWin=
new MGComboEffectWinCoinXeng;this.effectWin.initObj();this.addChild(this.effectWin,3);this.effectWin.setPosition(640,550);this.effectWin.setProties(190,.8,80)},showAnimation:function(a,b,d,e){this.listResult[a].AnimationEff||this.createSkeletonAnimation(a);this.listResult[a].AnimationEff.setVisible(!0);this.listResult[a].AnimationEff.setAnimation(0,b,d);this.listResult[a].setVisible(!1);d||this.runAction(cc.sequence(cc.delayTime(e?.5:2.5),cc.callFunc(function(){this.hideAnimation(a)}.bind(this))))},
showFrameFx:function(a,b){var d=3,e=2;b&&(d=2,e=1);var f=this.listResult[a];this.compoEffectNode.showEffectItem(a,e);f.runAction(cc.sequence(cc.sequence(cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.3,1,1)).repeat(d)))},hideAnimation:function(a){this.listResult[a].AnimationEff&&this.listResult[a].AnimationEff.setVisible(!1);this.listResult[a].setVisible(!0)},hideAllAnimation:function(){for(var a=0;a<this.listResult.length;a++)this.listResult[a].AnimationEff&&this.listResult[a].AnimationEff.setVisible(!1),this.listResult[a].xFrame.setVisible(!1),
this.listResult[a].setVisible(!0);this.compoEffectNode.hideAllEffect()},playLineEffects:function(a){var b=0;length=a.length;for(b;b<length;b++){var d=this.mapEffects[a[b].index][a[b].col];8>a[b].value?this.showAnimation(d,MGXHCEffect.ANIMATION_NAME[a[b].value].NAME,!1,!1):this.showFrameFx(d,!1)}},pushLineToList:function(a){this.listLine3Row.push(a)},showNextEffect:function(){0!=this.canPlayEff&&(Utilities.showLog("showNextEffect still run "),0!=this.totalLine&&(this.effectWin||this.initEffectWin(),
Utilities.showLog("showNextEffect this.currentLine "+this.currentLine+"this.totalLine "+this.totalLine),this.currentLine<this.totalLine?(this.effectWin.stopAnimationWin(),this.playLineEffects(this.listLine3Row[this.currentLine]),this.currentLine++):(this.currentLine=0,this.playAllLinesEffects(),0<this.mainGame.goldWin&&this.effectWin.playAnimationWin(this.mainGame.goldWin)),this.playSoundEffectOnLine()))},playSoundEffectOnLine:function(){if(!(0<this.mainGame.isHaveMiniGame)){var a=parseInt(3*Math.random())+
1;mg.audio.stopAllEffects();1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Win1):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Win2):3==a&&mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Win3)}},playAllLinesEffects:function(){var a=0;for(a;a<this.listLine3Row.length;a++)this.playLineEffects(this.listLine3Row[a])},resetListLine:function(){for(;0<this.listLine3Row.length;)this.listLine3Row.pop()},playEffectEndMatch:function(){this.compoEffectNode.hideAllEffectReel();
0<this.scatterLines?this.playFireWallEffectEndMatch():0<this.mainGame.isHaveMiniGame?this.playBonusEffectEndMatch():this.playLinesEffectEndMatch()},playLinesEffectEndMatch:function(){this.canPlayEff=!0;this.currentLine=this.totalLine=this.listLine3Row.length;this.compoEffectNode.hideAllEffectReel();0<this.totalLine&&(this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.showNextEffect()}.bind(this)))),this.schedule(this.showNextEffect,3));0<this.scatterLines&&(this.playEffectScatter(),
this.mainGame.showPopupFreeTurning())},playFireWallEffectEndMatch:function(){this.effectSpecialXeng||this.initEffectSpecialXeng();this.effectSpecialXeng.playEffectWinScatter(320)},playBonusEffectEndMatch:function(){this.effectSpecialXeng||this.initEffectSpecialXeng();this.effectSpecialXeng.playEffectWinBonus(320)},setScatterLines:function(a){this.scatterLines=a},playEffectScatter:function(){for(var a=0;5>a;a++)for(var b=0;3>b;b++)this.mainGame.compoSpin.getItemFromCol(a,b).ItemID==ConstantsVariable.TYPE_ICON_XHC.SCATTER&&
this.showAnimation(this.mapEffects[b][a],MGXHCEffect.ANIMATION_NAME[ConstantsVariable.TYPE_ICON_XHC.SCATTER].NAME,!0,!1)},showAllXFrameRatio:function(a){if(null!==a&&0!==a.length)for(var b=0;5>b;b++)for(var d=0;3>d;d++)if(this.mainGame.compoSpin.getItemFromCol(b,d).ItemID==ConstantsVariable.TYPE_ICON_XHC.WILD){var e=this.mapEffects[d][b];0<a[b]&&this.showXFrameRatio(e,a[b])}},showXFrameRatio:function(a,b){this.listResult[a].xFrame.setSpriteFrame("x"+b+".png");this.listResult[a].xFrame.setVisible(!0)},
clearArraysMap:function(){this.listLine3Row=[];this.mapEffects=[];this.listResult=[]},stopAllEfect:function(){this.effectWin&&this.effectWin.stopAnimationWin();this.unschedule(this.showNextEffect);this.scatterLines=this.totalLine=0;this.resetListLine();this.hideAllAnimation();this.stopAllActions();this.canPlayEff=!1},playEffectBonusBox:function(a){a=a.getUserData();this.mainGame.darkLayer.setVisible(!0);mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Bigwin,
MGGameInfo.gameVolume,!1);if(!this.effectBonusBox){var b=cc.p(.5*this.mainGame.darkLayer.getContentSize().width,.5*this.mainGame.darkLayer.getContentSize().height);this.effectBonusBox=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengHoangCung.BonusBox_Json,ResourceManager.MGResourcesGameXengHoangCung.BonusBox_Atlas);this.effectBonusBox.setPosition(b);this.mainGame.darkLayer.addChild(this.effectBonusBox);this.effectBonusBox.setVisible(!1);this.effectCoinWinNoHu=new cc.LabelBMFont("10.000.000.000",
ResourceManager.MGResourcesGameXengHoangCung.Font_fnt);this.effectCoinWinNoHu.setVisible(!1);this.mainGame.darkLayer.addChild(this.effectCoinWinNoHu);this.effectCoinWinNoHu.setPosition(b.x,b.y+10)}this.haveJackPot=!0;this.effectBonusBox.setAnimation(0,"animation",!1);this.effectBonusBox.setVisible(!0);this.effectCoinWinNoHu.setString(Utilities.Coin(a.EarnCoin));this.effectCoinWinNoHu.setVisible(!0);this.effectCoinWinNoHu.setScale(30);this.effectCoinWinNoHu.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),
cc.callFunc(function(){this.effectCoinWinNoHu.setVisible(!1);this.mainGame.darkLayer.setVisible(!1);this.haveJackPot=!1}.bind(this))));this.timeOutEffectBonus=setTimeout(this.hideEffect.bind(this,this.effectBonusBox),4E3)},playEffectBigWin:function(a){if(!this.mainGame.haveBonus){a=a.getUserData();mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Bigwin,MGGameInfo.gameVolume,!1);if(!this.effectBigWin){var b=cc.p(.5*this.mainGame.darkLayer.getContentSize().width,.5*this.mainGame.darkLayer.getContentSize().height);
this.effectBigWin=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengHoangCung.ThangLon_JSON,ResourceManager.MGResourcesGameXengHoangCung.ThangLon_ATLAS);this.effectBigWin.setPosition(b.x,b.y+50);this.mainGame.darkLayer.addChild(this.effectBigWin);this.effectBigWin.setVisible(!1);this.effectCoinWinBigWin=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengHoangCung.FontWin_fnt);this.effectCoinWinBigWin.setVisible(!1);this.mainGame.darkLayer.addChild(this.effectCoinWinBigWin);
this.effectCoinWinBigWin.setPosition(b.x,b.y-50)}this.mainGame.darkLayer.setVisible(!0);this.effectBigWin.setAnimation(0,"animation",!1);this.effectBigWin.setVisible(!0);this.effectCoinWinBigWin.setString(Utilities.Coin(a.EarnCoin));this.effectCoinWinBigWin.setVisible(!0);this.effectCoinWinBigWin.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinBigWin.setVisible(!1);this.mainGame.darkLayer.setVisible(!1)}.bind(this))));this.timeOutEffectBigWin=setTimeout(this.hideEffect.bind(this,
this.effectBigWin),4E3)}},hideEffect:function(a){a.setVisible(!1)},onPlayReelEffect:function(a){for(var b=0;3>b;b++){var d=this.mainGame.compoSpin.getItemFromCol(a,b);if(d.ItemID==ConstantsVariable.TYPE_ICON_XHC.SCATTER||d.ItemID==ConstantsVariable.TYPE_ICON_XHC.COIN){var e=this.mapEffects[b][a];d.ItemID==ConstantsVariable.TYPE_ICON_XHC.SCATTER?this.showAnimation(e,MGXHCEffect.ANIMATION_NAME[ConstantsVariable.TYPE_ICON_XHC.SCATTER].NAME,!1,!0):this.showFrameFx(e,!0)}}},onHideAllReelEffect:function(){Utilities.showLog("onHideAllReelEffect  ")},
setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoEffectNode&&this.compoEffectNode.setDispose();this.timeOutEffectBonus&&clearTimeout(this.timeOutEffectBonus);this.timeOutEffectBigWin&&clearTimeout(this.timeOutEffectBigWin);this.unschedule(this.showNextEffect);this.stopAllActions()}});MGXHCEffect.ANIMATION_NAME={1:{NAME:"DragonHead"},5:{NAME:"Fishes"},6:{NAME:"Lion"},2:{NAME:"Long"},4:{NAME:"Turtle"},7:{NAME:"Frog"}};MGXHCEffect.EVENT={FX_BONUS_BOX:"fxNoHu",FX_BIG_WIN:"fxBigWin"};var MGXHCHub=MGBaseNode.extend({mainGame:null,textUserGold:null,textMatchID:null,textUserBet:null,textGameStatus:null,textGameResult:null,textFreeSpin:null,textHuNho:null,textHuVua:null,textHuKha:null,textHuLon:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.textUserGold=this.getChildByName(MGXHCHub.ITEMS_NAME.USER_GOLD);this.textUserGold.setString(Utilities.Coin(MGGameInfo.myInfo.Gold));this.textMatchID=this.getChildByName(MGXHCHub.ITEMS_NAME.MATCH_ID);
this.textMatchID.setString("#0");this.textUserBet=this.getChildByName(MGXHCHub.ITEMS_NAME.TONG_CUOC);this.textUserBet.setString("0");this.textGameStatus=this.getChildByName(MGXHCHub.ITEMS_NAME.GAME_STATUS);this.textGameStatus.setString("DÒNG CƯỢC");this.textGameResult=this.getChildByName(MGXHCHub.ITEMS_NAME.SO_DONG);this.textGameResult.setString("243 DÒNG");this.textFreeSpin=this.getChildByName(MGXHCHub.ITEMS_NAME.FREE_SPINS);this.textHuNho=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengHoangCung.FontNho_fnt);
this.textHuNho.setPosition(this.getChildByName(MGXHCHub.ITEMS_NAME.HU_NHO).getPosition());this.addChild(this.textHuNho);this.getChildByName(MGXHCHub.ITEMS_NAME.HU_NHO).removeFromParent(!0);this.textHuVua=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengHoangCung.FontVua_fnt);this.textHuVua.setPosition(this.getChildByName(MGXHCHub.ITEMS_NAME.HU_VUA).getPosition());this.addChild(this.textHuVua);this.getChildByName(MGXHCHub.ITEMS_NAME.HU_VUA).removeFromParent(!0);this.textHuKha=new cc.LabelBMFont("0",
ResourceManager.MGResourcesGameXengHoangCung.FontKha_fnt);this.textHuKha.setPosition(this.getChildByName(MGXHCHub.ITEMS_NAME.HU_KHA).getPosition());this.addChild(this.textHuKha);this.getChildByName(MGXHCHub.ITEMS_NAME.HU_KHA).removeFromParent(!0);this.textHuLon=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengHoangCung.FontLon_fnt);this.textHuLon.setPosition(this.getChildByName(MGXHCHub.ITEMS_NAME.HU_LON).getPosition());this.addChild(this.textHuLon);this.getChildByName(MGXHCHub.ITEMS_NAME.HU_LON).removeFromParent(!0)},
updateFreeSpin:function(a){this.textFreeSpin.setString(a)},resetStateGame:function(){this.textGameStatus.setString("DÒNG CƯỢC");this.textGameResult.setString("243 DÒNG")},updateCoinWin:function(a){this.textGameStatus.setString("TIỀN THẮNG");this.textGameResult.setString(Utilities.Coin(a))},updateMatchID:function(a){this.textMatchID.setString("#"+a.toString())},updateUserGold:function(a){this.textUserGold.setString(Utilities.Coin(a))},updateUserBet:function(a){this.textUserBet.setString(Utilities.Coin(a))},
updateBonusBoxs:function(a){for(var b=0;b<a.Info.length;b++)switch(a.Info[b].BoxType){case ConstantsVariable.TYPE_BOX.NHO:this.textHuNho.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.VUA:this.textHuVua.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.KHA:this.textHuKha.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.LON:this.textHuLon.setString(Utilities.Coin(a.Info[b].Coint))}}});
MGXHCHub.ITEMS_NAME={TONG_CUOC:"MGTextBet",SO_DONG:"MGTextLineNumber",GAME_STATUS:"MGTextStatus",HU_LON:"MGTextHuLon",HU_KHA:"MGTextHuKha",HU_VUA:"MGTextHuVua",HU_NHO:"MGTextHuNho",MATCH_ID:"MGTextMatchID",FREE_SPINS:"MGTextFreeTurning",USER_GOLD:"MGTextCoin"};var MGXHCCompoButtonsSpin=MGBaseNode.extend({_listButton:null,mainGame:null,_benginTouch:!1,_count:0,_canSpin:!0,listValueBet:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this._benginTouch=!1;this._count=0;this._canSpin=!0;this.listValueBet=[]},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),
this._listButton.push(a[d]));this.scheduleUpdate()},update:function(a){this._benginTouch&&(this._count+=a,.5<=this._count&&(this._count=0,this._benginTouch=this._canSpin=!1,this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN).setVisible(!1),this.mainGame.isAutoSpin=!0,this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setVisible(!0),this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setEnabled(!0),this.hideButtonSpin(),this.mainGame.gameStatus===ConstantsVariable.STATE_XHC.NOT_START&&
this.mainGame.netSend.spin(this.mainGame.getBetGold())))},hideWhenSpin:function(){this.hideButton(MGXHCCompoButtonsSpin.BUTTON_NAME.BET_UP);this.hideButton(MGXHCCompoButtonsSpin.BUTTON_NAME.BET_DOWN);this.hideButton(MGXHCCompoButtonsSpin.BUTTON_NAME.MAX_BET);this.hideButtonSpin()},showWhenSpinDone:function(){this.showButton(MGXHCCompoButtonsSpin.BUTTON_NAME.BET_UP);this.showButton(MGXHCCompoButtonsSpin.BUTTON_NAME.BET_DOWN);this.showButton(MGXHCCompoButtonsSpin.BUTTON_NAME.MAX_BET);this.showButtonSpin()},
hideButton:function(a){this.getChildByName(a).setEnabled(!1);this.getChildByName(a).setBright(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},stopAutoSpin:function(){this.getChildByName(MGXHCCompoButtonsSpin.BUTTON_NAME.SPIN).setVisible(!0);this.mainGame.isAutoSpin=!1;this.getChildByName(MGXHCCompoButtonsSpin.BUTTON_NAME.STOP).setVisible(!1);this._canSpin=!0},onClickBtnFromCocostudio:function(a,b){b==ccui.Widget.TOUCH_BEGAN&&(a.getName()==MGXHCCompoButtonsSpin.BUTTON_NAME.SPIN?
mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_ClickQuay,MGGameInfo.gameVolume,!1):mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1));switch(a.getName()){case MGXHCCompoButtonsSpin.BUTTON_NAME.SPIN:switch(b){case ccui.Widget.TOUCH_BEGAN:this._benginTouch=!0;this._count=0;break;case ccui.Widget.TOUCH_MOVED:this._benginTouch=!0;break;case ccui.Widget.TOUCH_ENDED:this._count=0;this._benginTouch=!1;this._canSpin&&this.sendBetting();
break;case ccui.Widget.TOUCH_CANCELED:this._count=0,this._benginTouch=!1}break;case MGXHCCompoButtonsSpin.BUTTON_NAME.INFO:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupGameInfo();break;case MGXHCCompoButtonsSpin.BUTTON_NAME.BET_DOWN:if(b===ccui.Widget.TOUCH_ENDED)this.mainGame.onClickDown();break;case MGXHCCompoButtonsSpin.BUTTON_NAME.BET_UP:if(b===ccui.Widget.TOUCH_ENDED)this.mainGame.onClickUp();break;case MGXHCCompoButtonsSpin.BUTTON_NAME.MAX_BET:if(b===ccui.Widget.TOUCH_ENDED)this.mainGame.onMaxBetClick();
break;case MGXHCCompoButtonsSpin.BUTTON_NAME.THANG_LON:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupBigWin();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.THONG_BAO:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupNotify();break;case MGXHCCompoButtonsSpin.BUTTON_NAME.LICH_SU:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupHistory();break;case MGXHCCompoButtonsSpin.BUTTON_NAME.STOP:b===ccui.Widget.TOUCH_ENDED&&this.stopAutoSpin()}},showButtonSpin:function(){this.showButton(MGXHCCompoButtonsSpin.BUTTON_NAME.SPIN);
this._canSpin=!0},hideButtonSpin:function(){this.hideButton(MGXHCCompoButtonsSpin.BUTTON_NAME.SPIN)},hideAll:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)},sendBetting:function(){if(MGGameInfo.myInfo.Gold<this.mainGame.getBetGold()){var a=this.getMaxIndexCanBet();if(0>a){a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]="Bạn không đủ gold. \nXin vui lòng nạp gold để tiếp tục chơi";
cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a);this.mainGame.isAutoSpin&&(this.stopAutoSpin(),this.showWhenSpinDone());return}this.mainGame.setCountBet(a)}this.mainGame.netSend.spin(this.mainGame.getBetGold())},updateListBet:function(a){this.listValueBet=a},getMaxIndexCanBet:function(){for(var a=this.listValueBet.length-1;0<=a;){if(MGGameInfo.myInfo.Gold>=this.listValueBet[a])return a;a--}return-1}});
MGXHCCompoButtonsSpin.BUTTON_NAME={SPIN:"Button_Spin",STOP:"Button_Stop",MAX_BET:"Button_MaxBet",BET_UP:"Button_Up",BET_DOWN:"Button_Down",INFO:"Button_Info",THANG_LON:"Button_ThangLon",THONG_BAO:"Button_ThongBao",LICH_SU:"Button_LichSu"};var MGXHCMiniGameButton=MGBaseNode.extend({idButton:0,button:null,lbValue:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.button=this.getChildByName("MGButton");this.lbValue=this.getChildByName("MGTextValue")},resetButton:function(){this.lbValue.setVisible(!1);this.button.setTouchEnabled(!0);this.button.runAction(cc.rotateTo(.001,0,0))},showResult:function(a){this.button.setTouchEnabled(!1);this.lbValue.setSpriteFrame(4===
a?"sp_lon_xhc.png":3===a?"sp_kha_xhc.png":2===a?"sp_vua_xhc.png":"sp_nho_xhc.png");this.button.runAction(cc.sequence(cc.rotateBy(.25,0,180),cc.callFunc(function(){this.lbValue.setVisible(!0)}.bind(this))))}});var MGXHCCompoMiniGame=MGBaseNode.extend({listButton:[],lbLuotChoi:null,luotChoi:0,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listButton=[];this.initUI();this._initEventsGame();this._initEventBtnFromNode()},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.ChoiceGameMini.toString(),
this.ngChoiceGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.ResultGameMini.toString(),this.ngResultGameMini.bind(this)))},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGUICompoMiniGame,PreLoaderConfig.PathToResourceDefault);this.lbLuotChoi=this._mainLayer.getChildByName("MGTextLuotChoi")},_initEventBtnFromNode:function(){for(var a=this._mainLayer.getChildByName("MGMiniGameButtons"),
b=0;b<a.getChildren().length;b++){var d=new MGXHCMiniGameButton;d.cloneFromNode(a.getChildByName("MGButton"+b));d.initObj();d.idButton=b+1;d.button.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));a.addChild(d);this.listButton.push(d)}},ngChoiceGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Index:b.UInt32,Value:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngChoiceGameMini : "+JSON.stringify(a));this.luotChoi--;0<=this.luotChoi&&
this.lbLuotChoi.setString(this.luotChoi+" LƯỢT CHƠI");0===this.luotChoi&&this.disableAllButton();this.getButtonByID(a.Index).showResult(a.Value)},ngResultGameMini:function(a){Utilities.showLog("ngResultGameMini");this.setShowMiniGame(!1,0)},setShowMiniGame:function(a,b){this.setVisible(a);a&&(this.luotChoi=b,this.resetAllButton(),this.lbLuotChoi.setString(this.luotChoi+" LƯỢT CHƠI"))},getButtonByID:function(a){for(var b=0;b<this.listButton.length;b++)if(this.listButton[b].idButton===a)return this.listButton[b]},
resetAllButton:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].resetButton()},disableAllButton:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].button.setTouchEnabled(!1)},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);this.mainGame.netSend.sendChoiceGameMini(a.getParent().idButton)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGXHCPopupBigWin=MGBaseNode.extend({listView:null,btnClose:null,mainPopup:null,_dataBigWin:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this._dataBigWin=[];this._currentLoad=0;this._isShowed=!1;this.initUI();this.initEvent();this.scheduleUpdate()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGPopupBigWinNode,PreLoaderConfig.PathToResourceDefault);
this.listView=this._mainLayer.getChildByName("MGCompoTopWinListView");this._mainLayer.getChildByName("MGTopWinViewCell").setVisible(!1);this.btnClose=this._mainLayer.getChildByName("MGCompoTopWinButtonClose");this.btnClose.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},update:function(a){this._isShowed&&this.listView.getBottommostItemInCurrentView()&&this.listView.getBottommostItemInCurrentView().getTag()===this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+
10<this._dataBigWin.length?10:this._dataBigWin.length-this._currentLoad;if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this.listView.pushBackCustomItem(this.createCellWithInfo(this._dataBigWin[b],b+1));this.listView.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.reArrangeSTT()}},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.BigWin.toString(),this.ngBigWin.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.TopBigWin.toString(),this.ngTopBigWin.bind(this)))},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},showBigWinLayer:function(){this._isShowed||(this._isShowed=!0,this.loadMoreItem(),this.listView.jumpToTop());this.setVisible(!0)},ngTopBigWin:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.dataBigWin.length;b++)this._dataBigWin.push(a.dataBigWin[b])},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,
Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this._isShowed?(this.listView.getItems().length>=MGXHCPopupBigWin.MAX_LINE&&this.listView.removeItem(MGXHCPopupBigWin.MAX_LINE-1),this.listView.insertCustomItem(this.createCellWithInfo(a,1),0),this.listView.jumpToTop(),this.reArrangeSTT()):this._dataBigWin.splice(0,0,a);MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGXHCEffect.EVENT.FX_BIG_WIN,a)},createCellWithInfo:function(a,
b){var d=this._mainLayer.getChildByName("MGTopWinViewCell").clone();d.getChildByName("Text1").enableOutline(cc.color("#000000"),2);d.getChildByName("Text2").enableOutline(cc.color("#000000"),2);d.getChildByName("Text3").enableOutline(cc.color("#000000"),2);d.getChildByName("Text4").enableOutline(cc.color("#000000"),2);d.getChildByName("Text5").enableOutline(cc.color("#000000"),2);d.setVisible(!0);this.setCellInfo(d,a);return d},setCellInfo:function(a,b){a.getChildByName("Text1").setString(a.getTag());
a.getChildByName("Text2").setString(b.UserID);a.getChildByName("Text3").setString(b.NickName);a.getChildByName("Text4").setString(0===b.Type?"THƯỜNG":"NỔ HŨ");a.getChildByName("Text5").setString(Utilities.Coin(b.EarnCoin))},reArrangeSTT:function(){for(var a=0;a<this.listView.getItems().length;a++)this.listView.getItem(a).setTag(a+1),this.listView.getItem(a).getChildByName("Text1").setString(a+1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.unscheduleUpdate()}});
MGXHCPopupBigWin.MAX_LINE=100;MGXHCPopupBigWin.TYPE_NOHU={0:"THƯỜNG",1:"NỔ HŨ"};var MGXHCPopupFreeTurning=MGBaseNode.extend({lbFreeNumber:null,btnStart:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGPopupFreeTuring,PreLoaderConfig.PathToResourceDefault);this.btnStart=this._mainLayer.getChildByName("MGBackground").getChildByName("MGButtonStart");this.btnStart.addClickEventListener(this.onBtnStartClick.bind(this));
this.lbFreeNumber=this._mainLayer.getChildByName("MGBackground").getChildByName("MGTextFreeNumber")},onBtnStartClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},showFreeTurning:function(a){this.setVisible(!0);this.lbFreeNumber.setString(a);a=this._mainLayer.getChildByName("MGBackground");a.setScale(0);a.runAction(cc.sequence(cc.scaleTo(.25,1.3),cc.scaleTo(.1,1)))}});var MGXHCPopupGameInfo=MGBaseNode.extend({btnBack:null,btnBackToGame:null,btnNext:null,pageView:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGPopupGameInfoNode,PreLoaderConfig.PathToResourceDefault);this.btnBack=this._mainLayer.getChildByName("MGButtonPre");this.btnBackToGame=this._mainLayer.getChildByName("MGButtonExit");
this.btnNext=this._mainLayer.getChildByName("MGButtonNext");this.pageView=this._mainLayer.getChildByName("MGPageView");this.btnBack.addClickEventListener(this.onBtnBackClick.bind(this));this.btnBackToGame.addClickEventListener(this.onBtnBackToGameClick.bind(this));this.btnNext.addClickEventListener(this.onBtnNextClick.bind(this))},onBtnBackClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);var d=this.pageView.getCurrentPageIndex();
0<d?d--:d=3;this.pageView.scrollToPage(d)},onBtnBackToGameClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},onBtnNextClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);var d=this.pageView.getCurrentPageIndex();3>d?d++:d=0;this.pageView.scrollToPage(d)}});var MGXHCPopupHistory=MGBaseNode.extend({listView:null,btnClose:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this.initUI()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGPopupHistoryNode,PreLoaderConfig.PathToResourceDefault);this.listView=this._mainLayer.getChildByName("MGHistoryListView");this._mainLayer.getChildByName("MGHistoryViewCell").setVisible(!1);
this.btnClose=this._mainLayer.getChildByName("MGCompoHistoryButtonClose");this.btnClose.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},setHistoryInfo:function(a){this.listView.insertCustomItem(this.createCellWithInfo(a),0);this.listView.jumpToTop()},createCellWithInfo:function(a){var b=
this._mainLayer.getChildByName("MGHistoryViewCell").clone();b.getChildByName("Text1").enableOutline(cc.color("#000000"),2);b.getChildByName("Text2").enableOutline(cc.color("#000000"),2);b.getChildByName("Text3").enableOutline(cc.color("#000000"),2);b.getChildByName("Text4").enableOutline(cc.color("#000000"),2);b.getChildByName("Text5").enableOutline(cc.color("#000000"),2);b.setVisible(!0);this.setCellInfo(b,a);return b},setCellInfo:function(a,b){var d=new Date(b.Time),e=("0"+d.getHours()).slice(-2),
f=("0"+d.getMinutes()).slice(-2),g=("0"+d.getSeconds()).slice(-2),h=("0"+d.getDate()).slice(-2),k=("0"+(d.getMonth()+1)).slice(-2),d=d.getFullYear();a.getChildByName("Text1").setString(b.MatchID);a.getChildByName("Text2").setString(e+":"+f+":"+g+"\n"+h+"/"+k+"/"+d);a.getChildByName("Text3").setString(Utilities.Coin(b.CoinBet));a.getChildByName("Text4").setString(b.DongTrung);a.getChildByName("Text5").setString(Utilities.Coin(b.EarnCoin))}});MGXHCPopupHistory.MAX_LINE=100;var MGXHCPopupNotify=MGBaseNode.extend({btnClose:null,listView:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this.initUI();this.initEvents()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGPopupNotifyNode,PreLoaderConfig.PathToResourceDefault);this.btnClose=this._mainLayer.getChildByName("ButtonClose");this.btnClose.addClickEventListener(this.onBtnClosetClick.bind(this));
this.listView=this._mainLayer.getChildByName("ListViewContent")},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.ngThongBao.bind(this)))},onBtnClosetClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},ngThongBao:function(a){a=a.getUserData();this.listView.getItems().length>=MGXHCPopupNotify.MAX_LINE&&
this.listView.removeItem(MGXHCPopupNotify.MAX_LINE-1);var b=new MGBaseRichText("Arial",18,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.insertCustomItem(b,0);this.listView.jumpToTop()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXHCPopupNotify.MAX_LINE=100;var MGXHCPopup=MGBaseNode.extend({popupGameInfo:null,popupHistory:null,popupNotify:null,popupBigWin:null,popupFreeTurning:null,backGroundPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.backGroundPopup=new ccui.ImageView("sp_info_bg_xhc.png",ccui.Widget.PLIST_TEXTURE);this.backGroundPopup.setScale9Enabled(!0);this.backGroundPopup.setColor(cc.color("#000000"));this.backGroundPopup.setOpacity(210);this.backGroundPopup.setTouchEnabled(!0);
this.backGroundPopup.setSwallowTouches(!0);this.addChild(this.backGroundPopup);this.showPopupBackground(!1);this.popupNotify||(this.popupNotify=new MGXHCPopupNotify,this.popupNotify.initObj(this),this.addChild(this.popupNotify));this.popupNotify.setVisible(!1);this.popupBigWin||(this.popupBigWin=new MGXHCPopupBigWin,this.popupBigWin.initObj(this),this.addChild(this.popupBigWin));this.popupBigWin.setVisible(!1);this.popupHistory||(this.popupHistory=new MGXHCPopupHistory,this.popupHistory.initObj(this),
this.addChild(this.popupHistory));this.popupHistory.setVisible(!1)},showPopupGameInfo:function(){this.popupGameInfo||(this.popupGameInfo=new MGXHCPopupGameInfo,this.popupGameInfo.initObj(this),this.addChild(this.popupGameInfo));this.popupGameInfo.setVisible(!0);this.showPopupBackground(!0)},showPopupNotify:function(){this.popupNotify.setVisible(!0);this.showPopupBackground(!0)},showPopupBigWin:function(){this.popupBigWin.showBigWinLayer();this.showPopupBackground(!0)},setHistoryInfo:function(a){this.popupHistory.setHistoryInfo(a)},
showPopupHistory:function(){this.popupHistory.setVisible(!0);this.showPopupBackground(!0)},showPopupFreeTurning:function(a){this.popupFreeTurning||(this.popupFreeTurning=new MGXHCPopupFreeTurning,this.popupFreeTurning.initObj(this),this.addChild(this.popupFreeTurning));this.popupFreeTurning.showFreeTurning(a);this.showPopupBackground(!0)},showPopupBackground:function(a){this.backGroundPopup.setVisible(a);this.backGroundPopup.setContentSize(cc.size(2560,1440));this.backGroundPopup.setPosition(cc.p(640,
.5*-this.backGroundPopup.getContentSize().height+720))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.popupNotify&&this.popupNotify.setDispose();this.popupBigWin&&this.popupBigWin.setDispose()}});var MGXengHoangCung=MGBaseGame.extend({netSend:null,popup:null,gameHub:null,compoMiniGame:null,compoButtonsSpin:null,compoSpin:null,compoEffect:null,darkLayer:null,listCanBet:null,countBet:0,bounusSpinFree:0,countSpinFree:0,scatterLines:0,isHaveMiniGame:0,isAutoSpin:null,haveBonus:null,contentHistory:null,gameStatus:0,goldWin:0,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesXengHoangCung},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.contentHistory=
null;this.darkLayer=new ccui.ImageView("sp_info_bg_xhc.png",ccui.Widget.PLIST_TEXTURE);this.darkLayer.setScale9Enabled(!0);this.darkLayer.setContentSize(cc.size(cc.winSize.width,cc.winSize.height));this.darkLayer.setPosition(cc.p(640,.5*-this.darkLayer.getContentSize().height+720));this.darkLayer.setColor(cc.color("#000000"));this.darkLayer.setOpacity(210);this.darkLayer.setTouchEnabled(!0);this.darkLayer.setSwallowTouches(!0);this.darkLayer.setVisible(!1);this.initCompoButtonsSpin();this.initCompoSpin();
this.initCompoTextHub();this.initCompoEffect();this.initGamePopup();this.listCanBet=[];this.bounusSpinFree=this.goldWin=this.isHaveMiniGame=this.scatterLines=this.countSpinFree=0;this.haveBonus=!1;this.addChild(this.darkLayer);this.netSend=new MGNetSendXengHoangCung;this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SOUND_WELCOME)}.bind(this),.05)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),
this.ngUserCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.Turning.toString(),this.ngTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.BonusBoxInfo.toString(),
this.ngBonusBoxInfo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.WinBonusBox.toString(),this.ngWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK.toString(),this.ngSubMenuLeaveRoom.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGHOANGCUNG.StartMiniGame.toString(),this.ngStartMiniGame.bind(this)))},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengHoangCung.UIMGUIXengHoangCungLayer,
PreLoaderConfig.PathToResourceDefault)},initGamePopup:function(){this.popup=new MGXHCPopup;this.popup.initObj();this.addChild(this.popup)},initCompoButtonsSpin:function(){this.compoButtonsSpin=new MGXHCCompoButtonsSpin;this.compoButtonsSpin.cloneFromNode(this._mainLayer.getChildByName("MGCompoButtonsSpin"));this.compoButtonsSpin.initObj(this);this.addChild(this.compoButtonsSpin)},initCompoTextHub:function(){this.gameHub=new MGXHCHub;this.gameHub.cloneFromNode(this._mainLayer.getChildByName("MGHub"));
this.gameHub.initObj(this);this.addChild(this.gameHub)},initCompoSpin:function(){this.compoSpin=new MGXHCSpinLayout;this.compoSpin.setDelegate(this);this.compoSpin.initObj(this._mainLayer.getChildByName("MGScrollContain"))},initCompoEffect:function(){this.compoEffect=new MGXHCEffect(this);this.compoEffect.initObj(this._mainLayer.getChildByName("MGCompoEffect"),this.compoSpin.getListItemsResult());this.addChild(this.compoEffect)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={Status:b.UInt8,TimeRemain:b.UInt16,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,NumRoundFree:b.UInt8,BetCoinFree:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));this.countSpinFree=a.NumRoundFree;this.listCanBet=a.ListCoinCanBet;this.gameHub.updateMatchID(a.MatchID);this.gameHub.updateUserGold(a.CoinUser);this.gameHub.updateUserBet(this.listCanBet[0]);this.gameHub.updateFreeSpin(this.countSpinFree);
this.compoButtonsSpin.updateListBet(a.ListCoinCanBet);this.compoButtonsSpin.hideButtonSpin();0<this.countSpinFree&&(this.compoButtonsSpin.hideWhenSpin(),this.gameHub.updateUserBet(a.BetCoinFree));this.matchID=a.MatchID;this._changeBackGroundXHC()},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("StartGame : "+JSON.stringify(a));this.gameStatus=ConstantsVariable.STATE_XHC.NOT_START;
this.matchID=a.MatchID;this.isHaveMiniGame=0;this.gameHub.updateFreeSpin(this.countSpinFree);this.contentHistory&&this.popup.setHistoryInfo(this.contentHistory);this.isAutoSpin?this.haveBonus?(this.compoButtonsSpin.showWhenSpinDone(),this.haveBonus=!1):this.compoButtonsSpin.sendBetting():0<this.countSpinFree?this.compoButtonsSpin.showButtonSpin():this.compoButtonsSpin.showWhenSpinDone()},showPopupFreeTurning:function(){this.popup.showPopupFreeTurning(this.bounusSpinFree)},ngTurning:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,CoinWinBet:b.UInt64,ScatterLines:b.UInt8,NumRoundFree:b.UInt8,CoinWinFromBonusBox:b.UInt64,InfoWin:b.Array8,InfoWin_Type:b.Object8,InfoWin_Type_Struct:{Icon:b.UInt8,NumLineWin:b.UInt8,IsReplaceWild:b.UInt8},RatioWildLine:b.Array8,RatioWildLine_Type:b.UInt8,IsHaveMini:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("Turning : "+JSON.stringify(a));this.gameStatus=
ConstantsVariable.STATE_XHC.TURNING;this.goldWin=a.CoinWinBet;this.bounusSpinFree=a.NumRoundFree-(0<this.countSpinFree?this.countSpinFree-1:this.countSpinFree);this.countSpinFree=a.NumRoundFree;this.scatterLines=a.ScatterLines;this.isHaveMiniGame=a.IsHaveMini;this.gameHub.updateMatchID(this.matchID);this.gameHub.resetStateGame();this.compoButtonsSpin.hideWhenSpin();this.compoEffect.stopAllEfect();this.compoEffect.setScatterLines(a.ScatterLines);this.compoSpin.turning(a);this.createHistoryInfo(a);
mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengHoangCung.SFX_Quay,MGGameInfo.gameVolume,!1)},createHistoryInfo:function(a){var b={};b.MatchID=this.matchID;b.CoinBet=this.getBetGold();b.Time=(new Date).getTime();for(var d=b.DongTrung=0;d<a.InfoWin.length;d++)b.DongTrung+=a.InfoWin[d].NumLineWin;b.EarnCoin=a.CoinWinBet;this.contentHistory=b},ngWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,NickName:b.StringDynamic,
EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngWinBonusBox : "+JSON.stringify(a));MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGXHCEffect.EVENT.FX_BONUS_BOX,a)},ngBonusBoxInfo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Info:b.Array8,Info_Type:b.Object8,Info_Type_Struct:{BoxType:b.UInt8,Coint:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngBonusBoxInfo : "+JSON.stringify(a));
this.gameHub.updateBonusBoxs(a)},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.gameHub.updateUserGold(a.Gold)},ngStartMiniGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Amount:b.UInt32,TimeOut:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngStartMiniGame: "+JSON.stringify(a));this.haveBonus=!0;this.showMiniGame(!0,a.Amount)},ngSubMenuLeaveRoom:function(a){0<this.countSpinFree&&
this.isAutoSpin&&this.compoButtonsSpin.stopAutoSpin()},_changeBackGroundXHC:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameXengHoangCung.XHCBackgroundOutGame;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)}},showMiniGame:function(a,b){this.compoMiniGame||(this.compoMiniGame=new MGXHCCompoMiniGame(this),this.addChild(this.compoMiniGame));this.compoButtonsSpin.stopAutoSpin();this.compoMiniGame.setShowMiniGame(a,
b)},onMaxBetClick:function(){this.countBet=this.listCanBet.length-1;this.gameHub.updateUserBet(this.listCanBet[this.countBet])},updateGoldWin:function(){this.gameHub.updateCoinWin(this.goldWin)},onClickUp:function(){this.countBet++;this.countBet>=this.listCanBet.length&&(this.countBet=0);this.gameHub.updateUserBet(this.listCanBet[this.countBet])},onClickDown:function(){this.countBet--;0>this.countBet&&(this.countBet=this.listCanBet.length-1);this.gameHub.updateUserBet(this.listCanBet[this.countBet])},
getBetGold:function(){return this.listCanBet[this.countBet]},setCountBet:function(a){this.countBet=a;this.gameHub.updateUserBet(this.listCanBet[this.countBet])},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);mg.audio.stopAllEffects();mg.audio.stopMusic(!0);this.compoSpin&&(this.compoSpin.setDispose(),this.compoSpin=null);this.compoMiniGame&&(this.compoMiniGame.setDispose(),this.compoMiniGame=null);this.compoEffect&&(this.compoEffect.setDispose(),this.compoEffect=null);this.popup&&
this.popup.setDispose()}});ResourceManager.MGResourcesGameXengThamHiem={BackGroundHDXTH:"res/game/xengthamhiem/BackGroundHDXTH.jpg",No_Hu_PNG:"res/Effects/NoHu_FX.png",No_Hu_JSON:"res/Effects/NoHu_FX.json",No_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",No_ThangLon_PNG:"res/Effects/big_win.png",No_ThangLon_JSON:"res/Effects/big_win.json",No_ThangLon_ATLAS:"res/Effects/big_win.atlas",Effect_Element_PNG:"res/game/xengthamhiem/effect/thamhiem.png",Effect_Element_JSON:"res/game/xengthamhiem/effect/thamhiem.json",Effect_Element_ATLAS:"res/game/xengthamhiem/effect/thamhiem.atlas",
FontNoHuPNG:"res/Fonts/fontNoHu.png",FontNoHu:"res/Fonts/fontNoHu.fnt",FontBigWinPNG:"res/Fonts/fontWin.png",FontBigWin:"res/Fonts/fontWin.fnt",MGUILayerXengThamHiem:"res/game/xengthamhiem/UIXTHXengThamHiem.json",MGUILayerPopupTutorial:"res/game/xengthamhiem/UIXTHPopupTutorial.json",MGUICompoMiniGame:"res/game/xengthamhiem/UIXTHCompoMiniGame.json",MGUILayerContentLichSu:"res/game/xengthamhiem/UIXTHContentLichSu.json",MGUILayerPopupLichSu:"res/game/xengthamhiem/UIXTHPopupLichSu.json",MGUILayerPopupThongBao:"res/game/xengthamhiem/UIXTHPopupThongBao.json",
MGUILayerContentThangLon:"res/game/xengthamhiem/UIXTHContentThangLon.json",MGUILayerPopupThangLon:"res/game/xengthamhiem/UIXTHPopupThangLon.json",XTH_Click:"res/game/xengthamhiem/sounds/click.mp3",XTH_ClickQuay:"res/game/xengthamhiem/sounds/ClickQuay.mp3",XTH_BigWin:"res/game/xengthamhiem/sounds/BigWin.mp3",XTH_Quay:"res/game/xengthamhiem/sounds/Quay.mp3",XTH_Win1:"res/game/xengthamhiem/sounds/Win2.mp3",XTH_Win2:"res/game/xengthamhiem/sounds/Win3.mp3",XTH_Win3:"res/game/xengthamhiem/sounds/Win4.mp3",
XTH_Win4:"res/game/xengthamhiem/sounds/Win5.mp3",XTH_SoundMiniGame:"res/game/xengthamhiem/sounds/NhaThamHiemBGM.mp3",XTH_RuongTrat:"res/game/xengthamhiem/sounds/RuongTrat.mp3",XTH_RuongTrung:"res/game/xengthamhiem/sounds/RuongTrung.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};
ResourceManager.MGResourcesGameXengThamHiemPreloadMobile={PlistAtlasXengThamHiem:"res/game/xengthamhiem/atlas/AtlasXengThamHiem.plist",PngAtlasXengThamHiem:"res/game/xengthamhiem/atlas/AtlasXengThamHiem.png",No_Hu_PNG:"res/Effects/NoHu_FX.png",No_Hu_JSON:"res/Effects/NoHu_FX.json",No_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",No_ThangLon_PNG:"res/Effects/big_win.png",No_ThangLon_JSON:"res/Effects/big_win.json",No_ThangLon_ATLAS:"res/Effects/big_win.atlas",Effect_Element_PNG:"res/game/xengthamhiem/effect/thamhiem.png",
Effect_Element_JSON:"res/game/xengthamhiem/effect/thamhiem.json",Effect_Element_ATLAS:"res/game/xengthamhiem/effect/thamhiem.atlas",FontNoHuPNG:"res/Fonts/fontNoHu.png",FontNoHu:"res/Fonts/fontNoHu.fnt",FontBigWinPNG:"res/Fonts/fontWin.png",FontBigWin:"res/Fonts/fontWin.fnt",MGUILayerXengThamHiem:"res/game/xengthamhiem/UIXTHXengThamHiem.json",MGUILayerPopupTutorial:"res/game/xengthamhiem/UIXTHPopupTutorial.json",MGUICompoMiniGame:"res/game/xengthamhiem/UIXTHCompoMiniGame.json",MGUILayerContentLichSu:"res/game/xengthamhiem/UIXTHContentLichSu.json",
MGUILayerPopupLichSu:"res/game/xengthamhiem/UIXTHPopupLichSu.json",MGUILayerPopupThongBao:"res/game/xengthamhiem/UIXTHPopupThongBao.json",MGUILayerContentThangLon:"res/game/xengthamhiem/UIXTHContentThangLon.json",MGUILayerPopupThangLon:"res/game/xengthamhiem/UIXTHPopupThangLon.json",XTH_Click:"res/game/xengthamhiem/sounds/click.mp3",XTH_ClickQuay:"res/game/xengthamhiem/sounds/ClickQuay.mp3",XTH_BigWin:"res/game/xengthamhiem/sounds/BigWin.mp3",XTH_Quay:"res/game/xengthamhiem/sounds/Quay.mp3",XTH_Win1:"res/game/xengthamhiem/sounds/Win2.mp3",
XTH_Win2:"res/game/xengthamhiem/sounds/Win3.mp3",XTH_Win3:"res/game/xengthamhiem/sounds/Win4.mp3",XTH_Win4:"res/game/xengthamhiem/sounds/Win5.mp3",XTH_SoundMiniGame:"res/game/xengthamhiem/sounds/NhaThamHiemBGM.mp3",XTH_RuongTrat:"res/game/xengthamhiem/sounds/RuongTrat.mp3",XTH_RuongTrung:"res/game/xengthamhiem/sounds/RuongTrung.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesXengThamHiem=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengThamHiemPreloadMobile)ResourceManager.MGResourcesGameXengThamHiemPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengThamHiemPreloadMobile[i],resourcesXengThamHiem.push(ResourceManager.MGResourcesGameXengThamHiemPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengThamHiem)ResourceManager.MGResourcesGameXengThamHiem[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengThamHiem[i]}else for(i in ResourceManager.MGResourcesGameXengThamHiem)ResourceManager.MGResourcesGameXengThamHiem[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameXengThamHiem[i],resourcesXengThamHiem.push(ResourceManager.MGResourcesGameXengThamHiem[i]);ConstantsVariable.NETWORK_XENGTHAMHIEM={Turning:3200,PerformTurning:3201,BetGameMini:3202,ResultGameMini:3203,StartGame:3204,CancelGameMini:3205,UserLeftDesk:3206,ListUser:3207,GameData:3208,TotalGoldBonus:3209,ToolResult:3210,WinBonusBox:3211,BigWin:3212,TopWinBonusBox:3213,TopBigWin:3214,AutoTurning:3215,AutoPlayMiniGame:3216};var MGNetSendXengThamHiem=cc.Class.extend({gameModuleID:null,ctor:function(){},sendBetSpin:function(a){var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGTHAMHIEM.Turning.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendPosMiniGame:function(a){var b={};b.BetKind=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGTHAMHIEM.BetGameMini.toString(),{BetKind:BinaryConstants.DataTypeID.UInt8},
b);MGNetCore.MGSocket.sendMsg(a)},sendToolThamHiem:function(a){var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGTHAMHIEM.ToolResult.toString(),{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXTHContentLichSu=MGBaseNode.extend({containLS:null,_textPhien:null,_textThoiGian:null,_textCuoc:null,_textDongTrung:null,_textTienTrung:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerContentLichSu,PreLoaderConfig.PathToResourceDefault).node);this.containLS=this.getChildByName("ContentLSTH");this._textPhien=this.containLS.getChildByName("TextPhien");
this._textPhien.ignoreContentAdaptWithSize(!0);this._textThoiGian=this.containLS.getChildByName("TextThoiGian");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textCuoc=this.containLS.getChildByName("TextCuoc");this._textCuoc.ignoreContentAdaptWithSize(!0);this._textDongTrung=this.containLS.getChildByName("TextDongTrung");this._textDongTrung.ignoreContentAdaptWithSize(!0);this._textTienTrung=this.containLS.getChildByName("TextTienTrung");this._textTienTrung.ignoreContentAdaptWithSize(!0)},
getContainLS:function(a,b,d,e,f){this._textPhien.setString(a);this._getThoiGian(b);this._textCuoc.setString(Utilities.Coin(d));this._getDongTrung(e);this._textTienTrung.setString(Utilities.Coin(f))},_getThoiGian:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+a.getSeconds(),d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?a.getHours():"0"+a.getHours();this._textThoiGian.setString(e+":"+d+":"+b+"  "+a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear())},
_getDongTrung:function(a){this._textDongTrung.setString(a.length)}});var MGXTHContentThangLon=MGBaseNode.extend({containThangLon:null,_textSTT:null,_textMaTK:null,_textTenHienThi:null,_textKetQua:null,_tienThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerContentThangLon,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("ContentTLTH");this._textSTT=this.containThangLon.getChildByName("TextSTT");
this._textSTT.ignoreContentAdaptWithSize(!0);this._textMaTK=this.containThangLon.getChildByName("TextMTK");this._textMaTK.ignoreContentAdaptWithSize(!0);this._textTenHienThi=this.containThangLon.getChildByName("TextTenHienThi");this._textTenHienThi.ignoreContentAdaptWithSize(!0);this._textKetQua=this.containThangLon.getChildByName("TextKetQua");this._textKetQua.ignoreContentAdaptWithSize(!0);this._tienThang=this.containThangLon.getChildByName("TextTienThang");this._tienThang.ignoreContentAdaptWithSize(!0)},
getContainThangLon:function(a,b,d,e){this._textMaTK.setString(a);this._textTenHienThi.setString(b);this._tienThang.setString(Utilities.Coin(e));this._getKetQua(d)},getSTT:function(a){this._textSTT.setString(a)},_getKetQua:function(a){0<=a&&1>=a&&this._textKetQua.setString(MGXTHContentThangLon.TYPE_NOHU[a])}});MGXTHContentThangLon.TYPE_NOHU={0:"Thắng thường",1:"Nổ hũ"};var MGXTHPopupLichSu=MGBaseNode.extend({_listLichSu:null,backGround:null,matchID:null,thoiGian:null,tienCuoc:null,dongTrung:null,coinWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerPopupLichSu,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("ListViewLSTH")},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);
this._listEvents.push(this.getChildByName("ButtonBackGameLSTH").addClickEventListener(this.hidePopup.bind(this)))},setContainLichSu:function(a,b,d,e,f){this.matchID=a;this.thoiGian=b;this.tienCuoc=d;this.dongTrung=e;this.coinWin=f},addContainLichSu:function(){var a=new MGXTHContentLichSu;a.initObj();a.getContainLS(this.matchID,this.thoiGian,this.tienCuoc,this.dongTrung,this.coinWin);a.containLS.removeFromParent(!0);this._listLichSu.insertCustomItem(a.containLS,0);this._showListLichSu()},_showListLichSu:function(){this._listLichSu.getItems().length>=
MGXTHPopupLichSu.MAX_LINE&&this._listLichSu.removeItem(MGXTHPopupLichSu.MAX_LINE-1)},hidePopup:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Click,MGGameInfo.gameVolume,!1);this.backGround.setVisible(!1);this.setVisible(!1)},showPopup:function(){this.backGround.setVisible(!0);this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this._listLichSu.removeAllChildren(!0)}});MGXTHPopupLichSu.MAX_LINE=100;var MGXTHPopupThangLon=MGBaseNode.extend({_dataThangLon:null,_listThangLon:null,backGround:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._currentLoad=0;this._isShowed=!1;this._dataThangLon=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerPopupThangLon,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listThangLon=this.getChildByName("ListViewTLTH");
this.scheduleUpdate()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("ButtonBackGameTBTH").addClickEventListener(this.hidePopup.bind(this))},update:function(a){this._isShowed&&this._listThangLon.getBottommostItemInCurrentView()&&this._listThangLon.getBottommostItemInCurrentView().getTag()===this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+11<this._dataThangLon.length?11:this._dataThangLon.length-this._currentLoad;
if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this._listThangLon.pushBackCustomItem(this.createCellInfo(this._dataThangLon[b],b+1));this._listThangLon.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.getSTTListData()}},getListDataThangLon:function(a){for(var b=a.length<MGXTHPopupThangLon.MAX_LINE?a.length:MGXTHPopupThangLon.MAX_LINE,d=0;d<b;d++)this._dataThangLon.push(a[d])},getSTTListData:function(){for(var a=0;a<this._listThangLon.getItems().length;a++)this._listThangLon.getItem(a).setTag(a+
1),this._listThangLon.getItem(a).getChildByName("TextSTT").setString(a+1)},createCellInfo:function(a,b){var d=new MGXTHContentThangLon;d.initObj();d.getContainThangLon(a.UserID,a.NickName,a.Type,a.EarnCoin);d.containThangLon.removeFromParent(!0);return d.containThangLon},getDataThangLon:function(a){this._isShowed?(a=this.createCellInfo(a,0),this._listThangLon.insertCustomItem(a,0),this._listThangLon.getItems().length>MGXTHPopupThangLon.MAX_LINE&&(this._listThangLon.removeItem(MGXTHPopupThangLon.MAX_LINE),
this._dataThangLon.splice(this._dataThangLon.length-1,1)),this.getSTTListData()):this._dataThangLon.splice(0,0,a)},hidePopup:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Click,MGGameInfo.gameVolume,!1);this.backGround.setVisible(!1);this.setVisible(!1)},showPopup:function(){this._isShowed||(this._isShowed=!0,this.loadMoreItem(),this._listThangLon.jumpToTop());this.backGround.setVisible(!0);this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);
this._listThangLon.removeAllChildren(!0);this._dataThangLon.splice(0,this._dataThangLon.length);this._dataThangLon=[];this.unscheduleUpdate()}});MGXTHPopupThangLon.MAX_LINE=100;var MGXTHPopupTutorial=MGBaseNode.extend({pageView:null,listButton:null,backGround:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listButton=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerPopupTutorial,PreLoaderConfig.PathToResourceDefault).node);this.pageView=this.getChildByName("PageView");this.listButton=this.getChildren();this._initEventBtnFromNode()},_initEventBtnFromNode:function(){for(var a=
0;a<this.listButton.length;a++)this.listButton[a]instanceof ccui.Button&&this.listButton[a].addClickEventListener(this.onClickBtnFromCocostudio.bind(this));this.pageView.addEventListener(function(a,d){this.updateButtonTutorial(a.getCurPageIndex())}.bind(this))},onClickBtnFromCocostudio:function(a){mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Click,MGGameInfo.gameVolume,!1);switch(a.getName()){case MGXTHPopupTutorial.BUTTON_NAME.EXIT:this.hidePopup();break;case MGXTHPopupTutorial.BUTTON_NAME.NEXT:a=
this.pageView.getCurrentPageIndex();a=3>a?++a:3;this.updatePageView(a);break;case MGXTHPopupTutorial.BUTTON_NAME.BACK:a=this.pageView.getCurrentPageIndex(),a=0<a?--a:0,this.updatePageView(a)}},updatePageView:function(a){this.pageView.scrollToPage(a);this.updateButtonTutorial(a)},updateButtonTutorial:function(a){0==a?(this.showButton(MGXTHPopupTutorial.BUTTON_NAME.NEXT),this.hideButton(MGXTHPopupTutorial.BUTTON_NAME.BACK)):3==a?(this.showButton(MGXTHPopupTutorial.BUTTON_NAME.BACK),this.hideButton(MGXTHPopupTutorial.BUTTON_NAME.NEXT)):
(this.showButton(MGXTHPopupTutorial.BUTTON_NAME.BACK),this.showButton(MGXTHPopupTutorial.BUTTON_NAME.NEXT))},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showPopup:function(){this.backGround.setVisible(!0);this.setVisible(!0);var a=this.pageView.getCurrentPageIndex();this.updateButtonTutorial(a)},hidePopup:function(){this.backGround.setVisible(!1);
this.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXTHPopupTutorial.BUTTON_NAME={EXIT:"Button_BackGameTH",NEXT:"Button_NextTH",BACK:"Button_PreTH"};var MGXTHPopupThongBao=MGBaseNode.extend({listView:null,backGround:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.backGround=a;this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerPopupThongBao,PreLoaderConfig.PathToResourceDefault).node);this.listView=this.getChildByName("ListViewTBTH");this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("ButtonBackGameTBTH").addClickEventListener(this.hidePopup.bind(this));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=a.getUserData();this.listView.getItems().length>=MGXTHPopupThongBao.MAX_LINE&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",15,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()},showPopup:function(){this.backGround.setVisible(!0);
this.setVisible(!0)},hidePopup:function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Click,MGGameInfo.gameVolume,!1);this.backGround.setVisible(!1);this.setVisible(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXTHPopupThongBao.MAX_LINE=100;var MGXTHLayerPopup=MGBaseNode.extend({popupTutorial:null,popupThongBao:null,popupLichSu:null,popupThangLon:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.initBackGround();this.initPopupThongBao();this.initPopupThangLon();this.initPopupLichSu()},initBackGround:function(){MGBaseNode.prototype.initObj.call(this);this.backGroundPopup=new ccui.Layout;this.backGroundPopup.setContentSize(cc.size(2560,1440));this.backGroundPopup.setPosition(cc.p(0,
0));this.backGroundPopup.setAnchorPoint(.5,.5);this.backGroundPopup.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);this.backGroundPopup.setBackGroundColor(cc.color(0,0,0));this.backGroundPopup.setBackGroundColorOpacity(210);this.backGroundPopup.setTouchEnabled(!0);this.addChild(this.backGroundPopup,0);this.backGroundPopup.setVisible(!1)},initPopupTutorial:function(){this.popupTutorial=new MGXTHPopupTutorial;this.popupTutorial.initObj(this.backGroundPopup);this.popupTutorial.hidePopup();this.addChild(this.popupTutorial)},
showPopupTutorial:function(){this.popupTutorial||this.initPopupTutorial();this.popupTutorial.showPopup()},showPopupThangLon:function(){this.popupThangLon.showPopup()},initPopupThongBao:function(){this.popupThongBao=new MGXTHPopupThongBao;this.popupThongBao.initObj(this.backGroundPopup);this.popupThongBao.hidePopup();this.addChild(this.popupThongBao)},initPopupThangLon:function(){this.popupThangLon=new MGXTHPopupThangLon;this.popupThangLon.initObj(this.backGroundPopup);this.popupThangLon.hidePopup();
this.addChild(this.popupThangLon)},initPopupLichSu:function(){this.popupLichSu=new MGXTHPopupLichSu;this.popupLichSu.initObj(this.backGroundPopup);this.popupLichSu.hidePopup();this.addChild(this.popupLichSu)}});var MGXTHComboElement=MGBaseNode.extend({_listColumn:null,listElementLine:null,_panelCombo:null,lineWin:null,listTimeOut:null,countLine:null,mainGame:null,listIntervalEffect:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.lineWin=[];this._listColumn=[];this.listElementLine=[];this.listTimeOut=[];this.listIntervalEffect=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._panelCombo=this.getChildByName("Panel");this._initListImage();this.initElementLine()},
_initListImage:function(){for(var a=null,b=0;5>b;b++)a=new MGXTHContainElement,a.cloneFromNode(this._panelCombo.getChildByName("MGScroll_"+b)),a.initObj(),this._listColumn.push(a),this._listColumn[b].delayLine=b,this._panelCombo.addChild(a)},initElementLine:function(){for(var a=[],b=0;5>b;b++)for(var d=0;3>d;d++)a.push(this._listColumn[b].listImage[d]),this._listColumn[b].listImage[d].idPos=a.length-1;this.listElementLine[0]=[a[1],a[4],a[7],a[10],a[13]];this.listElementLine[1]=[a[2],a[5],a[8],a[11],
a[14]];this.listElementLine[2]=[a[0],a[3],a[6],a[9],a[12]];this.listElementLine[3]=[a[2],a[4],a[6],a[10],a[14]];this.listElementLine[4]=[a[0],a[4],a[8],a[10],a[12]];this.listElementLine[5]=[a[1],a[5],a[8],a[11],a[13]];this.listElementLine[6]=[a[1],a[3],a[6],a[9],a[13]];this.listElementLine[7]=[a[2],a[5],a[7],a[9],a[12]];this.listElementLine[8]=[a[0],a[3],a[7],a[11],a[14]];this.listElementLine[9]=[a[1],a[3],a[7],a[11],a[13]];this.listElementLine[10]=[a[1],a[5],a[7],a[9],a[13]];this.listElementLine[11]=
[a[2],a[4],a[7],a[10],a[14]];this.listElementLine[12]=[a[0],a[4],a[7],a[10],a[12]];this.listElementLine[13]=[a[2],a[4],a[8],a[10],a[14]];this.listElementLine[14]=[a[0],a[4],a[6],a[10],a[12]];this.listElementLine[15]=[a[1],a[4],a[8],a[10],a[13]];this.listElementLine[16]=[a[1],a[4],a[6],a[10],a[13]];this.listElementLine[17]=[a[2],a[5],a[6],a[11],a[14]];this.listElementLine[18]=[a[0],a[3],a[8],a[9],a[12]];this.listElementLine[19]=[a[2],a[3],a[6],a[9],a[14]]},moveComboElement:function(){for(var a=0;5>
a;a++)this._listColumn[a].moveContainElement()},setComboElement:function(a){this.unschedule(this.showNextEffect);this.stopAllActionColumn();this.moveComboElement();for(var b=0;b<this._listColumn.length;b++)this._listColumn[b].setValueElement(this._setValueArr(a,b),this.mainGame.comboEffect.compoEffectNode.getMoreTimeEffect(b))},_setValueArr:function(a,b){for(var d=[],e=0;3>e;e++)d[e]=a[b][e];return d},hideAllEffect:function(){for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].hideEffect()},
setLineWin:function(a){this.lineWin=a;this.countLine=this.lineWin.length},showEffectEndMatch:function(){this.mainGame.comboEffect.compoEffectNode.hideAllEffectReel();0<this.lineWin.length&&this.showAllLine()},showAllLine:function(){this.showNextEffect();this.schedule(this.showNextEffect,2.7)},showNextEffect:function(){mg.audio.stopAllEffects();var a=parseInt(4*Math.random())+1;1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Win1,MGGameInfo.gameVolume,!1):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Win2,
MGGameInfo.gameVolume,!1):3==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Win3,MGGameInfo.gameVolume,!1):mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Win4,MGGameInfo.gameVolume,!1);this.stopAllActionColumn();if(this.countLine==this.lineWin.length){this.mainGame.comboEffect.effectWin||this.mainGame.comboEffect.initEffectWin();0<this.mainGame.goldWin&&this.mainGame.comboEffect.effectWin.playAnimationWin(this.mainGame.goldWin);for(a=0;a<this.lineWin.length;a++)for(var b=
0;5>b;b++)this.showEffectLine(this.listElementLine[this.lineWin[a].Index][b],this.lineWin[a].IconWin);this.countLine=0}else{this.mainGame.comboEffect.effectWin.stopAnimationWin();for(b=0;5>b;b++)this.showEffectLine(this.listElementLine[this.lineWin[this.countLine].Index][b],this.lineWin[this.countLine].IconWin);this.countLine++}},showEffectLine:function(a,b){this.mainGame.comboEffectItem.showKhung(a);if(a.idElement==b||9==a.idElement)9==a.idElement||11==a.idElement||6==a.idElement||4==a.idElement||
3==a.idElement||1==a.idElement||12==a.idElement?(a.setVisible(!1),this.mainGame.comboEffect.showEffectElement(a)):(this.mainGame.comboEffectItem.showKhung(a),a.runAction(cc.sequence(cc.sequence(cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.3,1,1)).repeat(4))))},showEffectOnReel:function(a,b){a.setVisible(!1);this.mainGame.comboEffect.showEffectElement(a);this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.mainGame.comboEffect.hideEffectElement(a);a.setVisible(!0)}.bind(this))))},stopAllActionColumn:function(){this.mainGame.comboEffect.hideAllEffectElement();
this.mainGame.comboEffectItem.hideAllEffectItem();for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].stopActionColumn(),this._listColumn[a].showColumn()},hideAllColumn:function(){this.stopAllActionColumn();for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].hideColumn();this.unschedule(this.showNextEffect)},showAllColumn:function(){if(1==this.mainGame.isMiniGame){for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].showColumn();this.mainGame.isMiniGame=!1}},onPlayReelEffect:function(a){for(var b=
0;3>b;b++){var d=this._listColumn[a].listImage[b];11!=d.idElement&&12!=d.idElement||this.showEffectOnReel(d,d.idElement)}},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(var a=0;a<this._listColumn.length;a++)this._listColumn[a].setDispose(),this._listColumn[a].removeFromParent(!0);this.unschedule(this.showNextEffect)}});var MGXTHContainElement=MGBaseNode.extend({listImage:null,_valueListImage:null,_countCallBack:null,delayLine:null,_result:null,moreTime:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listImage=[];this._countCallBack=0;this._valueListImage=[];this._result=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initIcon()},_initIcon:function(){for(var a=null,b=null,d=0;6>d;d++)b=parseInt(13*Math.random())+1,a=this.getChildByName("Sprite_"+d),a.setSpriteFrame(MGXTHContainElement.IMAGE_ELEMENT[b]),
a.idElement=b,this.listImage.push(a)},loadImage:function(){for(var a=0;6>a;a++)this.listImage[a].setSpriteFrame(MGXTHContainElement.IMAGE_ELEMENT[this._valueListImage[a]]),this.listImage[a].idElement=this._valueListImage[a]},setValueElement:function(a,b){for(var d=2,e=0;3>e;e++)this._valueListImage[e]=a[d],d--;d=null;for(e=3;6>e;e++)d=parseInt(13*Math.random())+1,this._valueListImage[e]=d;this.moreTime=b},moveContainElement:function(){this._countCallBack++;var a=this.getPosition();-510>=a.y&&this.setPosition(a.x,
0);var a=this.getPosition(),b=null,d=b=null;if(1===this._countCallBack)b=new cc.JumpBy(.1,cc.p(0,30),0,0),d=new cc.JumpBy(.01,cc.p(0,-30),0,0),b=cc.sequence(cc.delayTime(.3*this.delayLine),b,d,cc.callFunc(this.moveContainElement.bind(this)));else if(2<=this._countCallBack&&5>this._countCallBack)b=cc.sequence(cc.moveTo(.01,cc.p(a.x,a.y-100)),cc.callFunc(this.moveContainElement.bind(this)));else if(this._countCallBack<=25+15*this.moreTime)b=cc.sequence(cc.moveTo(.009,cc.p(a.x,a.y-100)),cc.callFunc(this.moveContainElement.bind(this)));
else{this.loadImage();var b=new cc.JumpBy(.001,cc.p(0,-25),0,0),d=new cc.JumpBy(.3,cc.p(0,25),0,0),e={};e.Index=this.delayLine;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,e);b=4===this.delayLine?cc.sequence(b,d,cc.delayTime(.5),cc.callFunc(this._finishQuay.bind(this)),cc.delayTime(4)):cc.sequence(b,d);this._countCallBack=0;this.setPosition(a.x,0)}this.runAction(b)},_finishQuay:function(){cc.eventManager.dispatchCustomEvent(MGXTHContainElement.EVENTS.FINISH_SPIN,null)},
stopActionColumn:function(){for(var a=0;3>a;a++)this.listImage[a].stopAllActions(),this.listImage[a].setScale(1)},hideColumn:function(){this.stopActionColumn();for(var a=0;3>a;a++)this.listImage[a].setVisible(!1)},showColumn:function(){for(var a=0;3>a;a++)this.listImage[a].setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.unscheduleAllCallbacks()}});
MGXTHContainElement.IMAGE_ELEMENT={1:"image_chengho.png",2:"image_pharaong.png",3:"image_columbus.png",4:"image_magellan.png",5:"image_ongdia.png",6:"image_nikitin.png",7:"image_voi.png",8:"image_tuong2.png",9:"image_wild.png",10:"image_tuong1.png",11:"image_scatter.png",12:"image_bonus.png",13:"Image_Ruong.png"};MGXTHContainElement.EVENTS={FINISH_SPIN:"finish_spin"};var MGXTHComboEffectItem=MGBaseNode.extend({mainGame:null,compoEffectNode:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.initCompoEffectNode()},initCompoEffectNode:function(){this.compoEffectNode=new MGCompoEffectNode;this.addChild(this.compoEffectNode,0);for(var a=this.mainGame._mainLayer.getChildByName("NodeKhung"),b=1;16>b;b++)this.compoEffectNode.addEffectItem(cc.size(240,240),a.getChildByName("NodeKhung_"+
b).getPosition())},showKhung:function(a){this.compoEffectNode.showEffectItem(a.idPos,2.4)},hideEffectElement:function(a){this.compoEffectNode.hideEffectItem(a.idPos)},hideAllEffectItem:function(){this.compoEffectNode.hideAllEffectItem()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoEffectNode&&this.compoEffectNode.setDispose()}});var MGXTHComboText=MGBaseNode.extend({mainGame:null,coinWin:null,textNoHu:null,textTongTien:null,textMatchID:null,textTongCuoc:null,textTitleDongCuoc:null,textNumberDongCuoc:null,freeTurning:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.textNoHu=this.getChildByName("MGTextNoHu");this.textTongTien=this.getChildByName("MGTextCoin");this.textMatchID=this.getChildByName("MGTextMatchID");this.textTongCuoc=this.getChildByName("MGTextTongBet");
this.textTitleDongCuoc=this.getChildByName("MGTextDongCuoc");this.textNumberDongCuoc=this.getChildByName("MGTextTongDong")},setTextNoHu:function(a){this.textNoHu.setString(Utilities.Coin(a))},setTextTongTien:function(a){this.textTongTien.setString(Utilities.Coin(a))},setTextMatchID:function(a){this.textMatchID.setString("#"+a)},setCoinWin:function(a){this.coinWin=a},setTextWhenSpin:function(a,b,d,e){this.setTextTongTien(a);this.setTextMatchID(b);this.setCoinWin(d);this.freeTurning=e;this.setTextDongCuoc()},
setTextTongCuoc:function(a){this.mainGame.betCuoc=a;this.textTongCuoc.setString(Utilities.Coin(a))},setTextDongCuoc:function(){this.textTitleDongCuoc.setString("DÒNG CƯỢC");this.textNumberDongCuoc.setString("20 DÒNG")},setTextTienThang:function(){this.textTitleDongCuoc.setString("TIỀN THẮNG");this.textNumberDongCuoc.setString(Utilities.Coin(this.coinWin))},setTextFreeTurning:function(){0<this.freeTurning?(this.mainGame.textFree.setVisible(!0),this.mainGame.textFree.setString("LƯỢT QUAY MIỄN PHÍ: "+
this.freeTurning),this.mainGame.isFreeTurning=!0):(this.mainGame.textFree.setVisible(!1),this.mainGame.isFreeTurning=!1)},setMaxCuoc:function(){this.mainGame.betCuoc=this.mainGame.listCoinCanBet[this.mainGame.listCoinCanBet.length-1];this.textTongCuoc.setString(Utilities.Coin(this.mainGame.betCuoc))},addBetCuoc:function(){for(var a=-1,b=0;b<this.mainGame.listCoinCanBet.length;b++)this.mainGame.betCuoc==this.mainGame.listCoinCanBet[b]&&(a=b);a=a==this.mainGame.listCoinCanBet.length-1?0:++a;this.setTextTongCuoc(this.mainGame.listCoinCanBet[a])},
subBetCuoc:function(){for(var a=-1,b=0;b<this.mainGame.listCoinCanBet.length;b++)this.mainGame.betCuoc==this.mainGame.listCoinCanBet[b]&&(a=b);a=0==a?this.mainGame.listCoinCanBet.length-1:--a;this.setTextTongCuoc(this.mainGame.listCoinCanBet[a])},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGXTHComboButton=MGBaseNode.extend({_listButton:null,mainGame:null,_benginTouch:!1,_count:0,_canSpin:!0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this._benginTouch=!1;this._count=0;this._canSpin=!0},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),
this._listButton.push(a[d]));this.scheduleUpdate()},update:function(a){this._benginTouch&&(this._count+=a,.5<=this._count&&(this._count=0,this._benginTouch=this._canSpin=!1,this.getChildByName(MGXTHComboButton.BUTTON_NAME.SPIN).setVisible(!1),this.mainGame.isAutoSpin=!0,this.getChildByName(MGXTHComboButton.BUTTON_NAME.STOP).setVisible(!0),this.hideButtonSpin(),0==this.mainGame.gameStatus&&this.mainGame.netSend.sendBetSpin(this.mainGame.betCuoc)))},hideWhenSpin:function(){this.hideButton(MGXTHComboButton.BUTTON_NAME.BET_UP);
this.hideButton(MGXTHComboButton.BUTTON_NAME.BET_DOWN);this.hideButton(MGXTHComboButton.BUTTON_NAME.MAX_BET);this.hideButton(MGXTHComboButton.BUTTON_NAME.SPIN)},showWhenSpinDone:function(){0==this.mainGame.isFreeTurning&&0==this.mainGame.isAutoSpin&&(this.showButton(MGXTHComboButton.BUTTON_NAME.BET_UP),this.showButton(MGXTHComboButton.BUTTON_NAME.BET_DOWN),this.showButton(MGXTHComboButton.BUTTON_NAME.MAX_BET))},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},
showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},stopAutoSpin:function(){this.mainGame.isAutoSpin=!1;this.getChildByName(MGXTHComboButton.BUTTON_NAME.STOP).setVisible(!1);this.getChildByName(MGXTHComboButton.BUTTON_NAME.SPIN).setVisible(!0);this.showButton(MGXTHComboButton.BUTTON_NAME.SPIN);this.mainGame.isSpin?this.getChildByName(MGXTHComboButton.BUTTON_NAME.SPIN).setEnabled(!1):(this.getChildByName(MGXTHComboButton.BUTTON_NAME.SPIN).setEnabled(!0),
this.showWhenSpinDone());this._canSpin=!0},onClickBtnFromCocostudio:function(a,b){0==b&&(a.getName()==MGXTHComboButton.BUTTON_NAME.SPIN?mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_ClickQuay,MGGameInfo.gameVolume,!1):mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Click,MGGameInfo.gameVolume,!1));switch(a.getName()){case MGXTHComboButton.BUTTON_NAME.SPIN:switch(b){case 0:this._benginTouch=!0;this._count=0;break;case 1:this._benginTouch=!0;break;case 2:this._count=
0;this._benginTouch=!1;this._canSpin&&this.mainGame.netSend.sendBetSpin(this.mainGame.betCuoc);break;case 3:this._count=0,this._benginTouch=!1}break;case MGXTHComboButton.BUTTON_NAME.INFO:0==b&&this.mainGame.layerPopup.showPopupTutorial();break;case MGXTHComboButton.BUTTON_NAME.BET_DOWN:0==b&&this.mainGame.comboText.subBetCuoc();break;case MGXTHComboButton.BUTTON_NAME.BET_UP:0==b&&this.mainGame.comboText.addBetCuoc();break;case MGXTHComboButton.BUTTON_NAME.MAX_BET:0==b&&this.mainGame.comboText.setMaxCuoc();
break;case MGXTHComboButton.BUTTON_NAME.THANG_LON:0==b&&this.mainGame.layerPopup.showPopupThangLon();break;case MGXTHComboButton.BUTTON_NAME.THONG_BAO:0==b&&this.mainGame.layerPopup.popupThongBao.showPopup();break;case MGXTHComboButton.BUTTON_NAME.LICH_SU:0==b&&this.mainGame.layerPopup.popupLichSu.showPopup();break;case MGXTHComboButton.BUTTON_NAME.STOP:0==b&&this.stopAutoSpin()}},showButtonSpin:function(){this.showButton(MGXTHComboButton.BUTTON_NAME.SPIN);this._canSpin=!0},hideButtonSpin:function(){this.hideButton(MGXTHComboButton.BUTTON_NAME.SPIN)},
hideAll:function(){for(var a=0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXTHComboButton.BUTTON_NAME={SPIN:"ButtonStartTH",STOP:"ButtonStopTH",MAX_BET:"ButtonMaxBetTH",BET_UP:"ButtonAddBetTH",BET_DOWN:"ButtonSubBetTH",INFO:"ButtonThongTinTH",THANG_LON:"ButtonThangLonTH",THONG_BAO:"ButtonThongBaoTH",LICH_SU:"ButtonLichSuTH"};var MGXTHComboEffect=MGBaseNode.extend({mainGame:null,backGroundEffect:null,effectBonusBox:null,effectCoinWinBonusBox:null,listEffectImage:null,timeOutEffectBonusBox:null,timeOutEffectBigWin:null,effectBigWin:null,effectCoinWinBigWin:null,haveJackPot:!1,effectWin:null,compoEffectNode:null,comboEffectSpecial:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listEffectImage=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.initCompoEffectNode();this.initBackGroundEffect()},
initBackGroundEffect:function(){this.backGroundEffect=new ccui.Layout;this.backGroundEffect.setContentSize(cc.size(cc.winSize.width,cc.winSize.height+300));this.backGroundEffect.setPosition(cc.p(-((cc.winSize.width-1280)/2),720));this.backGroundEffect.setAnchorPoint(0,1);this.backGroundEffect.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);this.backGroundEffect.setBackGroundColor(cc.color(0,0,0));this.backGroundEffect.setBackGroundColorOpacity(200);this.backGroundEffect.setTouchEnabled(!0);this.addChild(this.backGroundEffect,
MGXTHComboEffect.INDEX_BIG_WIN);this.backGroundEffect.setVisible(!1)},initEffectWin:function(){this.effectWin=new MGComboEffectWinCoinXeng;this.effectWin.initObj();this.addChild(this.effectWin,MGXTHComboEffect.INDEX_IMAGE+10);this.effectWin.setPosition(630,640);this.effectWin.setPositionText(230);this.effectWin.setPositionAni(85)},initBonusBox:function(){var a=this.mainGame._mainLayer.getChildByName("NodeEffectTH").getPosition();this.effectBonusBox=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengThamHiem.No_Hu_JSON,
ResourceManager.MGResourcesGameXengThamHiem.No_Hu_ATLAS);this.effectBonusBox.setPosition(a);this.addChild(this.effectBonusBox,MGXTHComboEffect.INDEX_BIG_WIN);this.effectBonusBox.setVisible(!1);this.effectCoinWinBonusBox=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengThamHiem.FontNoHu);this.effectCoinWinBonusBox.setVisible(!1);this.addChild(this.effectCoinWinBonusBox,MGXTHComboEffect.INDEX_BIG_WIN);this.effectCoinWinBonusBox.setPosition(a.x,a.y+10)},initBigWin:function(){var a=
this.mainGame._mainLayer.getChildByName("NodeEffectTH").getPosition();this.effectBigWin=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengThamHiem.No_ThangLon_JSON,ResourceManager.MGResourcesGameXengThamHiem.No_ThangLon_ATLAS);this.effectBigWin.setPosition(a.x,a.y+30);this.addChild(this.effectBigWin,MGXTHComboEffect.INDEX_BIG_WIN);this.effectBigWin.setVisible(!1);this.effectCoinWinBigWin=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengThamHiem.FontBigWin);this.effectCoinWinBigWin.setVisible(!1);
this.addChild(this.effectCoinWinBigWin,MGXTHComboEffect.INDEX_BIG_WIN);this.effectCoinWinBigWin.setPosition(a.x,a.y-80)},initEffectSpecial:function(){this.comboEffectSpecial=new MGComboEffectSpecialXeng;this.comboEffectSpecial.initObj();this.addChild(this.comboEffectSpecial,MGXTHComboEffect.INDEX_BIG_WIN);this.comboEffectSpecial.setCallBackSuccess(this.mainGame.comboElement.showEffectEndMatch())},createSkeletonAnimation:function(a){var b=this.mainGame._mainLayer.getChildByName("NodeEffectIconTH"),
d=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengThamHiem.Effect_Element_JSON,ResourceManager.MGResourcesGameXengThamHiem.Effect_Element_ATLAS);d.setPosition(b.getChildByName("Node_Effect_"+(a+1)).getPosition());this.addChild(d,MGXTHComboEffect.INDEX_IMAGE);d.setVisible(!1);return this.listEffectImage[a]=d},initCompoEffectNode:function(){this.compoEffectNode=new MGCompoEffectNode;this.addChild(this.compoEffectNode,MGXTHComboEffect.INDEX_BIG_WIN);for(var a=this.mainGame._mainLayer.getChildByName("NodeEffectReel"),
b=1;5>=b;b++)this.compoEffectNode.addEffectReel(cc.size(250,520),a.getChildByName("NodeReel_"+b).getPosition());this.compoEffectNode.setCallbackOnPlayEffectReel(this.mainGame.comboElement.onPlayReelEffect.bind(this.mainGame.comboElement))},playWinBonus:function(){this.compoEffectNode.hideAllEffectReel();this.comboEffectSpecial||this.initEffectSpecial();this.comboEffectSpecial.playEffectWinBonus(350)},playWinScatter:function(){this.compoEffectNode.hideAllEffectReel();this.mainGame.textFree.setVisible(!1);
this.comboEffectSpecial||this.initEffectSpecial();this.comboEffectSpecial.playEffectWinScatter(250)},playEffectBonusBox:function(a){mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_BigWin,MGGameInfo.gameVolume,!1);this.backGroundEffect.setVisible(!0);this.haveJackPot=!0;this.effectBonusBox||this.initBonusBox();this.effectBonusBox.setVisible(!0);this.effectBonusBox.setAnimation(0,"animation",!1);this.effectCoinWinBonusBox.setVisible(!0);this.effectCoinWinBonusBox.setString(Utilities.Coin(a));
this.effectCoinWinBonusBox.setScale(30);this.effectCoinWinBonusBox.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinBonusBox.setVisible(!1);this.backGroundEffect.setVisible(!1);this.haveJackPot=!1}.bind(this))));this.timeOutEffectBonusBox=setTimeout(this.hideEffect.bind(this,this.effectBonusBox),4E3)},playEffectBigWin:function(a,b){b==MGGameInfo.myInfo.UserID&&0==this.haveJackPot&&0==this.mainGame.isFreeTurning&&0==this.mainGame.isAutoSpin&&(mg.audio.stopAllEffects(),
mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_BigWin,MGGameInfo.gameVolume,!1),this.backGroundEffect.setVisible(!0),this.effectBigWin||this.initBigWin(),this.effectBigWin.setAnimation(0,"animation",!1),this.effectBigWin.setVisible(!0),this.effectCoinWinBigWin.setString(Utilities.Coin(a)),this.effectCoinWinBigWin.setVisible(!0),this.effectCoinWinBigWin.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinBigWin.setVisible(!1);this.backGroundEffect.setVisible(!1)}.bind(this)))),
this.timeOutEffectBigWin=setTimeout(this.hideEffect.bind(this,this.effectBigWin),4E3))},hideEffect:function(a){a.setVisible(!1)},showEffectElement:function(a){this.listEffectImage[a.idPos]||this.createSkeletonAnimation(a.idPos);this.listEffectImage[a.idPos].setVisible(!0);this.listEffectImage[a.idPos].setAnimation(0,MGXTHComboEffect.NAME_EFFECT[a.idElement],"false")},hideEffectElement:function(a){this.listEffectImage[a.idPos]&&this.listEffectImage[a.idPos].setVisible(!1)},hideAllEffectElement:function(){this.effectWin&&
this.effectWin.stopAnimationWin();for(var a=0;a<this.listEffectImage.length;a++)this.listEffectImage[a]&&this.listEffectImage[a].setVisible(!1);this.compoEffectNode.hideAllEffectReel()},setDataTurning:function(a){this.compoEffectNode.addReelData(a,1,[MGXTHComboEffect.TYPE_SCATTER,MGXTHComboEffect.TYPE_BONUS])},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoEffectNode&&this.compoEffectNode.setDispose();this.timeOutEffectBigWin&&clearTimeout(this.timeOutEffectBigWin);this.timeOutEffectBonusBox&&
clearTimeout(this.timeOutEffectBonusBox)}});MGXTHComboEffect.NAME_EFFECT={1:"chengho",3:"columbus",4:"magellan",6:"nikitin",9:"wild",11:"scatter",12:"bonus"};MGXTHComboEffect.TYPE_SCATTER=11;MGXTHComboEffect.TYPE_BONUS=12;MGXTHComboEffect.INDEX_IMAGE=20;MGXTHComboEffect.INDEX_BIG_WIN=40;var MGXTHMiniGame=MGBaseNode.extend({listImage:null,mainGame:null,coinWin:null,countAuto:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.listImage=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initFromCocostudio(ResourceManager.MGResourcesGameXengThamHiem.MGUICompoMiniGame,PreLoaderConfig.PathToResourceDefault);this.initComboImage();this.hideAllImage()},initComboImage:function(){for(var a=null,b=0;15>b;b++)a=this._mainLayer.getChildByName("Image_"+
b),a.setTouchEnabled(!0),a.typeImage=b,a.isClick=0,a.addClickEventListener(this.onClickRuong.bind(this)),this.listImage.push(a)},onClickRuong:function(a){mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Click,MGGameInfo.gameVolume,!1);this.mainGame.netSend.sendPosMiniGame(a.typeImage);a.isClick=1;this.disEnableAllImage();a.runAction(cc.sequence(cc.fadeOut(1.7),cc.fadeIn(0),cc.callFunc(this.loadImageResult.bind(this,a))))},loadImageResult:function(a){0==
this.coinWin?(this.loadRuongFail(a),mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_RuongTrat,MGGameInfo.gameVolume,!1)):(this.loadRuongVang(a),a.getChildByName("TextCoin").setVisible(!0),a.getChildByName("TextCoin").setString(Utilities.Coin(this.coinWin)),mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_RuongTrung,MGGameInfo.gameVolume,!1))},loadRuongNormal:function(a){a.loadTexture(MGXTHMiniGame.LIST_IMAGE[0],ccui.Widget.PLIST_TEXTURE)},loadRuongVang:function(a){a.loadTexture(MGXTHMiniGame.LIST_IMAGE[1],
ccui.Widget.PLIST_TEXTURE)},loadRuongFail:function(a){a.loadTexture(MGXTHMiniGame.LIST_IMAGE[2],ccui.Widget.PLIST_TEXTURE)},setResultMiniGame:function(a){this.coinWin=a.CoinWinMiniGame},disEnableAllImage:function(){for(var a=0;a<this.listImage.length;a++)this.listImage[a].setTouchEnabled(!1)},hideAllImage:function(){mg.audio.stopMusic(!0);for(var a=0;a<this.listImage.length;a++)this.listImage[a].isClick=0,this.listImage[a].setVisible(!1),this.listImage[a].getChildByName("TextCoin").setVisible(!1),
this.loadRuongNormal(this.listImage[a])},showAllImage:function(){for(var a=0,b=0;b<this.listImage.length;b++)this.listImage[b].setVisible(!0),0==this.listImage[b].isClick&&(this.listImage[b].setTouchEnabled(!0),a++);15===a&&mg.audio.playMusic(ResourceManager.MGResourcesGameXengThamHiem.XTH_SoundMiniGame,MGGameInfo.gameVolume,!0)},autoMiniGame:function(a){this.countAuto++;if(this.countAuto<a.ListId.length){this.disEnableAllImage();for(var b=0;b<this.listImage.length;b++)this.listImage[b].typeImage==
a.ListId[this.countAuto]&&(this.coinWin=a.ListCoinWin[this.countAuto],this.listImage[b].runAction(cc.sequence(cc.fadeOut(2),cc.fadeIn(0),cc.callFunc(this.loadImageResult.bind(this,this.listImage[b])),cc.callFunc(this.autoMiniGame.bind(this,a)))))}},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);mg.audio.stopMusic(!0)}});MGXTHMiniGame.LIST_IMAGE={0:"imageRuong_Block.png",1:"imageRuong_Gold.png",2:"imageRuong_Fail.png"};var MGXengThamHiem=MGBaseGame.extend({netsend:null,layerPopup:null,comboElement:null,comboButton:null,comboText:null,comboLine:null,comboEffect:null,layerMiniGame:null,betCuoc:null,listCoinCanBet:null,coinUser:null,timeTurning:null,isAutoSpin:null,isSpin:null,isFreeTurning:null,isMiniGame:!1,gameStatus:null,textFree:null,goldWin:null,comboEffectItem:null,countScatter:null,countBonus:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesXengThamHiem},initObj:function(){MGBaseGame.prototype.initObj.call(this);
this.netSend=new MGNetSendXengThamHiem;this._initFromCocostudio(ResourceManager.MGResourcesGameXengThamHiem.MGUILayerXengThamHiem,PreLoaderConfig.PathToResourceDefault);this.initComboEffectItem();this.initComboElement();this.initComboButton();this.initComboText();this.initComboLine();this.initComboEffect();this.initTextFreeSpin();this.initLayerPopup();this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.SOUND_WELCOME)}.bind(this),.2)},initLayerPopup:function(){this.layerPopup=
new MGXTHLayerPopup;this.layerPopup.cloneFromNode(this._mainLayer.getChildByName("NodeLayerPopupTH"));this.layerPopup.initObj();this.addChild(this.layerPopup,MGXengThamHiem.INDEX_POPUP)},initComboEffectItem:function(){this.comboEffectItem=new MGXTHComboEffectItem;this.comboEffectItem.initObj(this);this.addChild(this.comboEffectItem)},initComboElement:function(){this.comboElement=new MGXTHComboElement;this.comboElement.cloneFromNode(this._mainLayer.getChildByName("MGScrollItem"));this.comboElement.initObj(this);
this.addChild(this.comboElement)},initComboButton:function(){this.comboButton=new MGXTHComboButton;this.comboButton.cloneFromNode(this._mainLayer.getChildByName("MGComboButtonTH"));this.comboButton.initObj(this);this.comboButton.hideButtonSpin();this.addChild(this.comboButton)},initComboText:function(){this.comboText=new MGXTHComboText;this.comboText.cloneFromNode(this._mainLayer.getChildByName("MGComboTextTH"));this.comboText.initObj(this);this.addChild(this.comboText)},initComboLine:function(){this.comboLine=
this._mainLayer.getChildByName("NodeComboLine");this.comboLine.removeFromParent(!0);this.addChild(this.comboLine)},initMiniGame:function(){this.layerMiniGame=new MGXTHMiniGame;this.layerMiniGame.setVisible(!0);this.layerMiniGame.initObj(this);this.addChild(this.layerMiniGame)},initComboEffect:function(){this.comboEffect=new MGXTHComboEffect;this.comboEffect.initObj(this);this.addChild(this.comboEffect,MGXengThamHiem.INDEX_EFFECT)},initTextFreeSpin:function(){this.textFree=this._mainLayer.getChildByName("MGTextFreeSpin");
this.textFree.removeFromParent(!0);this.addChild(this.textFree,MGXengThamHiem.INDEX_EFFECT+10)},_changeBackGroundXTH:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameXengThamHiem.BackGroundHDXTH;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)}},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.GameData.toString(),
this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.TotalGoldBonus.toString(),this.ngTotalGoldBonus.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.Turning.toString(),this.ngTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.BetGameMini.toString(),
this.ngBetGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.ResultGameMini.toString(),this.ngResultGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.TopBigWin.toString(),this.ngTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.BigWin.toString(),this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.WinBonusBox.toString(),
this.ngWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGTHAMHIEM.AutoPlayMiniGame.toString(),this.ngAutoPlayMiniGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGXTHContainElement.EVENTS.FINISH_SPIN.toString(),this.ngFinishSpin.bind(this)))},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListBet:b.Array8,ListBet_Type:b.UInt8,MaxCoin:b.UInt64,MinCoin:b.UInt64,
MatchID:b.UInt32,CoinUser:b.UInt64,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.comboText.setTextMatchID(a.MatchID);this.coinUser=a.CoinUser;this.comboText.setTextTongTien(a.CoinUser);this.listCoinCanBet=a.ListCoinCanBet;this.comboText.setTextTongCuoc(this.listCoinCanBet[0]);this.isAutoSpin=this.isFreeTurning=!1;this._changeBackGroundXTH()},ngTotalGoldBonus:function(a){a=a.getUserData();var b={TotalCoinBonusBox:BinaryConstants.DataTypeID.UInt64};
a=(new BinaryParser).initObj(b,a.content);this.comboText.setTextNoHu(a.TotalCoinBonusBox)},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.gameStatus=0;this.isSpin=!1;this.comboText.setTextTongTien(a.Coin);this.comboText.setTextNoHu(a.TotalCoinBonusBox);this.comboText.setTextFreeTurning();this.comboButton.showWhenSpinDone();0==this.isFreeTurning&&this.comboButton.showButtonSpin();
this.comboElement.showAllColumn();this.layerMiniGame&&this.layerMiniGame.hideAllImage();this.isAutoSpin&&this.netSend.sendBetSpin(this.betCuoc)},ngTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,CoinWinBet:b.UInt64,ScatterLines:b.UInt8,NumRoundFree:b.UInt8,InfoWin:b.Array8,InfoWin_Type:b.Object8,InfoWin_Type_Struct:{Index:b.UInt32,IconWin:b.UInt32},MatchID:b.UInt64,BetCoin:b.UInt64,BonusLines:b.UInt8};a=(new BinaryParser).initObj(b,
a.content);Utilities.showLog("---ngTurning : "+JSON.stringify(a));this.gameStatus=1;this.isSpin=!0;this.goldWin=a.CoinWinBet;this.coinUser=MGGameInfo.myInfo.Gold;this.comboText.setTextWhenSpin(this.coinUser,a.MatchID,a.CoinWinBet,a.NumRoundFree);this.isMiniGame=!0;this.comboEffect.setDataTurning(a.ArrIcon);this.comboElement.showAllColumn();this.comboElement.setComboElement(a.ArrIcon);this.comboElement.setLineWin(a.InfoWin);this.comboButton.hideWhenSpin();this.timeTurning=new Date;this.countBonus=
a.BonusLines;this.countScatter=a.ScatterLines;this.layerPopup.popupLichSu.setContainLichSu(a.MatchID,this.timeTurning,a.BetCoin,a.InfoWin,a.CoinWinBet);mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengThamHiem.XTH_Quay,MGGameInfo.gameVolume,!1)},ngBetGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={BetMoney:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngBetGameMini : "+JSON.stringify(a));this.isMiniGame=
!0;this.comboElement.hideAllColumn();this.layerMiniGame||this.initMiniGame();this.layerMiniGame.showAllImage();this.comboText.setCoinWin(a.BetMoney);this.comboText.setTextTienThang()},ngResultGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={RandomNumber:b.UInt16,CoinWin:b.UInt64,CoinWinMiniGame:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("---ngResultGameMini : "+JSON.stringify(a));this.layerMiniGame.setResultMiniGame(a)},ngTopBigWin:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);this.layerPopup.popupThangLon.getListDataThangLon(a.dataBigWin)},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,
EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this.layerPopup.popupThangLon.getDataThangLon(a);this.comboEffect.playEffectBigWin(a.EarnCoin,a.UserID)},ngWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);this.comboEffect.playEffectBonusBox(a.EarnCoin)},ngAutoPlayMiniGame:function(a){a=a.getUserData();
var b=BinaryConstants.DataTypeID,b={ListCoinWin:b.Array8,ListCoinWin_Type:b.UInt64,ListId:b.Array8,ListId_Type:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this.layerMiniGame.countAuto=-1;this.layerMiniGame.autoMiniGame(a)},ngFinishSpin:function(){this.comboText.setTextTienThang();this.comboButton.showWhenSpinDone();this.layerPopup.popupLichSu.addContainLichSu();2<this.countScatter&&this.comboEffect.playWinScatter();2<this.countBonus&&this.comboEffect.playWinBonus();!this.isAutoSpin&&3>this.countScatter&&
3>this.countBonus&&this.comboElement.showEffectEndMatch()},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);mg.audio.stopAllEffects();mg.audio.stopMusic(!0);this.comboButton&&(this.comboButton.setDispose(),this.comboButton=null);this.comboElement&&(this.comboElement.setDispose(),this.comboElement=null);this.comboEffect&&(this.comboEffect.setDispose(),this.comboEffect=null)}});MGXengThamHiem.INDEX_EFFECT=10;MGXengThamHiem.INDEX_POPUP=20;ResourceManager.MGResourcesGameXengAladin={XengAladinAtlas:"res/game/xengAladin/Atlas/atlasXengAladin.plist",XengAladinPng:"res/game/xengAladin/Atlas/atlasXengAladin.png",UIMGUIXengAladinLayer:"res/game/xengAladin/UIXengAladinLayer.json",UIMGUIXengAladinTutorial:"res/game/xengAladin/MGXALDTutorial.json",UIMGUIXengAladinTopBigWin:"res/game/xengAladin/MGXALDTopBigWin.json",UIMGUIXengAladinBigWinItem:"res/game/xengAladin/MGXALDItemBigWin.json",UIMGUIXengAladinHistory:"res/game/xengAladin/MGXALDHistory.json",
UIMGUIXengAladinFreeSpin:"res/game/xengAladin/MGXALDFreeSpin.json",UIMGUIXengAladinNotification:"res/game/xengAladin/MGXALDNotification.json",XengAladinItemAtlas:"res/game/xengAladin/Atlas/atlasXengAladinItem.plist",XengAladinItemPng:"res/game/xengAladin/Atlas/atlasXengAladinItem.png",FontXPNG:"res/Fonts/Number-export.png",FontX:"res/Fonts/Number-export.fnt",FontBigWinXPNG:"res/Fonts/fontWin.png",FontBigWinX:"res/Fonts/fontWin.fnt",SpineNo_Hu_PNG:"res/Effects/NoHu_FX.png",SpineNo_Hu_JSON:"res/Effects/NoHu_FX.json",
SpineNo_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",FontfontNoHuPNG:"res/Fonts/fontNoHu.png",FontfontNoHu:"res/Fonts/fontNoHu.fnt",SpineNo_ThangLon_PNG:"res/Effects/big_win.png",SpineNo_ThangLon_JSON:"res/Effects/big_win.json",SpineNo_ThangLon_ATLAS:"res/Effects/big_win.atlas",XAL_Sound_Click:"res/game/xengAladin/sounds/click.mp3",XAL_Sound_Click_Spin:"res/game/xengAladin/sounds/ClickQuay.mp3",XAL_Sound_Spin:"res/game/xengAladin/sounds/Quay.mp3",XAL_Sound_BigWin:"res/game/xengAladin/sounds/BigWin.mp3",XAL_Sound_Win1:"res/game/xengAladin/sounds/Win1.mp3",
XAL_Sound_Win2:"res/game/xengAladin/sounds/Win2.mp3",XAL_Sound_Win3:"res/game/xengAladin/sounds/Win3.mp3",XAL_Sound_MiniGame:"res/game/xengAladin/Sounds/XengAladinBackgroundMusic.mp3",XAL_Sound_Bonus:"res/game/xengAladin/Sounds/TrungBonus.mp3",XAL_Sound_FreeSpin:"res/game/xengAladin/Sounds/TrungFreeSpin.mp3",MGBackGroundAL:"res/game/xengAladin/BGXengALD.jpg",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3",Spine_Effect_0_PNG:"res/game/xengAladin/spine/aladin.png",Spine_Effect_1_PNG:"res/game/xengAladin/spine/aladin2.png",
Spine_Effect_JSON:"res/game/xengAladin/spine/aladin.json",Spine_Effect_ATLAS:"res/game/xengAladin/spine/aladin.atlas"};
ResourceManager.MGResourcesGameXengAladinPreloadMobile={XengAladinAtlas:"res/game/xengAladin/Atlas/atlasXengAladin.plist",XengAladinPng:"res/game/xengAladin/Atlas/atlasXengAladin.png",UIMGUIXengAladinLayer:"res/game/xengAladin/UIXengAladinLayer.json",UIMGUIXengAladinTutorial:"res/game/xengAladin/MGXALDTutorial.json",UIMGUIXengAladinTopBigWin:"res/game/xengAladin/MGXALDTopBigWin.json",UIMGUIXengAladinBigWinItem:"res/game/xengAladin/MGXALDItemBigWin.json",UIMGUIXengAladinHistory:"res/game/xengAladin/MGXALDHistory.json",
UIMGUIXengAladinFreeSpin:"res/game/xengAladin/MGXALDFreeSpin.json",UIMGUIXengAladinNotification:"res/game/xengAladin/MGXALDNotification.json",XengAladinItemAtlas:"res/game/xengAladin/Atlas/atlasXengAladinItem.plist",XengAladinItemPng:"res/game/xengAladin/Atlas/atlasXengAladinItem.png",FontXPNG:"res/Fonts/Number-export.png",FontX:"res/Fonts/Number-export.fnt",FontBigWinXPNG:"res/Fonts/fontWin.png",FontBigWinX:"res/Fonts/fontWin.fnt",SpineNo_Hu_PNG:"res/Effects/NoHu_FX.png",SpineNo_Hu_JSON:"res/Effects/NoHu_FX.json",
SpineNo_Hu_ATLAS:"res/Effects/NoHu_FX.atlas",FontfontNoHuPNG:"res/Fonts/fontNoHu.png",FontfontNoHu:"res/Fonts/fontNoHu.fnt",SpineNo_ThangLon_PNG:"res/Effects/big_win.png",SpineNo_ThangLon_JSON:"res/Effects/big_win.json",SpineNo_ThangLon_ATLAS:"res/Effects/big_win.atlas",XAL_Sound_Click:"res/game/xengAladin/sounds/click.mp3",XAL_Sound_Click_Spin:"res/game/xengAladin/sounds/ClickQuay.mp3",XAL_Sound_Spin:"res/game/xengAladin/sounds/Quay.mp3",XAL_Sound_BigWin:"res/game/xengAladin/sounds/BigWin.mp3",XAL_Sound_Win1:"res/game/xengAladin/sounds/Win1.mp3",
XAL_Sound_Win2:"res/game/xengAladin/sounds/Win2.mp3",XAL_Sound_Win3:"res/game/xengAladin/sounds/Win3.mp3",XAL_Sound_MiniGame:"res/game/xengAladin/Sounds/XengAladinBackgroundMusic.mp3",XAL_Sound_Bonus:"res/game/xengAladin/Sounds/TrungBonus.mp3",XAL_Sound_FreeSpin:"res/game/xengAladin/Sounds/TrungFreeSpin.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3",Spine_Effect_0_PNG:"res/game/xengAladin/spine/aladin.png",Spine_Effect_1_PNG:"res/game/xengAladin/spine/aladin2.png",Spine_Effect_JSON:"res/game/xengAladin/spine/aladin.json",
Spine_Effect_ATLAS:"res/game/xengAladin/spine/aladin.atlas"};var resourcesXengAladin=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengAladinPreloadMobile)ResourceManager.MGResourcesGameXengAladinPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAladinPreloadMobile[i],resourcesXengAladin.push(ResourceManager.MGResourcesGameXengAladinPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengAladin)ResourceManager.MGResourcesGameXengAladin[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAladin[i]}else for(i in ResourceManager.MGResourcesGameXengAladin)ResourceManager.MGResourcesGameXengAladin[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAladin[i],resourcesXengAladin.push(ResourceManager.MGResourcesGameXengAladin[i]);ConstantsVariable.NETWORK_XENG_ALADIN={ListUser:3300,GameData:3301,StartGame:3302,UpdateJackPot:3303,TopWinBonusBox:3304,TopBigWin:3305,Turning:3306,StartMini:3307,UserChoiceMiniGame:3308,ResultGameMini:3309,UserLeftDesk:3310,ToolResult:3311,WinBonusBox:3312,BigWin:3313,AutoTurning:3315};var MGNetSendXALD=cc.Class.extend({gameModuleID:null,maiGame:null,ctor:function(a){this.maiGame=a},spinMiniGame:function(){Utilities.showLog("spinMiniGame: ");this.maiGame.stopAllEffect();var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_VANPHUC.FortuneWheel.toString(),null,null);MGNetCore.MGSocket.sendMsg(a)},spin:function(a){Utilities.showLog("spin: "+a);this.maiGame.stopAllEffect();var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_ALADIN.Turning.toString(),
{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},choseChestGold:function(){Utilities.showLog("Play Mini Game: ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_ALADIN.UserChoiceMiniGame.toString(),null,null);MGNetCore.MGSocket.sendMsg(a)},autoSpin:function(a){Utilities.showLog("spin: "+a);this.maiGame.stopAllEffect();var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_ALADIN.AutoTurning.toString(),
{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendToolAladin:function(a){Utilities.showLog("ToolResult");var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENG_ALADIN.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXALDItem=MGBaseNode.extend({image:null,itemName:null,imageEffect:null,originY:0,isFreeSpin:!0,isEndSpin:!1,ItemID:0,row:0,col:0,spine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this.image=new cc.Sprite;this.addChild(this.image);this.imageEffect=new cc.Sprite;this.imageEffect.setSpriteFrame("khung2.png");this.addChild(this.imageEffect);this.isFreeSpin=!0},createRanDom:function(){var a=parseInt(13*Math.random())+1;this.ItemID=a;this.itemName=a="Item"+a+".png";this.image.setSpriteFrame(a);
this.setScale(1);this.imageEffect.setVisible(!1)},createItemWin:function(a){var b="Item"+a+".png";this.itemName=b;this.image.setSpriteFrame(b);this.ItemID=a},stopEffect:function(){this.imageEffect.stopAllActions();this.imageEffect.setVisible(!1);this.setScale(1);this.spine&&this.spine.setVisible(!1);this.image.setVisible(!0)},showLineWin:function(){this.imageEffect.setOpacity(255);this.imageEffect.setVisible(!1)},hideBoder:function(){this.imageEffect.setVisible(!1)},playEffect:function(){if(2!=this.ItemID){if(8==
this.ItemID||3==this.ItemID||10==this.ItemID||6==this.ItemID||5==this.ItemID||9==this.ItemID||4==this.ItemID)switch(null==this.spine&&(this.spine=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAladin.Spine_Effect_JSON,ResourceManager.MGResourcesGameXengAladin.Spine_Effect_ATLAS),this.addChild(this.spine)),this.spine.setVisible(!0),this.image.setVisible(!1),this.ItemID){case 8:this.spine.setAnimation(0,"cup",!1);break;case 3:this.spine.setAnimation(0,"fr_spin",!1);break;case 10:this.spine.setAnimation(0,
"giay",!1);break;case 6:this.spine.setAnimation(0,"nhan",!1);break;case 5:this.spine.setAnimation(0,"thden_icon",!1);break;case 9:this.spine.setAnimation(0,"tham",!1);break;case 4:this.spine.setAnimation(0,"scatter",!1)}else this.imageEffect.runAction(cc.sequence(cc.fadeOut(.3),cc.fadeIn(.3)).repeat(3));this.imageEffect.stopAllActions();this.imageEffect.setOpacity(255);this.imageEffect.setVisible(!1)}},playEffectOnReel:function(){if(3==this.ItemID||4==this.ItemID)switch(null==this.spine&&(this.spine=
new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAladin.Spine_Effect_JSON,ResourceManager.MGResourcesGameXengAladin.Spine_Effect_ATLAS),this.addChild(this.spine)),this.spine.setVisible(!0),this.image.setVisible(!1),this.ItemID){case 3:this.spine.setAnimation(0,"fr_spin",!1);break;case 4:this.spine.setAnimation(0,"scatter",!1)}}});var MGXALDCompoButtons=MGBaseNode.extend({_listButton:null,mainGame:null,_benginTouch:!1,_count:0,_canSpin:!0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this._benginTouch=!1;this._count=0;this._canSpin=!0},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),
this._listButton.push(a[d]));this.scheduleUpdate()},update:function(a){this._benginTouch&&(this._count+=a,.5<=this._count&&(this._count=0,this._benginTouch=this._canSpin=!1,this.getChildByName(MGXALDCompoButtons.BUTTON_NAME.SPIN).setVisible(!1),this.mainGame.isAutoSpin=!0,this.getChildByName(MGXALDCompoButtons.BUTTON_NAME.STOP).setVisible(!0),this.hideButtonSpin(),0==this.mainGame.gameStatust&&this.mainGame.netSend.spin(this.mainGame.getBetGold())))},hideWhenSpin:function(){this.hideButton(MGXALDCompoButtons.BUTTON_NAME.BET_UP);
this.hideButton(MGXALDCompoButtons.BUTTON_NAME.BET_DOWN);this.hideButton(MGXALDCompoButtons.BUTTON_NAME.MAX_BET)},showWhenSpinDone:function(){this.showButton(MGXALDCompoButtons.BUTTON_NAME.BET_UP);this.showButton(MGXALDCompoButtons.BUTTON_NAME.BET_DOWN);this.showButton(MGXALDCompoButtons.BUTTON_NAME.MAX_BET);this.showButton(MGXALDCompoButtons.BUTTON_NAME.SPIN)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},showButton:function(a){cc.sys.isNative||
this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},stopAutoSpin:function(){this.getChildByName(MGXALDCompoButtons.BUTTON_NAME.SPIN).setVisible(!0);this.mainGame.isAutoSpin=!1;this.getChildByName(MGXALDCompoButtons.BUTTON_NAME.STOP).setVisible(!1);this.showButton(MGXALDCompoButtons.BUTTON_NAME.SPIN);this._canSpin=!0},onClickBtnFromCocostudio:function(a,b){0==b&&(Utilities.showLog(a.getName()),a.getName()==MGXALDCompoButtons.BUTTON_NAME.SPIN?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click_Spin,
MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,MGGameInfo.gameVolume));switch(a.getName()){case MGXALDCompoButtons.BUTTON_NAME.SPIN:switch(b){case 0:this._benginTouch=!0;this._count=0;break;case 1:this._benginTouch=!0;break;case 2:this._count=0;this._benginTouch=!1;this._canSpin&&this.mainGame.netSend.spin(this.mainGame.getBetGold());break;case 3:this._count=0,this._benginTouch=!1}break;case MGXALDCompoButtons.BUTTON_NAME.INFO:0==b&&this.mainGame.showTutorialLayer();
break;case MGXALDCompoButtons.BUTTON_NAME.BET_DOWN:if(0==b)this.mainGame.onClickDown();break;case MGXALDCompoButtons.BUTTON_NAME.BET_UP:if(0==b)this.mainGame.onClickUp();break;case MGXALDCompoButtons.BUTTON_NAME.MAX_BET:if(0==b)this.mainGame.onMaxBetClick();break;case MGXALDCompoButtons.BUTTON_NAME.THANG_LON:0==b&&this.mainGame.popupThangLon.showPopup();break;case MGXALDCompoButtons.BUTTON_NAME.THONG_BAO:0==b&&this.mainGame.popupThongBao.showPopup();break;case MGXALDCompoButtons.BUTTON_NAME.LICH_SU:0==
b&&this.mainGame.popupLichSu.showPopup();break;case MGXALDCompoButtons.BUTTON_NAME.STOP:0==b&&this.stopAutoSpin()}},showButtonSpin:function(){this.showButton(MGXALDCompoButtons.BUTTON_NAME.SPIN);this._canSpin=!0},hideButtonSpin:function(){this.hideButton(MGXALDCompoButtons.BUTTON_NAME.SPIN)},hideAll:function(){for(var a=0;a<this._listButton.length;a++)cc.sys.isNative||this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)}});
MGXALDCompoButtons.BUTTON_NAME={SPIN:"Button_Spin",STOP:"Button_Stop",MAX_BET:"Button_BetMax",BET_UP:"Button_BetUp",BET_DOWN:"Button_BetDown",INFO:"Button_Info",THANG_LON:"Button_ThangLon",THONG_BAO:"Button_ThongBao",LICH_SU:"Button_LichSu"};var MGXALDColumn=MGBaseNode.extend({listItem:null,isFinish:!1,isPreFinis:!1,isDownSpeed:!1,vY:0,canSpin:!1,index:0,dataSpin:null,mainGame:null,isDone:!1,spinDone:!1,_moreTime:0,ctor:function(a,b){MGBaseNode.prototype.ctor.call(this);this.listItem=[];this.dataSpin=[];this.mainGame=a;for(var d=0;4>d;d++){var e=new MGXALDItem;e.row=3-d;e.col=b;e.createRanDom();e.setPosition(cc.p(0,MGXALDColumn.ITEM_HEIGHT*d));e.originY=MGXALDColumn.ITEM_HEIGHT*d;this.addChild(e);this.listItem.push(e)}this.vY=60;this.scheduleUpdate()},
beginSpin:function(a,b,d){for(this._moreTime=d;0<this.dataSpin.length;)this.dataSpin.pop();for(d=0;4>d;d++)this.listItem[d].setVisible(!0);this.spinDone=this.isDone=!1;this.dataSpin.length=0;this.dataSpin=b;this.runAction(cc.sequence(cc.delayTime(.3*a),cc.callFunc(function(){this.spin()}.bind(this))))},spin:function(){this.canSpin=!0;this.isDownSpeed=this.isPreFinis=this.isFinish=!1;for(var a=0;4>a;a++)this.listItem[a].isEndSpin=!1,this.listItem[a].isFreeSpin=!0,this.listItem[a].setVisible(!0),this.isPreFinis=
!1;this.vY=-8;this.stopAllActions();this.runAction(cc.sequence(cc.delayTime(1.5+this._moreTime),cc.callFunc(function(){this.isDownSpeed=!0}.bind(this)),cc.delayTime(.5),cc.callFunc(function(){this.isPreFinis=!0}.bind(this))))},update:function(a){if(this.canSpin)for(this.isDownSpeed?5<this.vY&&(this.vY-=.7):(0>this.vY?this.vY+=1:0<=this.vY&&(this.vY+=2),60<=this.vY&&(this.vY=60)),a=0;4>a;a++)if(0==this.listItem[a].isEndSpin&&this.listItem[a].setPositionY(this.listItem[a].getPositionY()-this.vY),0==
this.listItem[a].isFreeSpin){if(this.listItem[a].getPositionY()<=this.listItem[a].originY-10){this.listItem[a].setPositionY(this.listItem[a].originY-10);this.listItem[a].isEndSpin=!0;this.listItem[a].runAction(cc.moveTo(.1,cc.p(this.listItem[a].getPositionX(),this.listItem[a].originY-3)));if(!this.spinDone){this.spinDone=!0;Utilities.showLog("SPIN END COLUMN "+this.index);var b={};b.Index=this.index;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,b)}4!=this.index||this.isDone||
(this.isDone=!0,Utilities.showLog("SPIN END"),this.mainGame.finishSpin())}}else this.listItem[a].getPositionY()<-MGXALDColumn.ITEM_HEIGHT&&(this.listItem[a].setPositionY(3*MGXALDColumn.ITEM_HEIGHT),this.isPreFinis&&0==a&&(this.isFinish=!0),this.isFinish?(3>a&&this.listItem[a].createItemWin(this.dataSpin[2-a]),this.listItem[a].isFreeSpin=!1):this.listItem[a].createRanDom())},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);for(this.unscheduleUpdate();0<this.listItem.length;)this.listItem.pop();
this.listItem.length=0}});MGXALDColumn.ITEM_WITH=190;MGXALDColumn.ITEM_HEIGHT=170;MGXALDColumn.COLUMN_WITH=190;var MGXALDScrollLayer=MGBaseNode.extend({mainGame:null,listColumn:null,panel:null,panelSizeX:960,listItemResult:null,listLineEffect:null,dataEffect:null,currentLine:0,totalLine:0,intervalEffect:null,timeOut:null,countFreeChest:0,listChest:null,listItemMagic:null,compoEffectNode:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.listColumn=[];this.panel=this.mainGame._mainLayer.getChildByName("MGSCrollLayer");this.listItemResult=[];this.listLineEffect=[];this.dataEffect=
[];for(a=0;5>a;a++){var b=new MGXALDColumn(this.mainGame,a);b.index=a;this.listColumn.push(b);this.panel.addChild(b);this.listItemResult.push(b.listItem[2]);this.listItemResult.push(b.listItem[1]);this.listItemResult.push(b.listItem[0])}this.listColumn[0].setPosition(cc.p(this.panelSizeX/2-2*MGXALDColumn.COLUMN_WITH,88));this.listColumn[1].setPosition(cc.p(this.panelSizeX/2-1*MGXALDColumn.COLUMN_WITH,88));this.listColumn[2].setPosition(cc.p(this.panelSizeX/2,86));this.listColumn[3].setPosition(cc.p(this.panelSizeX/
2+1*MGXALDColumn.COLUMN_WITH,88));this.listColumn[4].setPosition(cc.p(this.panelSizeX/2+2*MGXALDColumn.COLUMN_WITH,88));this.initLineEffect();this.listChest=[];this.listItemMagic=[];for(a=0;5>a;a++)b=new MGXALDMagiceffect(this.mainGame,a),this.addChild(b),this.listItemMagic.push(b);this.compoEffectNode=new MGCompoEffectNode;b=this.mainGame._mainLayer.getChildByName("MGCompoItemEffect");b.addChild(this.compoEffectNode);this.compoEffectNode.setCallbackOnPlayEffectReel(this.onPlayReelEffect.bind(this));
for(a=0;a<this.listItemResult.length;a++){var d="Item"+(a+1);this.compoEffectNode.addEffectItem(cc.size(230,230),b.getChildByName(d).getPosition())}for(a=1;5>=a;a++)d="MGEffectReel"+a,this.compoEffectNode.addEffectReel(cc.size(250,520),b.getChildByName(d).getPosition())},initLineEffect:function(){this.listLineEffect[0]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13]];this.listLineEffect[1]=[this.listItemResult[0],this.listItemResult[3],
this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLineEffect[2]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLineEffect[3]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[12]];this.listLineEffect[4]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14]];this.listLineEffect[5]=
[this.listItemResult[1],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[13]];this.listLineEffect[6]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[13]];this.listLineEffect[7]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[14]];this.listLineEffect[8]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],
this.listItemResult[12]];this.listLineEffect[9]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],this.listItemResult[13]];this.listLineEffect[10]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[13]];this.listLineEffect[11]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[12]];this.listLineEffect[12]=[this.listItemResult[2],this.listItemResult[4],
this.listItemResult[7],this.listItemResult[10],this.listItemResult[14]];this.listLineEffect[13]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[12]];this.listLineEffect[14]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[14]];this.listLineEffect[15]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[13]];
this.listLineEffect[16]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[13]];this.listLineEffect[17]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[9],this.listItemResult[12]];this.listLineEffect[18]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[11],this.listItemResult[14]];this.listLineEffect[19]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[8],
this.listItemResult[11],this.listItemResult[12]];this.listLineEffect[20]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14]];this.listLineEffect[21]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[6],this.listItemResult[11],this.listItemResult[13]];this.listLineEffect[22]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[8],this.listItemResult[9],this.listItemResult[13]];this.listLineEffect[23]=[this.listItemResult[0],
this.listItemResult[5],this.listItemResult[6],this.listItemResult[11],this.listItemResult[12]];this.listLineEffect[24]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[8],this.listItemResult[9],this.listItemResult[14]];this.listLineEffect[25]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[12]];this.listLineEffect[26]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],this.listItemResult[14]];
this.listLineEffect[27]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[7],this.listItemResult[11],this.listItemResult[12]];this.listLineEffect[28]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[7],this.listItemResult[9],this.listItemResult[14]];this.listLineEffect[29]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLineEffect[30]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],
this.listItemResult[11],this.listItemResult[13]];this.listLineEffect[31]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLineEffect[32]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLineEffect[33]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[8],this.listItemResult[10],this.listItemResult[14]];this.listLineEffect[34]=
[this.listItemResult[1],this.listItemResult[5],this.listItemResult[6],this.listItemResult[10],this.listItemResult[12]];this.listLineEffect[35]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14]];this.listLineEffect[36]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[12]];this.listLineEffect[37]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[8],this.listItemResult[9],
this.listItemResult[12]];this.listLineEffect[38]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[10],this.listItemResult[14]];this.listLineEffect[39]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[10],this.listItemResult[12]];this.listLineEffect[40]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLineEffect[41]=[this.listItemResult[0],
this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLineEffect[42]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[12]];this.listLineEffect[43]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14]];this.listLineEffect[44]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[7],this.listItemResult[9],this.listItemResult[13]];
this.listLineEffect[45]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[7],this.listItemResult[11],this.listItemResult[13]];this.listLineEffect[46]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLineEffect[47]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLineEffect[48]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[7],
this.listItemResult[10],this.listItemResult[13]];this.listLineEffect[49]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13]]},playEffect:function(){this.currentLine=0;this.totalLine=this.dataEffect.length;this.timeOut&&clearTimeout(this.timeOut);this.timeOut=setTimeout(function(){this.showMagicItem();this.playEffectAllLine()}.bind(this),500);this.intervalEffect&&clearInterval(this.intervalEffect);this.intervalEffect=setInterval(this.showNextEffect.bind(this),
3E3)},playEffectLine:function(a,b){a--;this.playSound();for(var d=0;5>d;d++){var e=this.listLineEffect[a][d];e.stopAllActions();e.setScale(1);e.ItemID==b?(11!=e.ItemID&&12!=e.ItemID&&13!=e.ItemID&&1!=e.ItemID&&7!=e.ItemID||e.runAction(cc.sequence(cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.3,1,1)).repeat(3)),this._playEffectItem(e,b)):e.showLineWin();this.compoEffectNode.showEffectItem(3*e.col+e.row-1,2)}},playSound:function(){var a=parseInt(3*Math.random())+1;1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win1,
MGGameInfo.gameVolume):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win2,MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win3,MGGameInfo.gameVolume)},playEffectAllLine:function(){0<this.mainGame.coinWin&&(this.playSound(),this.mainGame.effectWin||this.mainGame.initEffectWin(),this.mainGame.effectWin.playAnimationWin(this.mainGame.coinWin));for(var a=0;a<this.dataEffect.length;a++)this.playEffectLine(this.dataEffect[a].LineID,
0)},clearChests:function(){for(var a=0;a<this.listChest.length;a++)this.listChest[a]&&this.listChest[a].removeFromParent(!0);for(;0<this.listChest.length;)this.listChest.pop();this.listChest.length=0},showDataFreeSpin:function(){this.clearChests();for(var a=0;a<this.listItemResult.length;a++){var b=this.listItemResult[a];if(4==b.ItemID){var d=new ccui.Button("Item4.png","","",ccui.Widget.PLIST_TEXTURE),b=b.getParent().convertToWorldSpace(b.getPosition());cc.sys.isNative?d.setPosition(cc.p(b.x,b.y)):
d.setPosition(cc.p(b.x,b.y-170-32));this.listChest.push(d);d.addTouchEventListener(function(a,b){0!=b&&2==b&&(this.mainGame.netSend.choseChestGold(),this.mainGame.itemChess=a,this.mainGame.isAutoMiniGame=!1)}.bind(this));this.mainGame.addChild(d)}}},auotOpenMiniGame:function(){0>=this.listChest.length&&(this.mainGame.buttonReward.setVisible(!1),this.showDataFreeSpin());0<this.listChest.length&&(this.mainGame.itemChess=this.listChest[0])},showMagicItem:function(){for(var a=0;5>a;a++)this.showMagicItemByColumn(a)},
showMagicItemByColumn:function(a){for(var b=0;b<this.listColumn[a].listItem.length-1;b++){var d=this.listColumn[a].listItem[b];if(2==d.ItemID){d.setVisible(!1);this.listItemMagic[a].showWill(d.row);break}}},showNextEffect:function(){this.hideAllEffect();this.compoEffectNode.hideAllEffectReel();this.mainGame.effectWin||this.mainGame.initEffectWin();this.currentLine>=this.totalLine?(0<this.mainGame.coinWin&&this.mainGame.effectWin.playAnimationWin(this.mainGame.coinWin),this.playEffectAllLine(),this.currentLine=
0):(this.mainGame.effectWin.stopAnimationWin(),this.playEffectLine(this.dataEffect[this.currentLine].LineID,this.dataEffect[this.currentLine].IconID),this.currentLine++)},_playEffectItem:function(a,b){a.playEffect()},hideAllEffect:function(){this.mainGame.effectWin&&this.mainGame.effectWin.stopAnimationWin();for(var a=0;a<this.listItemResult.length;a++)this.listItemResult[a].stopEffect(),this.listItemResult[a].stopAllActions()},spin:function(a,b){for(this.compoEffectNode.hideAllEffect();0<this.dataEffect.length;)this.dataEffect.pop();
this.timeOut&&clearTimeout(this.timeOut);this.mainGame.effectWin&&this.mainGame.effectWin.stopAnimationWin();this.stopAllEffect();this.dataEffect.length=0;this.dataEffect=b;for(var d=0;d<this.listItemMagic.length;d++)this.listItemMagic[d].hideWill();this.compoEffectNode.addReelData(a,1,[3,4]);this.listColumn[0].beginSpin(0,a[0],this.compoEffectNode.getMoreTimeEffect(0));this.listColumn[1].beginSpin(1,a[1],this.compoEffectNode.getMoreTimeEffect(1));this.listColumn[2].beginSpin(2,a[2],this.compoEffectNode.getMoreTimeEffect(2));
this.listColumn[3].beginSpin(3,a[3],this.compoEffectNode.getMoreTimeEffect(3));this.listColumn[4].beginSpin(4,a[4],this.compoEffectNode.getMoreTimeEffect(4))},onPlayReelEffect:function(a){for(var b=0;3>b;b++){var d=this.listItemResult[3*a+b];3!=d.ItemID&&4!=d.ItemID||d.playEffectOnReel()}},stopAllEffect:function(){this.intervalEffect&&clearInterval(this.intervalEffect);this.hideAllEffect()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.intervalEffect&&clearInterval(this.intervalEffect);
this.timeOut&&clearTimeout(this.timeOut);this.hideAllEffect();for(this.clearChests();0<this.listLineEffect.length;)this.listLineEffect.pop();for(this.listLineEffect.length=0;0<this.listItemResult.length;)this.listItemResult.pop();for(var a=this.listItemResult.length=0;a<this.listColumn.length;a++)this.listColumn[a].setDispose();for(;0<this.listColumn.length;)this.listColumn.pop();for(this.listColumn.length=0;0<this.listItemMagic.length;)this.listItemMagic.pop();this.listItemMagic.length=0;this.compoEffectNode.setDispose()}});var MGXALDCompoHub=MGBaseNode.extend({mainGame:null,textBigWin:null,textUserGold:null,textMatchID:null,textUserBet:null,textGameStatus:null,textGameResult:null,textFreeSpin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.textBigWin=this.getChildByName("Text_BigGold");this.textBigWin.setString(0);this.textUserGold=this.getChildByName("Text_UserGold");this.textUserGold.setString(Utilities.Coin(MGGameInfo.myInfo.Gold));
this.textMatchID=this.getChildByName("Text_MatchID");this.textMatchID.setString("#0");this.textUserBet=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengAladin.FontX);this.textUserBet.setPosition(this.getChildByName("Text_TotalBet").getPosition());this.textUserBet.setPositionY(this.textUserBet.getPositionY()+5);this.getChildByName("Text_TotalBet").setVisible(!1);this.addChild(this.textUserBet);this.textUserBet.setString("0");this.textGameStatus=this.getChildByName("Text_GameStatus");this.textGameStatus.setString("Dòng Cược");
this.textGameStatus.ignoreContentAdaptWithSize(!0);this.textGameResult=new cc.LabelBMFont("50",ResourceManager.MGResourcesGameXengAladin.FontX);this.textGameResult.setPosition(this.getChildByName("Text_GameResult").getPosition());this.addChild(this.textGameResult);this.textGameResult.setPositionY(this.textGameResult.getPositionY()+5);this.getChildByName("Text_GameResult").setVisible(!1);this.textGameResult.setString("50");this.textFreeSpin=this.getChildByName("Text_FreeSpin")},updateFreeSpin:function(a){0<
a?(mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_FreeSpin,MGGameInfo.gameVolume),this.textFreeSpin.setVisible(!0),this.textFreeSpin.setString("LƯỢT QUAY MIỄN PHÍ: "+a)):(this.textFreeSpin.setVisible(!1),this.mainGame.isShowFreeSpin&&(this.mainGame.isShowFreeSpin=!1))},resetStateGame:function(){this.textGameStatus.setString("Dòng Cược");this.textGameResult.setString("50")},updateCoinWin:function(a){this.textGameStatus.setString("Tiền Thắng");this.textGameResult.setString(Utilities.Coin(a))},
updateMatchID:function(a){this.textMatchID.setString("#"+a.toString())},updateBigWin:function(a){this.textBigWin.setString(Utilities.Coin(a))},updateUserGold:function(a){this.textUserGold.setString(Utilities.Coin(a))},updateUserBet:function(a){this.textUserBet.setString(Utilities.Coin(a))}});var MGXALDMagiceffect=MGBaseNode.extend({mainGame:null,panel:null,column:0,itemMagic:null,ctor:function(a,b){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.column=b;this.panel=this.mainGame._mainLayer.getChildByName("MGMacgicEffect").getChildByName("Panel_Magic"+b.toString());this.itemMagic=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAladin.Spine_Effect_JSON,ResourceManager.MGResourcesGameXengAladin.Spine_Effect_ATLAS);this.mainGame.addChild(this.itemMagic);this.hideWill()},
showWill:function(a){this.itemMagic.setVisible(!0);Utilities.showLog("showWill ROW "+a);switch(a){case 1:this.itemMagic.setAnimation(0,"wild_icon1",!1);this.itemMagic.setPosition(cc.p(this.panel.getPositionX(),this.panel.getPositionY()+175));break;case 2:this.itemMagic.setAnimation(0,"wild_icon3",!1);this.itemMagic.setPosition(cc.p(this.panel.getPositionX(),this.panel.getPositionY()));break;case 3:this.itemMagic.setAnimation(0,"wild_icon2",!1),this.itemMagic.setPosition(cc.p(this.panel.getPositionX(),
this.panel.getPositionY()-179))}},hideWill:function(){this.itemMagic.setVisible(!1)}});var MGXALDTutorial=MGBaseNode.extend({pageView:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinTutorial,PreLoaderConfig.PathToResourceDefault).node);this.pageView=this.getChildByName("PageView");this._initEventBtnFromNode();this.hide();this.pageView.addEventListener(function(a,b){this.updateStatutButton(a.getCurPageIndex())}.bind(this))},_initEventBtnFromNode:function(){for(var a=
this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){Utilities.showLog(a.getName()+b);0==b&&mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,MGGameInfo.gameVolume);switch(a.getName()){case MGXALDTutorial.BUTTON_NAME.EXIT:2==b&&this.hide();break;case MGXALDTutorial.BUTTON_NAME.BACK:if(2==b){var d=this.pageView.getCurrentPageIndex();0<d?d--:d=0;this.updateStatutButton(d);
this.pageView.scrollToPage(d)}break;case MGXALDTutorial.BUTTON_NAME.NEXT:2==b&&(d=this.pageView.getCurrentPageIndex(),3>d?d++:d=0,this.updateStatutButton(d),this.pageView.scrollToPage(d))}},updateStatutButton:function(a){Utilities.showLog("Index "+a);0==a?(this.hideButton(MGXALDTutorial.BUTTON_NAME.BACK),this.showButton(MGXALDTutorial.BUTTON_NAME.NEXT)):3==a?(this.hideButton(MGXALDTutorial.BUTTON_NAME.NEXT),this.showButton(MGXALDTutorial.BUTTON_NAME.BACK)):(this.showButton(MGXALDTutorial.BUTTON_NAME.BACK),
this.showButton(MGXALDTutorial.BUTTON_NAME.NEXT))},showButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},hideButton:function(a){cc.sys.isNative||this.getChildByName(a).setBright(!1);this.getChildByName(a).setEnabled(!1)},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0);var a=this.pageView.getCurrentPageIndex();this.updateStatutButton(a)}});MGXALDTutorial.BUTTON_NAME={EXIT:"Button_Exit",NEXT:"Button_Next",BACK:"Button_Back"};var MGXALDNotification=MGBaseNode.extend({listView:null,maxLine:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinNotification,PreLoaderConfig.PathToResourceDefault).node);this.listView=this.getChildByName("MGListThongBao");this._initEventsGame();this.maxLine=100},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(4E3,
4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("MGButton_Exit").addClickEventListener(this.hidePopup.bind(this));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.onchatSysteam.bind(this)))},onchatSysteam:function(a){a=
a.getUserData();this.listView.getItems().length>=this.maxLine&&this.listView.removeItem(0);var b=new MGBaseRichText("Arial",15,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.pushBackCustomItem(b);this.listView.jumpToBottom()},showPopup:function(){this.setVisible(!0)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,MGGameInfo.gameVolume)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGXALDBigWinItem=MGBaseNode.extend({containThangLon:null,_textSTT:null,_textMaTK:null,_textTenHienThi:null,_textKetQua:null,_tienThang:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinBigWinItem,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("MGBackGround");this._textSTT=this.containThangLon.getChildByName("Text_STT");
this._textSTT.ignoreContentAdaptWithSize(!0);this._textMaTK=this.containThangLon.getChildByName("Text_MTK");this._textMaTK.ignoreContentAdaptWithSize(!0);this._textTenHienThi=this.containThangLon.getChildByName("Text_NICKNAME");this._textTenHienThi.ignoreContentAdaptWithSize(!0);this._textKetQua=this.containThangLon.getChildByName("Text_RESULT");this._textKetQua.ignoreContentAdaptWithSize(!0);this._tienThang=this.containThangLon.getChildByName("Text_GOLDWIN");this._tienThang.ignoreContentAdaptWithSize(!0)},
getContainThangLon:function(a,b,d,e){if(10<b.length){for(var f="",g=0;7>g;g++)f+=b.charAt(g);b=f+"..."}this._textMaTK.setString(a);this._textTenHienThi.setString(b);this._tienThang.setString(Utilities.Coin(e));this._getKetQua(d)},getSTT:function(a){this._textSTT.setString(a)},_getKetQua:function(a){0==a?this._textKetQua.setString("Thắng Thường"):1==a?this._textKetQua.setString("NỔ HŨ"):this._textKetQua.setString("Thắng Thường")}});var MGXALADHistoryItem=MGBaseNode.extend({containLS:null,_textPhien:null,_textThoiGian:null,_textCuoc:null,_textDongTrung:null,_textTienTrung:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinBigWinItem,PreLoaderConfig.PathToResourceDefault).node);this.containLS=this.getChildByName("MGBackGround");this._textPhien=this.containLS.getChildByName("Text_STT");
this._textPhien.setFontSize(18);this._textPhien.ignoreContentAdaptWithSize(!0);this._textThoiGian=this.containLS.getChildByName("Text_MTK");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textThoiGian.setFontSize(15);this._textThoiGian.setPositionX(this._textThoiGian.getPositionX()+5);this._textCuoc=this.containLS.getChildByName("Text_NICKNAME");this._textCuoc.ignoreContentAdaptWithSize(!0);this._textCuoc.setFontSize(18);this._textDongTrung=this.containLS.getChildByName("Text_RESULT");this._textDongTrung.setFontSize(18);
this._textDongTrung.ignoreContentAdaptWithSize(!0);this._textTienTrung=this.containLS.getChildByName("Text_GOLDWIN");this._textTienTrung.setFontSize(18);this._textTienTrung.ignoreContentAdaptWithSize(!0)},getContainLS:function(a,b,d,e,f){this._textPhien.setString(a);this._getThoiGian(b);this._textCuoc.setString(Utilities.Coin(d));this._textDongTrung.setString(e);this._textTienTrung.setString(Utilities.Coin(f))},_getThoiGian:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+
a.getSeconds(),d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?a.getHours():"0"+a.getHours();this._textThoiGian.setString(e+":"+d+":"+b+"  "+a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear())},_getDongTrung:function(a){for(var b=[],d=0;d<a.length;d++)0<a[d]&&b.push(d+1);this._textDongTrung.setString(b.length)}});var MGXALDTopBigWin=MGBaseNode.extend({_dataThangLon:null,_listThangLon:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._currentLoad=0;this._isShowed=!1;this._dataThangLon=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinTopBigWin,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listThangLon=this.getChildByName("MGListThangLon");
this.scheduleUpdate()},_initBackGround:function(){var a=new ccui.Layout;a.setContentSize(4E3,4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("Button_Close").addClickEventListener(this.hidePopup.bind(this))},update:function(a){this._isShowed&&this._listThangLon.getBottommostItemInCurrentView()&&
this._listThangLon.getBottommostItemInCurrentView().getTag()===this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+10<this._dataThangLon.length?10:this._dataThangLon.length-this._currentLoad;if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this._listThangLon.pushBackCustomItem(this.createCellInfo(this._dataThangLon[b],b+1));this._listThangLon.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.getSTTListData()}},getListDataThangLon:function(a){for(var b=
a.length<MGXALDTopBigWin.MAX_LINE?a.length:MGXALDTopBigWin.MAX_LINE,d=0;d<b;d++)this._dataThangLon.push(a[d])},getSTTListData:function(){for(var a=0;a<this._listThangLon.getItems().length;a++)this._listThangLon.getItem(a).setTag(a+1),this._listThangLon.getItem(a).getChildByName("Text_STT").setString(a+1)},createCellInfo:function(a,b){var d=new MGXALDBigWinItem;d.initObj();d.getContainThangLon(a.UserID,a.NickName,a.Type,a.EarnCoin);d.containThangLon.removeFromParent(!0);return d.containThangLon},getDataThangLon:function(a){this._isShowed?
(a=this.createCellInfo(a,0),this._listThangLon.insertCustomItem(a,0),this._listThangLon.getItems().length>MGXALDTopBigWin.MAX_LINE&&(this._listThangLon.removeItem(MGXALDTopBigWin.MAX_LINE),this._dataThangLon.splice(this._dataThangLon.length-1,1)),this.getSTTListData()):this._dataThangLon.splice(0,0,a)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,MGGameInfo.gameVolume)},showPopup:function(){this._isShowed||(this._isShowed=!0,
this.loadMoreItem(),this._listThangLon.jumpToTop());this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this._listThangLon.removeAllChildren(!0);this._dataThangLon.splice(0,this._dataThangLon.length);this._dataThangLon=[];this.unscheduleUpdate()}});MGXALDTopBigWin.MAX_LINE=100;var MGXALDHistory=MGBaseNode.extend({_listLichSu:null,_thoiGian:null,_tienCuoc:null,_dongTrung:null,_coinWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinHistory,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("MGListThangLon")},_initBackGround:function(){var a=
new ccui.Layout;a.setContentSize(4E3,4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.getChildByName("Button_Close").addClickEventListener(this.hidePopup.bind(this))},getContainLichSu:function(a){var b=new MGXALADHistoryItem;b.initObj();b.getContainLS(a,this._thoiGian,this._tienCuoc,
this._dongTrung,this._coinWin);b.containLS.removeFromParent(!0);this._listLichSu.insertCustomItem(b.containLS,0);this._showListLichSu()},getCoinWin:function(a,b,d,e){this._thoiGian=a;this._tienCuoc=b;this._dongTrung=d;this._coinWin=e},_showListLichSu:function(){this._listLichSu.getItems().length>=MGXALDHistory.MAX_LINE&&this._listLichSu.removeItem(MGXALDHistory.MAX_LINE-1)},hidePopup:function(){this.setVisible(!1);mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,MGGameInfo.gameVolume)},
showPopup:function(){this.setVisible(!0)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXALDHistory.MAX_LINE=100;var MGXALDFreeSpin=MGBaseNode.extend({textFree:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinFreeSpin,PreLoaderConfig.PathToResourceDefault).node);this.getChildByName("Button_OK").addClickEventListener(function(){this.hide();mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,MGGameInfo.gameVolume)}.bind(this));this.textFree=
this.getChildByName("Text_FreeSpin");this.textFree.setFontSize(150)},show:function(a){this.setVisible(!0);this.textFree.setString(a)},hide:function(){this.setVisible(!1)}});var MGXengAladin=MGBaseGame.extend({netSend:null,compoButtons:null,compoGameHub:null,layerSpin:null,freeSpinLayer:null,isPinBonus:!1,tutorialLayer:null,popupThangLon:null,popupThongBao:null,effectNoHu:null,popupLichSu:null,listCanBet:null,countBet:0,coinWin:0,textNuHu:null,goldNoHu:0,countNoHu:0,darkLayer:null,spineThangLon:null,textBigWin:null,goldWin:0,numFreeSpin:0,isShowFreeSpin:!1,buttonReward:null,gameStatust:0,itemChess:null,haveMiniGame:!1,isAutoSpin:!1,isNoHu:!1,isBigWin:!1,isAutoMiniGame:!0,
iupdateMenu:!1,effectWin:null,extendEffect:null,timeOutBonus:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesXengAladin},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.netSend=new MGNetSendXALD(this);this._initUI();this.initCompoButtons();this.layerSpin=new MGXALDScrollLayer(this);this.addChild(this.layerSpin);this.initCompoGameHub();this.darkLayer=this._mainLayer.getChildByName("Dark_Layer");this.darkLayer.removeFromParent(!0);this.darkLayer.setVisible(!1);
this.addChild(this.darkLayer,MGXengAladin.INDEX_EFFECT_POPUP);this.initPopupThongBao();this.initPopupThangLon();this.initPopupLichSu();this.listCanBet=[];this.goldNoHu=this.goldWin=this.coinWin=this.countBet=0;this.isShowFreeSpin=!1;this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.SOUND_WELCOME)}.bind(this),.2)},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengAladin.UIMGUIXengAladinLayer,PreLoaderConfig.PathToResourceDefault)},
_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.Turning.toString(),this.ngTurning.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.UpdateJackPot.toString(),this.ngUpdateJackPot.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.TopWinBonusBox.toString(),this.ngTopWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.TopBigWin.toString(),this.ngTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.WinBonusBox.toString(),
this.ngWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.BigWin.toString(),this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.StartMini.toString(),this.ngStartMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENG_ALADIN.ResultGameMini.toString(),this.ngResultGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),
this.ngUserCoin.bind(this)))},initCompoButtons:function(){this.compoButtons=new MGXALDCompoButtons;this.compoButtons.cloneFromNode(this._mainLayer.getChildByName("MGCompoButtons"));this.compoButtons.initObj(this);this.addChild(this.compoButtons)},initCompoGameHub:function(){this.compoGameHub=new MGXALDCompoHub;this.compoGameHub.cloneFromNode(this._mainLayer.getChildByName("MGCompoHub"));this.compoGameHub.initObj(this);this.addChild(this.compoGameHub)},initEffectWin:function(){this.effectWin=new MGComboEffectWinCoinXeng;
this.effectWin.initObj();this.addChild(this.effectWin,MGXengAladin.INDEX_EFFECT_COIN);this.effectWin.setPosition(cc.p(640,630));this.effectWin.setPositionText(220);this.effectWin.setPositionAni(85)},initTutorialLayer:function(){this.tutorialLayer=new MGXALDTutorial;this.tutorialLayer.initObj();this.addChild(this.tutorialLayer,MGXengAladin.INDEX_EFFECT_POPUP)},showTutorialLayer:function(){this.tutorialLayer||this.initTutorialLayer();this.tutorialLayer.show()},initPopupThongBao:function(){this.popupThongBao=
new MGXALDNotification;this.popupThongBao.initObj();this.popupThongBao.hidePopup();this.addChild(this.popupThongBao,MGXengAladin.INDEX_EFFECT_POPUP)},initPopupThangLon:function(){this.popupThangLon=new MGXALDTopBigWin;this.popupThangLon.initObj();this.popupThangLon.hidePopup();this.addChild(this.popupThangLon,MGXengAladin.INDEX_EFFECT_POPUP)},initFreeSpinLayer:function(){this.freeSpinLayer=new MGXALDFreeSpin;this.freeSpinLayer.initObj();this.freeSpinLayer.hide();this.addChild(this.freeSpinLayer,MGXengAladin.INDEX_EFFECT_POPUP)},
initPopupLichSu:function(){this.popupLichSu=new MGXALDHistory;this.popupLichSu.initObj();this.popupLichSu.hidePopup();this.addChild(this.popupLichSu,MGXengAladin.INDEX_EFFECT_POPUP)},initLayerMiniGame:function(){this.buttonReward=new ccui.Button("ButtonReward.png","","",ccui.Widget.PLIST_TEXTURE);this.buttonReward.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2));this.buttonReward.addTouchEventListener(function(a,b){0==b?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Click,
MGGameInfo.gameVolume):2==b&&(a.setVisible(!1),this.layerSpin.showDataFreeSpin())}.bind(this));this.addChild(this.buttonReward);this.darkLayer.setVisible(!0);this.hideMiniGame()},showMiniGame:function(){this.darkLayer.setVisible(!0);this.buttonReward.setVisible(!0);this.isAutoMiniGame=!0;mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_MiniGame,MGGameInfo.gameVolume)},hideMiniGame:function(){this.darkLayer.setVisible(!1);this.buttonReward.setVisible(!1);this.layerSpin.clearChests();
mg.audio.stopAllEffects()},_changeBackGroundAL:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameXengAladin.MGBackGroundAL;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,a)}},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.compoGameHub.updateUserGold(a.Gold)},ngGameData:function(a){a=a.getUserData();var b=
BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListBet:b.Array8,ListBet_Type:b.UInt8,MatchID:b.UInt32,CoinUser:b.UInt64,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64};this.iupdateMenu=!1;a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));this.compoGameHub.updateMatchID(a.MatchID);this.compoGameHub.updateUserGold(a.CoinUser);this.listCanBet=a.ListCoinCanBet;this.compoGameHub.updateUserBet(this.listCanBet[0]);this.compoButtons.hideButtonSpin();
this._changeBackGroundAL();this.isBigWin=this.isNoHu=!1},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngStartGame : "+JSON.stringify(a));this.compoButtons.showWhenSpinDone();this.haveMiniGame=!1;this.gameStatust=0;this.isAutoSpin&&0==this.gameStatust&&this.netSend.spin(this.getBetGold())},ngTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b=
{ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,CoinWinBet:b.UInt64,ScatterLines:b.UInt8,NumRoundFree:b.UInt8,CoinWinFromBonusBox:b.UInt64,InfoWin:b.Array8,InfoWin_Type:b.Object8,InfoWin_Type_Struct:{LineID:b.UInt8,IconID:b.UInt8,CoinWin:b.UInt64},MatchID:b.UInt32};mg.audio.stopAllEffects();a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTurning : "+JSON.stringify(a));this.layerSpin.stopAllEffect();this.coinWin=a.CoinWinBet;this.compoGameHub.updateMatchID(a.MatchID);
this.layerSpin.spin(a.ArrIcon,a.InfoWin);this.compoGameHub.updateCoinWin(0);this.compoButtons.hideButtonSpin();this.compoButtons.hideWhenSpin();this.popupLichSu.getCoinWin(new Date,this.getBetGold(),a.ArrIcon.length,a.CoinWinBet);this.popupLichSu.getContainLichSu(a.MatchID);this.numFreeSpin=a.NumRoundFree;this.gameStatust=1;mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Spin,MGGameInfo.gameVolume)},ngUpdateJackPot:function(a){a=a.getUserData();var b={CoinJP:BinaryConstants.DataTypeID.UInt64};
a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngUpdateJackPot : "+JSON.stringify(a));this.compoGameHub.updateBigWin(a.CoinJP)},ngTopWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBonus:b.Array8,dataBonus_Type:b.Object8,dataBonus_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTopWinBonusBox : "+JSON.stringify(a))},ngTopBigWin:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTopBigWin : "+JSON.stringify(a));this.popupThangLon.getListDataThangLon(a.dataBigWin)},ngWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,
NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("No HU : "+JSON.stringify(a));this.goldNoHu=a.EarnCoin;this.isNoHu=!0},ngStartMini:function(a){Utilities.showLog("MSG ngStartMini ");a=a.getUserData();var b={NumIconBonus:BinaryConstants.DataTypeID.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngStartMini : "+JSON.stringify(a));this.buttonReward||this.initLayerMiniGame();this.haveMiniGame=!0},ngResultGameMini:function(a){a=
a.getUserData();var b={CoinReward:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultGameMini : "+JSON.stringify(a));this.isAutoMiniGame&&(this.layerSpin.auotOpenMiniGame(),this.isAutoMiniGame=!1,Utilities.showLog("Auto Open GameMini"));a=a.CoinReward;if(0<a){var d=new cc.LabelBMFont(a,ResourceManager.MGResourcesGameXengAladin.FontfontNoHu);d.setPosition(this.itemChess.getPosition());a=parseInt(3*Math.random())+1;1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win1,
MGGameInfo.gameVolume):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win2,MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win3,MGGameInfo.gameVolume);this.addChild(d);d.runAction(cc.sequence(cc.moveBy(1.3,cc.p(0,50)),cc.delayTime(1),cc.callFunc(function(){d.removeFromParent(!0)}.bind(this))))}this.hideMiniGame()},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,
NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("Big Win : "+JSON.stringify(a));this.goldWin=a.EarnCoin;this.isBigWin=!1;MGGameInfo.myInfo.UserID==a.UserID&&(this.isBigWin=!0);this.popupThangLon.getDataThangLon(a)},showNoHu:function(){this.countNoHu=0;null==this.effectNoHu&&(this.effectNoHu=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAladin.SpineNo_Hu_JSON,ResourceManager.MGResourcesGameXengAladin.SpineNo_Hu_ATLAS),
this.effectNoHu.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2)),this.darkLayer.addChild(this.effectNoHu,MGXengAladin.INDEX_EFFECT_BIG_WIN));null==this.textNuHu&&(this.textNuHu=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengAladin.FontfontNoHu),this.textNuHu.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2)),this.darkLayer.addChild(this.textNuHu,MGXengAladin.INDEX_EFFECT_BIG_WIN));this.darkLayer.setVisible(!0);this.textNuHu.setVisible(!0);this.textNuHu.setString(Utilities.Coin(0));
this.runEffectNoHu();this.effectNoHu.setAnimation(0,"animation",!1);this.effectNoHu.setVisible(!0);setTimeout(function(){this.effectNoHu.setVisible(!1);this.textNuHu.setVisible(!1);this.darkLayer.setVisible(!1)}.bind(this),4E3);mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_BigWin,MGGameInfo.gameVolume)},runEffectNoHu:function(){if(this.countNoHu>=this.goldNoHu)this.textNuHu.setString(Utilities.Coin(this.goldNoHu));else{var a=Math.floor(this.goldNoHu/30);setTimeout(function(){this.countNoHu+=
a;this.countNoHu>=this.goldNoHu&&(this.countNoHu=this.goldNoHu);this.textNuHu.setString(Utilities.Coin(this.countNoHu));this.runEffectNoHu()}.bind(this),30)}},showSpineThangLon:function(){null==this.spineThangLon&&(this.spineThangLon=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAladin.SpineNo_ThangLon_JSON,ResourceManager.MGResourcesGameXengAladin.SpineNo_ThangLon_ATLAS),this.spineThangLon.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2)),this.darkLayer.addChild(this.spineThangLon,
MGXengAladin.INDEX_EFFECT_BIG_WIN));null==this.textBigWin&&(this.textBigWin=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengAladin.FontBigWinX),this.textBigWin.setPosition(cc.p(MGGameInfo.appRealWidth/2,MGGameInfo.appRealHeight/2-50)),this.darkLayer.addChild(this.textBigWin,MGXengAladin.INDEX_EFFECT_BIG_WIN));this.darkLayer.setVisible(!0);this.textBigWin.setVisible(!0);this.textBigWin.setString(0);this.goldCount=0;this.runEffectBigWin();this.spineThangLon.setAnimation(0,"animation",!1);
this.spineThangLon.setVisible(!0);setTimeout(function(){this.spineThangLon.setVisible(!1);this.textBigWin.setVisible(!1);this.darkLayer.setVisible(!1)}.bind(this),4E3);mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_BigWin,MGGameInfo.gameVolume)},runEffectBigWin:function(){if(this.goldCount>=this.goldWin)this.textBigWin.setString(Utilities.Coin(this.goldWin));else{var a=Math.floor(this.goldWin/30);setTimeout(function(){this.goldCount+=a;this.goldCount>=this.goldWin&&(this.goldCount=
this.goldWin);this.textBigWin.setString(Utilities.Coin(this.goldCount));this.runEffectBigWin()}.bind(this),30)}},finishSpin:function(){this.compoGameHub.updateCoinWin(this.coinWin);this.compoGameHub.updateUserGold(MGGameInfo.myInfo.Gold);this.iupdateMenu=!1;this.isAutoSpin||this.layerSpin.playEffect();0<this.numFreeSpin&&0==this.isShowFreeSpin&&(this.isShowFreeSpin=!0,this.playEffectScatter());this.compoGameHub.updateFreeSpin(this.numFreeSpin);this.haveMiniGame&&this.playEffectBonus();this.isNoHu?
(this.isBigWin=this.isNoHu=!1,this.showNoHu()):this.isBigWin&&!this.isNoHu&&(this.showSpineThangLon(),this.isNoHu=this.isBigWin=!1,mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_BigWin,MGGameInfo.gameVolume));if(0<this.coinWin){var a=parseInt(3*Math.random())+1;1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win1,MGGameInfo.gameVolume):2==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win2,MGGameInfo.gameVolume):mg.audio.playEffect(ResourceManager.MGResourcesGameXengAladin.XAL_Sound_Win3,
MGGameInfo.gameVolume)}},onClickUp:function(){this.countBet++;this.countBet>=this.listCanBet.length&&(this.countBet=0);this.compoGameHub.updateUserBet(this.listCanBet[this.countBet])},onClickDown:function(){this.countBet--;0>this.countBet&&(this.countBet=this.listCanBet.length-1);this.compoGameHub.updateUserBet(this.listCanBet[this.countBet])},onMaxBetClick:function(){this.countBet=this.listCanBet.length-1;this.compoGameHub.updateUserBet(this.listCanBet[this.countBet])},getBetGold:function(){return this.listCanBet[this.countBet]},
initExtendEffect:function(){this.extendEffect=new MGComboEffectSpecialXeng;this.extendEffect.initObj();this.addChild(this.extendEffect,MGXengAladin.INDEX_EFFECT_BIG_WIN)},playEffectBonus:function(){this.extendEffect||this.initExtendEffect();this.extendEffect.playEffectWinBonus(MGGameInfo.appRealHeight/2);this.timeOutBonus&&clearTimeout(this.timeOutBonus);this.timeOutBonus=setTimeout(function(){this.extendEffect.stopEffectWinSpecial();this.showMiniGame()}.bind(this),2E3)},playEffectScatter:function(){this.extendEffect||
this.initExtendEffect();this.extendEffect.playEffectWinScatter(MGGameInfo.appRealHeight/2);this.timeOutBonus&&clearTimeout(this.timeOutBonus);this.timeOutBonus=setTimeout(function(){this.extendEffect.stopEffectWinSpecial();this.freeSpinLayer||this.initFreeSpinLayer();this.freeSpinLayer.show(this.numFreeSpin)}.bind(this),2E3)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);mg.audio.stopAllEffects();this.layerSpin.setDispose();this.timeOutBonus&&clearTimeout(this.timeOutBonus)},stopAllEffect:function(){}});
MGXengAladin.INDEX_EFFECT_COIN=30;MGXengAladin.INDEX_EFFECT_BIG_WIN=50;MGXengAladin.INDEX_EFFECT_POPUP=70;ResourceManager.MGResourcesGameXengAiCap={XACBackgroundOutGame:"res/game/xengaicap/XACBackgroundOutGame.jpg",XACGameBackground:"res/game/xengaicap/atlas/Background/XACGameBackground.jpg",XACMiniGameBackground:"res/game/xengaicap/atlas/Background/XACMiniGameBackground.jpg",EffectAiCap_json:"res/game/xengaicap/Effect/XengAiCap_ItemFX.json",EffectAiCap_atlas:"res/game/xengaicap/Effect/XengAiCap_ItemFX.atlas",EffectAiCap_png:"res/game/xengaicap/Effect/XengAiCap_ItemFX.png",PlistXengAiCap:"res/game/xengaicap/atlas/AtlasXAC/AtlasXAC.plist",
AtlasXengAiCap:"res/game/xengaicap/atlas/AtlasXAC/AtlasXAC.png",PlistItemsXAC:"res/game/xengaicap/atlas/AtlasItem/AtlasItemsXAC.plist",AtlasItemsXAC:"res/game/xengaicap/atlas/AtlasItem/AtlasItemsXAC.png",UIMGUIXengAiCapLayer:"res/game/xengaicap/UIXengAiCapLayer.json",UIMGPopupBigWinNode:"res/game/xengaicap/UIMGXACPopupBigWin.json",UIMGPopupHistoryNode:"res/game/xengaicap/UIMGXACPopupHistory.json",UIMGPopupNotifyNode:"res/game/xengaicap/UIMGXACPopupNotify.json",UIMGPopupGameInfoNode:"res/game/xengaicap/UIMGXACPopupGameInfoNode.json",
UIMGPopupFreeTuring:"res/game/xengaicap/UIMGXACPopupFreeTurning.json",UIMGUICompoMiniGame:"res/game/xengaicap/UIMGXACCompoMiniGame.json",BonusBox_Atlas:"res/Effects/NoHu_FX.atlas",BonusBox_PNG:"res/Effects/NoHu_FX.png",BonusBox_Json:"res/Effects/NoHu_FX.json",ThangLon_PNG:"res/Effects/big_win.png",ThangLon_JSON:"res/Effects/big_win.json",ThangLon_ATLAS:"res/Effects/big_win.atlas",Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",FontWin_fnt:"res/Fonts/fontWin.fnt",FontWin_png:"res/Fonts/fontWin.png",
FontVua_fnt:"res/Fonts/VuaNumber-export.fnt",FontVua_png:"res/Fonts/VuaNumber-export.png",FontLon_fnt:"res/Fonts/LonNumber-export.fnt",FontLon_png:"res/Fonts/LonNumber-export.png",FontNho_fnt:"res/Fonts/NhoNumber-export.fnt",FontNho_png:"res/Fonts/NhoNumber-export.png",FontKha_fnt:"res/Fonts/KhaNumber-export.fnt",FontKha_png:"res/Fonts/KhaNumber-export.png",FontFree_fnt:"res/Fonts/FreeNumber-export.fnt",FontFree_png:"res/Fonts/FreeNumber-export.png",SFX_Click:"res/game/xengaicap/Sounds/click.mp3",
SFX_ClickQuay:"res/game/xengaicap/Sounds/clickquay.mp3",SFX_Bigwin:"res/game/xengaicap/Sounds/bigwin.mp3",SFX_Quay:"res/game/xengaicap/Sounds/quay.mp3",SFX_Win1:"res/game/xengaicap/Sounds/win1.mp3",SFX_Win2:"res/game/xengaicap/Sounds/win2.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};
ResourceManager.MGResourcesGameXengAiCapPreloadMobile={EffectAiCap_json:"res/game/xengaicap/Effect/XengAiCap_ItemFX.json",EffectAiCap_atlas:"res/game/xengaicap/Effect/XengAiCap_ItemFX.atlas",EffectAiCap_png:"res/game/xengaicap/Effect/XengAiCap_ItemFX.png",PlistXengAiCap:"res/game/xengaicap/atlas/AtlasXAC/AtlasXAC.plist",AtlasXengAiCap:"res/game/xengaicap/atlas/AtlasXAC/AtlasXAC.png",PlistItemsXAC:"res/game/xengaicap/atlas/AtlasItem/AtlasItemsXAC.plist",AtlasItemsXAC:"res/game/xengaicap/atlas/AtlasItem/AtlasItemsXAC.png",
UIMGUIXengAiCapLayer:"res/game/xengaicap/UIXengAiCapLayer.json",UIMGPopupBigWinNode:"res/game/xengaicap/UIMGXACPopupBigWin.json",UIMGPopupHistoryNode:"res/game/xengaicap/UIMGXACPopupHistory.json",UIMGPopupNotifyNode:"res/game/xengaicap/UIMGXACPopupNotify.json",UIMGPopupGameInfoNode:"res/game/xengaicap/UIMGXACPopupGameInfoNode.json",UIMGPopupFreeTuring:"res/game/xengaicap/UIMGXACPopupFreeTurning.json",UIMGUICompoMiniGame:"res/game/xengaicap/UIMGXACCompoMiniGame.json",BonusBox_Atlas:"res/Effects/NoHu_FX.atlas",
BonusBox_PNG:"res/Effects/NoHu_FX.png",BonusBox_Json:"res/Effects/NoHu_FX.json",ThangLon_PNG:"res/Effects/big_win.png",ThangLon_JSON:"res/Effects/big_win.json",ThangLon_ATLAS:"res/Effects/big_win.atlas",Font_fnt:"res/Fonts/Number.fnt",Font_png:"res/Fonts/Number.png",FontWin_fnt:"res/Fonts/fontWin.fnt",FontWin_png:"res/Fonts/fontWin.png",FontVua_fnt:"res/Fonts/VuaNumber-export.fnt",FontVua_png:"res/Fonts/VuaNumber-export.png",FontLon_fnt:"res/Fonts/LonNumber-export.fnt",FontLon_png:"res/Fonts/LonNumber-export.png",
FontNho_fnt:"res/Fonts/NhoNumber-export.fnt",FontNho_png:"res/Fonts/NhoNumber-export.png",FontKha_fnt:"res/Fonts/KhaNumber-export.fnt",FontKha_png:"res/Fonts/KhaNumber-export.png",FontFree_fnt:"res/Fonts/FreeNumber-export.fnt",FontFree_png:"res/Fonts/FreeNumber-export.png",SFX_Click:"res/game/xengaicap/Sounds/click.mp3",SFX_ClickQuay:"res/game/xengaicap/Sounds/clickquay.mp3",SFX_Bigwin:"res/game/xengaicap/Sounds/bigwin.mp3",SFX_Quay:"res/game/xengaicap/Sounds/quay.mp3",SFX_Win1:"res/game/xengaicap/Sounds/win1.mp3",
SFX_Win2:"res/game/xengaicap/Sounds/win2.mp3",SFX_Win3:"res/game/xengaicap/Sounds/win3.mp3",SOUND_WELCOME:"res/game/Components/Sounds/WelcomeXeng.mp3"};var resourcesXengAiCap=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengAiCapPreloadMobile)ResourceManager.MGResourcesGameXengAiCapPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAiCapPreloadMobile[i],resourcesXengAiCap.push(ResourceManager.MGResourcesGameXengAiCapPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengAiCap)ResourceManager.MGResourcesGameXengAiCap[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAiCap[i]}else for(i in ResourceManager.MGResourcesGameXengAiCap)ResourceManager.MGResourcesGameXengAiCap[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAiCap[i],resourcesXengAiCap.push(ResourceManager.MGResourcesGameXengAiCap[i]);ConstantsVariable.NETWORK_XENGAICAP={StartGame:3400,Turning:3401,UserLeftDesk:3402,ListUser:3403,GameData:3404,FreeTurning:3405,ToolResult:3406,WinBonusBox:3407,BigWin:3408,TopWinBonusBox:3409,TopBigWin:3410,BonusBoxInfo:3411,StartMiniGame:3412,ChoiceGameMini:3413,ResultGameMini:3414};ConstantsVariable.TYPE_ICON_XAC={NOTHING:0,WILD:1,SCATTER:2,COIN:3,KING:4,LOCK:5,CAT:6,BUG:7,A:8,K:9,TEN:10,Q:11,J:12};ConstantsVariable.TYPE_BOX={NHO:1,VUA:2,KHA:3,LON:4};
ConstantsVariable.STATE_XAC={NOT_START:0,WAIT:1,TURNING:2,GAME_MINI:3,FINISH:4};var MGNetSendXengAiCap=cc.Class.extend({gameModuleID:null,ctor:function(){},spin:function(a){Utilities.showLog("spin: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGAICAP.Turning.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendChoiceGameMini:function(a){var b={};b.Index=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGAICAP.ChoiceGameMini,{Index:BinaryConstants.DataTypeID.UInt8},
b);MGNetCore.MGSocket.sendMsg(a)},sendToolAiCap:function(a){var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_XENGAICAP.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Array8,ArrIcon_Type_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGXACColumn=cc.Class.extend({listItem:null,scrollCol:null,numIconShow:3,index:0,totalIcons:null,callBackFinish:null,_moreTime:0,ctor:function(){this.totalIcons=12},initObj:function(a,b){this.scrollCol=a;this.listItem=[];for(var d=0;d<a.getChildren().length;d++)this.listItem.push(a.getChildren()[d]);this.index=b;this.randomTopItem();this.updateBottomItem()},randomTopItem:function(){var a=0,b=this.numIconShow,d,e;for(a;a<b;a++)d=parseInt(Math.random()*this.totalIcons)+1,e="Item"+d+".png",this.listItem[a].ItemID=
d,this.listItem[a].textureName=e,this.listItem[a].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0),this.listItem[a].setVisible(!0)},beginScroll:function(){var a=0,b=this.numIconShow;for(a;a<b;a++)this.listItem[a].setVisible(!0)},randomHideItem:function(){var a=0,b=this.numIconShow,d,e,f=this.listItem.length;for(a;a<b;a++)d=parseInt(Math.random()*this.totalIcons)+1,e="Item"+d+".png",this.listItem[f-(this.numIconShow-a)].ItemID=d,this.listItem[f-(this.numIconShow-
a)].textureName=e,this.listItem[f-(this.numIconShow-a)].loadTexture(e,ccui.Widget.PLIST_TEXTURE),this.listItem[f-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateBottomItem:function(){var a=0,b=this.numIconShow,d=this.listItem.length;for(a;a<b;a++)this.listItem[d-(this.numIconShow-a)].ItemID=this.listItem[a].ItemID,this.listItem[d-(this.numIconShow-a)].textureName=this.listItem[a].textureName,this.listItem[d-(this.numIconShow-a)].loadTexture(this.listItem[a].textureName,ccui.Widget.PLIST_TEXTURE),
this.listItem[d-(this.numIconShow-a)].ignoreContentAdaptWithSize(!0)},updateReult:function(){var a=0,b=this.numIconShow,d;for(a;a<b;a++)d="Item"+this.listResult[a]+".png",this.listItem[a].textureName=d,this.listItem[a].ItemID=this.listResult[a],this.listItem[a].loadTexture(d,ccui.Widget.PLIST_TEXTURE),this.listItem[a].ignoreContentAdaptWithSize(!0)},turning:function(a,b){this._moreTime=b;this.scrollFist();this.listResult=a},scrollFist:function(){this.beginScroll();var a=-this.listItem[this.numIconShow].getPositionY()/
2+37;this.scrollCol.runAction(cc.sequence(cc.jumpBy(.3,cc.p(0,30),0,0),cc.jumpBy(.1,cc.p(0,a),0,0),cc.callFunc(this.scrollSecond.bind(this))))},scrollSecond:function(){this.scrollCol.setPositionY(0);this.updateBottomItem();var a=0;0<this._moreTime&&(a=parseInt(this._moreTime/.2));this.scrollCol.runAction(cc.sequence(cc.sequence(cc.callFunc(function(){this.randomHideItem();this.scrollCol.setPositionY(0)}.bind(this)),cc.jumpBy(.15,cc.p(0,-488),0,0)).repeat(8+a+2*this.index),cc.callFunc(this.scrollLast.bind(this))))},
scrollLast:function(){this.updateReult();this.updateBottomItem();this.scrollCol.setPositionY(0);this.scrollCol.runAction(cc.sequence(cc.jumpBy(.5,cc.p(0,-538),0,0),cc.jumpBy(.1,cc.p(0,112),0,0),cc.callFunc(function(){this.updateBottomItem();var a={};a.Index=this.index;cc.eventManager.dispatchCustomEvent(MGCompoEffectNode.EVENT.FX_EFFECT_REEL,a);this.callBackFinish&&this.callBackFinish()}.bind(this))))},getItemFromIndex:function(a){return this.listItem[a]},setDispose:function(){this.scrollCol.stopAllActions();
this.listItem=[]}});var MGXACSpinLayout=cc.Class.extend({listColumn:null,mainGame:null,listItemResult:null,ctor:function(){},initObj:function(a){this.listColumn=[];this.listItemResult=[];var b=0,d=a.getChildByName("Panel");for(b;5>b;b++)a=new MGXACColumn,a.initObj(d.getChildByName("MGScroll"+b),b),this.listColumn.push(a),this.listItemResult.push(a.listItem[0]),this.listItemResult.push(a.listItem[1]),this.listItemResult.push(a.listItem[2])},setDelegate:function(a){this.mainGame=a},getListItemsResult:function(){return this.listItemResult},
turning:function(a){var b=0;this.mainGame.compoEffect.compoEffectNode.addReelData(a.ArrIcon,1,[ConstantsVariable.TYPE_ICON_XAC.SCATTER,ConstantsVariable.TYPE_ICON_XAC.COIN]);for(b;5>b;b++)this.listColumn[b].turning(a.ArrIcon[b],this.mainGame.compoEffect.compoEffectNode.getMoreTimeEffect(b));this.mainGame.compoEffect.setDataEndMatch(a.InfoWin);this.listColumn[4].callBackFinish=this.finishScroll.bind(this)},finishScroll:function(){mg.audio.stopAllEffects();this.mainGame.isAutoSpin||this.mainGame.compoEffect.playEffectEndMatch();
this.mainGame.updateGoldWin()},setDispose:function(){for(var a=this.listColumn.length-1;0<this.listColumn.length;)this.listColumn[a].setDispose(),this.listColumn.pop(),a--;for(;0<this.listItemResult.length;)this.listItemResult.pop()}});var MGXACSpinItemEffect=cc.Class.extend({listItemResult:null,listLine:null,ctor:function(){},initObj:function(a){this.listItemResult=a;this.listLine=[];this.listLine[0]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13]];this.listLine[1]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLine[2]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[8],
this.listItemResult[11],this.listItemResult[14]];this.listLine[3]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[12]];this.listLine[4]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14]];this.listLine[5]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[13]];this.listLine[6]=[this.listItemResult[1],this.listItemResult[5],
this.listItemResult[8],this.listItemResult[11],this.listItemResult[13]];this.listLine[7]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[14]];this.listLine[8]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],this.listItemResult[12]];this.listLine[9]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],this.listItemResult[13]];this.listLine[10]=[this.listItemResult[1],
this.listItemResult[3],this.listItemResult[7],this.listItemResult[11],this.listItemResult[13]];this.listLine[11]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[12]];this.listLine[12]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[14]];this.listLine[13]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[12]];
this.listLine[14]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[14]];this.listLine[15]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[13]];this.listLine[16]=[this.listItemResult[1],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],this.listItemResult[13]];this.listLine[17]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[8],this.listItemResult[9],
this.listItemResult[12]];this.listLine[18]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[6],this.listItemResult[11],this.listItemResult[14]];this.listLine[19]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[12]];this.listLine[20]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14]];this.listLine[21]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[6],
this.listItemResult[11],this.listItemResult[13]];this.listLine[22]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[8],this.listItemResult[9],this.listItemResult[13]];this.listLine[23]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[6],this.listItemResult[11],this.listItemResult[12]];this.listLine[24]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[8],this.listItemResult[9],this.listItemResult[14]];this.listLine[25]=[this.listItemResult[2],this.listItemResult[3],
this.listItemResult[7],this.listItemResult[11],this.listItemResult[12]];this.listLine[26]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[7],this.listItemResult[9],this.listItemResult[14]];this.listLine[27]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[7],this.listItemResult[11],this.listItemResult[12]];this.listLine[28]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[7],this.listItemResult[9],this.listItemResult[14]];this.listLine[29]=[this.listItemResult[2],
this.listItemResult[4],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLine[30]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[11],this.listItemResult[13]];this.listLine[31]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLine[32]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];
this.listLine[33]=[this.listItemResult[1],this.listItemResult[3],this.listItemResult[8],this.listItemResult[10],this.listItemResult[14]];this.listLine[34]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[6],this.listItemResult[10],this.listItemResult[12]];this.listLine[35]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[6],this.listItemResult[10],this.listItemResult[14]];this.listLine[36]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[8],this.listItemResult[10],
this.listItemResult[12]];this.listLine[37]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[8],this.listItemResult[9],this.listItemResult[12]];this.listLine[38]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[7],this.listItemResult[10],this.listItemResult[14]];this.listLine[39]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[7],this.listItemResult[10],this.listItemResult[12]];this.listLine[40]=[this.listItemResult[2],this.listItemResult[3],this.listItemResult[6],
this.listItemResult[9],this.listItemResult[12]];this.listLine[41]=[this.listItemResult[0],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLine[42]=[this.listItemResult[2],this.listItemResult[5],this.listItemResult[8],this.listItemResult[11],this.listItemResult[12]];this.listLine[43]=[this.listItemResult[0],this.listItemResult[3],this.listItemResult[6],this.listItemResult[9],this.listItemResult[14]];this.listLine[44]=[this.listItemResult[1],this.listItemResult[3],
this.listItemResult[7],this.listItemResult[9],this.listItemResult[13]];this.listLine[45]=[this.listItemResult[1],this.listItemResult[5],this.listItemResult[7],this.listItemResult[11],this.listItemResult[12]];this.listLine[46]=[this.listItemResult[0],this.listItemResult[4],this.listItemResult[8],this.listItemResult[11],this.listItemResult[14]];this.listLine[47]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[6],this.listItemResult[9],this.listItemResult[12]];this.listLine[48]=[this.listItemResult[0],
this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13]];this.listLine[49]=[this.listItemResult[2],this.listItemResult[4],this.listItemResult[7],this.listItemResult[10],this.listItemResult[13]]},hideAllEffect:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)this.listItemResult[a].stopAllActions(),this.listItemResult[a].AnimationEff&&this.listItemResult[a].AnimationEff.setVisible(!1),this.listItemResult[a].FrameEff.stopAnimation(!1),this.listItemResult[a].setVisible(!0),
this.listItemResult[a].setScale(1)},hideEffect:function(a){a.stopAllActions();a.AnimationEff&&a.AnimationEff.setVisible(!1);a.FrameEff.stopAnimation(!1);a.setVisible(!0);a.setScale(1)},playLineEffects:function(a,b){for(var d=0;5>d;d++)this._playEffectItem(this.listLine[a.Index][d],a.IconWin,b)},setDispose:function(){var a=0,b=this.listItemResult.length;for(a;a<b;a++)this.listItemResult[a].stopAllActions();for(;0<this.listItemResult.length;)this.listItemResult.pop();this.listLine=[]},playEffectScatter:function(a){for(var b=
0;b<this.listItemResult.length;b++)if(this.listItemResult[b].ItemID==ConstantsVariable.TYPE_ICON_XAC.SCATTER){var d=this.listItemResult[b];d.AnimationEff||a.createSkeletonAnimation(b);d.AnimationEff.setVisible(!0);d.setVisible(!1);d.AnimationEff.setAnimation(0,MGXACEffect.ANIMATION_NAME[ConstantsVariable.TYPE_ICON_XAC.SCATTER].NAME,!0)}},showAnimation:function(a,b,d,e,f){b.AnimationEff||a.createSkeletonAnimation(b.ResultIndex);b.AnimationEff.setVisible(!0);b.AnimationEff.setAnimation(0,d,e);b.setVisible(!1);
e||b.runAction(cc.sequence(cc.delayTime(f?.5:2.5),cc.callFunc(function(){this.hideEffect(b)}.bind(this))))},showFrameFx:function(a,b){var d=3,e=2;b&&(d=2,e=1);a.FrameEff.playAnimation(e);a.runAction(cc.sequence(cc.sequence(cc.scaleTo(.3,1.1,1.1),cc.scaleTo(.3,1,1)).repeat(d)))},_playEffectItem:function(a,b,d){if(a.ItemID==b||a.ItemID==ConstantsVariable.TYPE_ICON_XAC.WILD)Utilities.showLog("Effect Item : "+b+"Play Effect Item : "+a.ItemID),a.setVisible(!0),7<a.ItemID?this.showFrameFx(a,!1):a.ItemID!=
ConstantsVariable.TYPE_ICON_XAC.COIN&&(a.ItemID!=ConstantsVariable.TYPE_ICON_XAC.SCATTER?this.showAnimation(d,a,MGXACEffect.ANIMATION_NAME[a.ItemID].NAME,!1,!1):this.showAnimation(d,a,MGXACEffect.ANIMATION_NAME[a.ItemID].NAME,!0,!1));a.FrameEff.playAnimation(2);a.FrameEff.runAction(cc.sequence(cc.delayTime(2.4),cc.callFunc(function(){a.FrameEff.setVisible(!1)}.bind(this))))}});var MGXACEffect=MGBaseNode.extend({posListAni:null,canPlayEff:null,totalLine:null,currentLine:null,darkLayer:null,mainGame:null,effectBonusBox:null,effectCoinWinNoHu:null,timeOutEffectBonus:null,haveJackPot:!1,effectBigWin:null,effectCoinWinBigWin:null,timeOutEffectBigWin:null,scatterLines:0,isHaveBonus:!1,listResult:null,spinItemEffect:null,listLineWin:null,effectWin:null,effectSpecialXeng:null,compoEffectNode:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.listLine3Row=
[];this.listLineWin=[];this.compoEffectNode=new MGCompoEffectNode;this.addChild(this.compoEffectNode)},initObj:function(a,b){MGBaseNode.prototype.initObj.call(this);this.posListAni=a;this.listResult=b;this.spinItemEffect=new MGXACSpinItemEffect;this.spinItemEffect.initObj(b);this.initEffectReel();this.initSkeAnimation();this.initEvents()},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGXACEffect.EVENT.FX_BONUS_BOX,this.playEffectBonusBox.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(MGXACEffect.EVENT.FX_BIG_WIN,this.playEffectBigWin.bind(this)))},initSkeAnimation:function(){for(var a=0;15>a;a++)this.listResult[a].FrameEff=this.compoEffectNode.addEffectItem(cc.size(200,200),this.posListAni.getChildByName("Effect_"+a).getPosition()),this.listResult[a].ResultIndex=a},createSkeletonAnimation:function(a){var b=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAiCap.EffectAiCap_json,ResourceManager.MGResourcesGameXengAiCap.EffectAiCap_atlas);
b.setPosition(this.posListAni.getChildByName("Effect_"+a).getPosition());b.setVisible(!1);this.addChild(b,2);this.listResult[a].AnimationEff=b},initEffectWin:function(){this.effectWin=new MGComboEffectWinCoinXeng;this.effectWin.initObj();this.addChild(this.effectWin,3);this.effectWin.setPosition(640,550);this.effectWin.setProties(180,.8,80)},initBonusBox:function(){var a=cc.p(.5*this.mainGame.darkLayer.getContentSize().width,.5*this.mainGame.darkLayer.getContentSize().height);this.effectBonusBox=
new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAiCap.BonusBox_Json,ResourceManager.MGResourcesGameXengAiCap.BonusBox_Atlas);this.effectBonusBox.setPosition(a);this.mainGame.darkLayer.addChild(this.effectBonusBox);this.effectBonusBox.setVisible(!1);this.effectCoinWinNoHu=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengAiCap.Font_fnt);this.effectCoinWinNoHu.setVisible(!1);this.mainGame.darkLayer.addChild(this.effectCoinWinNoHu);this.effectCoinWinNoHu.setPosition(a.x,
a.y+10)},initBigWin:function(){var a=cc.p(.5*this.mainGame.darkLayer.getContentSize().width,.5*this.mainGame.darkLayer.getContentSize().height);this.effectBigWin=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameXengAiCap.ThangLon_JSON,ResourceManager.MGResourcesGameXengAiCap.ThangLon_ATLAS);this.effectBigWin.setPosition(a.x,a.y+50);this.mainGame.darkLayer.addChild(this.effectBigWin);this.effectBigWin.setVisible(!1);this.effectCoinWinBigWin=new cc.LabelBMFont("10.000.000.000",ResourceManager.MGResourcesGameXengAiCap.FontWin_fnt);
this.effectCoinWinBigWin.setVisible(!1);this.mainGame.darkLayer.addChild(this.effectCoinWinBigWin);this.effectCoinWinBigWin.setPosition(a.x,a.y-50)},initEffectSpecialXeng:function(){this.effectSpecialXeng=new MGComboEffectSpecialXeng;this.effectSpecialXeng.initObj();this.effectSpecialXeng.setCallBackSuccess(this.playLinesEffectEndMatch.bind(this));this.mainGame.addChild(this.effectSpecialXeng)},initEffectReel:function(){for(var a=1;5>=a;a++)this.compoEffectNode.addEffectReel(cc.size(240,426),this.posListAni.getChildByName("EffectReel_"+
a).getPosition());this.compoEffectNode.setCallbackOnPlayEffectReel(this.onPlayReelEffect.bind(this))},playLineEffects:function(a){this.spinItemEffect.playLineEffects(a,this)},pushLineToList:function(a){this.listLine3Row.push(a)},showNextEffect:function(){0!=this.canPlayEff&&(Utilities.showLog("showNextEffect still run "),0!=this.totalLine&&(this.effectWin||this.initEffectWin(),Utilities.showLog("showNextEffect this.currentLine "+this.currentLine+"this.totalLine "+this.totalLine),this.currentLine<
this.totalLine?(this.effectWin.stopAnimationWin(),this.playSoundEffectOnLine(),this.playLineEffects(this.listLineWin[this.currentLine]),this.currentLine++):this.currentLine>=this.totalLine&&(0<this.mainGame.goldWin&&this.effectWin.playAnimationWin(this.mainGame.goldWin),this.currentLine=0,this.playAllLinesEffects())))},playAllLinesEffects:function(){var a=0;for(a;a<this.listLineWin.length;a++)this.playLineEffects(this.listLineWin[a])},resetListLine:function(){for(;0<this.listLine3Row.length;)this.listLine3Row.pop()},
playEffectEndMatch:function(){this.compoEffectNode.hideAllEffectReel();0<this.scatterLines||this.isHaveBonus?this.playFireWallEffectEndMatch():this.playLinesEffectEndMatch()},playLinesEffectEndMatch:function(){this.canPlayEff=!0;this.currentLine=this.totalLine=this.listLineWin.length;0<this.totalLine&&this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.showNextEffect();this.schedule(this.showNextEffect,3)}.bind(this))));0<this.scatterLines&&(this.mainGame.showPopupFreeTurning(),
this.spinItemEffect.playEffectScatter(this))},playFireWallEffectEndMatch:function(){0<this.scatterLines?(this.effectSpecialXeng||this.initEffectSpecialXeng(),this.effectSpecialXeng.playEffectWinScatter(320)):this.isHaveBonus&&(this.effectSpecialXeng||this.initEffectSpecialXeng(),this.effectSpecialXeng.playEffectWinBonus(320))},setScatterLines:function(a){this.scatterLines=a},setHaveBonus:function(a){this.isHaveBonus=a},clearArraysMap:function(){this.listLineWin=[]},stopAllEfect:function(){this.effectWin&&
this.effectWin.stopAnimationWin();this.unschedule(this.showNextEffect);this.scatterLines=this.totalLine=0;this.resetListLine();this.spinItemEffect.hideAllEffect();this.compoEffectNode.hideAllEffect();this.stopAllActions();this.canPlayEff=!1},playEffectBonusBox:function(a){a=a.getUserData();this.mainGame.darkLayer.setVisible(!0);mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Bigwin,MGGameInfo.gameVolume,!1);this.haveJackPot=!0;this.effectBonusBox||this.initBonusBox();
this.effectBonusBox.setAnimation(0,"animation",!1);this.effectBonusBox.setVisible(!0);this.effectCoinWinNoHu.setString(Utilities.Coin(a.EarnCoin));this.effectCoinWinNoHu.setVisible(!0);this.effectCoinWinNoHu.setScale(30);this.effectCoinWinNoHu.runAction(cc.sequence(cc.scaleTo(1,1),cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinNoHu.setVisible(!1);this.mainGame.darkLayer.setVisible(!1);this.haveJackPot=!1}.bind(this))));this.timeOutEffectBonus=setTimeout(this.hideEffect.bind(this,this.effectBonusBox),
4E3)},playEffectBigWin:function(a){this.mainGame.haveBonus||(a=a.getUserData(),mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Bigwin,MGGameInfo.gameVolume,!1),this.mainGame.darkLayer.setVisible(!0),this.effectBigWin||this.initBigWin(),this.effectBigWin.setAnimation(0,"animation",!1),this.effectBigWin.setVisible(!0),this.effectCoinWinBigWin.setString(Utilities.Coin(a.EarnCoin)),this.effectCoinWinBigWin.setVisible(!0),this.effectCoinWinBigWin.runAction(cc.sequence(cc.scaleTo(1,1),
cc.delayTime(3),cc.callFunc(function(){this.effectCoinWinBigWin.setVisible(!1);this.mainGame.darkLayer.setVisible(!1)}.bind(this)))),this.timeOutEffectBigWin=setTimeout(this.hideEffect.bind(this,this.effectBigWin),4E3))},hideEffect:function(a){a.setVisible(!1)},setDataEndMatch:function(a){this.listLineWin=a},playSoundEffectOnLine:function(){var a=parseInt(2*Math.random())+1;mg.audio.stopAllEffects();1==a?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Win1):2==a&&mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Win2)},
onPlayReelEffect:function(a){for(var b=0;3>b;b++){var d=this.listResult[3*a+b];if(d.ItemID==ConstantsVariable.TYPE_ICON_XAC.SCATTER||d.ItemID==ConstantsVariable.TYPE_ICON_XAC.COIN)d.ItemID==ConstantsVariable.TYPE_ICON_XAC.SCATTER?this.spinItemEffect.showAnimation(this,d,MGXACEffect.ANIMATION_NAME[ConstantsVariable.TYPE_ICON_XAC.SCATTER].NAME,!1,!0):this.spinItemEffect.showFrameFx(d,!0)}},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.compoEffectNode&&this.compoEffectNode.setDispose();
this.timeOutEffectBonus&&clearTimeout(this.timeOutEffectBonus);this.timeOutEffectBigWin&&clearTimeout(this.timeOutEffectBigWin);this.unschedule(this.showNextEffect);this.stopAllActions();this.spinItemEffect.setDispose();this.listLineWin=[]}});MGXACEffect.ANIMATION_NAME={1:{NAME:"Queen"},5:{NAME:"Ankn"},6:{NAME:"Cat"},2:{NAME:"Pyramids"},4:{NAME:"Pharaoh"},7:{NAME:"Bug"}};MGXACEffect.EVENT={FX_BONUS_BOX:"fxNoHu",FX_BIG_WIN:"fxBigWin"};var MGXACHub=MGBaseNode.extend({mainGame:null,textUserGold:null,textMatchID:null,textUserBet:null,textGameStatus:null,textGameResult:null,textFreeSpin:null,textHuNho:null,textHuVua:null,textHuKha:null,textHuLon:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this.textUserGold=this.getChildByName(MGXACHub.ITEMS_NAME.USER_GOLD);this.textUserGold.setString(Utilities.Coin(MGGameInfo.myInfo.Gold));this.textMatchID=this.getChildByName(MGXACHub.ITEMS_NAME.MATCH_ID);
this.textMatchID.setString("#0");this.textUserBet=this.getChildByName(MGXACHub.ITEMS_NAME.TONG_CUOC);this.textUserBet.setString("0");this.textGameStatus=this.getChildByName(MGXACHub.ITEMS_NAME.GAME_STATUS);this.textGameStatus.setString("DÒNG CƯỢC");this.textGameResult=this.getChildByName(MGXACHub.ITEMS_NAME.SO_DONG);this.textGameResult.setString("50 DÒNG");this.textFreeSpin=this.getChildByName(MGXACHub.ITEMS_NAME.FREE_SPINS);this.textHuNho=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengAiCap.FontNho_fnt);
this.textHuNho.setPosition(this.getChildByName(MGXACHub.ITEMS_NAME.HU_NHO).getPosition());this.addChild(this.textHuNho);this.getChildByName(MGXACHub.ITEMS_NAME.HU_NHO).removeFromParent(!0);this.textHuVua=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengAiCap.FontVua_fnt);this.textHuVua.setPosition(this.getChildByName(MGXACHub.ITEMS_NAME.HU_VUA).getPosition());this.addChild(this.textHuVua);this.getChildByName(MGXACHub.ITEMS_NAME.HU_VUA).removeFromParent(!0);this.textHuKha=new cc.LabelBMFont("0",
ResourceManager.MGResourcesGameXengAiCap.FontKha_fnt);this.textHuKha.setPosition(this.getChildByName(MGXACHub.ITEMS_NAME.HU_KHA).getPosition());this.addChild(this.textHuKha);this.getChildByName(MGXACHub.ITEMS_NAME.HU_KHA).removeFromParent(!0);this.textHuLon=new cc.LabelBMFont("0",ResourceManager.MGResourcesGameXengAiCap.FontLon_fnt);this.textHuLon.setPosition(this.getChildByName(MGXACHub.ITEMS_NAME.HU_LON).getPosition());this.addChild(this.textHuLon);this.getChildByName(MGXACHub.ITEMS_NAME.HU_LON).removeFromParent(!0)},
updateFreeSpin:function(a){this.textFreeSpin.setString(a)},resetStateGame:function(){this.textGameStatus.setString("DÒNG CƯỢC");this.textGameResult.setString("50 DÒNG")},updateCoinWin:function(a){this.textGameStatus.setString("TIỀN THẮNG");this.textGameResult.setString(Utilities.Coin(a))},updateMatchID:function(a){this.textMatchID.setString("#"+a.toString())},updateUserGold:function(a){this.textUserGold.setString(Utilities.Coin(a))},updateUserBet:function(a){this.textUserBet.setString(Utilities.Coin(a))},
updateBonusBoxs:function(a){for(var b=0;b<a.Info.length;b++)switch(a.Info[b].BoxType){case ConstantsVariable.TYPE_BOX.NHO:this.textHuNho.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.VUA:this.textHuVua.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.KHA:this.textHuKha.setString(Utilities.Coin(a.Info[b].Coint));break;case ConstantsVariable.TYPE_BOX.LON:this.textHuLon.setString(Utilities.Coin(a.Info[b].Coint))}}});
MGXACHub.ITEMS_NAME={TONG_CUOC:"MGTextBet",SO_DONG:"MGTextLineNumber",GAME_STATUS:"MGTextStatus",HU_LON:"MGTextHuLon",HU_KHA:"MGTextHuKha",HU_VUA:"MGTextHuVua",HU_NHO:"MGTextHuNho",MATCH_ID:"MGTextMatchID",FREE_SPINS:"MGTextFreeTurning",USER_GOLD:"MGTextCoin"};var MGXACCompoButtonsSpin=MGBaseNode.extend({_listButton:null,mainGame:null,_benginTouch:!1,_count:0,_canSpin:!0,listValueBet:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._listButton=[];this._initEventBtnFromNode();this._benginTouch=!1;this._count=0;this._canSpin=!0;this.listValueBet=[]},_initEventBtnFromNode:function(){for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),
this._listButton.push(a[d]));this.scheduleUpdate()},update:function(a){this._benginTouch&&(this._count+=a,.5<=this._count&&(this._count=0,this._benginTouch=this._canSpin=!1,this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.SPIN).setVisible(!1),this.mainGame.isAutoSpin=!0,this.mainGame.haveBonus=!1,this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setVisible(!0),this.getChildByName(MGXPDCompoButtonsSpin.BUTTON_NAME.STOP).setEnabled(!0),this.hideButtonSpin(),this.mainGame.gameStatus===
ConstantsVariable.STATE_XAC.NOT_START&&this.mainGame.netSend.spin(this.mainGame.getBetGold())))},hideWhenSpin:function(){this.hideButton(MGXACCompoButtonsSpin.BUTTON_NAME.BET_UP);this.hideButton(MGXACCompoButtonsSpin.BUTTON_NAME.BET_DOWN);this.hideButton(MGXACCompoButtonsSpin.BUTTON_NAME.MAX_BET);this.hideButtonSpin()},showWhenSpinDone:function(){this.showButton(MGXACCompoButtonsSpin.BUTTON_NAME.BET_UP);this.showButton(MGXACCompoButtonsSpin.BUTTON_NAME.BET_DOWN);this.showButton(MGXACCompoButtonsSpin.BUTTON_NAME.MAX_BET);
this.showButtonSpin()},hideButton:function(a){this.getChildByName(a).setEnabled(!1);this.getChildByName(a).setBright(!1)},showButton:function(a){this.getChildByName(a).setBright(!0);this.getChildByName(a).setEnabled(!0)},stopAutoSpin:function(){this.getChildByName(MGXACCompoButtonsSpin.BUTTON_NAME.SPIN).setVisible(!0);this.mainGame.isAutoSpin=!1;this.getChildByName(MGXACCompoButtonsSpin.BUTTON_NAME.STOP).setVisible(!1);this._canSpin=!0},onClickBtnFromCocostudio:function(a,b){b==ccui.Widget.TOUCH_BEGAN&&
(a.getName()==MGXACCompoButtonsSpin.BUTTON_NAME.SPIN?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_ClickQuay,MGGameInfo.gameVolume,!1):mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1));switch(a.getName()){case MGXACCompoButtonsSpin.BUTTON_NAME.SPIN:switch(b){case ccui.Widget.TOUCH_BEGAN:this._benginTouch=!0;this._count=0;break;case ccui.Widget.TOUCH_MOVED:this._benginTouch=!0;break;case ccui.Widget.TOUCH_ENDED:this._count=0;this._benginTouch=
!1;this._canSpin&&this.sendBetting();break;case ccui.Widget.TOUCH_CANCELED:this._count=0,this._benginTouch=!1}break;case MGXACCompoButtonsSpin.BUTTON_NAME.INFO:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupGameInfo();break;case MGXACCompoButtonsSpin.BUTTON_NAME.BET_DOWN:if(b===ccui.Widget.TOUCH_ENDED)this.mainGame.onClickDown();break;case MGXACCompoButtonsSpin.BUTTON_NAME.BET_UP:if(b===ccui.Widget.TOUCH_ENDED)this.mainGame.onClickUp();break;case MGXACCompoButtonsSpin.BUTTON_NAME.MAX_BET:if(b===
ccui.Widget.TOUCH_ENDED)this.mainGame.onMaxBetClick();break;case MGXACCompoButtonsSpin.BUTTON_NAME.THANG_LON:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupBigWin();break;case MGXPDCompoButtonsSpin.BUTTON_NAME.THONG_BAO:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupNotify();break;case MGXACCompoButtonsSpin.BUTTON_NAME.LICH_SU:b===ccui.Widget.TOUCH_ENDED&&this.mainGame.popup.showPopupHistory();break;case MGXACCompoButtonsSpin.BUTTON_NAME.STOP:b===ccui.Widget.TOUCH_ENDED&&this.stopAutoSpin()}},
showButtonSpin:function(){this.showButton(MGXACCompoButtonsSpin.BUTTON_NAME.SPIN);this._canSpin=!0},hideButtonSpin:function(){this.hideButton(MGXACCompoButtonsSpin.BUTTON_NAME.SPIN)},hideAll:function(){for(var a=0;a<this._listButton.length;a++)this._listButton[a].setBright(!1),this._listButton[a].setEnabled(!1)},sendBetting:function(){if(MGGameInfo.myInfo.Gold<this.mainGame.getBetGold()){var a=this.getMaxIndexCanBet();if(0>a){a={};a[MG_POPUP_KEY_DATA.POPUP_TITTLE]=ConstantsVariable.TEXT.NOTICE;a[MG_POPUP_KEY_DATA.POPUP_MSG]=
"Bạn không đủ gold. \nXin vui lòng nạp gold để tiếp tục chơi";cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_MESSAGE,a);this.mainGame.isAutoSpin&&(this.stopAutoSpin(),this.showWhenSpinDone());return}this.mainGame.setCountBet(a)}this.mainGame.netSend.spin(this.mainGame.getBetGold())},updateListBet:function(a){this.listValueBet=a},getMaxIndexCanBet:function(){for(var a=this.listValueBet.length-1;0<=a;){if(MGGameInfo.myInfo.Gold>=this.listValueBet[a])return a;a--}return-1}});
MGXACCompoButtonsSpin.BUTTON_NAME={SPIN:"Button_Spin",STOP:"Button_Stop",MAX_BET:"Button_MaxBet",BET_UP:"Button_Up",BET_DOWN:"Button_Down",INFO:"Button_Info",THANG_LON:"Button_ThangLon",THONG_BAO:"Button_ThongBao",LICH_SU:"Button_LichSu"};var MGXACMiniGameButton=MGBaseNode.extend({idButton:0,button:null,lbValue:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.button=this.getChildByName("MGButton");this.lbValue=this.getChildByName("MGTextValue")},resetButton:function(){this.lbValue.setVisible(!1);this.button.setTouchEnabled(!0);this.button.runAction(cc.rotateTo(.001,0,0))},showResult:function(a){this.button.setTouchEnabled(!1);this.lbValue.setSpriteFrame(4===
a?"sp_lon_xhc.png":3===a?"sp_kha_xhc.png":2===a?"sp_vua_xhc.png":"sp_nho_xhc.png");this.button.runAction(cc.sequence(cc.rotateBy(.25,0,180),cc.callFunc(function(){this.lbValue.setVisible(!0)}.bind(this))))}});var MGXACCompoMiniGame=MGBaseNode.extend({listButton:[],lbLuotChoi:null,luotChoi:0,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.initObj()},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listButton=[];this.initUI();this._initEventBtnFromNode();this._initEventsGame()},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.ChoiceGameMini.toString(),
this.ngChoiceGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.ResultGameMini.toString(),this.ngResultGameMini.bind(this)))},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGUICompoMiniGame,PreLoaderConfig.PathToResourceDefault);this.lbLuotChoi=this._mainLayer.getChildByName("MGTextLuotChoi")},_initEventBtnFromNode:function(){for(var a=this._mainLayer.getChildByName("MGMiniGameButtons"),b=0;b<a.getChildren().length;b++){var d=
new MGXACMiniGameButton;d.cloneFromNode(a.getChildByName("MGButton"+b));d.initObj();d.idButton=b+1;d.button.addClickEventListener(this.onClickBtnFromCocostudio.bind(this));a.addChild(d);this.listButton.push(d)}},ngChoiceGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Index:b.UInt32,Value:b.UInt32};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngChoiceGameMini : "+JSON.stringify(a));this.luotChoi--;0<=this.luotChoi&&this.lbLuotChoi.setString(this.luotChoi+
" LƯỢT CHƠI");0===this.luotChoi&&this.disableAllButton();this.getButtonByID(a.Index).showResult(a.Value)},ngResultGameMini:function(a){Utilities.showLog("ngResultGameMini");this.setShowMiniGame(!1,0)},setShowMiniGame:function(a,b){this.setVisible(a);a&&(this.luotChoi=b,this.resetAllButton(),this.lbLuotChoi.setString(this.luotChoi+" LƯỢT CHƠI"))},getButtonByID:function(a){for(var b=0;b<this.listButton.length;b++)if(this.listButton[b].idButton===a)return this.listButton[b]},resetAllButton:function(){for(var a=
0;a<this.listButton.length;a++)this.listButton[a].resetButton()},disableAllButton:function(){for(var a=0;a<this.listButton.length;a++)this.listButton[a].button.setTouchEnabled(!1)},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);this.mainGame.netSend.sendChoiceGameMini(a.getParent().idButton)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGXACPopupBigWin=MGBaseNode.extend({listView:null,btnClose:null,mainPopup:null,_dataBigWin:null,_isShowed:!1,_currentLoad:0,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this._dataBigWin=[];this._currentLoad=0;this._isShowed=!1;this.initUI();this.initEvent();this.scheduleUpdate()},update:function(a){this._isShowed&&this.listView.getBottommostItemInCurrentView()&&this.listView.getBottommostItemInCurrentView().getTag()===
this._currentLoad&&this.loadMoreItem()},loadMoreItem:function(){var a=this._currentLoad+10<this._dataBigWin.length?10:this._dataBigWin.length-this._currentLoad;if(0!==a){for(var b=this._currentLoad;b<this._currentLoad+a;b++)this.listView.pushBackCustomItem(this.createCellWithInfo(this._dataBigWin[b],b+1));this.listView.jumpToItem(this._currentLoad,cc.p(.5,.5),cc.p(.5,.5));this._currentLoad+=a;this.reArrangeSTT()}},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGPopupBigWinNode,
PreLoaderConfig.PathToResourceDefault);this.listView=this._mainLayer.getChildByName("MGCompoTopWinListView");this._mainLayer.getChildByName("MGTopWinViewCell").setVisible(!1);this.btnClose=this._mainLayer.getChildByName("MGCompoTopWinButtonClose");this.btnClose.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.BigWin.toString(),this.ngBigWin.bind(this)));
this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.TopBigWin.toString(),this.ngTopBigWin.bind(this)))},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},showBigWinLayer:function(){this._isShowed||(this._isShowed=!0,this.loadMoreItem(),this.listView.jumpToTop());this.setVisible(!0)},ngTopBigWin:function(a){a=a.getUserData();
var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);for(b=0;b<a.dataBigWin.length;b++)this._dataBigWin.push(a.dataBigWin[b])},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,
UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);this._isShowed?(this.listView.getItems().length>=MGXACPopupBigWin.MAX_LINE&&this.listView.removeItem(MGXACPopupBigWin.MAX_LINE-1),this.listView.insertCustomItem(this.createCellWithInfo(a,1),0),this.listView.jumpToTop(),this.reArrangeSTT()):this._dataBigWin.splice(0,0,a);MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGXACEffect.EVENT.FX_BIG_WIN,a)},createCellWithInfo:function(a,b){var d=this._mainLayer.getChildByName("MGTopWinViewCell").clone();
d.getChildByName("Text1").enableOutline(cc.color("#000000"),2);d.getChildByName("Text2").enableOutline(cc.color("#000000"),2);d.getChildByName("Text3").enableOutline(cc.color("#000000"),2);d.getChildByName("Text4").enableOutline(cc.color("#000000"),2);d.getChildByName("Text5").enableOutline(cc.color("#000000"),2);d.setVisible(!0);this.setCellInfo(d,a);return d},setCellInfo:function(a,b){a.getChildByName("Text1").setString(a.getTag());a.getChildByName("Text2").setString(b.UserID);a.getChildByName("Text3").setString(b.NickName);
a.getChildByName("Text4").setString(0===b.Type?"THƯỜNG":"NỔ HŨ");a.getChildByName("Text5").setString(Utilities.Coin(b.EarnCoin))},reArrangeSTT:function(){for(var a=0;a<this.listView.getItems().length;a++)this.listView.getItem(a).setTag(a+1),this.listView.getItem(a).getChildByName("Text1").setString(a+1)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.unscheduleUpdate()}});MGXACPopupBigWin.MAX_LINE=100;MGXACPopupBigWin.TYPE_NOHU={0:"THƯỜNG",1:"NỔ HŨ"};var MGXACPopupFreeTurning=MGBaseNode.extend({lbFreeNumber:null,btnStart:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGPopupFreeTuring,PreLoaderConfig.PathToResourceDefault);this.btnStart=this._mainLayer.getChildByName("MGBackground").getChildByName("MGButtonStart");this.btnStart.addClickEventListener(this.onBtnStartClick.bind(this));
this.lbFreeNumber=this._mainLayer.getChildByName("MGBackground").getChildByName("MGTextFreeNumber")},onBtnStartClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},showFreeTurning:function(a){this.setVisible(!0);this.lbFreeNumber.setString(a);a=this._mainLayer.getChildByName("MGBackground");a.setScale(0);a.runAction(cc.sequence(cc.scaleTo(.25,1.3),cc.scaleTo(.1,1)))}});var MGXACPopupGameInfo=MGBaseNode.extend({btnBack:null,btnBackToGame:null,btnNext:null,pageView:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGPopupGameInfoNode,PreLoaderConfig.PathToResourceDefault);this.btnBack=this._mainLayer.getChildByName("MGButtonPre");this.btnBackToGame=this._mainLayer.getChildByName("MGButtonExit");this.btnNext=
this._mainLayer.getChildByName("MGButtonNext");this.pageView=this._mainLayer.getChildByName("MGPageView");this.btnBack.addClickEventListener(this.onBtnBackClick.bind(this));this.btnBackToGame.addClickEventListener(this.onBtnBackToGameClick.bind(this));this.btnNext.addClickEventListener(this.onBtnNextClick.bind(this))},onBtnBackClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);var d=this.pageView.getCurrentPageIndex();0<d?d--:d=4;this.pageView.scrollToPage(d)},
onBtnBackToGameClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},onBtnNextClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);var d=this.pageView.getCurrentPageIndex();4>d?d++:d=0;this.pageView.scrollToPage(d)}});var MGXACPopupHistory=MGBaseNode.extend({listView:null,btnClose:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this.initUI()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGPopupHistoryNode,PreLoaderConfig.PathToResourceDefault);this.listView=this._mainLayer.getChildByName("MGHistoryListView");this._mainLayer.getChildByName("MGHistoryViewCell").setVisible(!1);
this.btnClose=this._mainLayer.getChildByName("MGCompoHistoryButtonClose");this.btnClose.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},setHistoryInfo:function(a){this.listView.insertCustomItem(this.createCellWithInfo(a),0);this.listView.jumpToTop()},createCellWithInfo:function(a){var b=
this._mainLayer.getChildByName("MGHistoryViewCell").clone();b.getChildByName("Text1").enableOutline(cc.color("#000000"),2);b.getChildByName("Text2").enableOutline(cc.color("#000000"),2);b.getChildByName("Text3").enableOutline(cc.color("#000000"),2);b.getChildByName("Text4").enableOutline(cc.color("#000000"),2);b.getChildByName("Text5").enableOutline(cc.color("#000000"),2);b.setVisible(!0);this.setCellInfo(b,a);return b},setCellInfo:function(a,b){var d=new Date(b.Time),e=("0"+d.getHours()).slice(-2),
f=("0"+d.getMinutes()).slice(-2),g=("0"+d.getSeconds()).slice(-2),h=("0"+d.getDate()).slice(-2),k=("0"+(d.getMonth()+1)).slice(-2),d=d.getFullYear();a.getChildByName("Text1").setString(b.MatchID);a.getChildByName("Text2").setString(e+":"+f+":"+g+"\n"+h+"/"+k+"/"+d);a.getChildByName("Text3").setString(Utilities.Coin(b.CoinBet));a.getChildByName("Text4").setString(b.DongTrung);a.getChildByName("Text5").setString(Utilities.Coin(b.EarnCoin))}});MGXACPopupHistory.MAX_LINE=100;var MGXACPopupNotify=MGBaseNode.extend({btnClose:null,listView:null,mainPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainPopup=a;this.initUI();this.initEvents()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGPopupNotifyNode,PreLoaderConfig.PathToResourceDefault);this.btnClose=this._mainLayer.getChildByName("ButtonClose");this.btnClose.addClickEventListener(this.onBtnClosetClick.bind(this));
this.listView=this._mainLayer.getChildByName("ListViewContent")},initEvents:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHAT_SYSTEM,this.ngThongBao.bind(this)))},onBtnClosetClick:function(a,b){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Click,MGGameInfo.gameVolume,!1);this.setVisible(!1);this.mainPopup.showPopupBackground(!1)},ngThongBao:function(a){a=a.getUserData();this.listView.getItems().length>=MGXACPopupNotify.MAX_LINE&&
this.listView.removeItem(MGXACPopupNotify.MAX_LINE-1);var b=new MGBaseRichText("Arial",18,cc.color.WHITE,!0,this.listView.getContentSize().width);b.setString(a.ArrMsg,a.ArrColor);this.listView.insertCustomItem(b,0);this.listView.jumpToTop()},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGXACPopupNotify.MAX_LINE=100;var MGXACPopup=MGBaseNode.extend({popupGameInfo:null,popupHistory:null,popupNotify:null,popupBigWin:null,popupFreeTurning:null,backGroundPopup:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.backGroundPopup=new ccui.ImageView("sp_info_bg_xac.png",ccui.Widget.PLIST_TEXTURE);this.backGroundPopup.setScale9Enabled(!0);this.backGroundPopup.setColor(cc.color("#000000"));this.backGroundPopup.setOpacity(210);this.backGroundPopup.setTouchEnabled(!0);
this.backGroundPopup.setSwallowTouches(!0);this.addChild(this.backGroundPopup);this.showPopupBackground(!1);this.popupNotify||(this.popupNotify=new MGXACPopupNotify,this.popupNotify.initObj(this),this.addChild(this.popupNotify));this.popupNotify.setVisible(!1);this.popupBigWin||(this.popupBigWin=new MGXACPopupBigWin,this.popupBigWin.initObj(this),this.addChild(this.popupBigWin));this.popupBigWin.setVisible(!1);this.popupHistory||(this.popupHistory=new MGXACPopupHistory,this.popupHistory.initObj(this),
this.addChild(this.popupHistory));this.popupHistory.setVisible(!1)},showPopupGameInfo:function(){this.popupGameInfo||(this.popupGameInfo=new MGXACPopupGameInfo,this.popupGameInfo.initObj(this),this.addChild(this.popupGameInfo));this.popupGameInfo.setVisible(!0);this.showPopupBackground(!0)},showPopupNotify:function(){this.popupNotify.setVisible(!0);this.showPopupBackground(!0)},showPopupBigWin:function(){this.popupBigWin.showBigWinLayer();this.showPopupBackground(!0)},setHistoryInfo:function(a){this.popupHistory.setHistoryInfo(a)},
showPopupHistory:function(){this.popupHistory.setVisible(!0);this.showPopupBackground(!0)},showPopupFreeTurning:function(a){this.popupFreeTurning||(this.popupFreeTurning=new MGXACPopupFreeTurning,this.popupFreeTurning.initObj(this),this.addChild(this.popupFreeTurning));this.popupFreeTurning.showFreeTurning(a);this.showPopupBackground(!0)},showPopupBackground:function(a){this.backGroundPopup.setVisible(a);this.backGroundPopup.setContentSize(cc.size(2560,1440));this.backGroundPopup.setPosition(cc.p(640,
.5*-this.backGroundPopup.getContentSize().height+720))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);this.popupNotify&&this.popupNotify.setDispose();this.popupBigWin&&this.popupBigWin.setDispose()}});var MGXengAiCap=MGBaseGame.extend({netSend:null,popup:null,gameHub:null,compoMiniGame:null,compoButtonsSpin:null,compoSpin:null,compoEffect:null,darkLayer:null,listCanBet:null,countBet:0,bounusSpinFree:0,countSpinFree:0,scatterLines:0,isAutoSpin:null,haveBonus:null,contentHistory:null,gameStatus:0,goldWin:0,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesXengAiCap},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._initUI();this.contentHistory=null;this.darkLayer=
new ccui.ImageView("sp_info_bg_xac.png",ccui.Widget.PLIST_TEXTURE);this.darkLayer.setScale9Enabled(!0);this.darkLayer.setContentSize(cc.size(cc.winSize.width,cc.winSize.height));this.darkLayer.setPosition(cc.p(640,.5*-this.darkLayer.getContentSize().height+720));this.darkLayer.setColor(cc.color("#000000"));this.darkLayer.setOpacity(210);this.darkLayer.setTouchEnabled(!0);this.darkLayer.setSwallowTouches(!0);this.darkLayer.setVisible(!1);this.initCompoButtonsSpin();this.initCompoSpin();this.initCompoTextHub();
this.initCompoEffect();this.initGamePopup();this.listCanBet=[];this.bounusSpinFree=this.goldWin=this.scatterLines=this.countSpinFree=0;this.haveBonus=!1;this.addChild(this.darkLayer);this.netSend=new MGNetSendXengAiCap;this.scheduleOnce(function(){mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SOUND_WELCOME)}.bind(this),.05)},_initEventsGame:function(){MGBaseGame.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),
this.ngUserCoin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.Turning.toString(),this.ngTurning.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.BonusBoxInfo.toString(),
this.ngBonusBoxInfo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.WinBonusBox.toString(),this.ngWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(MGCompoHeader.EVENTS.SUB_MENU_IN_GAME_BTN_BACK.toString(),this.ngSubMenuLeaveRoom.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_XENGAICAP.StartMiniGame.toString(),this.ngStartMiniGame.bind(this)))},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameXengAiCap.UIMGUIXengAiCapLayer,
PreLoaderConfig.PathToResourceDefault)},initGamePopup:function(){this.popup=new MGXACPopup;this.popup.initObj();this.addChild(this.popup)},initCompoButtonsSpin:function(){this.compoButtonsSpin=new MGXACCompoButtonsSpin;this.compoButtonsSpin.cloneFromNode(this._mainLayer.getChildByName("MGCompoButtonsSpin"));this.compoButtonsSpin.initObj(this);this.addChild(this.compoButtonsSpin)},initCompoTextHub:function(){this.gameHub=new MGXACHub;this.gameHub.cloneFromNode(this._mainLayer.getChildByName("MGHub"));
this.gameHub.initObj(this);this.addChild(this.gameHub)},initCompoSpin:function(){this.compoSpin=new MGXACSpinLayout;this.compoSpin.setDelegate(this);this.compoSpin.initObj(this._mainLayer.getChildByName("MGScrollContain"))},initCompoEffect:function(){this.compoEffect=new MGXACEffect(this);this.compoEffect.initObj(this._mainLayer.getChildByName("MGCompoEffect"),this.compoSpin.getListItemsResult());this.addChild(this.compoEffect)},initMiniGame:function(){this.compoMiniGame=new MGXACCompoMiniGame(this);
this.addChild(this.compoMiniGame)},ngGameData:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,NumRoundFree:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));this.countSpinFree=a.NumRoundFree;this.listCanBet=a.ListCoinCanBet;this.gameHub.updateMatchID(a.MatchID);this.gameHub.updateUserGold(a.CoinUser);this.gameHub.updateUserBet(this.listCanBet[0]);
this.gameHub.updateFreeSpin(this.countSpinFree);this.compoButtonsSpin.updateListBet(a.ListCoinCanBet);this.compoButtonsSpin.hideButtonSpin();this.matchID=a.MatchID;this._changeBackGroundXAC()},ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,TotalCoinBonusBox:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("StartGame : "+JSON.stringify(a));this.gameStatus=ConstantsVariable.STATE_XAC.NOT_START;this.matchID=a.MatchID;
this.gameHub.updateFreeSpin(this.countSpinFree);this.contentHistory&&this.popup.setHistoryInfo(this.contentHistory);this.isAutoSpin?this.haveBonus?(this.compoButtonsSpin.showWhenSpinDone(),this.haveBonus=!1):this.compoButtonsSpin.sendBetting():0<this.countSpinFree?this.compoButtonsSpin.showButtonSpin():this.compoButtonsSpin.showWhenSpinDone()},ngTurning:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={ArrIcon:b.Array8,ArrIcon_Type:b.Array8,ArrIcon_Type_Type:b.UInt8,CoinWinBet:b.UInt64,
ScatterLines:b.UInt8,NumRoundFree:b.UInt8,InfoWin:b.Array8,InfoWin_Type:b.Object8,InfoWin_Type_Struct:{Index:b.UInt32,IconWin:b.UInt32},IsHaveMini:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("Turning : "+JSON.stringify(a));this.gameStatus=ConstantsVariable.STATE_XAC.TURNING;this.goldWin=a.CoinWinBet;this.bounusSpinFree=a.NumRoundFree-(0<this.countSpinFree?this.countSpinFree-1:this.countSpinFree);this.countSpinFree=a.NumRoundFree;this.scatterLines=a.ScatterLines;this.gameHub.updateMatchID(this.matchID);
this.gameHub.resetStateGame();this.compoButtonsSpin.hideWhenSpin();this.compoEffect.stopAllEfect();this.compoEffect.setScatterLines(a.ScatterLines);this.compoEffect.setHaveBonus(a.IsHaveMini);this.compoSpin.turning(a);this.createHistoryInfo(a);mg.audio.stopAllEffects();mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Quay,MGGameInfo.gameVolume,!1)},createHistoryInfo:function(a){var b={};b.MatchID=this.matchID;b.CoinBet=this.getBetGold();b.Time=(new Date).getTime();b.DongTrung=0;b.DongTrung=
a.InfoWin.length;b.EarnCoin=a.CoinWinBet;this.contentHistory=b},ngWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,NickName:b.StringDynamic,EarnCoin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngWinBonusBox : "+JSON.stringify(a));MGGameInfo.myInfo.DisplayName===a.NickName&&cc.eventManager.dispatchCustomEvent(MGXACEffect.EVENT.FX_BONUS_BOX,a)},ngBonusBoxInfo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,
b={Info:b.Array8,Info_Type:b.Object8,Info_Type_Struct:{BoxType:b.UInt8,Coint:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngBonusBoxInfo : "+JSON.stringify(a));this.gameHub.updateBonusBoxs(a)},ngUserCoin:function(a){a=a.getUserData();var b={Gold:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);this.gameHub.updateUserGold(a.Gold)},ngStartMiniGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Amount:b.UInt32,TimeOut:b.UInt32};
a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("--ngStartMiniGame: "+JSON.stringify(a));this.haveBonus=!0;this.showMiniGame(!0,a.Amount)},ngSubMenuLeaveRoom:function(a){0<this.countSpinFree&&this.isAutoSpin&&this.compoButtonsSpin.stopAutoSpin()},_changeBackGroundXAC:function(){if(!cc.sys.isNative){var a={id:0};a[ConstantsVariable.EVENTS_KEY.URL_BACKGROUND]=ResourceManager.MGResourcesGameXengAiCap.XACBackgroundOutGame;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHANGE_MAIN_BACKGROUND,
a)}},showMiniGame:function(a,b){this.compoButtonsSpin.stopAutoSpin();this.compoMiniGame||this.initMiniGame();this.compoMiniGame.setShowMiniGame(a,b)},onMaxBetClick:function(){this.countBet=this.listCanBet.length-1;this.gameHub.updateUserBet(this.listCanBet[this.countBet])},updateGoldWin:function(){this.gameHub.updateCoinWin(this.goldWin);this.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.goldWin>=this.listCanBet[this.countBet]?mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Win2):
0<this.goldWin&&mg.audio.playEffect(ResourceManager.MGResourcesGameXengAiCap.SFX_Win1)}.bind(this))))},onClickUp:function(){this.countBet++;this.countBet>=this.listCanBet.length&&(this.countBet=0);this.gameHub.updateUserBet(this.listCanBet[this.countBet])},onClickDown:function(){this.countBet--;0>this.countBet&&(this.countBet=this.listCanBet.length-1);this.gameHub.updateUserBet(this.listCanBet[this.countBet])},getBetGold:function(){return this.listCanBet[this.countBet]},setCountBet:function(a){this.countBet=
a;this.gameHub.updateUserBet(this.listCanBet[this.countBet])},showPopupFreeTurning:function(){this.popup.showPopupFreeTurning(this.bounusSpinFree)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);mg.audio.stopAllEffects();mg.audio.stopMusic(!0);this.compoSpin&&(this.compoSpin.setDispose(),this.compoSpin=null);this.compoMiniGame&&(this.compoMiniGame.setDispose(),this.compoMiniGame=null);this.compoEffect&&(this.compoEffect.setDispose(),this.compoEffect=null);this.popup&&this.popup.setDispose()}});var MGNetSendCaoThap=cc.Class.extend({gameModuleID:null,ctor:function(){},sendTurningCard:function(a){Utilities.showLog("sendTurningCard: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINI_CAOTHAP.Turning.toString(),{Coin:BinaryConstants.DataTypeID.UInt64},b);MGNetCore.MGSocket.sendMsg(a)},sendBetMiniGame:function(a){var b={};b.BetKind=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINI_CAOTHAP.BetGameMini.toString(),{BetKind:BinaryConstants.DataTypeID.UInt8},
b);MGNetCore.MGSocket.sendMsg(a)},sendCancelMiniGame:function(){Utilities.showLog("sendCancelMiniGame: ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINI_CAOTHAP.CancelGameMini.toString());MGNetCore.MGSocket.sendMsg(a)},sendChangeCoinBet:function(a){Utilities.showLog("sendChangeCoinBet: "+a);var b={};b.Coin=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINI_CAOTHAP.ChangeCoinBet.toString(),{Coin:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)},
sendCloseGameMini:function(){Utilities.showLog("sendCancelMiniGame: ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK.LEAVE_DESK,null,null);MGNetCore.MGSocket.sendMsg(a)},sendToolCaoThap:function(a){Utilities.showLog("---Tool Result: "+a);var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_MINI_CAOTHAP.ToolResult.toString(),{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.Object8,ArrIcon_Type_Struct:{point:BinaryConstants.DataTypeID.UInt8,
color:BinaryConstants.DataTypeID.UInt8}},b);MGNetCore.MGSocket.sendMsg(a)}});ResourceManager.MGResourcesGameCaoThap={UICaoThapComboButtonsBet:"res/game/minigame/caothap/UICaoThapComboButtonsBet.json",UICaoThapButtonsInfo:"res/game/minigame/caothap/UICaoThapButtonsInfo.json",UICompoLichSuTradeCaoThap:"res/game/minigame/caothap/UICaoThapLichSuTrade.json",UIItemLichSuTradeCaoThap:"res/game/minigame/caothap/UICaoThapItemLichSuTrade.json",UICompoVinhDanhCaoThap:"res/game/minigame/caothap/UICaoThapBangVinhDanh.json",UIItemVinhDanhCaoThap:"res/game/minigame/caothap/UICaoThapItemVinhDanh.json",
UICaoThapHubLabel:"res/game/minigame/caothap/UICaoThapHubLabel.json",UICaoThapLayer:"res/game/minigame/caothap/UICaoThapLayer.json",UIItemSelectPageCaoThap:"res/game/minigame/caothap/UICaoThapItemSelectPage.json",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",
Thua_Json:"res/game/Components/EffectThangThua/thua.json",Hoa_Atlas:"res/game/Components/EffectThangThua/hoa.atlas",Hoa_PNG:"res/game/Components/EffectThangThua/hoa.png",Hoa_Json:"res/game/Components/EffectThangThua/hoa.json",UIMGUICaoThapPNG:"res/game/minigame/caothap/AtlasCaoThap/AtlasCaoThap.png",UIMGUICaoThapPLIST:"res/game/minigame/caothap/AtlasCaoThap/AtlasCaoThap.plist",AtlasCardsCaoThap:"res/game/Cards/AtlasCards.png",AtlasCardsPlistCaoThap:"res/game/Cards/AtlasCards.plist",Thang_Atlas:"res/game/Components/EffectThangThua/thang.atlas",
Thang_PNG:"res/game/Components/EffectThangThua/thang.png",Thang_Json:"res/game/Components/EffectThangThua/thang.json",Thua_Atlas:"res/game/Components/EffectThangThua/thua.atlas",Thua_PNG:"res/game/Components/EffectThangThua/thua.png",Thua_Json:"res/game/Components/EffectThangThua/thua.json"};var resourcesGameCaoThap=[];for(i in ResourceManager.MGResourcesGameCaoThap)ResourceManager.MGResourcesGameCaoThap[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameCaoThap[i],resourcesGameCaoThap.push(ResourceManager.MGResourcesGameCaoThap[i]);var MGCaoThap=MGBaseGame.extend({netSend:null,mainGameNode:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameCaoThap;this.netSend=new MGNetSendCaoThap},initObj:function(){MGBaseGame.prototype.initObj.call(this);this.initUI();this.initMainGameNode();this.initEvent()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameCaoThap.UICaoThapLayer,PreLoaderConfig.PathToResourceDefault)},initEvent:function(){this._initEventsGame()},initMainGameNode:function(){this.mainGameNode=
new MGCaoThapMainGameNode;this.mainGameNode.cloneFromNode(this._mainLayer);this.mainGameNode.initObj(this);this.addChild(this.mainGameNode)},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);this.mainGameNode.setDispose()},onExit:function(){MGBaseGame.prototype.onExit.call(this)}});var MGCaoThapMainGameNode=MGMoveablePopup.extend({mainGame:null,compoButtonsBet:null,compoButtonsInfo:null,compoHubText:null,compoSpinCard:null,compoPopup:null,compoEffect:null,netSend:null,itemLichSuRecord:null,steps:0,listEvCBFinishTurning:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(a){MGMoveablePopup.prototype.initObj.call(this);this.listEvCBFinishTurning=[];this.mainGame=a;this.initUI();this.initCompoButtonBet();this.initCompoButtonsInfo();this.initCompoHubText();
this.initCompoSpinCard();this._initEventsGame();this.initCompoPopup();this.initCompoEffect()},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.GameData.toString(),this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.ResultMiniGame.toString(),this.ngResultMiniGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.StartGame.toString(),
this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.EndMatch.toString(),this.ngEndMatch.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.TotalGoldBonus.toString(),this.ngTotalGoldBonus.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.WinBonusBox.toString(),this.ngWinBonusBox.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.BigWin.toString(),
this.ngBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.AddCoinToBonusBox.toString(),this.ngAddCoinToBonusBox.bind(this)))},initUI:function(){this.setMoveInfo(this.getChildByName("MGCaoThapBackground"));this.addMoveElement(this.getChildByName("MGCaoThapBackground").getChildByName("MGCaoThapTitle"))},initCompoButtonBet:function(){this.compoButtonsBet=new MGCaoThapCompoButtonsBet(this);this.compoButtonsBet.cloneFromNode(this.getChildByName("MGComboButtonsBet"));
this.compoButtonsBet.initObj();this.addChild(this.compoButtonsBet)},initCompoButtonsInfo:function(){this.compoButtonsInfo=new MGCaoThapCompoButtonsInfos(this);this.compoButtonsInfo.cloneFromNode(this.getChildByName("MGComboButtonsInfo"));this.compoButtonsInfo.initObj();this.addChild(this.compoButtonsInfo)},initCompoHubText:function(){this.compoHubText=new MGCaoThapCompoHubText(this);this.compoHubText.cloneFromNode(this.getChildByName("MGCompoHubText"));this.compoHubText.initObj();this.addChild(this.compoHubText)},
initCompoSpinCard:function(){this.compoSpinCard=new MGCaoThapCompoSpinCard(this);this.compoSpinCard.cloneFromNode(this.getChildByName("MGComboSpinCard"));this.compoSpinCard.initObj();this.compoSpinCard.setCBFinishTurning(this.callbackWhenFinishTurning.bind(this));this.addChild(this.compoSpinCard)},initCompoPopup:function(){this.compoPopup=new MGCaoThapPopup(this);this.compoPopup.initObj()},initCompoEffect:function(){this.comboEffect=new MGCaoThapEffect(this);this.comboEffect.initObj()},ngGameData:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,MaxCoin:b.UInt64,MinCoin:b.UInt64,MatchID:b.UInt32,CoinUser:b.UInt64,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));this.compoButtonsBet.setListBetValue(a.ListCoinCanBet)},ngResultMiniGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Card:b.UInt8,Color:b.UInt8,Coin:b.UInt64,ASC:b.UInt64,DES:b.UInt64,
TimeBetMiniGame:b.UInt64,MatchID:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultMiniGame : "+JSON.stringify(a));this.matchID=a.MatchID;this.compoHubText.setMatchID(this.matchID);if(0==this.steps)this.compoButtonsBet.onTurning();this.compoSpinCard.turning(a);this.setItemRecord(a);this.steps++},ngStartGame:function(a){Utilities.showLog("ngStartGame : ");this.steps=0;this.compoButtonsBet.onStartGame();this.compoSpinCard.onStartGame();this.compoHubText.onStartGame()},ngEndMatch:function(a){a=
a.getUserData();var b={Coin:BinaryConstants.DataTypeID.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngEndMatch : "+JSON.stringify(a));this.compoButtonsBet.setStateUpDownButton(!1);0<a.Coin?(this.comboEffect.playEffectThang(a.Coin),this.compoSpinCard.setStateBtnLuotMoi(!1)):1<this.steps&&this.compoPopup.popupHistory.changeValueLastItem(0);1==this.steps&&this.recordStepsZero()},ngTotalGoldBonus:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={TotalCoinBonusBox:b.UInt64,
Id:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTotalGoldBonus : "+JSON.stringify(a));this.compoHubText.setValueNoHu(a.TotalCoinBonusBox);this.compoButtonsBet.currentBetID=a.Id-1;this.compoHubText.setValueNodeCuocCenter(this.compoButtonsBet.getBetValue());this.compoButtonsBet.onButtonBetClick(this.compoButtonsBet.getChildByTag(this.compoButtonsBet.currentBetID))},ngWinBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,
CoinBet:b.UInt64,NickName:b.StringDynamic,Rate:b.UInt8,EarnCoin:b.UInt64,KindBonus:b.UInt8};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngWinBonusBox : "+JSON.stringify(a));a.UserID==MGGameInfo.myInfo.GameID&&this.comboEffect.playAnimitionBonus(a.EarnCoin)},ngBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32};a=(new BinaryParser).initObj(b,a.content);
Utilities.showLog("ngBigWin : "+JSON.stringify(a));a.UserID==MGGameInfo.myInfo.GameID&&this.comboEffect.playAnimitionBigWin(a.EarnCoin);this.compoPopup.popupBigWin.addVinhDanh(a)},ngAddCoinToBonusBox:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CoinAddBonus:b.UInt64,CoinWin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngAddCoinToBonusBox : "+JSON.stringify(a));this.listEvCBFinishTurning.push({FuncID:ConstantsVariable.NETWORK_MINI_CAOTHAP.AddCoinToBonusBox,
data:a})},setItemRecord:function(a){this.itemLichSuRecord={Phien:0,CreatedTime:"17/01/2017",CoinBet:0,EarnCoin:0,CuaDat:0,Buoc:0,Result:{Card:0,Color:0},ASC:0,DES:0};this.itemLichSuRecord.Phien="# "+a.MatchID;var b=(new Date).getTime(),d=new Date(b),b=("0"+d.getHours()).slice(-2),e=("0"+d.getMinutes()).slice(-2),f=("0"+d.getSeconds()).slice(-2),g=("0"+d.getDate()).slice(-2),h=("0"+(d.getMonth()+1)).slice(-2),d=d.getFullYear();this.itemLichSuRecord.CreatedTime=b+":"+e+":"+f+"-"+g+"/"+h+"/"+d;this.itemLichSuRecord.CoinBet=
this.compoButtonsBet.getBetValue();this.itemLichSuRecord.Result={Card:a.Card,Color:a.Color};this.itemLichSuRecord.ASC=a.ASC;this.itemLichSuRecord.DES=a.DES},recordSteps:function(a){this.itemLichSuRecord.EarnCoin=a?this.itemLichSuRecord.ASC:this.itemLichSuRecord.DES;this.itemLichSuRecord.CuaDat=a?1:0;this.itemLichSuRecord.Buoc=this.steps;this.compoPopup.popupHistory.addLichSu(this.itemLichSuRecord)},recordStepsZero:function(){this.itemLichSuRecord.EarnCoin=0;this.itemLichSuRecord.CuaDat=-1;this.itemLichSuRecord.Buoc=
this.steps;this.compoPopup.popupHistory.addLichSu(this.itemLichSuRecord)},closeGame:function(){this.getNetSend().sendCloseGameMini()},getNetSend:function(){return this.mainGame.netSend},callbackWhenFinishTurning:function(){if(0<this.listEvCBFinishTurning.length){for(var a=0;a<this.listEvCBFinishTurning.length;a++){var b=this.listEvCBFinishTurning[a];switch(b.FuncID){case ConstantsVariable.NETWORK_MINI_CAOTHAP.AddCoinToBonusBox:this.compoHubText.addCoinToHu(b.data.CoinAddBonus)}}this.listEvCBFinishTurning=
[]}},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);MGGameBoardCaoThap.clearCards();this.compoHubText.setDispose();this.comboEffect.setDispose();this.compoSpinCard.setDispose();this.compoButtonsInfo.setDispose();this.compoPopup.setDispose()}});var MGGameBoardCaoThap=cc.Class.extend({ctor:function(){}});MGGameBoardCaoThap.Cards=null;MGGameBoardCaoThap.getCardByID=function(a){return MGGameBoardCaoThap.Cards[a]};MGGameBoardCaoThap.clearCards=function(){for(;0<MGGameBoardCaoThap.Cards.length;){var a=MGGameBoardCaoThap.Cards.pop();a.removeFromParent(!0);a.release()}MGGameBoardCaoThap.Cards=null};ConstantsVariable.NETWORK_MINI_CAOTHAP={GameData:3505,WinBonusBox:3507,TopWinBonusBox:3508,ResultMiniGame:3509,TotalGoldBonus:3510,AddCoinToBonusBox:3511,Turning:3500,BetGameMini:3501,CancelGameMini:3512,ToolResult:3506,StartGame:3502,EndMatch:3513,CloseGameMini:3514,ChangeCoinBet:3515,TopBigWin:3516,BigWin:3517};var MGCaoThapCompoButtonsBet=MGBaseNode.extend({mainGame:null,_listButton:null,btnUp:null,btnDown:null,listBetValue:null,currentBetID:0,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this._listButton=[];this.listBetValue=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initEventBtnFromNode();this.btnUp=this.getChildByName("MGBtnCuocUp");this.btnDown=this.getChildByName("MGBtnCuocDown");this.currentBetID=0},_initEventBtnFromNode:function(){for(var a=this.getChildren(),
b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]))},onClickBtnFromCocostudio:function(a,b){if(b==ccui.Widget.TOUCH_ENDED)switch(a.getName()){case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET_UP:this.mainGame.getNetSend().sendBetMiniGame(1);this.mainGame.recordSteps(!0);break;case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET_DOWN:this.mainGame.getNetSend().sendBetMiniGame(0);this.mainGame.recordSteps(!1);break;
case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET0:case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET1:case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET2:case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET3:case MGCaoThapCompoButtonsBet.BUTTON_NAME.BET4:this.mainGame.getNetSend().sendChangeCoinBet(a.getTag()+1)}},onStartGame:function(){this.setStateUpDownButton(!1);for(var a=0;5>a;a++)this.getChildByTag(a).setTouchEnabled(!0)},onTurning:function(){for(var a=0;5>a;a++)this.getChildByTag(a).setTouchEnabled(!1);this.setStateUpDownButton(!1)},
onACard:function(){this.btnUp.setEnabled(!1)},on2Card:function(){this.btnDown.setEnabled(!1)},setStateUpDownButton:function(a){this.btnUp.setEnabled(a);this.btnDown.setEnabled(a)},onButtonBetClick:function(a){for(var b=0;5>b;b++)this.getChildByTag(b).setEnabled(!0);a.setEnabled(!1)},setListBetValue:function(a){this.listBetValue=a;for(var b=0;b<this.listBetValue.length;b++)if(1E4<=a[b]){var d=parseInt(a[b]/1E3)+a[b]%1E3,d=d+"K";this.getChildByTag(b).setTitleText(d)}else this.getChildByTag(b).setTitleText(Utilities.CoinString(a[b]))},
getBetValue:function(){return this.listBetValue[this.currentBetID]},setDispose:function(){}});MGCaoThapCompoButtonsBet.BUTTON_NAME={BET_UP:"MGBtnCuocUp",BET_DOWN:"MGBtnCuocDown",BET0:"MGBtnCuoc0",BET1:"MGBtnCuoc1",BET2:"MGBtnCuoc2",BET3:"MGBtnCuoc3",BET4:"MGBtnCuoc4"};var MGCaoThapCompoButtonsInfos=MGBaseNode.extend({mainGame:null,_listButton:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this._listButton=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._initEventBtnFromNode()},_initEventBtnFromNode:function(){MGBaseNode.prototype._initEventBtnFromNode.call(this);for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]))},
onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGCaoThapCompoButtonsInfos.BUTTON_NAME.CLOSE:b==ccui.Widget.TOUCH_ENDED&&this.mainGame.closeGame();break;case MGCaoThapCompoButtonsInfos.BUTTON_NAME.RANKING:b==ccui.Widget.TOUCH_ENDED&&this.mainGame.compoPopup.showPopupBigWin();break;case MGCaoThapCompoButtonsInfos.BUTTON_NAME.LICHSU:b==ccui.Widget.TOUCH_ENDED&&this.mainGame.compoPopup.showPopupHistory();break;case MGCaoThapCompoButtonsInfos.BUTTON_NAME.TUTORIAL:b==ccui.Widget.TOUCH_ENDED&&
cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{layerID:MGLayerPopupRules.LAYER.CAOTHAP})}},setDispose:function(){}});MGCaoThapCompoButtonsInfos.BUTTON_NAME={CLOSE:"MGButtonClose",RANKING:"MGButtonRanking",LICHSU:"MGButtonInfo",TUTORIAL:"MGButtonHelp",BET1:"MGBtnCuoc1",BET2:"MGBtnCuoc2",BET3:"MGBtnCuoc3",BET4:"MGBtnCuoc4"};var MGCaoThapCompoHubText=MGBaseNode.extend({mainGame:null,textHistory:null,intervalBet:null,dataTurning:null,nodeCuocTop:null,nodeCuocCenter:null,nodeCuocBottom:null,labelAmimationCuocCenter:null,labelAmimationNoHu:null,listCardHistory:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.listCardHistory=[];this.textHistory="";this.lbTimerBet=this.getChildByName("MGTimeCount");this.lbTimerBet.setVisible(!1);this.nodeCuocTop=
this.getChildByName("MGTextCuocTop");this.nodeCuocCenter=this.getChildByName("MGTextCuocCenter");this.nodeCuocBottom=this.getChildByName("MGTextCuocBottom");this.labelAmimationCuocCenter=new MGLabelAnimation(this.getChildByName("MGTextCuocCenter").getChildByName("Text"));this.labelAmimationNoHu=new MGLabelAnimation(this.getChildByName("MGGoldHu"))},setMatchID:function(a){this.getChildByName("MGMarchID").setString("#"+a)},setDataTurning:function(a){this.dataTurning=a},setValuesWin:function(a){this.nodeCuocTop.getChildByName("Text").setString(Utilities.Coin(a.ASC));
this.nodeCuocCenter.getChildByName("Text").setString(Utilities.Coin(a.Coin));this.nodeCuocBottom.getChildByName("Text").setString(Utilities.Coin(a.DES))},setTimeCount:function(a){this.lbTimerBet.setVisible(!0);this._timerBet=a;null!=this.intervalBet&&(clearInterval(this.intervalBet),this.intervalBet=null);this.intervalBet=setInterval(this._setTimerBet.bind(this),1E3);this._setTimerBet()},_setTimerBet:function(){this.lbTimerBet.setString(this._getTimerFormat(this._timerBet));cc.sys.isNative||this.lbTimerBet.setNodeDirty();
3==this._timerBet?this.lbTimerBet.setColor(cc.color(255,0,0,255)):3<this._timerBet&&this.lbTimerBet.setColor(cc.color(255,255,255,255));0==this._timerBet&&(this.lbTimerBet.setVisible(!1),clearInterval(this.intervalBet),this.intervalBet=null);this._timerBet--},_getTimerFormat:function(a){var b=("0"+parseInt(a/60,10)).slice(-2);a=("0"+a%60).slice(-2);return b+":"+a},setValueNoHu:function(a){this.labelAmimationNoHu.setString(a,!0)},addCoinToHu:function(a){this.labelAmimationNoHu.setString(this.labelAmimationNoHu.currentScore+
a,!0)},setTextHistory:function(a){this.buildTextHistory(a);this.getChildByName("MGTextHistory").setString(this.textHistory)},setVisibleTextBottom:function(a){this.getChildByName("MGTextBottom").setVisible(a);this.getChildByName("MGTextHistory").setVisible(!a);a&&(this.textHistory="",this.getChildByName("MGTextHistory").setString(this.textHistory))},setVisibleAllNodeCuoc:function(a){this.nodeCuocTop.setVisible(a);this.nodeCuocBottom.setVisible(a)},onStartGame:function(){this.listCardHistory=[];this.lbTimerBet.setVisible(!1);
null!=this.intervalBet&&(clearInterval(this.intervalBet),this.intervalBet=null);this.setVisibleTextBottom(!0);this.nodeCuocTop.setVisible(!1);this.nodeCuocBottom.setVisible(!1);this.labelAmimationCuocCenter.setString(this.mainGame.compoButtonsBet.getBetValue())},onTurning:function(a){this.setMatchID(a.MatchID);this.setVisibleTextBottom(!1);this.setValuesWin(a);this.setTextHistory(a);this.setTimeCount(a.TimeBetMiniGame)},onACard:function(){this.nodeCuocTop.setVisible(!1)},on2Card:function(){this.nodeCuocBottom.setVisible(!1)},
setValueNodeCuocCenter:function(a){this.labelAmimationCuocCenter.setString(a,!0)},buildTextHistory:function(a){a=MGCaoThapCompoHubText.POINTS[a.Card]+" "+MGCaoThapCompoHubText.COLOR_SYMBOl[a.Color];10<=this.listCardHistory.length&&(this.listCardHistory=this.listCardHistory.slice(1));this.listCardHistory.push(a);this.textHistory="";for(a=0;a<this.listCardHistory.length;a++)this.textHistory+=this.listCardHistory[a]+" "},setDispose:function(){null!=this.intervalBet&&(clearInterval(this.intervalBet),
this.intervalBet=null);this.labelAmimationCuocCenter.setDispose();this.labelAmimationNoHu.setDispose()}});MGCaoThapCompoHubText.COLOR_SYMBOl={1:"♠",2:"♣",3:"♦",4:"♥"};MGCaoThapCompoHubText.POINTS={1:"A",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"J",12:"Q",13:"K"};
var MGLabelAnimation=MGBaseNode.extend({lbTextNode:null,currentScore:0,newScore:0,changeScore:0,interval:null,scorePersecond:10,ctor:function(a){this.lbTextNode=a},setString:function(a,b){b?(this.newScore=a,this.change=this.newScore-this.currentScore,0==this.change?this.lbTextNode.setString(Utilities.Coin(a)):(this.scorePersecond=parseInt(this.change/10),null!=this.interval&&clearInterval(this.interval),this.interval=setInterval(this.playAnimation.bind(this),.1))):this.lbTextNode.setString(Utilities.Coin(a))},
playAnimation:function(){0==this.change||this.currentScore==this.newScore?(clearInterval(this.interval),this.interval=null,0==this.scorePersecond&&(this.currentScore=this.newScore,this.lbTextNode.setString(Utilities.Coin(this.currentScore)))):(this.change=1*this.scorePersecond,this.currentScore+=parseInt(this.change),0<this.change?this.currentScore>=this.newScore&&(this.currentScore=this.newScore):this.currentScore<=this.newScore&&(this.currentScore=this.newScore),this.lbTextNode.setString(Utilities.Coin(this.currentScore)))},
setDispose:function(){null!=this.interval&&clearInterval(this.interval)}});var MGCaoThapCompoSpinCard=MGBaseNode.extend({mainGame:null,_comboBtnPlay:null,_comboCard:null,cardSprite:null,listCardsRand:null,btnLuotMoi:null,countAItem:0,listItemA:null,lastCard:null,isContinue:!1,dataTurning:null,timeoutEffect:null,callbackFinishTurning:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a;this.listCardsRand=[];this.listItemA=[]},initObj:function(){MGBaseNode.prototype.initObj.call(this);this._comboBtnPlay=this.getChildByName("MGBtnPlay");this._comboCard=
this.getChildByName("MGLayOutCard");this.cardSprite=this._comboCard.getChildByName("MGSpriteCard");this.btnLuotMoi=this.getChildByName("MGBtnLuotMoi");this._initEventBtnFromNode();this.initCards()},_initEventBtnFromNode:function(){this._comboBtnPlay.getChildByName("BtnPlay").addTouchEventListener(this.onClickBtnFromCocostudio.bind(this));this.btnLuotMoi.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this));for(var a=this.getChildren(),b=a.length-1;0<b;b--)a[b]instanceof ccui.Text&&this.listItemA.push(a[b])},
onClickBtnFromCocostudio:function(a,b){switch(a.getName()){case MGCaoThapCompoSpinCard.BUTTON_NAME.PLAY:if(b==ccui.Widget.TOUCH_ENDED)this.onPlayButtonClick(a);break;case MGCaoThapCompoSpinCard.BUTTON_NAME.LUOT_MOI:if(b==ccui.Widget.TOUCH_ENDED)this.onLuotMoiButtonClick(a)}},onPlayButtonClick:function(a){this.mainGame.getNetSend().sendTurningCard(this.mainGame.compoButtonsBet.getBetValue())},onLuotMoiButtonClick:function(a){this.mainGame.getNetSend().sendCancelMiniGame()},setComboPlayButotnVisible:function(a){this._comboBtnPlay.setVisible(a);
this._comboCard.setVisible(!a)},initCards:function(){MGGameBoardCaoThap.Cards=[];var a;for(a=0;52>a;a++){var b=new MGBaseSprite;b.setScale(.7);b.setSpriteFrame("card"+a+".png");b.setName("MGCard"+a+".png");b.setColor(MGCaoThapCompoSpinCard.COLORCARD.BRIGHT);MGGameBoardCaoThap.Cards.push(b);b.retain()}},turning:function(a){this.dataTurning=a;this.setComboPlayButotnVisible(!1);this.setStateBtnLuotMoi(!1);this.mainGame.compoButtonsBet.setStateUpDownButton(!1);0<a.Coin&&(this.isContinue=!0);for(this.listCardsRand.push(this.getIDCard(a.Card,
a.Color));11>this.listCardsRand.length;)a=Math.floor(51*Math.random())+1,-1<this.listCardsRand.indexOf(a)||(this.listCardsRand[this.listCardsRand.length]=a);Utilities.showLog("turning"+JSON.stringify(this.listCardsRand));this.schedule(this.playEffectChangeCard,.1)},playEffectChangeCard:function(){if(1<this.listCardsRand.length){var a=MGGameBoardCaoThap.getCardByID(this.listCardsRand[this.listCardsRand.length-1]);a&&(a.setColor(MGCaoThapCompoSpinCard.COLORCARD.BRIGHT),null==a.getParent()&&(Utilities.showLog("playEffectChangeCard "+
this.listCardsRand[this.listCardsRand.length-1]),this.cardSprite.addChild(a)));this.listCardsRand.pop()}else this.onFinishEffectChangeCard()},onFinishEffectChangeCard:function(){this.unschedule(this.playEffectChangeCard);this.mainGame.compoButtonsBet.setStateUpDownButton(!0);this.mainGame.compoHubText.onTurning(this.dataTurning);this.mainGame.compoHubText.setVisibleAllNodeCuoc(!0);1<this.mainGame.steps&&this.isContinue?(this.setStateBtnLuotMoi(!0),this.isContinue=!1):1<this.mainGame.steps&&!this.isContinue&&
(this.mainGame.compoButtonsBet.setStateUpDownButton(!1),this.timeoutEffect=setTimeout(this.mainGame.comboEffect.playEffectThua.bind(this.mainGame.comboEffect,this.mainGame.compoButtonsBet.getBetValue()),1E3));this.cardSprite.removeAllChildren();var a=MGGameBoardCaoThap.getCardByID(this.listCardsRand[0]);a.setColor(MGCaoThapCompoSpinCard.COLORCARD.NORMAL);this.cardSprite.addChild(a);this.lastCard=a;4>this.listCardsRand[0]?(this.listItemA[this.countAItem].setColor(MGCaoThapCompoSpinCard.COLORCARD.RED),
this.countAItem++,this.mainGame.compoButtonsBet.onACard(),this.mainGame.compoHubText.onACard()):8>this.listCardsRand[0]&&(this.mainGame.compoButtonsBet.on2Card(),this.mainGame.compoHubText.on2Card());null!=this.callbackFinishTurning&&this.callbackFinishTurning();this.listCardsRand.pop()},onStartGame:function(){for(var a=0;3>a;a++)this.listItemA[a].setColor(MGCaoThapCompoSpinCard.COLORCARD.NORMAL);this.setComboPlayButotnVisible(!0);this.setStateBtnLuotMoi(!1);this.countAItem=0;this.listCardsRand=[]},
getIDCard:function(a,b){Utilities.showLog("getIDCard "+(4*a-(4-b+1)));return 4*a-(4-b+1)},setStateBtnLuotMoi:function(a){this.btnLuotMoi.setEnabled(a)},setCBFinishTurning:function(a){this.callbackFinishTurning=a},setDispose:function(){clearTimeout(this.timeoutEffect)}});MGCaoThapCompoSpinCard.BUTTON_NAME={LUOT_MOI:"MGBtnLuotMoi",PLAY:"BtnPlay"};MGCaoThapCompoSpinCard.SPRITE_NAME={CARD:"MGSpriteCard"};
MGCaoThapCompoSpinCard.COLORCARD={BRIGHT:{r:155,g:155,b:155},NORMAL:{r:255,g:255,b:255},RED:{r:255,g:0,b:0},WHITE:{r:255,g:255,b:255}};var MGCaoThapEffect=cc.Class.extend({maingame:null,fxThang:null,fxThua:null,effectNode:null,timeOutHideEffect:null,ctor:function(a){this.maingame=a;this.timeOutHideEffect=[]},initObj:function(){this.fxThang=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameCaoThap.Thang_Json,ResourceManager.MGResourcesGameCaoThap.Thang_Atlas);this.maingame.addChild(this.fxThang);this.fxThang.setPosition(this.maingame.getChildByName("MGEffectPos").getPosition());this.fxThang.setVisible(!1);this.fxThua=new sp.SkeletonAnimation(ResourceManager.MGResourcesGameCaoThap.Thua_Json,
ResourceManager.MGResourcesGameCaoThap.Thua_Atlas);this.maingame.addChild(this.fxThua);this.fxThua.setPosition(this.maingame.getChildByName("MGEffectPos").getPosition());this.fxThua.setVisible(!1);this.effectNode=new MGCompoEffectMiniGame;this.effectNode.initObj();this.maingame.addChild(this.effectNode);this.effectNode.setPosition(this.maingame.getChildByName("MGEffectPos").getPosition())},playEffectThang:function(a){this.fxThang.setAnimation(0,"thang",!1);this.fxThang.setVisible(!0);this.showEffectGoldWinLose(a);
this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.fxThang),4E3))},playEffectThua:function(a){this.fxThua.setAnimation(0,"thua",!1);this.fxThua.setVisible(!0);this.showEffectGoldWinLose(-1*a);this.timeOutHideEffect.push(setTimeout(this.hideEffect.bind(this,this.fxThua),4E3))},playAnimitionBonus:function(a){this.effectNode.playBonusMiniGame(a)},playAnimitionBigWin:function(a){this.effectNode.playBigWinMiniGame(a)},hideEffect:function(a){a.setVisible(!1)},showEffectGoldWinLose:function(a){if(0!==
a){var b=new ccui.Text;b.setFontSize(MGCaoThapEffect.FONT_WINLOSE_SIZE);b.setFontName(MGCaoThapEffect.TEXT_WINLOSE_FONT);b.setString(0<a?"+"+Utilities.Coin(a):"-"+Utilities.Coin(Math.abs(a)));b.setPosition(0,0);0<a?b.setTextColor(MGCaoThapEffect.TEXT_WIN_COLOR):0>a&&b.setTextColor(MGCaoThapEffect.TEXT_LOSE_COLOR);this._effectTextAction(b);0<a?this.fxThang.addChild(b):this.fxThua.addChild(b)}},_effectTextAction:function(a){a.runAction(cc.sequence(cc.spawn(cc.moveTo(1,a.getPosition().x,a.getPosition().y+
MGCaoThapEffect.TEXT_WINLOSE_DESTINATION_Y),cc.fadeOut(1.5)),cc.callFunc(function(){a.removeFromParent(!0)})))},setDispose:function(){for(var a=0;a<this.timeOutHideEffect.length;a++)clearTimeout(this.timeOutHideEffect[a])}});MGCaoThapEffect.TEXT_WINLOSE_FONT="Roboto-Regular";MGCaoThapEffect.TEXT_WINLOSE_DESTINATION_Y=30;MGCaoThapEffect.FONT_WINLOSE_SIZE=20;MGCaoThapEffect.TEXT_WIN_COLOR=cc.color(255,255,255,255);MGCaoThapEffect.TEXT_LOSE_COLOR=cc.color(253,67,131,255);MGCaoThapEffect.Z_LOCAL={Text_Effect:12};var MGCaoThapPopup=cc.Class.extend({maingame:null,popupGameInfo:null,popupHistory:null,popupBigWin:null,ctor:function(a){this.maingame=a},initObj:function(){this.popupBigWin||(this.popupBigWin=new MGCaoThapPopupVinhDanh,this.popupBigWin.cloneFromNode(this.maingame.getChildByName("MGCompoVinhDanh")),this.popupBigWin.initObj(this),this.maingame.addChild(this.popupBigWin));this.popupBigWin.setVisible(!1);this.popupHistory||(this.popupHistory=new MGCaoThapPopupLichSu,this.popupHistory.cloneFromNode(this.maingame.getChildByName("MGCompoLichSu")),
this.popupHistory.initObj(this),this.maingame.addChild(this.popupHistory));this.popupHistory.setVisible(!1)},showPopupGameInfo:function(){this.popupGameInfo||(this.popupGameInfo=new MGXACPopupGameInfo,this.popupGameInfo.initObj(this),this.addChild(this.popupGameInfo));this.popupGameInfo.setVisible(!0)},showPopupBigWin:function(){this.popupBigWin.showVinhDanh()},setHistoryInfo:function(a){this.popupHistory.setHistoryInfo(a)},showPopupHistory:function(){this.popupHistory.showLichSu(!0)},setDispose:function(){this.popupBigWin&&
this.popupBigWin.setDispose();this.popupHistory&&this.popupBigWin.setDispose()}});var MGItemPageCaoThap=MGBaseNode.extend({textPage:null,onVisible:null,value:null,onPage:-1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameCaoThap.UIItemSelectPageCaoThap,PreLoaderConfig.PathToResourceDefault).node);this.buttonPage=this.getChildByName("buttonPage");this.backgroundPage=this.getChildByName("buttonPage").getChildByName("backGroundSelect");this.textPage=this.getChildByName("buttonPage").getChildByName("txtPageNum");
this.setBackground(!1);this.setVisiblePage(!0);this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.buttonPage.addClickEventListener(this.changePageHistory.bind(this))},setBackground:function(a){!0===a?this.backgroundPage.setVisible(!0):this.backgroundPage.setVisible(!1)},setVisiblePage:function(a){!0===a?(this.setVisible(!0),this.onVisible=1):(this.setVisible(!1),this.onVisible=0)},setText:function(a){this.textPage.setString(a)},setValue:function(a){this.value=
a},setKeyDispactchEvent:function(a){this.keyDispatch=a},changePageHistory:function(a){Utilities.showLog("changePageHistory "+this.keyDispatch);cc.eventManager.dispatchCustomEvent(this.keyDispatch,this)}});var MGCaoThapPageNode=MGBaseNode.extend({_delegate:null,_dataSource:null,_arrPageH:null,_totalPage:null,_itemPerPage:null,_pageLength:null,_currentPage:null,_pos:null,keyDispatch:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._arrPageH=[];this._pageLength=this._itemPerPage=this._totalPage=0;this._currentPage=1;this._delegate=null},initObj:function(a,b,d){this._pos=a.getPosition();this._itemPerPage=b;this._pageLength=d/b;this._initPage(this._pageLength)},setDelegate:function(a){this._delegate=
a},setDataSource:function(a){this._dataSource=a},_initPage:function(a){for(var b=null,d=0;d<a;d++)b=new MGItemPageCaoThap,b.initObj(),b.setText(d+1),b.setValue(d+1),b.setVisiblePage(!1),b.setKeyDispactchEvent(this.keyDispatch),this.addChild(b),this._arrPageH.push(b);a=this._pos;b=new MGItemPageCaoThap;b.initObj();b.setText(">");b.setValue(111);b.setVisiblePage(!1);b.setKeyDispactchEvent(this.keyDispatch);b.setPosition(a.x+2*MGCaoThapPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);
b=new MGItemPageCaoThap;b.initObj();b.setText(">>");b.setValue(112);b.setVisiblePage(!1);b.setKeyDispactchEvent(this.keyDispatch);b.setPosition(a.x+3*MGCaoThapPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);b=new MGItemPageCaoThap;b.initObj();b.setText("<<");b.setValue(113);b.setVisiblePage(!1);b.setKeyDispactchEvent(this.keyDispatch);b.setPosition(a.x-4*MGCaoThapPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);b=new MGItemPageCaoThap;b.initObj();b.setText("<");b.setValue(114);
b.setVisiblePage(!1);b.setKeyDispactchEvent(this.keyDispatch);b.setPosition(a.x-3*MGCaoThapPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);0!==this._arrPageH.length&&(this._arrPageH[0].setBackground(!0),this._arrPageH[0].onPage=1)},showPageHistory:function(a){111>a?this.changePage(a):(111===a&&this.nextPage(),112===a&&this.endPage(),113===a&&this.beganPage(),114===a&&this.previousPage())},changePage:function(a){this._totalPage=Math.ceil(this._dataSource.length/this._itemPerPage);
this._currentPage=a;for(var b=0;b<this._arrPageH.length;b++)if(1===this._arrPageH[b].onPage&&(this._arrPageH[b].setBackground(!1),this._arrPageH[b].onPage=0),b<this._totalPage&&4>=this._totalPage&&1<this._totalPage)this._arrPageH[b].setVisiblePage(!0);else if(b<this._totalPage&&4<this._totalPage&&1===this._currentPage)for(var d=0;4>d;d++)this._arrPageH[d].setVisiblePage(!0);for(b=0;b<this._totalPage;b++)if(this._arrPageH[b].value===a)return this._arrPageH[b].setBackground(!0),this._arrPageH[b].onPage=
1,4<this._totalPage&&(0===b?(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0)):b===this._arrPageH.length-5?(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-
4].setVisiblePage(!1)):(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0))),this.changeToPage(this._arrPageH[b].value),(4>=this._totalPage||4<this._totalPage&&1===this._currentPage)&&this.allignPage(),!0},allignPage:function(){var a=Math.ceil(this._dataSource.length/this._itemPerPage);this._totalPage=a;for(var b=this._pos,
d=null,e=0;e<a;e++)d=this._arrPageH[e],1>=a?d.setPosition(b.x,b.y):2>=a?d.setPosition(b.x-MGCaoThapPageNode.BUTTON_GAP+e*MGCaoThapPageNode.BUTTON_GAP,b.y):3>=a?d.setPosition(b.x-MGCaoThapPageNode.BUTTON_GAP+e*MGCaoThapPageNode.BUTTON_GAP,b.y):d.setPosition(b.x-2*MGCaoThapPageNode.BUTTON_GAP+e*MGCaoThapPageNode.BUTTON_GAP,b.y)},nextPage:function(){for(var a=0,b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(a=b);if(0===this._arrPageH[a+1].onVisible){var d=this._pos;this._arrPageH[a-3].setVisiblePage(!1);
for(b=0;4>b;b++)this._arrPageH[a-2+b].setVisiblePage(!0),this._arrPageH[a-2+b].setPosition(d.x-2*MGCaoThapPageNode.BUTTON_GAP+b*MGCaoThapPageNode.BUTTON_GAP,d.y)}if(11>this._arrPageH[a+1].value)return this._arrPageH[a].setBackground(!1),this._arrPageH[a+1].setBackground(!0),this._arrPageH[a].onPage=0,this._arrPageH[a+1].onPage=1,this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH.length-5===a+1&&(this._arrPageH[this._arrPageH.length-
3].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1)),this.changeToPage(this._arrPageH[a+1].value),!0},previousPage:function(){for(var a=0,b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(a=b);if(0===this._arrPageH[a-1].onVisible){var d=this._pos;this._arrPageH[a+3].setVisiblePage(!1);for(b=0;4>b;b++)this._arrPageH[a-1+b].setVisiblePage(!0),this._arrPageH[a-1+b].setPosition(d.x-2*MGCaoThapPageNode.BUTTON_GAP+b*MGCaoThapPageNode.BUTTON_GAP,d.y)}11>this._arrPageH[a-
1].value&&(this._arrPageH[a].setBackground(!1),this._arrPageH[a-1].setBackground(!0),this._arrPageH[a].onPage=0,this._arrPageH[a-1].onPage=1,this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0),0===a-1&&(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1)),this.changeToPage(this._arrPageH[a-1].value))},beganPage:function(){for(var a=0;a<this._arrPageH.length;a++)1===this._arrPageH[a].onPage&&
(this._arrPageH[a].setBackground(!1),this._arrPageH[a].onPage=0);for(a=0;a<this._arrPageH.length-4;a++)this._arrPageH[a].setVisiblePage(!1);for(a=0;4>a;a++){var b=this._pos;this._arrPageH[a].setVisiblePage(!0);this._arrPageH[a].setPosition(b.x-2*MGCaoThapPageNode.BUTTON_GAP+a*MGCaoThapPageNode.BUTTON_GAP,b.y)}this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-
4].setVisiblePage(!0);this._arrPageH[0].onPage=1;this._arrPageH[0].setBackground(!0);this.changeToPage(this._arrPageH[0].value)},endPage:function(){for(var a=0;a<this._arrPageH.length;a++)1===this._arrPageH[a].onPage&&(this._arrPageH[a].setBackground(!1),this._arrPageH[a].onPage=0);for(var b=0;b<this._arrPageH.length-4;b++)this._arrPageH[b].setVisiblePage(!1);a=0;for(b=this._arrPageH.length-8;b<this._arrPageH.length-4;b++){var d=this._pos;this._arrPageH[b].setVisiblePage(!0);this._arrPageH[b].setPosition(d.x-
2*MGCaoThapPageNode.BUTTON_GAP+a*MGCaoThapPageNode.BUTTON_GAP,d.y);a++}this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-5].onPage=1;this._arrPageH[this._arrPageH.length-5].setBackground(!0);this.changeToPage(this._arrPageH[this._arrPageH.length-5].value)},changeToPage:function(a){this._currentPage=
a;this._delegate&&this._delegate.loadPage(a)},getCurrentPage:function(){return this._currentPage},setKeyDispactchEvent:function(a){this.keyDispatch=a},removePage:function(){this._panelGiaoDich.removeAllItems();for(var a=0;a<this._arrPageH.length;a++)this._arrPageH[a].setVisiblePage(!1);this._arrPageH=[]}});MGCaoThapPageNode.BUTTON_GAP=50;var MGCaoThapItemVinhDanh=MGBaseNode.extend({panel:null,background:null,nickname:null,thoigian:null,muccuoc:null,tienthang:null,bobai:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._init()},_init:function(){this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameCaoThap.UIItemVinhDanhCaoThap,PreLoaderConfig.PathToResourceDefault).node);this.panel=this.getChildByName("Panel");this.background=this.panel.getChildByName("MGBackground");this.nickname=this.panel.getChildByName("ItemTaiKhoan");
this.thoigian=this.panel.getChildByName("ItemTime");this.muccuoc=this.panel.getChildByName("ItemMucCuoc");this.tienthang=this.panel.getChildByName("ItemThang");this.bobai=this.panel.getChildByName("ItemBoBai")},setBackGround:function(a){1===a%2?this.background.setVisible(!0):this.background.setVisible(!1)},setNickName:function(a){this.nickname.setString(a)},setThoiGian:function(a){a=a.slice(0,10)+"  "+a.slice(11,19);this.thoigian.setString(a)},setMucCuoc:function(a){a=Utilities.Coin(a);this.muccuoc.setString(a)},
setTienThang:function(a){a=Utilities.Coin(a);this.tienthang.setString(a)},setLoai:function(a){0==a?this.bobai.setString("Thắng lớn"):this.bobai.setString("Nổ hũ")}});var MGCaoThapPopupVinhDanh=MGMoveablePopup.extend({mainNode:null,buttonClose:null,_panelGiaoDich:null,compoPageNode:null,_datapage:null,_showed:null,ctor:function(a){MGMoveablePopup.prototype.ctor.call(this);this.mainNode=a;this._datapage=[];this._showed=!1},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this.initUI();this.initEvent()},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this.initUI();this.initEvent()},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGCaoThapPopupVinhDanh.EVENT.LOAD_PAGE.toString(),
this.onLoadPage.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINI_CAOTHAP.TopBigWin.toString(),this.ngTopBigWin.bind(this)))},initUI:function(){this.setMoveInfo(this.getChildByName("MGBackground"));this.buttonClose=this.getChildByName("MGButtonClose");this._panelGiaoDich=this.getChildByName("panelGiaoDich");this.compoPageNode=new MGCaoThapPageNode;this.compoPageNode.setKeyDispactchEvent(MGCaoThapPopupVinhDanh.EVENT.LOAD_PAGE);this.compoPageNode.initObj(this.getChildByName("PageNum"),
10,50);this.compoPageNode.setDelegate(this);this.compoPageNode.setDataSource(this._datapage);this.addChild(this.compoPageNode);this.buttonClose.addClickEventListener(function(a){this.hide()}.bind(this))},showVinhDanh:function(){this._showed||(this._showed=!0,this.compoPageNode.changePage(this.compoPageNode.getCurrentPage()));this.setVisible(!0)},onLoadPage:function(a){a=a.getUserData();this.compoPageNode.showPageHistory(a.value)},addVinhDanh:function(a){this._datapage.splice(0,0,a);50<this._datapage.length&&
this._datapage.pop();this._showed&&this.compoPageNode.changePage(this.compoPageNode.getCurrentPage())},loadPage:function(a){this._panelGiaoDich.removeAllItems();var b=[],d=this._datapage.length>=10*(a-1)+10?10*(a-1)+10:this._datapage.length;for(a=10*(a-1);a<d;a++)b.push(this._datapage[a]);for(a=0;a<b.length;a++)d=new MGCaoThapItemVinhDanh,d.setBackGround(a),d.setNickName(b[a].NickName),d.setThoiGian(b[a].CreatedTime),d.setMucCuoc(b[a].CoinBet),d.setTienThang(b[a].EarnCoin),d.setLoai(b[a].Type),d.panel.removeFromParent(),
this._panelGiaoDich.pushBackCustomItem(d.panel)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)},ngTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={dataBigWin:b.Array8,dataBigWin_Type:b.Object8,dataBigWin_Type_Struct:{CreatedTime:b.StringDynamic,CoinBet:b.UInt64,NickName:b.StringDynamic,Type:b.UInt8,EarnCoin:b.UInt64,UserID:b.UInt32}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTopBigWin: "+JSON.stringify(a));if(0<this._datapage.length)for(b=
0;b<a.dataBigWin.length;b++)this._datapage.splice(0,0,a.dataBigWin[b]);else this._datapage=a.dataBigWin.splice(0,a.dataBigWin.length),this.compoPageNode.setDataSource(this._datapage)}});MGCaoThapPopupVinhDanh.EVENT={LOAD_PAGE:"Load_Page_VinhDanh"};var MGCaoThapItemLichSu=MGBaseNode.extend({panel:null,background:null,nickname:null,thoigian:null,muccuoc:null,tienthang:null,cuadat:null,result:null,buoc:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._init()},_init:function(){this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameCaoThap.UIItemLichSuTradeCaoThap,PreLoaderConfig.PathToResourceDefault).node);this.panel=this.getChildByName("Panel");this.background=this.panel.getChildByName("MGBackground");this.phien=this.panel.getChildByName("ItemPhien");
this.thoigian=this.panel.getChildByName("ItemTime");this.muccuoc=this.panel.getChildByName("ItemMucCuoc");this.tienthang=this.panel.getChildByName("ItemNhan");this.cuadat=this.panel.getChildByName("ItemCuaDat");this.result=this.panel.getChildByName("ItemResult");this.buoc=this.panel.getChildByName("ItemBuoc")},setBackGround:function(a){1===a%2?this.background.setVisible(!0):this.background.setVisible(!1)},setThoiGian:function(a){this.thoigian.setString(a)},setMucCuoc:function(a){a=Utilities.Coin(a);
this.muccuoc.setString(a)},setTienThang:function(a){a=Utilities.Coin(a);this.tienthang.setString(a)},setCuaDat:function(a){0>a?(this.cuadat.setString(" "),this.cuadat.setColor({r:255,g:255,b:255})):(this.cuadat.setString(0==a?"Dưới":"Trên"),this.cuadat.setColor(0==a?{r:92,g:208,b:218}:{r:28,g:255,b:0}))},setPhien:function(a){this.phien.setString(a)},setBuoc:function(a){this.buoc.setString(a)},setResult:function(a){this.result.getChildByName("ItemPoint").setString(a.Card);this.result.getChildByName("ItemSuit").setString(MGCaoThapCompoHubText.COLOR_SYMBOl[a.Color])}});var MGCaoThapPopupLichSu=MGMoveablePopup.extend({mainNode:null,buttonClose:null,_panelGiaoDich:null,compoPageNode:null,_datapage:null,_showed:null,ctor:function(a){MGMoveablePopup.prototype.ctor.call(this);this.mainNode=a;this._datapage=[];this._showed=!1},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this.initUI();this.initEvent()},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGCaoThapPopupLichSu.EVENT.LOAD_PAGE.toString(),
this.onLoadPage.bind(this)))},initUI:function(){this.setMoveInfo(this.getChildByName("MGBackground"));this.buttonClose=this.getChildByName("MGButtonClose");this._panelGiaoDich=this.getChildByName("panelGiaoDich");this.compoPageNode=new MGCaoThapPageNode;this.compoPageNode.setKeyDispactchEvent(MGCaoThapPopupLichSu.EVENT.LOAD_PAGE);this.compoPageNode.initObj(this.getChildByName("PageNum"),10,50);this.compoPageNode.setDelegate(this);this.compoPageNode.setDataSource(this._datapage);this.addChild(this.compoPageNode);
this.buttonClose.addClickEventListener(function(a){this.hide()}.bind(this))},showLichSu:function(){this._showed||(this._showed=!0,this.compoPageNode.changePage(this.compoPageNode.getCurrentPage()));this.setVisible(!0)},onLoadPage:function(a){a=a.getUserData();this.compoPageNode.showPageHistory(a.value)},addLichSu:function(a){this._datapage.splice(0,0,a);50<this._datapage.length&&this._datapage.pop();this._showed&&this.compoPageNode.changePage(this.compoPageNode.getCurrentPage())},loadPage:function(a){this._panelGiaoDich.removeAllItems();
var b=[],d=this._datapage.length>=10*(a-1)+10?10*(a-1)+10:this._datapage.length;for(a=10*(a-1);a<d;a++)b.push(this._datapage[a]);for(a=0;a<b.length;a++)d=new MGCaoThapItemLichSu,d.setBackGround(a),d.setPhien(b[a].Phien),d.setThoiGian(b[a].CreatedTime),d.setMucCuoc(b[a].CoinBet),d.setTienThang(b[a].EarnCoin),d.setCuaDat(b[a].CuaDat),d.setBuoc(b[a].Buoc),d.setResult(b[a].Result),d.panel.removeFromParent(),this._panelGiaoDich.pushBackCustomItem(d.panel)},changeValueLastItem:function(a){0<this._datapage.length&&
(this._datapage[0].EarnCoin=a,0<this._panelGiaoDich.getItems().length&&this._panelGiaoDich.getItems()[0].getChildByName("ItemNhan").setString(Utilities.Coin(a)))},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});MGCaoThapPopupLichSu.EVENT={LOAD_PAGE:"Load_Page_LichSu"};ResourceManager.MGResourcesVongQuayMayMan={UIMGVQMMBigItemIn:"res/game/minigame/vongquaymayman/UIMGVQMMBigItemIn.json",UIMGVQMMSmallItemIn:"res/game/minigame/vongquaymayman/UIMGVQMMSmallItemIn.json",UIMGVQMMBigItemOut:"res/game/minigame/vongquaymayman/UIMGVQMMBigItemOut.json",UIMGVQMMSmallItemOut:"res/game/minigame/vongquaymayman/UIMGVQMMSmallItemOut.json",UIMGVQMMCompoBigRound:"res/game/minigame/vongquaymayman/UIMGVQMMCompoBigRound.json",UIMGVQMMCompoSmallRound:"res/game/minigame/vongquaymayman/UIMGVQMMCompoSmallRound.json",
UIMGVQMMCompoButton:"res/game/minigame/vongquaymayman/UIMGVQMMCompoButton.json",UIMGVongQuayMayManLayer:"res/game/minigame/vongquaymayman/UIMGVongQuayMayManLayer.json",UIMGVQMMCompoLichSuTrade:"res/game/minigame/vongquaymayman/UIMGVQMMCompoLichSuTrade.json",UIMGVQMMItemLichSuTrade:"res/game/minigame/vongquaymayman/UIMGVQMMItemLichSuTrade.json",UIMGVQMMItemSelectPage:"res/game/minigame/vongquaymayman/UIMGVQMMItemSelectPage.json",UIMGUIVQMMPNG:"res/game/minigame/vongquaymayman/atlas/AtlasVongQuayMayMan.png",
UIMGUIVQMMPLIST:"res/game/minigame/vongquaymayman/atlas/AtlasVongQuayMayMan.plist"};var resourcesGameVongQuayMayMan=[];for(i in ResourceManager.MGResourcesVongQuayMayMan)ResourceManager.MGResourcesVongQuayMayMan[i]=""+cc.loader.resPath+ResourceManager.MGResourcesVongQuayMayMan[i],resourcesGameVongQuayMayMan.push(ResourceManager.MGResourcesVongQuayMayMan[i]);ConstantsVariable.NETWORK_MINIGAME_VQMM={GameData:2701,StartGame:4003,Result:4004};ConstantsVariable.STATE_MINIGAME_VQMM={WAITING_BET_TIME_OUT:0,CALCULATE_RESULT:1,FINISH_GAME:2,NOT_PLAYING:3,WATCH_RESULT:4};var MGNetSendVQMM=cc.Class.extend({gameModuleID:null,ctor:function(){},sendQuay:function(a){Utilities.getAPIAfterLogin("event","spinevent",{},a,!0)},getAPIGameData:function(a){Utilities.getAPIAfterLogin("event","loadevent",{},a,!0)},getAPIHistory:function(a,b){var d={};d.PageNum=a;d.PageSize=50;Utilities.getAPIAfterLogin("event","gethistoryspinevent",d,b,!0)}});var MGVQMMPopupNotice=MGBaseNode.extend({buttonClose:null,lbMessage:null,_node:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this._node=a;a.getChildByName("MGBackground").setTouchEnabled(!0);a.getChildByName("MGBackground").setSwallowTouches(!0);this.buttonClose=a.getChildByName("MGButtonClose");this.buttonClose.addClickEventListener(function(a){this._node.setVisible(!1)}.bind(this));this.lbMessage=a.getChildByName("MGTextMessage")},
showPopup:function(a){this._node.setVisible(!0);this.lbMessage.setString(a)}});var MGVQMMPageNode=MGBaseNode.extend({_delegate:null,_dataSource:null,_arrPageH:null,_totalPage:null,_itemPerPage:null,_pageLength:null,_currentPage:null,_pos:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._arrPageH=[];this._pageLength=this._itemPerPage=this._totalPage=0;this._currentPage=1;this._delegate=null},initObj:function(a,b,d){this._pos=a.getPosition();this._itemPerPage=b;this._pageLength=d/b;this._initPage(this._pageLength)},setDelegate:function(a){this._delegate=a},setDataSource:function(a){this._dataSource=
a},_initPage:function(a){for(var b=null,d=0;d<a;d++)b=new MGVQMMItemPage,b.initObj(),b.setText(d+1),b.setValue(d+1),b.setVisiblePage(!1),this.addChild(b),this._arrPageH.push(b);a=this._pos;b=new MGVQMMItemPage;b.initObj();b.setText(">");b.setValue(111);b.setVisiblePage(!1);b.setPosition(a.x+2*MGVQMMPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);b=new MGVQMMItemPage;b.initObj();b.setText(">>");b.setValue(112);b.setVisiblePage(!1);b.setPosition(a.x+3*MGVQMMPageNode.BUTTON_GAP,a.y);
this.addChild(b);this._arrPageH.push(b);b=new MGVQMMItemPage;b.initObj();b.setText("<<");b.setValue(113);b.setVisiblePage(!1);b.setPosition(a.x-4*MGVQMMPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);b=new MGVQMMItemPage;b.initObj();b.setText("<");b.setValue(114);b.setVisiblePage(!1);b.setPosition(a.x-3*MGVQMMPageNode.BUTTON_GAP,a.y);this.addChild(b);this._arrPageH.push(b);0!==this._arrPageH.length&&(this._arrPageH[0].setBackground(!0),this._arrPageH[0].onPage=1)},showPageHistory:function(a){111>
a?this.changePage(a):(111===a&&this.nextPage(),112===a&&this.endPage(),113===a&&this.beganPage(),114===a&&this.previousPage())},changePage:function(a){this._totalPage=Math.ceil(this._dataSource.length/this._itemPerPage);for(var b=0;b<this._arrPageH.length;b++)if(1===this._arrPageH[b].onPage&&(this._arrPageH[b].setBackground(!1),this._arrPageH[b].onPage=0),b<this._totalPage&&4>=this._totalPage&&1<this._totalPage)this._arrPageH[b].setVisiblePage(!0);else if(b<this._totalPage&&4<this._totalPage&&1===
this._currentPage)for(var d=0;4>d;d++)this._arrPageH[d].setVisiblePage(!0);for(b=0;b<this._totalPage;b++)if(this._arrPageH[b].value===a)return this._arrPageH[b].setBackground(!0),this._arrPageH[b].onPage=1,4<this._totalPage&&(0===b?(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0)):b===this._arrPageH.length-5?(this._arrPageH[this._arrPageH.length-
1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1)):(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0))),this.changeToPage(this._arrPageH[b].value),(4>=this._totalPage||
4<this._totalPage&&1===this._currentPage)&&this.allignPage(),!0},allignPage:function(){var a=Math.ceil(this._dataSource.length/this._itemPerPage);this._totalPage=a;for(var b=this._pos,d=null,e=0;e<a;e++)d=this._arrPageH[e],1>=a?d.setPosition(b.x,b.y):2>=a?d.setPosition(b.x-MGVQMMPageNode.BUTTON_GAP+e*MGVQMMPageNode.BUTTON_GAP,b.y):3>=a?d.setPosition(b.x-MGVQMMPageNode.BUTTON_GAP+e*MGVQMMPageNode.BUTTON_GAP,b.y):d.setPosition(b.x-2*MGVQMMPageNode.BUTTON_GAP+e*MGVQMMPageNode.BUTTON_GAP,b.y)},nextPage:function(){for(var a=
0,b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(a=b);if(0===this._arrPageH[a+1].onVisible){var d=this._pos;this._arrPageH[a-3].setVisiblePage(!1);for(b=0;4>b;b++)this._arrPageH[a-2+b].setVisiblePage(!0),this._arrPageH[a-2+b].setPosition(d.x-2*MGVQMMPageNode.BUTTON_GAP+b*MGVQMMPageNode.BUTTON_GAP,d.y)}if(11>this._arrPageH[a+1].value)return this._arrPageH[a].setBackground(!1),this._arrPageH[a+1].setBackground(!0),this._arrPageH[a].onPage=0,this._arrPageH[a+1].onPage=1,this._arrPageH[this._arrPageH.length-
1].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0),this._arrPageH.length-5===a+1&&(this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1)),this.changeToPage(this._arrPageH[a+1].value),!0},previousPage:function(){for(var a=0,b=0;b<this._arrPageH.length;b++)1===this._arrPageH[b].onPage&&(a=b);if(0===this._arrPageH[a-1].onVisible){var d=this._pos;this._arrPageH[a+3].setVisiblePage(!1);for(b=0;4>b;b++)this._arrPageH[a-
1+b].setVisiblePage(!0),this._arrPageH[a-1+b].setPosition(d.x-2*MGVQMMPageNode.BUTTON_GAP+b*MGVQMMPageNode.BUTTON_GAP,d.y)}11>this._arrPageH[a-1].value&&(this._arrPageH[a].setBackground(!1),this._arrPageH[a-1].setBackground(!0),this._arrPageH[a].onPage=0,this._arrPageH[a-1].onPage=1,this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0),this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0),0===a-1&&(this._arrPageH[this._arrPageH.length-1].setVisiblePage(!1),this._arrPageH[this._arrPageH.length-
2].setVisiblePage(!1)),this.changeToPage(this._arrPageH[a-1].value))},beganPage:function(){for(var a=0;a<this._arrPageH.length;a++)1===this._arrPageH[a].onPage&&(this._arrPageH[a].setBackground(!1),this._arrPageH[a].onPage=0);for(a=0;a<this._arrPageH.length-4;a++)this._arrPageH[a].setVisiblePage(!1);for(a=0;4>a;a++){var b=this._pos;this._arrPageH[a].setVisiblePage(!0);this._arrPageH[a].setPosition(b.x-2*MGVQMMPageNode.BUTTON_GAP+a*MGVQMMPageNode.BUTTON_GAP,b.y)}this._arrPageH[this._arrPageH.length-
1].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-2].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-3].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-4].setVisiblePage(!0);this._arrPageH[0].onPage=1;this._arrPageH[0].setBackground(!0);this.changeToPage(this._arrPageH[0].value)},endPage:function(){for(var a=0;a<this._arrPageH.length;a++)1===this._arrPageH[a].onPage&&(this._arrPageH[a].setBackground(!1),this._arrPageH[a].onPage=0);for(var b=0;b<this._arrPageH.length-4;b++)this._arrPageH[b].setVisiblePage(!1);
a=0;for(b=this._arrPageH.length-8;b<this._arrPageH.length-4;b++){var d=this._pos;this._arrPageH[b].setVisiblePage(!0);this._arrPageH[b].setPosition(d.x-2*MGVQMMPageNode.BUTTON_GAP+a*MGVQMMPageNode.BUTTON_GAP,d.y);a++}this._arrPageH[this._arrPageH.length-1].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-2].setVisiblePage(!0);this._arrPageH[this._arrPageH.length-3].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-4].setVisiblePage(!1);this._arrPageH[this._arrPageH.length-5].onPage=1;
this._arrPageH[this._arrPageH.length-5].setBackground(!0);this.changeToPage(this._arrPageH[this._arrPageH.length-5].value)},changeToPage:function(a){this._currentPage=a;this._delegate&&this._delegate.loadPage(a)},getCurrentPage:function(){return this._currentPage},removePage:function(){this._panelGiaoDich.removeAllItems();for(var a=0;a<this._arrPageH.length;a++)this._arrPageH[a].setVisiblePage(!1);this._arrPageH=[]}});MGVQMMPageNode.BUTTON_GAP=50;var MGVQMMItemPage=MGBaseNode.extend({textPage:null,onVisible:null,value:null,onPage:-1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){this.cloneFromNode(ccs.load(ResourceManager.MGResourcesVongQuayMayMan.UIMGVQMMItemSelectPage,PreLoaderConfig.PathToResourceDefault).node);this.buttonPage=this.getChildByName("buttonPage");this.backgroundPage=this.getChildByName("buttonPage").getChildByName("backGroundSelect");this.textPage=this.getChildByName("buttonPage").getChildByName("txtPageNum");
this.setBackground(!1);this.setVisiblePage(!0);this._initEventsGame()},_initEventsGame:function(){MGBaseNode.prototype._initEventsGame.call(this);this.buttonPage.addClickEventListener(this.changePageHistory.bind(this))},setBackground:function(a){!0===a?this.backgroundPage.setVisible(!0):this.backgroundPage.setVisible(!1)},setVisiblePage:function(a){!0===a?(this.setVisible(!0),this.onVisible=1):(this.setVisible(!1),this.onVisible=0)},setText:function(a){this.textPage.setString(a)},setValue:function(a){this.value=
a},changePageHistory:function(a){cc.eventManager.dispatchCustomEvent(MGVQMMCompoLichSu.EVENT.LOAD_PAGE,this)}});var MGVQMMItemLichSu=MGBaseNode.extend({panel:null,background:null,phien:null,thoigian:null,vongVN:null,vongXu:null,vongSlot:null,ctor:function(){MGBaseNode.prototype.ctor.call(this);this._init()},_init:function(){this.cloneFromNode(ccs.load(ResourceManager.MGResourcesVongQuayMayMan.UIMGVQMMItemLichSuTrade,PreLoaderConfig.PathToResourceDefault).node);this.panel=this.getChildByName("Panel");this.background=this.panel.getChildByName("MGBackground");this.phien=this.panel.getChildByName("ItemPhien");
this.thoigian=this.panel.getChildByName("ItemTime");this.vongVN=this.panel.getChildByName("ItemVongVN");this.vongXu=this.panel.getChildByName("ItemVongXu");this.vongSlot=this.panel.getChildByName("ItemVongSlot")},setBackGround:function(a){1===a%2?this.background.setVisible(!0):this.background.setVisible(!1)},setPhien:function(a){this.phien.setString(a)},setThoiGian:function(a){this.thoigian.setString(a)},setVongVN:function(a){this.vongVN.setString(a)},setVongXu:function(a){this.vongXu.setString(a)},
setVongSlot:function(a){this.vongSlot.setString(a)}});var MGVQMMCompoLichSu=MGMoveablePopup.extend({mainNode:null,buttonClose:null,_panelGiaoDich:null,compoPageNode:null,_datapage:null,ctor:function(a){MGMoveablePopup.prototype.ctor.call(this);this.mainNode=a;this._datapage=[]},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this.initUI();this.initEvent()},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(MGVQMMCompoLichSu.EVENT.LOAD_PAGE.toString(),this.onLoadPage.bind(this)))},initUI:function(){this.setMoveInfo(this.getChildByName("MGBackground"));
this.buttonClose=this.getChildByName("MGButtonClose");this._panelGiaoDich=this.getChildByName("panelGiaoDich");this.compoPageNode=new MGVQMMPageNode;this.compoPageNode.initObj(this.getChildByName("PageNum"),10,50);this.compoPageNode.setDelegate(this);this.compoPageNode.setDataSource(this._datapage);this.addChild(this.compoPageNode);this.buttonClose.addClickEventListener(function(a){this.hide()}.bind(this))},showLichSu:function(){for(var a=0;a<this._datapage.length;a++)this._datapage.pop();this._datapage=
[];this.compoPageNode.setDataSource(this._datapage);this.sendGetHistory(1);this.setVisible(!0)},onLoadPage:function(a){a=a.getUserData();this.compoPageNode.showPageHistory(a.value)},loadPage:function(a){this._panelGiaoDich.removeAllItems();var b=[],d=this._datapage.length>=10*(a-1)+10?10*(a-1)+10:this._datapage.length;for(a=10*(a-1);a<d;a++)b.push(this._datapage[a]);for(a=0;a<b.length;a++)d=new MGVQMMItemLichSu,d.setBackGround(a),d.setPhien(b[a].id),d.setThoiGian(b[a].createDate),d.setVongVN(b[a].description),
d.panel.removeFromParent(),this._panelGiaoDich.pushBackCustomItem(d.panel)},sendGetHistory:function(a){this.mainNode.mainGame.netSend.getAPIHistory(a,this.onGetAPIHistory.bind(this))},onGetAPIHistory:function(a){1==a.result&&(this.parseHistoryData(a),this.compoPageNode.changePage(this.compoPageNode.getCurrentPage()))},parseHistoryData:function(a){for(var b=0;b<a.data.length;b++)this._datapage.push(a.data[b])},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});
MGVQMMCompoLichSu.EVENT={LOAD_PAGE:"Load_Page"};var MGVQMMCompoBigRound=MGBaseNode.extend({mainNode:null,outRound:null,inRound:null,_lastIDResultOut:0,_lastIDResultIn:0,_background:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainNode=a;this._lastIDResultOut=this._lastIDResultIn=0},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.outRound=a.getChildByName("MGVongNgoai");this.outRound.setRotation(15);this.inRound=a.getChildByName("MGVongTrong");this.inRound.setRotation(22.5);this._background=this.outRound.getChildByName("MGBackground")},
loadItemsData:function(a){for(var b=0;b<a[0].length;b++){var d=this.outRound.getChildByName("Item"+b),e=.25*this._background.getContentSize().width*Math.sin((-30*b-15)*Math.PI/180),f=.25*this._background.getContentSize().width*Math.cos((-30*b-15)*Math.PI/180);d.setPosition(cc.p(e,f));cc.loader.loadImg(a[0][b].image,{isCrossOrigin:!0},this._onLoadImgComplete.bind(this,d.getChildByName("MGValueIcon")))}for(b=0;b<a[1].length;b++)d=this.inRound.getChildByName("Item"+b),d.getChildByName("MGTextValue").setString(a[1][b].description.toUpperCase()),
0===a[1][b].value?d.getChildByName("MGTextValue").setColor(cc.color("#3ef015")):5E4>=a[1][b].value?d.getChildByName("MGTextValue").setColor(cc.color("#ffffff")):d.getChildByName("MGTextValue").setColor(cc.color("#ffd60d"))},_onLoadImgComplete:function(a,b,d){d&&(b=new cc.Sprite(d),a.setContentSize(b.getContentSize()),a.setTexture(b.getTexture()),a.setVisible(!0))},setRound:function(a){this.outRound.stopAllActions();this.inRound.stopAllActions();this.setHighLight(this.outRound,this._lastIDResultOut,
!1);this.setHighLight(this.inRound,this._lastIDResultIn,!1);var b=this.processResultOut(a[0].itemId-1);this.outRound.runAction(cc.sequence(cc.rotateBy(.3,-60).easing(cc.easeOut(1)),cc.rotateBy(1,1440).easing(cc.easeInOut(1.5)),cc.rotateBy(1,720).easing(cc.easeOut(1.2)),cc.rotateBy(4.7,420+b).easing(cc.easeOut(3.5)),cc.callFunc(function(){this.setHighLight(this.outRound,a[0].itemId-1,!0)}.bind(this))));this._lastIDResultOut=a[0].itemId-1;b=this.processResultIn(a[1].itemId-1);this.inRound.runAction(cc.sequence(cc.rotateBy(.3,
-60).easing(cc.easeOut(1)),cc.rotateBy(1,1440).easing(cc.easeInOut(1.5)),cc.rotateBy(1,720).easing(cc.easeOut(1.4)),cc.rotateBy(5.7,420+b).easing(cc.easeOut(4.5)),cc.callFunc(function(){this.setHighLight(this.inRound,a[1].itemId-1,!0);this.mainNode.compoLight.setIdleLightBigEffect()}.bind(this))));this._lastIDResultIn=a[1].itemId-1},setHighLight:function(a,b,d){a=a.getChildByName("Item"+b).getChildByName("MGHighlight");a.setVisible(d);a.stopAllActions();d&&a.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.25),
cc.fadeOut(.5))))},processResultOut:function(a){return 30*(a-this._lastIDResultOut)},processResultIn:function(a){return 45*(a-this._lastIDResultIn)}});var MGVQMMCompoSmallRound=MGBaseNode.extend({mainNode:null,vongQuay:null,luotQuay:null,_lastIDResult:0,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainNode=a;this._lastIDResult=0},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.vongQuay=a.getChildByName("MGVongQuay");this.luotQuay=a.getChildByName("MGTextLuotQuay");this.vongQuay.setRotation(22.5)},loadItemsData:function(a){for(var b=0;b<a.length;b++){var d=this.vongQuay.getChildByName("Item"+b);cc.loader.loadImg(a[b].image,
{isCrossOrigin:!0},this._onLoadImgComplete.bind(this,d.getChildByName("MGValueIcon")));d=this.vongQuay.getChildByName("Item0"+b);d.getChildByName("MGTextValue").setString(a[b].description.toUpperCase());0===a[b].value?d.getChildByName("MGTextValue").setColor(cc.color("#3ef015")):5E4>=a[b].value?d.getChildByName("MGTextValue").setColor(cc.color("#ffffff")):d.getChildByName("MGTextValue").setColor(cc.color("#ffd60d"))}},_onLoadImgComplete:function(a,b,d){d&&(b=new cc.Sprite(d),a.setContentSize(b.getContentSize()),
a.setTexture(b.getTexture()),a.setVisible(!0))},setLuotQuay:function(a){this.luotQuay.setString(a)},setRound:function(a){this.vongQuay.stopAllActions();this.setHighLight(this.vongQuay,this._lastIDResult,!1);var b=this.processResult(a.itemId-1);this.vongQuay.runAction(cc.sequence(cc.rotateBy(.3,60).easing(cc.easeOut(1)),cc.rotateBy(1,-1440).easing(cc.easeInOut(1.5)),cc.rotateBy(1,-720).easing(cc.easeOut(1.2)),cc.rotateBy(4.7,-420-b).easing(cc.easeOut(3.5)),cc.callFunc(function(){this.setHighLight(this.vongQuay,
a.itemId-1,!0);this.mainNode.compoLight.setIdleLightSmallEffect()}.bind(this))));this._lastIDResult=a.itemId-1},setHighLight:function(a,b,d){var e=a.getChildByName("Item"+b).getChildByName("MGHighlight");e.setVisible(d);e.stopAllActions();a=a.getChildByName("Item0"+b).getChildByName("MGHighlight");a.setVisible(d);a.stopAllActions();d&&(e.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.25),cc.fadeOut(.5)))),a.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.25),cc.fadeOut(.5)))))},processResult:function(a){return 45*
(a-this._lastIDResult)}});var MGVQMMCompoLight=MGBaseNode.extend({mainNode:null,listLightLon:null,listLightNho:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainNode=a;this.listLightLon=[];this.listLightNho=[]},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.listLightLon=a.getChildByName("MGCompoLightBig");this.listLightNho=a.getChildByName("MGCompoLightSmall");this.setIdleLightBigEffect();this.setIdleLightSmallEffect()},setIdleLightBigEffect:function(){for(var a=this.listLightLon.getChildren(),
b=0;b<a.length;b++)a[b].stopAllActions(),a[b].runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(a){a.setSpriteFrame("vqmm_light1.png")}.bind(this,a[b])),cc.delayTime(.5),cc.callFunc(function(a){a.setSpriteFrame("vqmm_light2.png")}.bind(this,a[b])),cc.delayTime(.5))))},playLightEffect:function(){for(var a=this.listLightLon.getChildren(),b=a.length-1;0<=b;b--)a[b].stopAllActions(),a[b].runAction(cc.sequence(cc.delayTime(.05*(a.length-1-b)),cc.repeat(cc.sequence(cc.callFunc(function(a){a.setSpriteFrame("vqmm_light1.png")}.bind(this,
a[b])),cc.delayTime(.4),cc.callFunc(function(a){a.setSpriteFrame("vqmm_light2.png")}.bind(this,a[b])),cc.delayTime(.4)),1E3)));a=this.listLightNho.getChildren();for(b=0;b<a.length;b++)a[b].stopAllActions(),a[b].runAction(cc.sequence(cc.delayTime(.05*b),cc.repeat(cc.sequence(cc.callFunc(function(a){a.setSpriteFrame("vqmm_light1.png")}.bind(this,a[b])),cc.delayTime(.4),cc.callFunc(function(a){a.setSpriteFrame("vqmm_light2.png")}.bind(this,a[b])),cc.delayTime(.4)),1E3)))},setIdleLightSmallEffect:function(){for(var a=
this.listLightNho.getChildren(),b=0;b<a.length;b++)a[b].stopAllActions(),a[b].runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(a){a.setSpriteFrame("vqmm_light1.png")}.bind(this,a[b])),cc.delayTime(.5),cc.callFunc(function(a){a.setSpriteFrame("vqmm_light2.png")}.bind(this,a[b])),cc.delayTime(.5))))}});var MGVQMMCompoButton=MGBaseNode.extend({mainGame:null,buttonQuay:null,buttonClose:null,buttonLichSu:null,buttonHuongDan:null,ctor:function(a){MGBaseNode.prototype.ctor.call(this);this.mainGame=a},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.buttonQuay=a.getChildByName("MGButtonQuay");this.buttonQuay.addClickEventListener(function(a){this.mainGame.sendQuay();this.setEnableButtonQuay(!1)}.bind(this));this.buttonClose=a.getChildByName("MGButtonClose");this.buttonClose.addClickEventListener(function(a){this.mainGame.closeGame()}.bind(this));
this.buttonLichSu=a.getChildByName("MGButtonLichSu");this.buttonLichSu.addClickEventListener(function(a){this.mainGame.mainGameNode.showLichSu()}.bind(this));this.buttonHuongDan=a.getChildByName("MGButtonHuongDan");this.buttonHuongDan.addClickEventListener(function(a){cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{layerID:MGLayerPopupRules.LAYER.VQMM})}.bind(this))},setEnableButtonQuay:function(a){this.buttonQuay.setEnabled(a)}});var MGVQMMMainGameNode=MGMoveablePopup.extend({mainGame:null,compoButton:null,compoLight:null,compoBigRound:null,compoSmallRound:null,compoLichSu:null,popupNotice:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(a){MGMoveablePopup.prototype.initObj.call(this);this.mainGame=a;this.initUI();this.initCompoButton();this.initCompoLight();this.initCompoBigRound();this.initCompoSmallRound();this.initCompoLichSu();this.initPopupNotice()},initUI:function(){this.setMoveInfo(this.getChildByName("MGBackgroundBigRound"));
this.addMoveElement(this.getChildByName("MGBackgroundSmallRound"));this.addMoveElement(this.getChildByName("MGTitle"))},initCompoButton:function(){this.compoButton=new MGVQMMCompoButton(this.mainGame);this.compoButton.initObj(this.getChildByName("MGCompoButton"))},initCompoLight:function(){this.compoLight=new MGVQMMCompoLight(this);this.compoLight.initObj(this.getChildByName("MGCompoLight"))},initCompoBigRound:function(){this.compoBigRound=new MGVQMMCompoBigRound(this);this.compoBigRound.initObj(this.getChildByName("MGCompoBigRound"))},
initCompoSmallRound:function(){this.compoSmallRound=new MGVQMMCompoSmallRound(this);this.compoSmallRound.initObj(this.getChildByName("MGCompoSmallRound"))},initCompoLichSu:function(){this.compoLichSu=new MGVQMMCompoLichSu(this);this.compoLichSu.cloneFromNode(this.getChildByName("MGCompoLichSu"));this.compoLichSu.initObj();this.addChild(this.compoLichSu)},initPopupNotice:function(){this.popupNotice=new MGVQMMPopupNotice(this);this.popupNotice.initObj(this.getChildByName("MGPopupNotice"))},loadItemsData:function(a){this.compoSmallRound.loadItemsData(a.SmallRound);
this.compoBigRound.loadItemsData(a.BigRound);this.compoSmallRound.setLuotQuay(a.LuotQuay)},setRound:function(a){this.compoBigRound.setRound(a.BigRoundWin);this.compoSmallRound.setRound(a.SmallRoundWin);this.compoLight.playLightEffect()},showLichSu:function(){this.compoLichSu.showLichSu()},showPopupNotice:function(a){this.popupNotice.showPopup(a)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this)}});var MGVongQuayMayMan=MGBaseGame.extend({netSend:null,mainGameNode:null,_luotQuay:0,_contentLichSu:null,_gameData:null,_phien:null,ctor:function(){MGBaseGame.prototype.ctor.call(this);this.resourceGame=resourcesGameVongQuayMayMan;this.netSend=new MGNetSendVQMM},initObj:function(){MGBaseGame.prototype.initObj.call(this);this._contentLichSu={};this._phien=1E4;this.initUI();this.initMainGameNode();this.initEvent();this.initGameData()},initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesVongQuayMayMan.UIMGVongQuayMayManLayer,
PreLoaderConfig.PathToResourceDefault)},initEvent:function(){this._initEventsGame();this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_MINIGAME_VQMM.StartGame.toString(),this.ngStartGame.bind(this)))},initMainGameNode:function(){this.mainGameNode=new MGVQMMMainGameNode;this.mainGameNode.cloneFromNode(this._mainLayer);this.mainGameNode.initObj(this);this.addChild(this.mainGameNode)},ngStartGame:function(a){this.mainGameNode.compoSmallRound.setLuotQuay(this._luotQuay);
MGGameInfo.myInfo.Gold=this._contentLichSu.Gold;cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.HEADER_UPDATE_USER_INFO,{});this.scheduleOnce(function(){this.mainGameNode.showPopupNotice(this._contentLichSu.notice);0<this._luotQuay&&this.mainGameNode.compoButton.setEnableButtonQuay(!0)}.bind(this),.5)},initGameData:function(){this.netSend.getAPIGameData(this.onGetAPIGameData.bind(this))},parseDataGame:function(a){if(null===a.data||void 0===a.data.listItem)return!1;var b={SmallRound:[],
BigRound:[[],[]],LuotQuay:0};a.data.listItem.filter(function(a,b,f,g){1===b.spinId&&a.SmallRound.push(b)}.bind(this,b));a.data.listItem.filter(function(a,b,f,g){2===b.spinId&&a.BigRound[0].push(b)}.bind(this,b));a.data.listItem.filter(function(a,b,f,g){3===b.spinId&&a.BigRound[1].push(b)}.bind(this,b));b.LuotQuay=a.data.remainCode;this._luotQuay=b.LuotQuay;this._gameData=b;return!0},parseResult:function(a,b){if(void 0===a)return!1;a.filter(function(a,b,f,g){1===b.spinId&&(a.SmallRoundWin=b)}.bind(this,
b));a.filter(function(a,b,f,g){2===b.spinId&&a.BigRoundWin.push(b)}.bind(this,b));a.filter(function(a,b,f,g){3===b.spinId&&a.BigRoundWin.push(b)}.bind(this,b));return!0},onGetAPIGameData:function(a){1==a.result?(a=this.parseDataGame(a),this.loadItemsData(this._gameData),a&&this.mainGameNode.compoButton.setEnableButtonQuay(!0)):this.closeGame()},sendQuay:function(){this.netSend.sendQuay(this.onGetResult.bind(this))},onGetResult:function(a){if(1==a.result){var b={BigRoundWin:[],SmallRoundWin:null};
null!==a.data&&this.parseResult(a.data.itemWin,b)&&(this.mainGameNode.compoSmallRound.setLuotQuay(this._luotQuay-1),this._luotQuay=a.data.remainCode,this.mainGameNode.setRound(b),this._contentLichSu.notice=a.data.message,this._contentLichSu.Gold=a.data.currentCoin,this.scheduleOnce(function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK_MINIGAME_VQMM.StartGame,null)}.bind(this),8))}else this.mainGameNode.compoButton.setEnableButtonQuay(!0)},loadItemsData:function(a){this.mainGameNode.loadItemsData(a)},
closeGame:function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LEAVE_WEB_GAME,{GameID:PreLoaderConfig.IDMiniVQMM})},setDispose:function(){MGBaseGame.prototype.setDispose.call(this);this.mainGameNode.setDispose();this.unscheduleAllCallbacks()}});ResourceManager.MGResourcesGameDaoMo={UIMGUIDaoMoJSON:"res/game/minigame/daoMo/MGDaoMo.json",UIMGUIDMHistoryJSON:"res/game/minigame/daoMo/MGDMHistory.json",UIMGUIDMTopWinJSON:"res/game/minigame/daoMo/MGDMTopWin.json",UIMGUIDMNodeHistoryJSON:"res/game/minigame/daoMo/MGDMNodeHistory.json",UIMGUIDMNodeTopWinJSON:"res/game/minigame/daoMo/MGDMNodeTopWin.json",FontBD:"res/Fonts/arialbd.ttf"};var resourcesDaoMo=[];
if(cc.sys.isNative){for(i in ResourceManager.MGResourcesGameXengAladinPreloadMobile)ResourceManager.MGResourcesGameXengAladinPreloadMobile[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAladinPreloadMobile[i],resourcesXengAladin.push(ResourceManager.MGResourcesGameXengAladinPreloadMobile[i]);for(i in ResourceManager.MGResourcesGameXengAladin)ResourceManager.MGResourcesGameXengAladin[i]=""+cc.loader.resPath+ResourceManager.MGResourcesGameXengAladin[i]}else for(i in ResourceManager.MGResourcesGameDaoMo)ResourceManager.MGResourcesGameDaoMo[i]=
""+cc.loader.resPath+ResourceManager.MGResourcesGameDaoMo[i],resourcesDaoMo.push(ResourceManager.MGResourcesGameDaoMo[i]);ConstantsVariable.NETWORK_DAO_MO={StartGame:3700,ChoiceGameMini:3701,UserLeftDesk:3702,ListUser:3703,GameData:3704,ToolResult:3705,TopBigWin:3706,AccumulateBoxInfo:3707,ResultGameMini:3708,Turning:3709,StopTurning:3710,WinBigWin:3711,WinJackpot:3712};ConstantsVariable.STATE_DAO_MO={NOTHING:0,X1:1,X2:2,X5:5,X10:10,X50:50,X100:100,FREE:101,BIGWIN:102,JACKPOT:103};var MGNetSendDaoMo=cc.Class.extend({gameModuleID:null,maiGame:null,ctor:function(a){this.maiGame=a},sendLeaveDesk:function(){Utilities.showLog("sendLeaveDesk "+this.gameModuleID);var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK.LEAVE_DESK,null,null);MGNetCore.MGSocket.sendMsg(a)},sendVaoMo:function(a){Utilities.showLog("sendVaoMo "+a);var b={};b.CoinBet=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_DAO_MO.Turning,{CoinBet:BinaryConstants.DataTypeID.UInt64},
b);MGNetCore.MGSocket.sendMsg(a)},sendRaMo:function(){Utilities.showLog("sendRaMo ");var a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_DAO_MO.StopTurning,null,null);MGNetCore.MGSocket.sendMsg(a)},sendBet:function(a,b){var d={};d.Index=a;d=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_DAO_MO.ChoiceGameMini,{Index:BinaryConstants.DataTypeID.UInt8},d);MGNetCore.MGSocket.sendMsg(d);Utilities.showLog("sendBet "+a+" value "+b)},sendToolDaoMo:function(a){Utilities.showLog("--Tool Dao Mo");
var b={};b.ArrIcon=a;a=Message.buildMsgWithModule(this.gameModuleID,ConstantsVariable.NETWORK_DAO_MO.ToolResult,{ArrIcon:BinaryConstants.DataTypeID.Array8,ArrIcon_Type:BinaryConstants.DataTypeID.UInt8},b);MGNetCore.MGSocket.sendMsg(a)}});var MGDMCompoEffect=MGBaseNode.extend({effectNode:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this)},playBigWin:function(a){this.effectNode||this.initEffectNode();this.effectNode.playBigWinMiniGame(a)},playWinBonus:function(a){this.effectNode||this.initEffectNode();this.effectNode.playBonusMiniGame(a)},initEffectNode:function(){this.effectNode=new MGCompoEffectMiniGame;this.effectNode.initObj();this.addChild(this.effectNode)},setDispose:function(){MGBaseNode.prototype.setDispose.call(this);
this.effectNode&&this.effectNode.setDispose()}});var MGDMCompoHub=MGBaseNode.extend({mainGame:null,_listButton:null,textCurrentBet:null,textToTalBet:null,textBoxGold:null,textCon:null,isOutMo:!1,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initEventBtnFromNode();this.textCurrentBet=this.getChildByName("Text_LastWin");this.textCurrentBet.setString(0);this.textToTalBet=this.getChildByName("Text_TotalBet");this.textToTalBet.setString(0);this.textBoxGold=this.getChildByName("Text_MyGold");
this.textBoxGold.setString(0);this.textCon=this.getChildByName("Text_Con");this.textCon.setString(0)},updateCurrentWin:function(a){this.textCurrentBet.setString(Utilities.Coin(a))},updateTotalBet:function(a){this.textToTalBet.setString(Utilities.Coin(a))},updateBoxGold:function(a){this.textBoxGold.setString(Utilities.Coin(a))},updateCon:function(a){this.textCon.setString(Utilities.Coin(a))},showCanSelectValueBet:function(){this.hideButtonBet(MGDMCompoHub.BUTTON_NAME.BET_500)},showButtonVaoMo:function(){var a=
this.getChildByName(MGDMCompoHub.BUTTON_NAME.MINER);a.setEnabled(!0);a.setBright(!0)},hideButtonVaoMo:function(){this.getChildByName(MGDMCompoHub.BUTTON_NAME.MINER).setEnabled(!1)},_initEventBtnFromNode:function(){this._listButton=[];for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this._listButton.push(a[d]))},hideAllButtonBet:function(){this.disableButtonBet(MGDMCompoHub.BUTTON_NAME.BET_500);this.disableButtonBet(MGDMCompoHub.BUTTON_NAME.BET_1K);
this.disableButtonBet(MGDMCompoHub.BUTTON_NAME.BET_2K);this.disableButtonBet(MGDMCompoHub.BUTTON_NAME.BET_5K);this.disableButtonBet(MGDMCompoHub.BUTTON_NAME.BET_10K)},showAllButtonBet:function(){this.showButtonBet(MGDMCompoHub.BUTTON_NAME.BET_500);this.showButtonBet(MGDMCompoHub.BUTTON_NAME.BET_1K);this.showButtonBet(MGDMCompoHub.BUTTON_NAME.BET_2K);this.showButtonBet(MGDMCompoHub.BUTTON_NAME.BET_5K);this.showButtonBet(MGDMCompoHub.BUTTON_NAME.BET_10K)},lockAllButtonBet:function(){this.lockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_500);
this.lockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_1K);this.lockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_2K);this.lockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_5K);this.lockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_10K)},unLockAllButtonBet:function(){this.unLockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_500);this.unLockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_1K);this.unLockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_2K);this.unLockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_5K);this.unLockButtonBet(MGDMCompoHub.BUTTON_NAME.BET_10K)},
showButtonBet:function(a){var b=this.getChildByName(a);b.setEnabled(!0);b.setTitleColor(cc.color.BLACK);b.setTitleText("0");switch(a){case MGDMCompoHub.BUTTON_NAME.BET_500:b.setTitleText("500");break;case MGDMCompoHub.BUTTON_NAME.BET_1K:b.setTitleText("1K");break;case MGDMCompoHub.BUTTON_NAME.BET_2K:b.setTitleText("2K");break;case MGDMCompoHub.BUTTON_NAME.BET_5K:b.setTitleText("5K");break;case MGDMCompoHub.BUTTON_NAME.BET_10K:b.setTitleText("10K")}},lockButtonBet:function(a){this.getChildByName(a).setTouchEnabled(!1)},
unLockButtonBet:function(a){this.getChildByName(a).setTouchEnabled(!0)},disableButtonBet:function(a){this.getChildByName(a).setEnabled(!1)},hideButtonBet:function(a){this.showAllButtonBet();var b=this.getChildByName(a);b.setEnabled(!1);b.setTitleColor(cc.color.WHITE);b.setTitleText("0");switch(a){case MGDMCompoHub.BUTTON_NAME.BET_500:b.setTitleText("500");break;case MGDMCompoHub.BUTTON_NAME.BET_1K:b.setTitleText("1K");break;case MGDMCompoHub.BUTTON_NAME.BET_2K:b.setTitleText("2K");break;case MGDMCompoHub.BUTTON_NAME.BET_5K:b.setTitleText("5K");
break;case MGDMCompoHub.BUTTON_NAME.BET_10K:b.setTitleText("10K")}},handleVaoMo:function(){var a=this.getChildByName(MGDMCompoHub.BUTTON_NAME.MINER);this.isOutMo=!1;this.mainGame.sendRaMo();a.loadTextureNormal("bntMiner.png",ccui.Widget.PLIST_TEXTURE)},handleRaMo:function(){var a=this.getChildByName(MGDMCompoHub.BUTTON_NAME.MINER);this.isOutMo=!0;a.loadTextureNormal("bntOut.png",ccui.Widget.PLIST_TEXTURE)},handleWaitServer:function(){var a=this.getChildByName(MGDMCompoHub.BUTTON_NAME.MINER);a.stopAllActions();
a.setEnabled(!1);a.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){a.setEnabled(!0);a.loadTextureNormal("bntMiner.png",ccui.Widget.PLIST_TEXTURE);this.isOutMo=!1}.bind(this))))},onClickBtnFromCocostudio:function(a,b){Utilities.showLog("Button Click "+a.getName());var d=a.getTag();0==b&&0<=d&&24>=d&&Utilities.showLog(d);switch(a.getName()){case MGDMCompoHub.BUTTON_NAME.EXIT:0==b&&this.mainGame.closeGame();break;case MGDMCompoHub.BUTTON_NAME.HISTORY:0==b&&this.mainGame.showHistory();break;
case MGDMCompoHub.BUTTON_NAME.TUTORIAL:0==b&&cc.eventManager.dispatchCustomEvent(MG_POPUPS.SHOW_POPUP_RULES,{layerID:MGLayerPopupRules.LAYER.DAOMO});break;case MGDMCompoHub.BUTTON_NAME.TOP:0==b&&this.mainGame.showTopWin();break;case MGDMCompoHub.BUTTON_NAME.MINER:0==b&&(0==this.isOutMo?this.mainGame.sendVaoMo():(Utilities.showLog("RA MOOOOOOOOOOOOO"),this.isOutMo=!1,this.mainGame.sendRaMo(),a.loadTextureNormal("bntMiner.png",ccui.Widget.PLIST_TEXTURE)));break;case MGDMCompoHub.BUTTON_NAME.BET_500:0==
b&&(this.hideButtonBet(MGDMCompoHub.BUTTON_NAME.BET_500),this.mainGame.typeBet=0,this.mainGame.updateBoxGold(0));break;case MGDMCompoHub.BUTTON_NAME.BET_1K:0==b&&(this.hideButtonBet(MGDMCompoHub.BUTTON_NAME.BET_1K),this.mainGame.typeBet=1,this.mainGame.updateBoxGold(1));break;case MGDMCompoHub.BUTTON_NAME.BET_2K:0==b&&(this.hideButtonBet(MGDMCompoHub.BUTTON_NAME.BET_2K),this.mainGame.typeBet=2,this.mainGame.updateBoxGold(2));break;case MGDMCompoHub.BUTTON_NAME.BET_5K:0==b&&(this.hideButtonBet(MGDMCompoHub.BUTTON_NAME.BET_5K),
this.mainGame.typeBet=3,this.mainGame.updateBoxGold(3));break;case MGDMCompoHub.BUTTON_NAME.BET_10K:0==b&&(this.hideButtonBet(MGDMCompoHub.BUTTON_NAME.BET_10K),this.mainGame.typeBet=4,this.mainGame.updateBoxGold(4))}}});MGDMCompoHub.BUTTON_NAME={EXIT:"Button_Close",BET_500:"Button_500",BET_1K:"Button_1K",BET_2K:"Button_2K",BET_5K:"Button_5K",BET_10K:"Button_10K",HISTORY:"Button_About",MINER:"Button_Miner",TOP:"Button_Top",TUTORIAL:"Button_Tutorial",ABOUT:"Button_About"};var MGMDCompoButtonGameBoard=MGBaseNode.extend({mainGame:null,_listButton:null,nodePanel:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(a){MGBaseNode.prototype.initObj.call(this);this.mainGame=a;this._initEventBtnFromNode();this.nodePanel=new cc.Node;this.addChild(this.nodePanel)},_initEventBtnFromNode:function(){this._listButton=[];for(var a=this.getChildren(),b=a.length,d=0;d<b;d++)a[d]instanceof ccui.Button&&(a[d].addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),
this._listButton.push(a[d]))},hideBoard:function(){this.setVisible(!1);this.nodePanel.removeAllChildren(!0)},showBoard:function(){this.setVisible(!0);this.nodePanel.removeAllChildren(!0);for(var a=0;a<this._listButton.length;a++)this._listButton[a].setVisible(!0)},reUpdateMyBet:function(a){a=this.getChildByTag(a);a.setVisible(!1);var b=new cc.Sprite("#HinhMoi.png");b.setPosition(a.getPosition());this.nodePanel.addChild(b)},updateResultBet:function(a,b,d,e){a=this.getChildByTag(a);a.setVisible(!1);
e&&(e=new cc.Sprite("#HinhMoi.png"),e.setPosition(a.getPosition()),this.nodePanel.addChild(e));switch(b){case ConstantsVariable.STATE_DAO_MO.JACKPOT:d=new cc.Sprite("#ChestGold.png");d.setPosition(a.getPosition());this.nodePanel.addChild(d);break;case ConstantsVariable.STATE_DAO_MO.BIGWIN:d=new cc.Sprite("#ThangLonStart.png");d.setPosition(a.getPosition());this.nodePanel.addChild(d);break;case ConstantsVariable.STATE_DAO_MO.NOTHING:d=new cc.Sprite("#imageX.png");d.setPosition(a.getPosition());this.nodePanel.addChild(d);
break;case ConstantsVariable.STATE_DAO_MO.FREE:b=new cc.LabelTTF("Free",ResourceManager.MGResourcesGameDaoMo.FontBD);b.setFontSize(18);b.setColor(cc.color(88,255,48));b.setPosition(a.getPosition());this.nodePanel.addChild(b);break;case ConstantsVariable.STATE_DAO_MO.X2:case ConstantsVariable.STATE_DAO_MO.X5:case ConstantsVariable.STATE_DAO_MO.X10:case ConstantsVariable.STATE_DAO_MO.X1:case ConstantsVariable.STATE_DAO_MO.X50:case ConstantsVariable.STATE_DAO_MO.X100:b=new cc.LabelTTF(b+"X",ResourceManager.MGResourcesGameDaoMo.FontBD),
0<d&&(Utilities.showLog("GOLD VALUE "+d),d=Utilities.Coin(d),d=this.converToK(d),b.setString(d)),b.setFontSize(20),b.setColor(cc.color(253,223,69)),b.setPosition(a.getPosition()),this.nodePanel.addChild(b)}},converToK:function(a){var b=a;if(4<a.length){for(var b="",d=0;d<a.length-4;d++)b+=a[d];a=a[a.length-3];0!=a&&(b=b+"."+a);b+="K"}return b},onClickBtnFromCocostudio:function(a,b){var d=a.getTag();0==b&&(Utilities.showLog("Button Click "+a.getName()),0<=d&&29>=d&&(Utilities.showLog(d),this.mainGame.bet(d)))}});var MGDMHistoryCell=MGBaseNode.extend({containThangLon:null,_textPhien:null,_textThoiGian:null,_textBet:null,_textWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDaoMo.UIMGUIDMNodeHistoryJSON,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("Image_BG");this._textPhien=this.containThangLon.getChildByName("Text_Phien");this._textPhien.ignoreContentAdaptWithSize(!0);
this._textThoiGian=this.containThangLon.getChildByName("Text_Time");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textBet=this.containThangLon.getChildByName("Text_Bet");this._textBet.ignoreContentAdaptWithSize(!0);this._textWin=this.containThangLon.getChildByName("Text_Win");this._textWin.ignoreContentAdaptWithSize(!0)},_getThoiGian:function(a){var b=null,d=null,e=null,b=9<a.getSeconds()?a.getSeconds():"0"+a.getSeconds(),d=9<a.getMinutes()?a.getMinutes():"0"+a.getMinutes(),e=9<a.getHours()?
a.getHours():"0"+a.getHours();this._textThoiGian.setString(e+":"+d+":"+b+"  "+a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear())},getContainLS:function(a,b,d,e){this._textPhien.setString(a);this._getThoiGian(b);this._textBet.setString(Utilities.Coin(d));this._textWin.setString(Utilities.Coin(e))}});var MGDMTopWinCell=MGBaseNode.extend({containThangLon:null,_textPhien:null,_textThoiGian:null,_textWin:null,ctor:function(){MGBaseNode.prototype.ctor.call(this)},initObj:function(){MGBaseNode.prototype.initObj.call(this);this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDaoMo.UIMGUIDMNodeTopWinJSON,PreLoaderConfig.PathToResourceDefault).node);this.containThangLon=this.getChildByName("Image_BG");this._textPhien=this.containThangLon.getChildByName("Text_Phien");this._textPhien.ignoreContentAdaptWithSize(!0);
this._textThoiGian=this.containThangLon.getChildByName("Text_Time");this._textThoiGian.ignoreContentAdaptWithSize(!0);this._textWin=this.containThangLon.getChildByName("Text_Win");this._textWin.ignoreContentAdaptWithSize(!0)},getContainBigWin:function(a,b,d){this._textPhien.setString(a);this._textThoiGian.setString(b);this._textWin.setString(Utilities.Coin(d))}});var MGDMHistoryLayer=MGMoveablePopup.extend({_listLichSu:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDaoMo.UIMGUIDMHistoryJSON,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("Panel");this.setMoveInfo(this.getChildByName("MGBackGround"))},_initBackGround:function(){var a=new ccui.Layout;
a.setContentSize(4E3,4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this.getChildByName("Button_Close").addClickEventListener(this.hidePopup.bind(this))},getContainLichSu:function(a,b,d,e){var f=new MGDMHistoryCell;f.initObj();f.getContainLS(a,b,d,e);f.containThangLon.removeFromParent(!0);
this._listLichSu.insertCustomItem(f.containThangLon,0);this._showListLichSu()},_showListLichSu:function(){this._listLichSu.getItems().length>=MGDMHistoryLayer.MAX_LINE&&this._listLichSu.removeItem(MGDMHistoryLayer.MAX_LINE-1)},hidePopup:function(){this.setVisible(!1)},showPopup:function(){this.setVisible(!0)},setDispose:function(){MGMoveablePopup.prototype.setDispose.call(this)}});MGDMHistoryLayer.MAX_LINE=100;var MGDMTopWinlayer=MGMoveablePopup.extend({_listLichSu:null,ctor:function(){MGMoveablePopup.prototype.ctor.call(this)},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this._initBackGround();this.cloneFromNode(ccs.load(ResourceManager.MGResourcesGameDaoMo.UIMGUIDMTopWinJSON,PreLoaderConfig.PathToResourceDefault).node);this._initEventsGame();this._listLichSu=this.getChildByName("Panel");this.setMoveInfo(this.getChildByName("MGBackGround"));this.hidePopup()},_initBackGround:function(){var a=
new ccui.Layout;a.setContentSize(4E3,4E3);a.setAnchorPoint(.5,.5);a.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID);a.setBackGroundColor(cc.color(0,0,0));a.setBackGroundColorOpacity(200);a.setTouchEnabled(!0);this.addChild(a,0)},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this.getChildByName("Button_Close").addClickEventListener(this.hidePopup.bind(this))},getContainThangLon:function(a,b,d){var e=new MGDMTopWinCell;e.initObj();e.getContainBigWin(a,b,d);e.containThangLon.removeFromParent(!0);
this._listLichSu.insertCustomItem(e.containThangLon,0);this._showListLichSu()},_showListLichSu:function(){this._listLichSu.getItems().length>=MGDMTopWinlayer.MAX_LINE&&this._listLichSu.removeItem(MGDMTopWinlayer.MAX_LINE-1)},removeAllItem:function(){0<this._listLichSu.getItems().length&&this._listLichSu.removeAllItems()},hidePopup:function(){this.setVisible(!1)},showPopup:function(){this.setVisible(!0)},setDispose:function(){MGMoveablePopup.prototype.setDispose.call(this)}});
MGDMTopWinlayer.MAX_LINE=50;var MGDaoMo=MGMoveablePopup.extend({netSend:null,compoHub:null,compoHistory:null,compoTopWin:null,boxGoldList:null,listBet:null,selectValue:0,compoButtonGameBoard:null,countBet:0,tongBet:0,matchID:0,compoEffect:null,lastWin:0,listMyBet:null,typeBet:0,ctor:function(){MGMoveablePopup.prototype.ctor.call(this);this.resourceGame=resourcesDaoMo},initObj:function(){MGMoveablePopup.prototype.initObj.call(this);this.netSend=new MGNetSendDaoMo(this);this._initUI();this._initEventsGame();this.setMoveInfo(this._mainLayer.getChildByName("MGBackGround"));
this.setMoveInfo(this._mainLayer.getChildByName("Image_Title"));this.compoHub=new MGDMCompoHub;this.compoHub.cloneFromNode(this._mainLayer.getChildByName("MGDMHub"));this.compoHub.initObj(this);this.addChild(this.compoHub);this.compoHub.hideButtonVaoMo();this.compoHub.hideAllButtonBet();this.compoButtonGameBoard=new MGMDCompoButtonGameBoard;this.compoButtonGameBoard.cloneFromNode(this._mainLayer.getChildByName("MGDM_MinerBoard"));this.compoButtonGameBoard.initObj(this);this.addChild(this.compoButtonGameBoard);
this.compoButtonGameBoard.hideBoard();this.listMyBet=[]},_initUI:function(){this._initFromCocostudio(ResourceManager.MGResourcesGameDaoMo.UIMGUIDaoMoJSON,PreLoaderConfig.PathToResourceDefault)},initCompoEffect:function(){this.compoEffect=new MGDMCompoEffect;this.compoEffect.initObj();this.compoEffect.setPosition(this._mainLayer.getChildByName("NodeEffect").getPosition());this.addChild(this.compoEffect)},_initEventsGame:function(){MGMoveablePopup.prototype._initEventsGame.call(this);this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.GameData.toString(),
this.ngGameData.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.StartGame.toString(),this.ngStartGame.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.AccumulateBoxInfo.toString(),this.ngAccumulateBoxInfo.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.TopBigWin.toString(),this.ngTopBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.ChoiceGameMini.toString(),
this.ngChoiceGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.ResultGameMini.toString(),this.ngResultGameMini.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.WinBigWin.toString(),this.ngWinBigWin.bind(this)));this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_DAO_MO.WinJackpot.toString(),this.ngWinJackpot.bind(this)))},ngGameData:function(a){a=a.getUserData();
var b=BinaryConstants.DataTypeID,b={Status:b.UInt8,TimeRemain:b.UInt16,ListCoinCanBet:b.Array8,ListCoinCanBet_Type:b.UInt64,TotalTimesBet:b.UInt32,MatchID:b.UInt32,CoinUser:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngGameData : "+JSON.stringify(a));this.listBet=[];this.listBet=a.ListCoinCanBet;this.selectValue=this.listBet[0];this.tongBet=this.countBet=a.TotalTimesBet;this.compoHub.updateCon(this.countBet);this.matchID=a.MatchID;this.compoHub.showButtonVaoMo();this.compoHub.showCanSelectValueBet()},
ngStartGame:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={MatchID:b.UInt64,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngStartGame : "+JSON.stringify(a));this.matchID=a.MatchID;this.countBet=this.tongBet;this.hideGameBoard();for(this.showGameBoard();0<this.listMyBet.length;)this.listMyBet.pop();this.listMyBet.length=0;this.compoHub.updateTotalBet(0);this.compoHub.updateCurrentWin(0);this.compoHub.updateCon(this.countBet);this.compoHub.lockAllButtonBet();
this.compoHub.handleRaMo()},ngAccumulateBoxInfo:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Info:b.Array8,Info_Type:b.Object8,Info_Type_Struct:{TypeBox:b.UInt8,CoinBet:b.UInt64,AccumulateCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngAccumulateBoxInfo : "+JSON.stringify(a));this.boxGoldList=[];for(b=0;b<a.Info.length;b++)this.boxGoldList.push(a.Info[b].AccumulateCoin);this.compoHub.updateBoxGold(this.boxGoldList[this.typeBet])},ngWinBigWin:function(a){a=
a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,NickName:b.StringDynamic,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);a.UserID==MGGameInfo.myInfo.UserID&&(this.compoEffect||this.initCompoEffect(),this.compoEffect.playBigWin(a.Coin))},ngWinJackpot:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={UserID:b.UInt32,NickName:b.StringDynamic,Coin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);a.UserID==MGGameInfo.myInfo.UserID&&(this.compoEffect||this.initCompoEffect(),
this.compoEffect.playWinBonus(a.Coin))},ngTopBigWin:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Info:b.Array8,Info_Type:b.Object8,Info_Type_Struct:{UserID:b.UInt32,NickName:b.StringDynamic,BonusCoin:b.UInt64}};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngTopBigWin : "+JSON.stringify(a));null==this.compoTopWin&&(this.compoTopWin=new MGDMTopWinlayer,this.compoTopWin.initObj(),this.compoTopWin.setPosition(this._mainLayer.getChildByName("NodeEffect").getPosition()),
this.addChild(this.compoTopWin));if(0<a.Info.length)for(this.compoTopWin.removeAllItem(),b=a.Info.length-1;-1<b;b--)this.compoTopWin.getContainThangLon(b+1,a.Info[b].NickName,a.Info[b].BonusCoin)},ngChoiceGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={Index:b.UInt32,Value:b.UInt32,Bonus:b.UInt64,Remain:b.UInt32,TotalCoinBet:b.UInt64,TotalCoinWin:b.UInt64};a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ChoiceGameMini : "+JSON.stringify(a));this.compoButtonGameBoard.updateResultBet(a.Index,
a.Value,a.Bonus,!0);this.listMyBet.push(a.Index);this.countBet=a.Remain;this.compoHub.updateCon(this.countBet);this.compoHub.updateTotalBet(a.TotalCoinBet);this.compoHub.updateCurrentWin(a.TotalCoinWin)},ngResultGameMini:function(a){a=a.getUserData();var b=BinaryConstants.DataTypeID,b={CoinBet:b.UInt64,TotalCoinBet:b.UInt64,TotalCoinWin:b.UInt64,ResultInfo:b.Array8,ResultInfo_Type:b.UInt32};this.hideGameBoard();this.showGameBoard();a=(new BinaryParser).initObj(b,a.content);Utilities.showLog("ngResultGameMini : "+
JSON.stringify(a));for(var b=a.ResultInfo,d=0;d<this.listMyBet.length;d++)this.compoButtonGameBoard.reUpdateMyBet(this.listMyBet[d]);for(d=0;d<b.length;d++)this.compoButtonGameBoard.updateResultBet(d,b[d],this.getGoldWinValue(b[d]),!1);null==this.compoHistory&&(this.compoHistory=new MGDMHistoryLayer,this.compoHistory.initObj(),this.compoHistory.setPosition(this._mainLayer.getChildByName("NodeEffect").getPosition()),this.addChild(this.compoHistory));this.compoHistory.getContainLichSu(this.matchID,
new Date,a.CoinBet,a.TotalCoinWin);this.compoHistory.hidePopup();this.compoHub.handleWaitServer();this.compoHub.updateTotalBet(a.TotalCoinBet);this.compoHub.updateCurrentWin(a.TotalCoinWin);this.compoHub.unLockAllButtonBet()},getGoldWinValue:function(a){var b=0;switch(a){case ConstantsVariable.STATE_DAO_MO.X1:b=this.selectValue;break;case ConstantsVariable.STATE_DAO_MO.X2:b=2*this.selectValue;break;case ConstantsVariable.STATE_DAO_MO.X5:b=5*this.selectValue;break;case ConstantsVariable.STATE_DAO_MO.X10:b=
10*this.selectValue;break;case ConstantsVariable.STATE_DAO_MO.X50:b=50*this.selectValue;break;case ConstantsVariable.STATE_DAO_MO.X100:b=100*this.selectValue}return b},closeGame:function(){this.netSend.sendLeaveDesk()},showHistory:function(){null==this.compoHistory&&(this.compoHistory=new MGDMHistoryLayer,this.compoHistory.initObj(),this.compoHistory.setPosition(this._mainLayer.getChildByName("NodeEffect").getPosition()),this.addChild(this.compoHistory));this.compoHistory.showPopup()},updateBoxGold:function(a){this.compoHub.updateBoxGold(this.boxGoldList[a]);
this.selectValue=this.listBet[a]},bet:function(a){0>=this.countBet?Utilities.showLog("Can not bet"):this.netSend.sendBet(a,this.selectValue)},sendVaoMo:function(){this.netSend.sendVaoMo(this.selectValue)},sendRaMo:function(){this.netSend.sendRaMo()},showGameBoard:function(){this.compoButtonGameBoard.showBoard()},hideGameBoard:function(){this.compoButtonGameBoard.hideBoard()},showTopWin:function(){null==this.compoTopWin&&(this.compoTopWin=new MGDMTopWinlayer,this.compoTopWin.initObj(),this.compoTopWin.setPosition(this._mainLayer.getChildByName("NodeEffect").getPosition()),
this.addChild(this.compoTopWin));this.compoTopWin.showPopup()},setDispose:function(){MGMoveablePopup.prototype.setDispose.call(this)},onExit:function(){MGMoveablePopup.prototype.onExit.call(this)}});